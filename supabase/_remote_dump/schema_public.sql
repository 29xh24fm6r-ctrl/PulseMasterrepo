


SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;


CREATE SCHEMA IF NOT EXISTS "public";


ALTER SCHEMA "public" OWNER TO "pg_database_owner";


COMMENT ON SCHEMA "public" IS 'standard public schema';



CREATE TYPE "public"."task_status" AS ENUM (
    'pending',
    'active',
    'blocked',
    'completed',
    'archived'
);


ALTER TYPE "public"."task_status" OWNER TO "postgres";


CREATE TYPE "public"."xp_kind" AS ENUM (
    'xp_physical',
    'xp_discipline',
    'xp_identity',
    'xp_relationship',
    'xp_career',
    'xp_mind',
    'xp_spirit'
);


ALTER TYPE "public"."xp_kind" OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."_canon_has_col"("p_schema" "text", "p_table" "text", "p_col" "text") RETURNS boolean
    LANGUAGE "sql" STABLE
    AS $$
  select exists (
    select 1
    from information_schema.columns
    where table_schema=p_schema
      and table_name=p_table
      and column_name=p_col
  );
$$;


ALTER FUNCTION "public"."_canon_has_col"("p_schema" "text", "p_table" "text", "p_col" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."_canon_try_uuid"("p_text" "text") RETURNS "uuid"
    LANGUAGE "plpgsql" IMMUTABLE
    AS $$
declare
  v uuid;
begin
  if p_text is null or btrim(p_text) = '' then
    return null;
  end if;

  begin
    v := p_text::uuid;
    return v;
  exception when others then
    return null;
  end;
end;
$$;


ALTER FUNCTION "public"."_canon_try_uuid"("p_text" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."_ddl_guard_user_id_fk"() RETURNS "event_trigger"
    LANGUAGE "plpgsql"
    AS $$
declare r record;
declare v_count int;
begin
  -- If any FK appears touching user_id after this DDL, block it.
  select count(*) into v_count
  from pg_constraint con
  join pg_class c on c.oid = con.conrelid
  join pg_namespace n on n.oid = c.relnamespace
  join pg_attribute a on a.attrelid = con.conrelid and a.attnum = any(con.conkey)
  where con.contype = 'f'
    and n.nspname = 'public'
    and a.attname = 'user_id';

  if v_count > 0 then
    raise exception
      'DDL blocked: foreign keys referencing user_id are forbidden (Clerk IDs). Remove FK and use app-level validation instead.';
  end if;
end;
$$;


ALTER FUNCTION "public"."_ddl_guard_user_id_fk"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."_ddl_guard_user_id_identity"() RETURNS "event_trigger"
    LANGUAGE "plpgsql"
    AS $$
declare r record;
begin
  -- Inspect objects affected by DDL in this command
  for r in
    select * from pg_event_trigger_ddl_commands()
  loop
    -- Only care about public schema changes
    if r.schema_name <> 'public' then
      continue;
    end if;

    -- If a table was created or altered, check if it now has user_id not text
    -- We do a post-DDL check by scanning information_schema for any violations.
    perform 1
    from public.schema_identity_violations
    limit 1;

    if found then
      raise exception
        'DDL blocked: user_id must be TEXT (Clerk sub). See public.schema_identity_violations for offenders.';
    end if;
  end loop;
end;
$$;


ALTER FUNCTION "public"."_ddl_guard_user_id_identity"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."_evt_enforce_email_canon_v1"() RETURNS "event_trigger"
    LANGUAGE "plpgsql"
    AS $$
declare
  cmd record;
  ident text;
  tbl text;
begin
  for cmd in select * from pg_event_trigger_ddl_commands()
  loop
    -- We only care about tables in public schema
    if cmd.object_type = 'table' and cmd.schema_name = 'public' then
      ident := cmd.object_identity; -- typically like: public.email_accounts

      -- enforce only email_* tables
      if ident like 'public.email\_%' escape '\' then
        -- extract table name from object_identity and strip quotes
        tbl := replace(replace(ident, 'public.', ''), '"', '');

        -- If the enforcement function exists, run it. If not, do nothing.
        if exists (
          select 1
          from pg_proc
          where pronamespace = 'public'::regnamespace
            and proname = 'enforce_email_canon_v1_for_table'
        ) then
          perform public.enforce_email_canon_v1_for_table(tbl);
        end if;
      end if;
    end if;
  end loop;
end;
$$;


ALTER FUNCTION "public"."_evt_enforce_email_canon_v1"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."_jobq_now_utc"() RETURNS timestamp with time zone
    LANGUAGE "sql"
    AS $$
  select now();
$$;


ALTER FUNCTION "public"."_jobq_now_utc"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."_jq_pick_ts_col"("p_table" "text") RETURNS "text"
    LANGUAGE "plpgsql" SECURITY DEFINER
    SET "search_path" TO 'public'
    AS $$
declare
  v_has_ts boolean;
  v_has_created_at boolean;
begin
  select exists (
    select 1 from information_schema.columns
    where table_schema='public' and table_name=p_table and column_name='ts'
  ) into v_has_ts;

  if v_has_ts then
    return 'ts';
  end if;

  select exists (
    select 1 from information_schema.columns
    where table_schema='public' and table_name=p_table and column_name='created_at'
  ) into v_has_created_at;

  if v_has_created_at then
    return 'created_at';
  end if;

  return null;
end;
$$;


ALTER FUNCTION "public"."_jq_pick_ts_col"("p_table" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."assert_canonical_schema"("p_domain" "text" DEFAULT NULL::"text") RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
begin
  perform public.canon_assert(p_domain);
end;
$$;


ALTER FUNCTION "public"."assert_canonical_schema"("p_domain" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."assert_email_canonical"() RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
begin
  perform public.canon_assert('email'::text);
end;
$$;


ALTER FUNCTION "public"."assert_email_canonical"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."assert_no_user_id_fks"() RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
declare
  v_cnt int;
begin
  select count(*) into v_cnt
  from pg_constraint con
  join pg_class rel on rel.oid = con.conrelid
  join pg_namespace n on n.oid = rel.relnamespace
  join pg_attribute a on a.attrelid = con.conrelid and a.attnum = any(con.conkey)
  where con.contype = 'f'
    and n.nspname = 'public'
    and a.attname = 'user_id';

  if v_cnt > 0 then
    raise exception
      'CANONICAL VIOLATION: Found % foreign keys on public.*.user_id (forbidden)',
      v_cnt
      using errcode = 'P0001';
  end if;
end;
$$;


ALTER FUNCTION "public"."assert_no_user_id_fks"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."assert_schema_identity"() RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
declare
  v_mode text;
  v_count int;
begin
  select mode into v_mode
  from public.canon_mode
  where id = true;

  if v_mode = 'v1_text' then
    -- Canon V1: user_id MUST be TEXT
    select count(*) into v_count
    from information_schema.columns
    where table_schema = 'public'
      and column_name = 'user_id'
      and data_type <> 'text';

    if v_count > 0 then
      raise exception
        'CANONICAL VIOLATION (V1): Found % user_id columns not TEXT',
        v_count;
    end if;

  elsif v_mode = 'v2_uuid' then
    -- Canon V2: user_id MUST be UUID
    select count(*) into v_count
    from information_schema.columns
    where table_schema = 'public'
      and column_name = 'user_id'
      and data_type <> 'uuid';

    if v_count > 0 then
      raise exception
        'CANONICAL VIOLATION (V2): Found % user_id columns not UUID',
        v_count;
    end if;

  else
    raise exception 'Unknown canon_mode: %', v_mode;
  end if;
end;
$$;


ALTER FUNCTION "public"."assert_schema_identity"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."assert_text_user_id"("val" "anyelement") RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
begin
  if pg_typeof(val)::text != 'text' then
    raise exception 'user_id must be TEXT (Clerk ID). UUIDs are forbidden.';
  end if;
end;
$$;


ALTER FUNCTION "public"."assert_text_user_id"("val" "anyelement") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."canary_ping"() RETURNS boolean
    LANGUAGE "sql" STABLE SECURITY DEFINER
    SET "search_path" TO 'public'
    AS $$
  select true;
$$;


ALTER FUNCTION "public"."canary_ping"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."canon_assert"("p_domain" "text" DEFAULT NULL::"text") RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
declare
  r record;
  actual_type text;
  actual_nullable text;
begin
  for r in
    select *
    from public.canon_rules
    where (p_domain is null or domain = p_domain)
    order by domain, table_name, column_name
  loop
    if not exists (
      select 1 from information_schema.columns
      where table_schema='public'
        and table_name = r.table_name
        and column_name = r.column_name
    ) then
      raise exception 'CANONICAL VIOLATION: missing column %.% (domain=%)',
        r.table_name, r.column_name, r.domain;
    end if;

    select public._canon_type(data_type), is_nullable
      into actual_type, actual_nullable
    from information_schema.columns
    where table_schema='public'
      and table_name = r.table_name
      and column_name = r.column_name;

    if actual_type <> r.data_type then
      raise exception 'CANONICAL VIOLATION: %.% type is %, expected % (domain=%)',
        r.table_name, r.column_name, actual_type, r.data_type, r.domain;
    end if;

    if (r.is_nullable = false and actual_nullable = 'YES') then
      raise exception 'CANONICAL VIOLATION: %.% is nullable but must be NOT NULL (domain=%)',
        r.table_name, r.column_name, r.domain;
    end if;
  end loop;

  for r in
    select * from public.canon_constraints
    where (p_domain is null or domain = p_domain)
  loop
    if r.kind = 'unique_index' then
      if not exists (
        select 1 from pg_indexes
        where schemaname='public' and indexname=r.name
      ) then
        raise exception 'CANONICAL VIOLATION: missing required index % (domain=% table=%)',
          r.name, r.domain, r.table_name;
      end if;
    end if;
  end loop;
end;
$$;


ALTER FUNCTION "public"."canon_assert"("p_domain" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."canon_assert_email"() RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
begin
  perform public.canon_assert('email'::text);
end;
$$;


ALTER FUNCTION "public"."canon_assert_email"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."canon_autofix"("p_domain" "text" DEFAULT NULL::"text") RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
declare
  r record;
  alter_sql text;
  null_sql text;
  default_sql text;
begin
  for r in
    select *
    from public.canon_rules
    where (p_domain is null or domain = p_domain)
    order by domain, table_name, column_name
  loop
    if not exists (
      select 1 from information_schema.columns
      where table_schema='public'
        and table_name = r.table_name
        and column_name = r.column_name
    ) then
      null_sql := case when r.is_nullable then '' else ' not null' end;
      default_sql := case when r.default_sql is null then '' else (' default ' || r.default_sql) end;

      alter_sql := format(
        'alter table public.%I add column if not exists %I %s%s%s;',
        r.table_name,
        r.column_name,
        case r.data_type
          when 'text' then 'text'
          when 'uuid' then 'uuid'
          when 'boolean' then 'boolean'
          when 'jsonb' then 'jsonb'
          when 'timestamptz' then 'timestamptz'
          when 'integer' then 'integer'
          else r.data_type
        end,
        default_sql,
        null_sql
      );

      execute alter_sql;
    end if;
  end loop;

  for r in
    select * from public.canon_constraints
    where (p_domain is null or domain = p_domain)
  loop
    if r.kind = 'unique_index' then
      if not exists (
        select 1 from pg_indexes
        where schemaname='public' and indexname=r.name
      ) then
        execute r.definition_sql;
      end if;
    end if;
  end loop;
end;
$$;


ALTER FUNCTION "public"."canon_autofix"("p_domain" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."canon_autofix_email"() RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
begin
  perform public.canon_autofix('email'::text);
end;
$$;


ALTER FUNCTION "public"."canon_autofix_email"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."canon_is_allowlisted"("p_schema" "text", "p_table" "text") RETURNS boolean
    LANGUAGE "sql" STABLE
    AS $$
  select exists (
    select 1
    from public.canon_migration_allowlist a
    where a.table_schema = p_schema
      and a.table_name   = p_table
  );
$$;


ALTER FUNCTION "public"."canon_is_allowlisted"("p_schema" "text", "p_table" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."canon_replace_pulse_user_owns_row_uuid"("p_schema" "text", "p_table" "text") RETURNS "void"
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $_$
declare
  fqtn text := format('%I.%I', p_schema, p_table);
  tmp_name text := 'pulse_user_owns_row__tmp_uuid';
begin
  -- Create temp policy first (so invariant never breaks)
  execute format($sql$
    drop policy if exists %I on %s;
  $sql$, tmp_name, fqtn);

  execute format($sql$
    create policy %I
    on %s
    for all
    using (user_id = auth.uid())
    with check (user_id = auth.uid());
  $sql$, tmp_name, fqtn);

  -- Now replace canonical policy name
  execute format('drop policy if exists pulse_user_owns_row on %s;', fqtn);
  execute format('alter policy %I on %s rename to pulse_user_owns_row;', tmp_name, fqtn);
end;
$_$;


ALTER FUNCTION "public"."canon_replace_pulse_user_owns_row_uuid"("p_schema" "text", "p_table" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."canon_run_email"() RETURNS "jsonb"
    LANGUAGE "plpgsql"
    AS $$
begin
  -- auto-fix first (adds missing columns + required indexes)
  perform public.canon_autofix_email();

  -- then assert (fails hard if any violation remains)
  perform public.canon_assert_email();

  return jsonb_build_object(
    'ok', true,
    'domain', 'email',
    'ran_at', now()
  );
exception
  when others then
    return jsonb_build_object(
      'ok', false,
      'domain', 'email',
      'ran_at', now(),
      'error', sqlerrm
    );
end;
$$;


ALTER FUNCTION "public"."canon_run_email"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."compute_entity_importance"("entity_id_param" "uuid", "match_user_id" "text") RETURNS numeric
    LANGUAGE "plpgsql"
    AS $$
declare
  mention_score numeric;
  connection_score numeric;
  recency_score numeric;
  total_score numeric;
begin
  -- Mention score (0-4 points)
  select least(4, ln(mention_count + 1)) into mention_score
  from tb_entities
  where id = entity_id_param and user_id = match_user_id;
  
  -- Connection score (0-3 points based on number of edges)
  select least(3, count(*) * 0.5) into connection_score
  from tb_entity_edges
  where user_id = match_user_id
    and (from_entity_id = entity_id_param or to_entity_id = entity_id_param);
  
  -- Recency score (0-3 points based on last seen)
  select 
    case 
      when last_seen_at > now() - interval '1 day' then 3
      when last_seen_at > now() - interval '7 days' then 2
      when last_seen_at > now() - interval '30 days' then 1
      else 0
    end into recency_score
  from tb_entities
  where id = entity_id_param and user_id = match_user_id;
  
  total_score := coalesce(mention_score, 0) + coalesce(connection_score, 0) + coalesce(recency_score, 0);
  
  return least(10, total_score);
end;
$$;


ALTER FUNCTION "public"."compute_entity_importance"("entity_id_param" "uuid", "match_user_id" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."compute_job_queue_alerts"() RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
declare
  v record;
begin
  select * into v
  from public.job_queue_health_snapshots
  order by created_at desc
  limit 1;

  if v.id is null then return; end if;

  if v.status = 'critical' then
    insert into public.job_queue_alerts(severity, code, message, meta)
    values ('crit','QUEUE_CRITICAL','Scheduler health is critical', to_jsonb(v));
  elsif v.status = 'degraded' then
    insert into public.job_queue_alerts(severity, code, message, meta)
    values ('warn','QUEUE_DEGRADED','Scheduler health is degraded', to_jsonb(v));
  end if;

  if coalesce(v.starvation_count,0) > 0 then
    insert into public.job_queue_alerts(severity, code, message, meta)
    values ('warn','STARVATION_DETECTED','Starvation detected in queue', jsonb_build_object('starvation_count', v.starvation_count));
  end if;
end;
$$;


ALTER FUNCTION "public"."compute_job_queue_alerts"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."compute_job_queue_budget_rollover"("p_day" "date") RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
begin
  insert into public.job_queue_budget_rollover (
    user_id,
    tier,
    day,
    carried_forward,
    expires_at
  )
  select
    b.user_id,
    coalesce(b.tier, ut.tier, 'free') as tier,
    p_day,
    greatest(
      floor((b.budget - b.spent) * (1 - coalesce(t.decay_rate, 0.0))),
      0
    )::int as carried_forward,
    now() + interval '7 days'
  from public.job_queue_daily_budget b
  left join public.job_queue_user_tiers ut
    on ut.user_id = b.user_id
  left join public.job_queue_tiers t
    on t.tier = coalesce(b.tier, ut.tier, 'free')
  where b.day = p_day
    and b.budget > b.spent
  on conflict do nothing;
end;
$$;


ALTER FUNCTION "public"."compute_job_queue_budget_rollover"("p_day" "date") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."compute_job_queue_health"("p_window_seconds" integer DEFAULT 300) RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
declare
  v_end timestamptz := now();
  v_start timestamptz := now() - make_interval(secs => p_window_seconds);
  v_queue_depth int;
  v_mean_wait numeric;
  v_p95_wait numeric;
  v_starvation int;
  v_sla_breaches int;
  v_retry_pressure numeric;
  v_score int;
  v_status text;
  v_warnings text[] := '{}'::text[];
begin
  -- queue depth (assumes job_queue table exists)
  select count(*) into v_queue_depth
  from public.job_queue
  where status in ('queued','ready');

  -- wait times (requires enqueued_at/created_at; uses created_at fallback)
  select
    avg(extract(epoch from (v_end - coalesce(first_enqueued_at, created_at)))),
    percentile_cont(0.95) within group (order by extract(epoch from (v_end - coalesce(first_enqueued_at, created_at))))
  into v_mean_wait, v_p95_wait
  from public.job_queue
  where status in ('queued','ready');

  -- starvation / sla signals (based on age thresholds)
  select count(*) into v_starvation
  from public.job_queue
  where status in ('queued','ready')
    and (v_end - coalesce(first_enqueued_at, created_at)) > interval '15 minutes';

  select count(*) into v_sla_breaches
  from public.job_queue
  where status in ('queued','ready')
    and (v_end - coalesce(first_enqueued_at, created_at)) > interval '30 minutes';

  -- retry pressure (assumes attempts column)
  select coalesce(avg(attempts), 0) into v_retry_pressure
  from public.job_queue
  where status in ('queued','ready');

  -- scoring (simple, stable, tunable)
  v_score := 100;

  if v_queue_depth > 500 then v_score := v_score - 20; v_warnings := array_append(v_warnings, 'high_queue_depth'); end if;
  if coalesce(v_p95_wait,0) > 600 then v_score := v_score - 25; v_warnings := array_append(v_warnings, 'p95_wait_high'); end if;
  if v_starvation > 0 then v_score := v_score - least(30, v_starvation); v_warnings := array_append(v_warnings, 'starvation_detected'); end if;
  if v_sla_breaches > 0 then v_score := v_score - 30; v_warnings := array_append(v_warnings, 'sla_risk'); end if;
  if coalesce(v_retry_pressure,0) > 2 then v_score := v_score - 10; v_warnings := array_append(v_warnings, 'retry_pressure'); end if;

  v_score := greatest(0, least(100, v_score));

  if v_score >= 80 then
    v_status := 'healthy';
  elsif v_score >= 50 then
    v_status := 'degraded';
  else
    v_status := 'critical';
  end if;

  insert into public.job_queue_health_snapshots (
    window_start, window_end, queue_depth,
    mean_wait_seconds, p95_wait_seconds,
    starvation_count, sla_breach_count,
    retry_pressure, score, status, warnings
  )
  values (
    v_start, v_end, v_queue_depth,
    v_mean_wait, v_p95_wait,
    v_starvation, v_sla_breaches,
    v_retry_pressure, v_score, v_status, v_warnings
  );
end;
$$;


ALTER FUNCTION "public"."compute_job_queue_health"("p_window_seconds" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."create_canonical_user_table"("p_schema" "text", "p_table" "text", "p_with_id" boolean DEFAULT true) RETURNS "void"
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $_$
declare
  fqtn text := format('%I.%I', p_schema, p_table);
  v_mode text;
begin
  if p_schema is null or p_schema = '' or p_table is null or p_table = '' then
    raise exception 'schema/table required';
  end if;

  select mode into v_mode
  from public.canon_mode
  where id = true;

  if v_mode is null then
    v_mode := 'v1_text';
  end if;

  -- Create table if missing
  if to_regclass(fqtn) is null then
    if v_mode = 'v2_uuid' then
      if p_with_id then
        execute format($sql$
          create table %s (
            id uuid primary key default gen_random_uuid(),
            user_id uuid not null default auth.uid(),
            created_at timestamptz not null default now(),
            updated_at timestamptz not null default now()
          );
        $sql$, fqtn);
      else
        execute format($sql$
          create table %s (
            user_id uuid not null default auth.uid(),
            created_at timestamptz not null default now(),
            updated_at timestamptz not null default now()
          );
        $sql$, fqtn);
      end if;
    else
      -- V1 legacy
      if p_with_id then
        execute format($sql$
          create table %s (
            id uuid primary key default gen_random_uuid(),
            user_id text not null default public.current_user_sub(),
            created_at timestamptz not null default now(),
            updated_at timestamptz not null default now()
          );
        $sql$, fqtn);
      else
        execute format($sql$
          create table %s (
            user_id text not null default public.current_user_sub(),
            created_at timestamptz not null default now(),
            updated_at timestamptz not null default now()
          );
        $sql$, fqtn);
      end if;
    end if;
  end if;

  -- Enable RLS
  execute format('alter table %s enable row level security;', fqtn);

  -- Drop+create canonical policy (protected by canon)
  execute format('drop policy if exists pulse_user_owns_row on %s;', fqtn);

  if v_mode = 'v2_uuid' then
    execute format($sql$
      create policy pulse_user_owns_row
      on %s
      for all
      using (user_id = auth.uid())
      with check (user_id = auth.uid());
    $sql$, fqtn);
  else
    execute format($sql$
      create policy pulse_user_owns_row
      on %s
      for all
      using (public.current_user_sub() = user_id)
      with check (public.current_user_sub() = user_id);
    $sql$, fqtn);
  end if;

  -- Gate check
  perform public.pulse_canon_gate();
end;
$_$;


ALTER FUNCTION "public"."create_canonical_user_table"("p_schema" "text", "p_table" "text", "p_with_id" boolean) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."create_tasks_for_needs_response"("p_owner_user_id" "text", "p_limit" integer DEFAULT 50) RETURNS integer
    LANGUAGE "plpgsql"
    AS $$
declare
  created_count int := 0;
begin
  -- Create tasks only where one doesn't already exist due to unique index
  insert into public.crm_tasks (
    owner_user_id,
    contact_id,
    title,
    status,
    priority,
    due_at,
    source_table,
    source_id
  )
  select
    t.owner_user_id,
    null::uuid as contact_id,
    ('Reply: ' || coalesce(t.subject, '(No subject)')) as title,
    'open' as status,
    'high' as priority,
    (now() + interval '1 day')::timestamptz as due_at,
    'email_threads' as source_table,
    t.thread_id::text as source_id
  from public.email_threads t
  where t.owner_user_id = p_owner_user_id
    and t.needs_response = true
  order by coalesce(t.last_activity_at, t.last_message_at, t.last_email_at) desc
  limit p_limit
  on conflict do nothing;

  get diagnostics created_count = row_count;
  return created_count;
end;
$$;


ALTER FUNCTION "public"."create_tasks_for_needs_response"("p_owner_user_id" "text", "p_limit" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."crm_block_writes_to_merged_contacts"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
begin
  if exists (
    select 1
    from public.crm_contacts c
    where c.id = new.contact_id
      and (
        c.status = 'merged'
        or c.merged_into_contact_id is not null
      )
  ) then
    raise exception 'Cannot write to merged contact_id %', new.contact_id;
  end if;

  return new;
end
$$;


ALTER FUNCTION "public"."crm_block_writes_to_merged_contacts"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."crm_contacts_foundation_before_write"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
declare
  existing_id uuid;
  full_name_local text;
begin
  -- ============================================================
  -- A) NORMALIZATION LAYER
  -- ============================================================

  -- full_name: set if missing
  if new.full_name is null or length(trim(new.full_name)) = 0 then
    full_name_local := trim(coalesce(new.first_name, '') || ' ' || coalesce(new.last_name, ''));
    if length(full_name_local) = 0 then
      new.full_name := null;
    else
      new.full_name := full_name_local;
    end if;
  end if;

  -- display_name: set if missing (prefer full_name)
  if new.display_name is null or length(trim(new.display_name)) = 0 then
    if new.full_name is not null and length(trim(new.full_name)) > 0 then
      new.display_name := trim(new.full_name);
    else
      full_name_local := trim(coalesce(new.first_name, '') || ' ' || coalesce(new.last_name, ''));
      if length(full_name_local) = 0 then
        new.display_name := null;
      else
        new.display_name := full_name_local;
      end if;
    end if;
  end if;

  -- normalized_email from primary_email
  if new.primary_email is null or length(trim(new.primary_email)) = 0 then
    new.normalized_email := null;
  else
    new.normalized_email := lower(trim(new.primary_email));
  end if;

  -- normalized_phone from primary_phone (digits only)
  if new.primary_phone is null or length(trim(new.primary_phone)) = 0 then
    new.normalized_phone := null;
  else
    new.normalized_phone := regexp_replace(new.primary_phone, '[^0-9]+', '', 'g');
    if new.normalized_phone is null or length(new.normalized_phone) = 0 then
      new.normalized_phone := null;
    end if;
  end if;

  -- normalized_full_name: prefer full_name if present
  if new.full_name is null or length(trim(new.full_name)) = 0 then
    full_name_local := lower(trim(coalesce(new.first_name, '') || ' ' || coalesce(new.last_name, '')));
    if length(trim(full_name_local)) = 0 then
      new.normalized_full_name := null;
    else
      new.normalized_full_name := full_name_local;
    end if;
  else
    new.normalized_full_name := lower(trim(new.full_name));
  end if;

  -- updated_at on update (only if column exists; it does in your schema)
  if tg_op = 'UPDATE' then
    new.updated_at := now();
  end if;

  -- ============================================================
  -- B) DEDUP GUARD LAYER
  -- ============================================================
  -- Allow merged records to be written without blocking
  if new.merged_into_contact_id is not null or new.status = 'merged' then
    return new;
  end if;

  -- Guard normalized_email per user_id
  existing_id := null;
  if new.normalized_email is not null and length(trim(new.normalized_email)) > 0 then
    select c.id
      into existing_id
    from public.crm_contacts c
    where c.user_id = new.user_id
      and c.normalized_email = new.normalized_email
      and c.merged_into_contact_id is null
      and (c.status is null or c.status <> 'merged')
      and (tg_op = 'INSERT' or c.id <> new.id)
    limit 1;

    if existing_id is not null then
      raise exception using
        errcode = 'P0001',
        message = 'Duplicate contact blocked: normalized_email already exists for this user.',
        detail  = format(
          'user_id=%s normalized_email=%s existing_contact_id=%s',
          new.user_id, new.normalized_email, existing_id
        ),
        hint    = 'Use the existing contact, or merge contacts instead of creating a duplicate.';
    end if;
  end if;

  -- Guard normalized_phone per user_id
  existing_id := null;
  if new.normalized_phone is not null and length(trim(new.normalized_phone)) > 0 then
    select c.id
      into existing_id
    from public.crm_contacts c
    where c.user_id = new.user_id
      and c.normalized_phone = new.normalized_phone
      and c.merged_into_contact_id is null
      and (c.status is null or c.status <> 'merged')
      and (tg_op = 'INSERT' or c.id <> new.id)
    limit 1;

    if existing_id is not null then
      raise exception using
        errcode = 'P0001',
        message = 'Duplicate contact blocked: normalized_phone already exists for this user.',
        detail  = format(
          'user_id=%s normalized_phone=%s existing_contact_id=%s',
          new.user_id, new.normalized_phone, existing_id
        ),
        hint    = 'Use the existing contact, or merge contacts instead of creating a duplicate.';
    end if;
  end if;

  return new;
end;
$$;


ALTER FUNCTION "public"."crm_contacts_foundation_before_write"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."current_clerk_user_id"() RETURNS "text"
    LANGUAGE "sql" STABLE
    AS $$
  select nullif(auth.jwt() ->> 'sub','');
$$;


ALTER FUNCTION "public"."current_clerk_user_id"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."current_user_id_uuid"() RETURNS "uuid"
    LANGUAGE "sql" STABLE
    AS $$
  select iu.id
  from public.identity_users iu
  where iu.clerk_user_id = public.current_clerk_user_id()
    and iu.is_archived = false
  limit 1;
$$;


ALTER FUNCTION "public"."current_user_id_uuid"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."current_user_row_id"() RETURNS "uuid"
    LANGUAGE "sql" STABLE
    AS $$
      select u.id
      from public.users u
      where u.clerk_user_id = coalesce(
        auth.jwt() ->> 'sub',
        current_setting('request.jwt.claim.sub', true)
      )
      limit 1
    $$;


ALTER FUNCTION "public"."current_user_row_id"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."current_user_sub"() RETURNS "text"
    LANGUAGE "sql" STABLE
    AS $$
  select coalesce(auth.jwt() ->> 'sub', nullif(current_setting('request.jwt.claim.sub', true), ''), null);
$$;


ALTER FUNCTION "public"."current_user_sub"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."ddl_guard_user_id_fk"() RETURNS "event_trigger"
    LANGUAGE "plpgsql"
    AS $$
begin
  perform public.assert_no_user_id_fks();
end;
$$;


ALTER FUNCTION "public"."ddl_guard_user_id_fk"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."ddl_guard_user_id_identity"() RETURNS "event_trigger"
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
declare
  r record;
  obj_schema text;
  obj_name text;
  ddl_txt text := coalesce(current_query(), '');
  has_user_id boolean;
  has_user_id_uuid boolean;
begin
  for r in
    select * from pg_event_trigger_ddl_commands()
  loop
    obj_schema := split_part(r.object_identity, '.', 1);
    obj_name   := split_part(r.object_identity, '.', 2);

    if obj_schema <> 'public' or obj_name = '' then
      continue;
    end if;

    -- Detect columns
    select exists (
      select 1 from information_schema.columns
      where table_schema=obj_schema and table_name=obj_name and column_name='user_id'
    ) into has_user_id;

    select exists (
      select 1 from information_schema.columns
      where table_schema=obj_schema and table_name=obj_name and column_name='user_id_uuid'
    ) into has_user_id_uuid;

    -- V2 allowlisted tables:
    if public.canon_is_allowlisted(obj_schema, obj_name) then
      if not has_user_id_uuid then
        raise exception
          'CANON LOCK (V2): %.% must have user_id_uuid UUID for ownership',
          obj_schema, obj_name;
      end if;
    end if;

    -- Universal locks (still apply)
    if r.command_tag = 'ALTER TABLE'
       and ddl_txt ilike '%disable row level security%'
       and has_user_id then
      raise exception
        'CANON LOCK: cannot DISABLE RLS on %.% (table has user_id)',
        obj_schema, obj_name;
    end if;

    if r.command_tag in ('DROP POLICY','ALTER POLICY')
       and ddl_txt ilike '%pulse_user_owns_row%' then
      raise exception
        'CANON LOCK: pulse_user_owns_row is protected';
    end if;
  end loop;
end;
$$;


ALTER FUNCTION "public"."ddl_guard_user_id_identity"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."ddl_guard_user_id_invariants"() RETURNS "event_trigger"
    LANGUAGE "plpgsql"
    AS $$
declare
  missing_count int;
begin
  /*
    Canon invariant:
    ONLY for public application tables (relkind r/p) that contain a user_id column:
      - RLS must be enabled
      - policy pulse_user_owns_row must exist
    Never enforce on auth/storage/etc schemas, and never on indexes/views.
  */

  select count(*) into missing_count
  from pg_class c
  join pg_namespace n on n.oid = c.relnamespace
  join pg_attribute a on a.attrelid = c.oid
  where n.nspname = 'public'
    and c.relkind in ('r','p')     -- tables + partitioned tables only
    and a.attname = 'user_id'
    and a.attnum > 0
    and not a.attisdropped
    and (
      -- missing RLS
      c.relrowsecurity = false
      or
      -- missing canonical policy
      not exists (
        select 1
        from pg_policy p
        where p.polrelid = c.oid
          and p.polname = 'pulse_user_owns_row'
      )
    );

  if missing_count > 0 then
    raise exception
      using
        errcode = 'P0001',
        message = format(
          'CANON VIOLATION: all PUBLIC tables with user_id must have RLS enabled and policy pulse_user_owns_row (found %s missing)',
          missing_count
        );
  end if;
end;
$$;


ALTER FUNCTION "public"."ddl_guard_user_id_invariants"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."dev_find_user_uuid"() RETURNS TABLE("user_uuid" "uuid", "source_table" "text", "source_column" "text", "raw_value" "text")
    LANGUAGE "plpgsql" SECURITY DEFINER
    SET "search_path" TO 'public'
    AS $_$
declare
  r record;
  v_sql text;
begin
  -- Scan public tables for common user id columns
  for r in
    select
      c.table_schema,
      c.table_name,
      c.column_name,
      c.data_type
    from information_schema.columns c
    where c.table_schema = 'public'
      and c.column_name in ('user_id_uuid', 'user_id', 'user_id_text')
    order by
      -- prefer canonical columns first
      case c.column_name
        when 'user_id_uuid' then 1
        when 'user_id' then 2
        when 'user_id_text' then 3
        else 99
      end,
      c.table_name,
      c.column_name
  loop
    -- If column is UUID, grab it directly
    if r.data_type = 'uuid' then
      v_sql := format(
        'select %1$I::uuid as user_uuid, %2$L as source_table, %3$L as source_column, %1$I::text as raw_value
         from %4$I.%5$I
         where %1$I is not null
         limit 1',
        r.column_name,
        r.table_name,
        r.column_name,
        r.table_schema,
        r.table_name
      );

      return query execute v_sql;

      -- If we already returned something, stop
      if found then
        return;
      end if;

    -- If column is text-ish, only return values that can safely cast to UUID
    elsif r.data_type in ('text', 'character varying', 'character') then
      v_sql := format(
        'select (%1$I)::uuid as user_uuid, %2$L as source_table, %3$L as source_column, %1$I::text as raw_value
         from %4$I.%5$I
         where %1$I is not null
           and %1$I ~* ''^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$''
         limit 1',
        r.column_name,
        r.table_name,
        r.column_name,
        r.table_schema,
        r.table_name
      );

      begin
        return query execute v_sql;

        if found then
          return;
        end if;
      exception
        when others then
          -- Ignore any table/column that errors due to unexpected casts or RLS edge cases
          null;
      end;
    end if;
  end loop;

  -- No rows found across any scanned table.
  return;
end;
$_$;


ALTER FUNCTION "public"."dev_find_user_uuid"() OWNER TO "postgres";

SET default_tablespace = '';

SET default_table_access_method = "heap";


CREATE TABLE IF NOT EXISTS "public"."email_outbox" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id" "text",
    "email_thread_id" "text" NOT NULL,
    "to_email" "text" NOT NULL,
    "subject" "text" NOT NULL,
    "body_text" "text" NOT NULL,
    "safe_checksum" "text" NOT NULL,
    "safe_mode" boolean DEFAULT true NOT NULL,
    "status" "text" DEFAULT 'queued'::"text" NOT NULL,
    "error" "text",
    "evidence" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "attempt_count" integer DEFAULT 0 NOT NULL,
    "max_attempts" integer DEFAULT 6 NOT NULL,
    "next_attempt_at" timestamp with time zone,
    "leased_by" "text",
    "leased_at" timestamp with time zone,
    "lease_expires_at" timestamp with time zone,
    "include_quote" boolean DEFAULT true NOT NULL,
    "quoted_message" "text",
    "last_error" "text",
    "failure_code" "text",
    "auto_fix_suggested" boolean DEFAULT false NOT NULL,
    "auto_fix_payload" "jsonb",
    "send_intent" "text",
    "approved_by_user" boolean DEFAULT false,
    "approved_at" timestamp with time zone,
    "scheduled_send_at" timestamp with time zone,
    "undo_until" timestamp with time zone,
    "cancel_reason" "text",
    "source_draft_id" "uuid",
    "approval_status" "text" DEFAULT 'pending'::"text" NOT NULL,
    "dismissed_at" timestamp with time zone,
    "defer_until" timestamp with time zone,
    "decision_note" "text",
    "trace_id" "uuid",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "email_outbox_send_intent_check" CHECK ((("send_intent" IS NULL) OR ("send_intent" = ANY (ARRAY['safe'::"text", 'real'::"text"])))),
    CONSTRAINT "email_outbox_status_check" CHECK ((("status" IS NULL) OR ("status" = ANY (ARRAY['queued'::"text", 'pending_send'::"text", 'sent'::"text", 'failed'::"text", 'canceled'::"text"])))),
    CONSTRAINT "pulse_user_id_text_only_email_outbox" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."email_outbox" OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."email_outbox_claim"("p_limit" integer, "p_worker_id" "text", "p_lease_seconds" integer DEFAULT 120) RETURNS SETOF "public"."email_outbox"
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
begin
  return query
  with candidates as (
    select o.id
    from public.email_outbox o
    where
      (
        (o.status = 'queued' and (o.next_attempt_at is null or o.next_attempt_at <= now()))
        or
        (o.status = 'sending' and o.lease_expires_at is not null and o.lease_expires_at <= now())
      )
    order by o.created_at asc
    limit greatest(1, least(p_limit, 50))
    for update skip locked
  ),
  updated as (
    update public.email_outbox o
    set
      status = 'sending',
      leased_by = p_worker_id,
      leased_at = now(),
      lease_expires_at = now() + make_interval(secs => greatest(10, p_lease_seconds)),
      -- do not change attempt_count here; we increment when we actually attempt the send
      last_error = null
    where o.id in (select id from candidates)
    returning o.*
  )
  select * from updated;
end;
$$;


ALTER FUNCTION "public"."email_outbox_claim"("p_limit" integer, "p_worker_id" "text", "p_lease_seconds" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."email_outbox_emit_reminders"() RETURNS "trigger"
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
declare
  retry_threshold interval := interval '5 minutes';
begin
  -- Only act if we can route it to a user
  if (new.user_id is null or length(new.user_id) = 0) then
    return new;
  end if;

  -- FAILED => immediate urgent reminder (only on status change)
  if (new.status = 'failed' and (old.status is distinct from new.status)) then
    insert into public.reminder_subscriptions
      (user_id, title, body, severity, source_type, source_id, kind, next_run_at, active)
    values
      (
        new.user_id,
        'Email failed to send',
        coalesce(new.last_error, 'Email failed after max retries') || ' (outbox_id=' || new.id::text || ')',
        'urgent',
        'email_outbox',
        new.id,
        'failed',
        now(),
        true
      )
    on conflict do nothing;
  end if;

  -- RETRY scheduled => warn reminder at next_attempt_at (only if far enough out)
  if (
    new.status = 'queued'
    and new.next_attempt_at is not null
    and (
      old.next_attempt_at is distinct from new.next_attempt_at
      or old.status is distinct from new.status
    )
    and (new.next_attempt_at - now() >= retry_threshold)
  ) then
    insert into public.reminder_subscriptions
      (user_id, title, body, severity, source_type, source_id, kind, next_run_at, active)
    values
      (
        new.user_id,
        'Email retry scheduled',
        'Retrying send later: ' || new.next_attempt_at::text || coalesce(' â€¢ ' || new.last_error, '') || ' (outbox_id=' || new.id::text || ')',
        'warn',
        'email_outbox',
        new.id,
        'retry',
        new.next_attempt_at,
        true
      )
    on conflict do nothing;
  end if;

  return new;
end;
$$;


ALTER FUNCTION "public"."email_outbox_emit_reminders"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."enforce_canonical_schema"("p_domain" "text", "p_table_schema" "text", "p_table_name" "text") RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
declare
  r record;
  actual record;
  problems text := '';
begin
  -- If no rules exist for this table, we don't enforce.
  if not exists (
    select 1
    from public.canonical_schema_rules
    where domain=p_domain and table_schema=p_table_schema and table_name=p_table_name
  ) then
    return;
  end if;

  for r in
    select *
    from public.canonical_schema_rules
    where domain=p_domain and table_schema=p_table_schema and table_name=p_table_name
  loop
    select
      c.data_type as data_type,
      (c.is_nullable='YES') as is_nullable,
      c.column_default as column_default
    into actual
    from information_schema.columns c
    where c.table_schema=p_table_schema and c.table_name=p_table_name and c.column_name=r.column_name;

    if actual.data_type is null then
      problems := problems || format('Missing column %I; ', r.column_name);
      continue;
    end if;

    if actual.data_type <> r.data_type then
      problems := problems || format('Type mismatch %I expected %s got %s; ', r.column_name, r.data_type, actual.data_type);
    end if;

    if actual.is_nullable <> r.is_nullable then
      problems := problems || format('Nullability mismatch %I expected %s got %s; ', r.column_name, r.is_nullable, actual.is_nullable);
    end if;

    -- Default rendering can differ; only enforce "must have a default" when canon has one and actual is null.
    if r.column_default is not null and actual.column_default is null then
      problems := problems || format('Default missing %I expected %s; ', r.column_name, r.column_default);
    end if;
  end loop;

  if problems <> '' then
    raise exception 'canonical_schema_violation [%] %.%: %', p_domain, p_table_schema, p_table_name, problems;
  end if;
end;
$$;


ALTER FUNCTION "public"."enforce_canonical_schema"("p_domain" "text", "p_table_schema" "text", "p_table_name" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."ensure_column"("p_schema" "text", "p_table" "text", "p_column" "text", "p_type" "text", "p_default_sql" "text" DEFAULT NULL::"text", "p_backfill" boolean DEFAULT true) RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
declare
  full_table text := format('%I.%I', p_schema, p_table);
  col_exists boolean;
begin
  select exists (
    select 1
    from information_schema.columns
    where table_schema = p_schema
      and table_name = p_table
      and column_name = p_column
  ) into col_exists;

  if not col_exists then
    execute format(
      'alter table %s add column %I %s',
      full_table,
      p_column,
      p_type
    );

    if p_default_sql is not null then
      execute format(
        'alter table %s alter column %I set default %s',
        full_table,
        p_column,
        p_default_sql
      );

      if p_backfill then
        execute format(
          'update %s set %I = %s where %I is null',
          full_table,
          p_column,
          p_default_sql,
          p_column
        );
      end if;
    end if;
  end if;
end;
$$;


ALTER FUNCTION "public"."ensure_column"("p_schema" "text", "p_table" "text", "p_column" "text", "p_type" "text", "p_default_sql" "text", "p_backfill" boolean) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."ensure_job_queue_daily_budget_row"("p_user_id" "uuid", "p_day" "date", "p_tier" "text") RETURNS "void"
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
begin
  insert into public.job_queue_daily_budget (user_id, day, budget, spent, tier)
  values (p_user_id, p_day, 0, 0, p_tier)
  on conflict (user_id, day) do nothing;
end;
$$;


ALTER FUNCTION "public"."ensure_job_queue_daily_budget_row"("p_user_id" "uuid", "p_day" "date", "p_tier" "text") OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."daily_quests" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "quest_date" "date" NOT NULL,
    "quest_key" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "target" integer DEFAULT 1 NOT NULL,
    "progress" integer DEFAULT 0 NOT NULL,
    "is_completed" boolean DEFAULT false NOT NULL,
    "completed_at" timestamp with time zone,
    "reward_xp" integer DEFAULT 25 NOT NULL,
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_daily_quests" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."daily_quests" OWNER TO "postgres";


COMMENT ON TABLE "public"."daily_quests" IS 'Daily quest missions generated per user per day.';



COMMENT ON COLUMN "public"."daily_quests"."quest_key" IS 'Stable quest identifier for idempotent generation.';



COMMENT ON COLUMN "public"."daily_quests"."meta" IS 'Quest-specific config and evidence.';



CREATE OR REPLACE FUNCTION "public"."evaluate_daily_quests"("p_user_id" "text", "p_quest_date" "date") RETURNS SETOF "public"."daily_quests"
    LANGUAGE "plpgsql"
    AS $$
declare
  v_start timestamptz;
  v_end   timestamptz;
begin
  select day_start, day_end into v_start, v_end
  from public.utc_day_bounds(p_quest_date);

  -- Ensure quests exist (no-op if already created by generator)
  -- (Generator owns creation; evaluator only updates progress.)

  -- For each quest row, compute progress based on quest_key + meta
  -- We update in-place then return all rows.

  -- 1) complete_n_tasks / complete_3_tasks legacy
  update public.daily_quests q
  set progress = least(
        q.target,
        (
          select count(*)
          from public.tasks t
          where t.user_id = p_user_id
            and t.status = 'completed'
            and t.completed_at >= v_start
            and t.completed_at < v_end
        )
      )
  where q.user_id = p_user_id
    and q.quest_date = p_quest_date
    and q.quest_key in ('complete_n_tasks','complete_3_tasks');

  -- 2) focus_finish / complete_1_focus_task
  update public.daily_quests q
  set progress = least(
        q.target,
        (
          select count(*)
          from public.xp_events e
          where e.user_id = p_user_id
            and e.event_type = 'focus_complete'
            and e.occurred_at >= v_start
            and e.occurred_at < v_end
        )
      )
  where q.user_id = p_user_id
    and q.quest_date = p_quest_date
    and q.quest_key in ('focus_finish','complete_1_focus_task');

  -- 3) clear_overdue / clear_1_overdue
  -- A completion counts as "overdue cleared" if due_at existed and was in the past at completion time.
  update public.daily_quests q
  set progress = least(
        q.target,
        (
          select count(*)
          from public.tasks t
          where t.user_id = p_user_id
            and t.status = 'completed'
            and t.completed_at >= v_start
            and t.completed_at < v_end
            and t.due_at is not null
            and t.due_at <= t.completed_at
        )
      )
  where q.user_id = p_user_id
    and q.quest_date = p_quest_date
    and q.quest_key in ('clear_overdue','clear_1_overdue');

  -- 4) complete_high_priority
  update public.daily_quests q
  set progress = least(
        q.target,
        (
          select count(*)
          from public.tasks t
          where t.user_id = p_user_id
            and t.status = 'completed'
            and t.completed_at >= v_start
            and t.completed_at < v_end
            and t.priority >= 5
        )
      )
  where q.user_id = p_user_id
    and q.quest_date = p_quest_date
    and q.quest_key = 'complete_high_priority';

  -- 5) due_soon (complete tasks due within next 24h window at start of day)
  update public.daily_quests q
  set progress = least(
        q.target,
        (
          select count(*)
          from public.tasks t
          where t.user_id = p_user_id
            and t.status = 'completed'
            and t.completed_at >= v_start
            and t.completed_at < v_end
            and t.due_at is not null
            and t.due_at >= v_start
            and t.due_at < (v_start + interval '24 hours')
        )
      )
  where q.user_id = p_user_id
    and q.quest_date = p_quest_date
    and q.quest_key = 'due_soon';

  -- 6) touch_context_work / touch_context_personal (meta.context)
  update public.daily_quests q
  set progress = least(
        q.target,
        (
          select count(*)
          from public.tasks t
          where t.user_id = p_user_id
            and t.status = 'completed'
            and t.completed_at >= v_start
            and t.completed_at < v_end
            and lower(coalesce(t.context,'')) = lower(coalesce(q.meta->>'context',''))
        )
      )
  where q.user_id = p_user_id
    and q.quest_date = p_quest_date
    and q.quest_key in ('touch_context_work','touch_context_personal')
    and (q.meta ? 'context');

  -- Completion flags
  update public.daily_quests q
  set
    is_completed = (q.progress >= q.target),
    completed_at = case
      when (q.progress >= q.target) then coalesce(q.completed_at, now())
      else null
    end
  where q.user_id = p_user_id
    and q.quest_date = p_quest_date;

  -- Return updated rows
  return query
    select *
    from public.daily_quests
    where user_id = p_user_id
      and quest_date = p_quest_date
    order by created_at asc;
end;
$$;


ALTER FUNCTION "public"."evaluate_daily_quests"("p_user_id" "text", "p_quest_date" "date") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."fn_time_bucket_key"("p_at" timestamp with time zone, "p_minutes" integer) RETURNS "text"
    LANGUAGE "sql" IMMUTABLE
    AS $$
  select to_char(
    date_trunc('minute', p_at) - make_interval(mins => (extract(minute from p_at)::int % greatest(1,p_minutes))),
    'YYYYMMDDHH24MI'
  );
$$;


ALTER FUNCTION "public"."fn_time_bucket_key"("p_at" timestamp with time zone, "p_minutes" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."generate_referral_code"() RETURNS "text"
    LANGUAGE "plpgsql"
    AS $$
DECLARE
  chars TEXT := 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
  result TEXT := '';
  i INTEGER;
BEGIN
  FOR i IN 1..8 LOOP
    result := result || substr(chars, floor(random() * length(chars) + 1)::integer, 1);
  END LOOP;
  RETURN 'PULSE-' || result;
END;
$$;


ALTER FUNCTION "public"."generate_referral_code"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."get_active_entities"("match_user_id" "text", "since_days" integer DEFAULT 7, "min_mentions" integer DEFAULT 2) RETURNS TABLE("entity_id" "uuid", "entity_type" "text", "entity_name" "text", "recent_mentions" bigint, "last_mentioned" timestamp with time zone)
    LANGUAGE "plpgsql"
    AS $$
begin
  return query
  select 
    e.id as entity_id,
    e.entity_type,
    e.name as entity_name,
    count(efl.id) as recent_mentions,
    max(f.occurred_at) as last_mentioned
  from tb_entities e
  join tb_entity_fragment_links efl on efl.entity_id = e.id
  join tb_memory_fragments f on f.id = efl.fragment_id
  where e.user_id = match_user_id
    and f.occurred_at > now() - (since_days || ' days')::interval
  group by e.id, e.entity_type, e.name
  having count(efl.id) >= min_mentions
  order by count(efl.id) desc, max(f.occurred_at) desc;
end;
$$;


ALTER FUNCTION "public"."get_active_entities"("match_user_id" "text", "since_days" integer, "min_mentions" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."get_related_entities"("start_entity_id" "uuid", "match_user_id" "text", "max_depth" integer DEFAULT 2, "min_weight" numeric DEFAULT 0.3) RETURNS TABLE("entity_id" "uuid", "entity_type" "text", "entity_name" "text", "depth" integer, "path_weight" numeric)
    LANGUAGE "plpgsql"
    AS $$
begin
  return query
  with recursive entity_graph as (
    -- Base case: start entity
    select 
      e.id as entity_id,
      e.entity_type,
      e.name as entity_name,
      0 as depth,
      1.0::numeric as path_weight
    from tb_entities e
    where e.id = start_entity_id
      and e.user_id = match_user_id
    
    union all
    
    -- Recursive case: connected entities
    select 
      case 
        when edge.from_entity_id = eg.entity_id then edge.to_entity_id
        else edge.from_entity_id
      end as entity_id,
      next_e.entity_type,
      next_e.name as entity_name,
      eg.depth + 1 as depth,
      eg.path_weight * edge.weight as path_weight
    from entity_graph eg
    join tb_entity_edges edge on (
      edge.from_entity_id = eg.entity_id or 
      (edge.to_entity_id = eg.entity_id and edge.bidirectional)
    )
    join tb_entities next_e on next_e.id = case 
      when edge.from_entity_id = eg.entity_id then edge.to_entity_id
      else edge.from_entity_id
    end
    where eg.depth < max_depth
      and edge.weight >= min_weight
      and edge.user_id = match_user_id
      and next_e.user_id = match_user_id
  )
  select distinct on (eg.entity_id)
    eg.entity_id,
    eg.entity_type,
    eg.entity_name,
    eg.depth,
    eg.path_weight
  from entity_graph eg
  where eg.entity_id != start_entity_id
  order by eg.entity_id, eg.depth, eg.path_weight desc;
end;
$$;


ALTER FUNCTION "public"."get_related_entities"("start_entity_id" "uuid", "match_user_id" "text", "max_depth" integer, "min_weight" numeric) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."guard_user_id_types"() RETURNS TABLE("table_name" "text", "user_id_data_type" "text", "ok" boolean)
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
begin
  return query
  select
    c.table_name::text,
    c.data_type::text,
    (c.data_type = 'uuid') as ok
  from information_schema.columns c
  where c.table_schema = 'public'
    and c.column_name = 'user_id'
    and c.table_name in (
      'contacts',
      'tasks',
      'deals',
      'habits',
      'habit_logs',
      'journal_entries'
    );
end;
$$;


ALTER FUNCTION "public"."guard_user_id_types"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."increment_teaching_usage"("teaching_id" "uuid") RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
BEGIN
  UPDATE teachings 
  SET usage_count = usage_count + 1, last_used_at = NOW()
  WHERE id = teaching_id;
END;
$$;


ALTER FUNCTION "public"."increment_teaching_usage"("teaching_id" "uuid") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."is_current_user"("user_id" "text") RETURNS boolean
    LANGUAGE "sql" STABLE
    AS $$
  select user_id = public.current_user_sub()
$$;


ALTER FUNCTION "public"."is_current_user"("user_id" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_provider_from_event_meta"("p_meta" "jsonb") RETURNS "text"
    LANGUAGE "sql" IMMUTABLE
    AS $$
  select coalesce(
    nullif(p_meta->>'provider',''),
    nullif(p_meta#>>'{detail,provider}',''),
    'unknown'
  );
$$;


ALTER FUNCTION "public"."job_provider_from_event_meta"("p_meta" "jsonb") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_provider_health_tick_c10"("p_window_minutes" integer DEFAULT 60, "p_degraded_threshold" numeric DEFAULT 0.10, "p_outage_threshold" numeric DEFAULT 0.30) RETURNS "void"
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
declare
  v_now timestamptz := now();
begin
  -- Recompute counts per provider
  with recent as (
    select
      public.job_provider_from_event_meta(e.meta) as provider,
      (e.meta->>'event') as event
    from public.job_queue_events e
    where e.ts >= v_now - make_interval(mins => greatest(p_window_minutes, 5))
      and (e.meta->>'event') in ('completed','failed')
  ),
  agg as (
    select
      provider,
      count(*) as total,
      count(*) filter (where event='failed') as failed,
      count(*) filter (where event='completed') as completed
    from recent
    group by 1
  ),
  scored as (
    select
      provider,
      total,
      failed,
      completed,
      case when total = 0 then 0 else (failed::numeric / total::numeric) end as failure_rate,
      case
        when total = 0 then 'unknown'
        when (failed::numeric / total::numeric) >= p_outage_threshold then 'outage'
        when (failed::numeric / total::numeric) >= p_degraded_threshold then 'degraded'
        else 'healthy'
      end as status
    from agg
  )
  insert into public.job_provider_health(provider, window_minutes, updated_at, total, failed, completed, failure_rate, status)
  select provider, p_window_minutes, v_now, total, failed, completed, failure_rate, status
  from scored
  on conflict (provider) do update
    set window_minutes = excluded.window_minutes,
        updated_at = excluded.updated_at,
        total = excluded.total,
        failed = excluded.failed,
        completed = excluded.completed,
        failure_rate = excluded.failure_rate,
        status = excluded.status;

  -- Incident log when status is degraded/outage (one row per tick/provider)
  insert into public.job_provider_incidents(provider, at, status, failure_rate, sample_total, sample_failed, meta)
  select provider, v_now, status, failure_rate, total, failed,
         jsonb_build_object('window_minutes', p_window_minutes)
  from public.job_provider_health
  where updated_at = v_now
    and status in ('degraded','outage');

end;
$$;


ALTER FUNCTION "public"."job_provider_health_tick_c10"("p_window_minutes" integer, "p_degraded_threshold" numeric, "p_outage_threshold" numeric) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_adaptive_delay_c10"("p_provider" "text", "p_base_delay_seconds" integer DEFAULT 30, "p_max_delay_seconds" integer DEFAULT 900) RETURNS integer
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
declare
  v_status text;
  v_mult numeric;
  v_base int := greatest(coalesce(p_base_delay_seconds, 30), 5);
  v_max int := greatest(coalesce(p_max_delay_seconds, 900), v_base);
  v_provider text := coalesce(nullif(p_provider,''), 'unknown');
begin
  select status, multiplier
    into v_status, v_mult
  from public.job_provider_health
  where provider = v_provider;

  if v_status is null then
    v_status := 'unknown';
    v_mult := 1.0;
  end if;

  -- Default multipliers if not explicitly set in table:
  if v_mult is null or v_mult <= 0 then
    if v_status = 'healthy' then v_mult := 1.0;
    elsif v_status = 'degraded' then v_mult := 2.0;
    elsif v_status = 'outage' then v_mult := 5.0;
    else v_mult := 1.5;
    end if;
  end if;

  return least(v_max, greatest(5, (v_base * v_mult)::int));
end;
$$;


ALTER FUNCTION "public"."job_queue_adaptive_delay_c10"("p_provider" "text", "p_base_delay_seconds" integer, "p_max_delay_seconds" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_apply_credits"("p_user_id" "uuid", "p_day" "date", "p_delta" integer, "p_reason" "text", "p_job_id" "uuid" DEFAULT NULL::"uuid", "p_meta" "jsonb" DEFAULT '{}'::"jsonb") RETURNS "void"
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
begin
  insert into public.job_queue_credits_ledger(user_id, day, delta, reason, job_id, meta)
  values (p_user_id, p_day, p_delta, p_reason, p_job_id, p_meta);

  insert into public.job_queue_credit_balances(user_id, balance)
  values (p_user_id, p_delta)
  on conflict (user_id) do update
    set balance = public.job_queue_credit_balances.balance + excluded.balance,
        updated_at = now();
end;
$$;


ALTER FUNCTION "public"."job_queue_apply_credits"("p_user_id" "uuid", "p_day" "date", "p_delta" integer, "p_reason" "text", "p_job_id" "uuid", "p_meta" "jsonb") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_complete_c8"("p_job_id" "uuid", "p_worker_id" "text", "p_outcome" "text", "p_error" "text" DEFAULT NULL::"text", "p_output" "jsonb" DEFAULT NULL::"jsonb", "p_meta" "jsonb" DEFAULT '{}'::"jsonb", "p_now" timestamp with time zone DEFAULT "now"()) RETURNS TABLE("job_id" "uuid", "final_status" "text", "refunded" integer, "next_run_at" timestamp with time zone)
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
declare
  v_job record;
  v_new_status text;
  v_refund int := 0;
  v_next_run_at timestamptz := null;

  v_attempts int;
  v_max_attempts int;
  v_day date := (p_now at time zone 'utc')::date;
begin
  select *
    into v_job
  from public.job_queue
  where id = p_job_id
  for update;

  if v_job.id is null then
    raise exception 'job not found: %', p_job_id;
  end if;

  if v_job.status <> 'running' then
    raise exception 'job % not running (status=%)', p_job_id, v_job.status;
  end if;

  if v_job.locked_by is not null and v_job.locked_by <> p_worker_id then
    raise exception 'job % locked_by=% but worker=%', p_job_id, v_job.locked_by, p_worker_id;
  end if;

  v_attempts := coalesce(v_job.attempts, 0);
  v_max_attempts := coalesce(v_job.max_attempts, 3);

  if p_outcome not in ('succeeded','failed','retry') then
    raise exception 'invalid outcome: %', p_outcome;
  end if;

  if p_outcome = 'retry' and v_attempts < v_max_attempts then
    v_new_status := 'queued';
    v_refund := greatest(coalesce(v_job.cost, 0), 0);
    v_next_run_at := p_now + public.job_queue_retry_backoff(v_attempts + 1);

    -- rollback daily spent (best-effort; table may be view)
    begin
      update public.job_queue_daily_budget
      set spent = greatest(spent - v_refund, 0)
      where user_id = v_job.user_id and day = v_day;
    exception when undefined_table then null;
    end;

    -- refund credits (ledger + balance)
    perform public.job_queue_apply_credits(
      v_job.user_id,
      v_day,
      v_refund,
      'refund_retry',
      v_job.id,
      jsonb_build_object('worker_id', p_worker_id, 'meta', coalesce(p_meta,'{}'::jsonb))
    );
  else
    v_new_status := case when p_outcome = 'succeeded' then 'succeeded' else 'failed' end;
  end if;

  insert into public.job_queue_results(job_id, status, output, error, meta)
  values (
    v_job.id,
    v_new_status,
    p_output,
    p_error,
    jsonb_build_object(
      'outcome', p_outcome,
      'worker_id', p_worker_id,
      'refunded', v_refund,
      'next_run_at', v_next_run_at,
      'attempts_before', v_attempts
    ) || coalesce(p_meta,'{}'::jsonb)
  );

  update public.job_queue
  set
    status = v_new_status,
    finished_at = case when v_new_status in ('succeeded','failed') then p_now else null end,
    last_error = case when v_new_status = 'failed' then left(coalesce(p_error,''), 4000) else null end,
    attempts = case when v_new_status = 'queued' then v_attempts + 1 else v_attempts end,
    run_at = case when v_new_status = 'queued' then v_next_run_at else run_at end,
    locked_at = null,
    locked_by = null
  where id = v_job.id;

  job_id := v_job.id;
  final_status := v_new_status;
  refunded := v_refund;
  next_run_at := v_next_run_at;
  return next;
end;
$$;


ALTER FUNCTION "public"."job_queue_complete_c8"("p_job_id" "uuid", "p_worker_id" "text", "p_outcome" "text", "p_error" "text", "p_output" "jsonb", "p_meta" "jsonb", "p_now" timestamp with time zone) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_compute_cost"("p_user_id" "uuid", "p_tier" "text", "p_kind" "text", "p_is_burst" boolean, "p_priority" integer) RETURNS integer
    LANGUAGE "plpgsql" STABLE
    AS $$
declare
  v_base int;
  v_burst numeric;
  v_pri numeric;
  v_cost numeric;
begin
  select base_cost, burst_surcharge, priority_surcharge
    into v_base, v_burst, v_pri
  from public.job_queue_pricing
  where tier = p_tier and kind = p_kind;

  if v_base is null then
    -- fallback to default kind
    select base_cost, burst_surcharge, priority_surcharge
      into v_base, v_burst, v_pri
    from public.job_queue_pricing
    where tier = p_tier and kind = 'default';
  end if;

  v_cost := v_base;

  if p_is_burst then
    v_cost := v_cost * (1 + coalesce(v_burst, 0));
  end if;

  if p_priority >= 10 then
    v_cost := v_cost * (1 + coalesce(v_pri, 0));
  end if;

  return greatest(1, ceil(v_cost))::int;
end;
$$;


ALTER FUNCTION "public"."job_queue_compute_cost"("p_user_id" "uuid", "p_tier" "text", "p_kind" "text", "p_is_burst" boolean, "p_priority" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_effective_budget"("p_user_id" "uuid", "p_day" "date") RETURNS TABLE("tier" "text", "base_budget" integer, "rollover_budget" integer, "burst_budget" integer, "effective_budget" integer)
    LANGUAGE "sql" SECURITY DEFINER
    AS $$
  with resolved_tier as (
    select coalesce(
      (select jt.tier from public.job_queue_user_tiers jt where jt.user_id = p_user_id),
      'free'
    ) as tier
  ),
  tier_cfg as (
    select
      rt.tier,
      coalesce(t.daily_budget, 0)::int as tier_daily_budget
    from resolved_tier rt
    left join public.job_queue_tiers t on t.tier = rt.tier
  ),
  ensure_daily as (
    insert into public.job_queue_daily_budget (user_id, day, budget, spent)
    select
      p_user_id,
      p_day,
      tc.tier_daily_budget,
      0
    from tier_cfg tc
    on conflict (user_id, day) do nothing
    returning 1
  ),
  daily_row as (
    select
      b.user_id,
      b.day,
      b.budget::int as budget
    from public.job_queue_daily_budget b
    where b.user_id = p_user_id and b.day = p_day
  )
  select
    tc.tier,
    coalesce(dr.budget, tc.tier_daily_budget, 0)::int as base_budget,
    0::int as rollover_budget,
    0::int as burst_budget,
    coalesce(dr.budget, tc.tier_daily_budget, 0)::int as effective_budget
  from tier_cfg tc
  left join daily_row dr on true;
$$;


ALTER FUNCTION "public"."job_queue_effective_budget"("p_user_id" "uuid", "p_day" "date") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_heartbeat_c8"("p_job_id" "uuid", "p_worker_id" "text", "p_lease_seconds" integer DEFAULT 120) RETURNS TABLE("ok" boolean, "id" "uuid", "lease_expires_at" timestamp with time zone, "heartbeat_at" timestamp with time zone)
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
declare
  v_now timestamptz := now();
begin
  update public.job_queue jq
     set heartbeat_at = v_now,
         lease_expires_at = v_now + make_interval(secs => greatest(p_lease_seconds, 15))
   where jq.id = p_job_id
     and jq.status = 'running'
     and jq.locked_by = p_worker_id
  returning true, jq.id, jq.lease_expires_at, jq.heartbeat_at
    into ok, id, lease_expires_at, heartbeat_at;

  if not found then
    ok := false;
    id := p_job_id;
    lease_expires_at := null;
    heartbeat_at := null;
    return next;
    return;
  end if;

  return next;
end;
$$;


ALTER FUNCTION "public"."job_queue_heartbeat_c8"("p_job_id" "uuid", "p_worker_id" "text", "p_lease_seconds" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_lane_rank"("p_lane" "text") RETURNS integer
    LANGUAGE "sql" IMMUTABLE
    AS $$
  select case
    when coalesce(p_lane,'') = 'interactive' then 0
    when coalesce(p_lane,'') = 'default' then 1
    when coalesce(p_lane,'') = 'cron' then 2
    else 9
  end;
$$;


ALTER FUNCTION "public"."job_queue_lane_rank"("p_lane" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_lease_any_budgeted"("p_locked_by" "text", "p_lock_seconds" integer DEFAULT 300, "p_max_running_per_user" integer DEFAULT 3, "p_default_daily_budget" integer DEFAULT 100) RETURNS TABLE("id" "uuid", "user_id" "uuid", "job_type" "text", "status" "text", "run_at" timestamp with time zone, "priority" integer, "payload" "jsonb", "attempts" integer, "max_attempts" integer, "correlation_id" "uuid", "idempotency_key" "text")
    LANGUAGE "plpgsql"
    AS $$
declare
  v_id uuid;
  v_user_id uuid;
  v_cost int;
  v_today date;
  v_budget_row record;
begin
  -- Get current UTC day
  v_today := (now() at time zone 'utc')::date;

  -- Ensure budget rows exist for all users with queued jobs (upsert)
  insert into public.job_queue_daily_budget (user_id, day, budget, spent)
  select distinct jq.user_id, v_today, p_default_daily_budget, 0
  from public.job_queue jq
  where jq.status = 'queued'
    and jq.run_at <= now()
    and jq.attempts < jq.max_attempts
    and not exists (
      select 1
      from public.job_queue_daily_budget b
      where b.user_id = jq.user_id
        and b.day = v_today
    )
  on conflict (user_id, day) do nothing;

  -- Find the next eligible job with concurrency check and budget check
  -- Lock both job and budget row atomically
  select jq.id, jq.user_id, jq.cost
    into v_id, v_user_id, v_cost
  from public.job_queue jq
  inner join public.job_queue_daily_budget b
    on b.user_id = jq.user_id
    and b.day = v_today
  where jq.status = 'queued'
    and jq.run_at <= now()
    and jq.attempts < jq.max_attempts
    and (
      jq.locked_at is null
      or jq.locked_at < (now() - make_interval(secs => p_lock_seconds))
    )
    -- Concurrency cap: user must have fewer than max_running_per_user running jobs
    and (
      select count(*)
      from public.job_queue jq2
      where jq2.user_id = jq.user_id
        and jq2.status = 'running'
    ) < p_max_running_per_user
    -- Budget check: ensure has enough remaining
    and (b.spent + jq.cost) <= b.budget
  order by
    -- Lane priority: interactive > default > cron
    case jq.lane
      when 'interactive' then 1
      when 'default' then 2
      when 'cron' then 3
      else 4
    end,
    -- Then priority ASC (lower number = higher priority)
    jq.priority asc,
    -- Then run_at ASC
    jq.run_at asc,
    -- Then created_at ASC (FIFO within same priority)
    jq.created_at asc
  for update of jq skip locked
  for update of b
  limit 1;

  if v_id is null then
    return;
  end if;

  -- Get budget row for update (lock it) - double-check budget after lock
  select * into v_budget_row
  from public.job_queue_daily_budget
  where user_id = v_user_id
    and day = v_today
  for update;

  -- Double-check budget (race safety)
  if (v_budget_row.spent + v_cost) > v_budget_row.budget then
    return;
  end if;

  -- Atomically lease the job
  update public.job_queue
  set
    status = 'running',
    started_at = coalesce(started_at, now()),
    locked_at = now(),
    locked_by = p_locked_by,
    updated_at = now()
  where id = v_id;

  -- Increment spent budget
  update public.job_queue_daily_budget
  set
    spent = spent + v_cost,
    updated_at = now()
  where user_id = v_user_id
    and day = v_today;

  -- Insert ledger entry
  insert into public.job_queue_budget_ledger (
    user_id, day, job_id, delta, reason, meta
  )
  values (
    v_user_id,
    v_today,
    v_id,
    v_cost,
    'lease',
    jsonb_build_object(
      'job_type', (select job_type from public.job_queue where id = v_id),
      'lane', (select lane from public.job_queue where id = v_id),
      'locked_by', p_locked_by
    )
  );

  -- Return the leased job
  return query
    select
      jq.id, jq.user_id, jq.job_type, jq.status, jq.run_at, jq.priority,
      jq.payload, jq.attempts, jq.max_attempts, jq.correlation_id, jq.idempotency_key
    from public.job_queue jq
    where jq.id = v_id;
end;
$$;


ALTER FUNCTION "public"."job_queue_lease_any_budgeted"("p_locked_by" "text", "p_lock_seconds" integer, "p_max_running_per_user" integer, "p_default_daily_budget" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_lease_any_c5"("p_locked_by" "text", "p_lock_seconds" integer DEFAULT 300, "p_max_running_per_user" integer DEFAULT 3, "p_default_daily_budget" integer DEFAULT 100, "p_window_seconds" integer DEFAULT 60, "p_window_limit" integer DEFAULT 10) RETURNS TABLE("id" "uuid", "user_id" "uuid", "job_type" "text", "status" "text", "run_at" timestamp with time zone, "priority" integer, "payload" "jsonb", "attempts" integer, "max_attempts" integer, "correlation_id" "uuid", "idempotency_key" "text")
    LANGUAGE "plpgsql"
    AS $$
#variable_conflict use_column
declare
  v_now timestamptz := now();
  v_today date := (now() at time zone 'utc')::date;
  v_window_start timestamptz := to_timestamp(floor(extract(epoch from v_now) / greatest(p_window_seconds,1)) * greatest(p_window_seconds,1));
  v_job record;
  v_cost int;
  v_budget int;
  v_spent int;
  v_running int;
  v_lane text;
  v_lane_quota int;
  v_lane_used int;
  v_rate_spent int;
begin
  -- Pick a candidate job (row lock prevents double lease)
  select
    jq.*
  into v_job
  from public.job_queue jq
  where jq.status = 'queued'
    and jq.run_at <= v_now
    and jq.attempts < jq.max_attempts
  order by jq.priority desc, jq.run_at asc, jq.id asc
  for update skip locked
  limit 1;

  if not found then
    return;
  end if;

  v_cost := coalesce(v_job.cost, 1);
  v_lane := coalesce(v_job.lane, 'default');

  -- Concurrency cap per user
  select count(*) into v_running
  from public.job_queue
  where status = 'running'
    and user_id = v_job.user_id
    and locked_at > (v_now - make_interval(secs => p_lock_seconds));

  if v_running >= p_max_running_per_user then
    insert into public.job_queue_fairness_ledger(user_id, day, job_id, delta, reason, meta)
    values (v_job.user_id, v_today, v_job.id, 0, 'skipped_concurrency', jsonb_build_object('running', v_running, 'cap', p_max_running_per_user));
    return;
  end if;

  -- Ensure daily budget row exists
  insert into public.job_queue_daily_budget(user_id, day, budget, spent)
  values (v_job.user_id, v_today, p_default_daily_budget, 0)
  on conflict (user_id, day) do nothing;

  select budget, spent into v_budget, v_spent
  from public.job_queue_daily_budget
  where user_id = v_job.user_id and day = v_today
  for update;

  if (v_spent + v_cost) > v_budget then
    insert into public.job_queue_fairness_ledger(user_id, day, job_id, delta, reason, meta)
    values (v_job.user_id, v_today, v_job.id, 0, 'skipped_budget', jsonb_build_object('spent', v_spent, 'budget', v_budget, 'cost', v_cost));
    return;
  end if;

  -- Ensure rate window row exists (NOTE: table column is max_jobs, NOT limit)
  insert into public.job_queue_rate_window(user_id, window_start, window_seconds, max_jobs, spent)
  values (v_job.user_id, v_window_start, p_window_seconds, p_window_limit, 0)
  on conflict (user_id, window_start, window_seconds) do nothing;

  select spent into v_rate_spent
  from public.job_queue_rate_window
  where user_id = v_job.user_id
    and window_start = v_window_start
    and window_seconds = p_window_seconds
  for update;

  if v_rate_spent >= p_window_limit then
    insert into public.job_queue_fairness_ledger(user_id, day, job_id, delta, reason, meta)
    values (v_job.user_id, v_today, v_job.id, 0, 'skipped_rate', jsonb_build_object('spent', v_rate_spent, 'limit', p_window_limit, 'window_start', v_window_start, 'window_seconds', p_window_seconds));
    return;
  end if;

  -- Lane quota (only enforced if a row exists for this user/day/lane)
  select quota, used into v_lane_quota, v_lane_used
  from public.job_queue_lane_quota
  where user_id = v_job.user_id and day = v_today and lane = v_lane
  for update;

  if found and v_lane_used >= v_lane_quota then
    insert into public.job_queue_fairness_ledger(user_id, day, job_id, delta, reason, meta)
    values (v_job.user_id, v_today, v_job.id, 0, 'skipped_lane', jsonb_build_object('lane', v_lane, 'used', v_lane_used, 'quota', v_lane_quota));
    return;
  end if;

  -- Lease the job
  update public.job_queue
  set status = 'running',
      locked_by = p_locked_by,
      locked_at = v_now,
      run_at = v_now
  where id = v_job.id
  returning
    job_queue.id,
    job_queue.user_id,
    job_queue.job_type,
    job_queue.status,
    job_queue.run_at,
    job_queue.priority,
    job_queue.payload,
    job_queue.attempts,
    job_queue.max_attempts,
    job_queue.correlation_id,
    job_queue.idempotency_key
  into
    id, user_id, job_type, status, run_at, priority, payload, attempts, max_attempts, correlation_id, idempotency_key;

  -- Spend budget + ledger
  update public.job_queue_daily_budget
  set spent = spent + v_cost
  where user_id = v_job.user_id and day = v_today;

  insert into public.job_queue_budget_ledger(user_id, day, job_id, delta, reason, meta)
  values (v_job.user_id, v_today, v_job.id, v_cost, 'lease', jsonb_build_object('locked_by', p_locked_by));

  -- Spend rate window
  update public.job_queue_rate_window
  set spent = spent + 1, updated_at = v_now
  where user_id = v_job.user_id
    and window_start = v_window_start
    and window_seconds = p_window_seconds;

  -- Spend lane quota (only if row exists)
  if found then
    update public.job_queue_lane_quota
    set used = used + 1, updated_at = v_now
    where user_id = v_job.user_id and day = v_today and lane = v_lane;
  end if;

  -- Fairness ledger: leased
  insert into public.job_queue_fairness_ledger(user_id, day, job_id, delta, reason, meta)
  values (v_job.user_id, v_today, v_job.id, 1, 'leased', jsonb_build_object('lane', v_lane, 'cost', v_cost, 'window_start', v_window_start, 'window_seconds', p_window_seconds));

  return next;

end;
$$;


ALTER FUNCTION "public"."job_queue_lease_any_c5"("p_locked_by" "text", "p_lock_seconds" integer, "p_max_running_per_user" integer, "p_default_daily_budget" integer, "p_window_seconds" integer, "p_window_limit" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_lease_any_c6"("p_user_id" "uuid", "p_worker_id" "text", "p_now" timestamp with time zone DEFAULT "now"()) RETURNS TABLE("job_id" "uuid", "kind" "text", "payload" "jsonb", "lane" "text")
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
declare
  v_day date := (p_now at time zone 'utc')::date;
  v_tier text;
  v_base int;
  v_rollover int;
  v_burst int;
  v_effective int;

  v_spent int;
  v_remaining int;

  v_health record;
  v_load_score numeric;
  v_mode text := 'normal';
  v_decision text;
  v_reason text;
  v_queue_depth int;

  v_job record;
  v_starvation boolean := false;
  v_sla boolean := false;
begin
  -- effective budget
  select tier, base_budget, rollover_budget, burst_budget, effective_budget
  into v_tier, v_base, v_rollover, v_burst, v_effective
  from public.job_queue_effective_budget(p_user_id, v_day);

  -- today spent
  select coalesce(spent, 0)::int
  into v_spent
  from public.job_queue_daily_budget
  where user_id = p_user_id and day = v_day;

  v_remaining := greatest(v_effective - v_spent, 0);

  -- health (latest snapshot)
  select *
  into v_health
  from public.job_queue_health_snapshots
  order by created_at desc
  limit 1;

  v_load_score := coalesce(v_health.score, 100);

  select count(*) into v_queue_depth
  from public.job_queue
  where status in ('queued','ready');

  -- predictive load shedding modes
  if v_load_score < 50 then
    v_mode := 'protect';
  elsif v_load_score < 80 then
    v_mode := 'slow_lane';
  else
    v_mode := 'normal';
  end if;

  -- budget gate
  if v_remaining <= 0 then
    v_decision := 'throttled_budget';
    v_reason := 'effective_budget_exhausted';
    insert into public.job_queue_scheduler_decisions(
      job_id, user_id, decision, reason, lane, queue_depth,
      user_budget_remaining, user_effective_budget, system_load_score,
      starvation_risk, sla_risk, meta
    )
    values (
      null, p_user_id, v_decision, v_reason, null, v_queue_depth,
      v_remaining, v_effective, v_load_score,
      false, false,
      jsonb_build_object('tier', v_tier, 'base', v_base, 'rollover', v_rollover, 'burst', v_burst, 'mode', v_mode)
    );
    return;
  end if;

  -- choose candidate job with lane controls
  -- protect: only normal lane jobs (or explicit SLA jobs)
  -- slow_lane: deprioritize slow lane
  if v_mode = 'protect' then
    select *
    into v_job
    from public.job_queue
    where status in ('queued','ready')
      and (lane = 'normal' or (sla_minutes is not null and sla_minutes <= 30))
      and user_id = p_user_id
    order by
      coalesce(first_enqueued_at, created_at) asc
    for update skip locked
    limit 1;
  elsif v_mode = 'slow_lane' then
    select *
    into v_job
    from public.job_queue
    where status in ('queued','ready')
      and user_id = p_user_id
    order by
      (case when lane = 'slow' then 1 else 0 end) asc,
      coalesce(first_enqueued_at, created_at) asc
    for update skip locked
    limit 1;
  else
    select *
    into v_job
    from public.job_queue
    where status in ('queued','ready')
      and user_id = p_user_id
    order by
      coalesce(first_enqueued_at, created_at) asc
    for update skip locked
    limit 1;
  end if;

  if v_job.id is null then
    v_decision := 'deferred_load';
    v_reason := 'no_eligible_job';
    insert into public.job_queue_scheduler_decisions(
      job_id, user_id, decision, reason, lane, queue_depth,
      user_budget_remaining, user_effective_budget, system_load_score,
      starvation_risk, sla_risk, meta
    )
    values (
      null, p_user_id, v_decision, v_reason, null, v_queue_depth,
      v_remaining, v_effective, v_load_score,
      false, false,
      jsonb_build_object('tier', v_tier, 'mode', v_mode)
    );
    return;
  end if;

  -- starvation + SLA signals
  v_starvation := (p_now - coalesce(v_job.first_enqueued_at, v_job.created_at)) > interval '15 minutes';
  v_sla := (p_now - coalesce(v_job.first_enqueued_at, v_job.created_at)) > interval '30 minutes';

  -- lease it (minimal shape; adapt to your existing schema fields)
  update public.job_queue
  set
    status = 'leased',
    leased_at = p_now,
    leased_by = p_worker_id,
    deferral_count = deferral_count + 0
  where id = v_job.id
  returning id, kind, payload, lane
  into job_id, kind, payload, lane;

  v_decision := 'leased';
  v_reason := 'ok';

  insert into public.job_queue_scheduler_decisions(
    job_id, user_id, decision, reason, lane, queue_depth,
    user_budget_remaining, user_effective_budget, system_load_score,
    starvation_risk, sla_risk, meta
  )
  values (
    job_id, p_user_id, v_decision, v_reason, lane, v_queue_depth,
    v_remaining, v_effective, v_load_score,
    v_starvation, v_sla,
    jsonb_build_object('tier', v_tier, 'mode', v_mode)
  );

  return next;
end;
$$;


ALTER FUNCTION "public"."job_queue_lease_any_c6"("p_user_id" "uuid", "p_worker_id" "text", "p_now" timestamp with time zone) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_lease_any_c7"("p_user_id" "uuid", "p_worker_id" "text", "p_now" timestamp with time zone DEFAULT "now"()) RETURNS TABLE("job_id" "uuid", "kind" "text", "payload" "jsonb", "lane" "text", "cost" integer)
    LANGUAGE "plpgsql"
    AS $$
declare
  v_job public.job_queue%rowtype;
  v_tier text;
  v_burst numeric;
  v_cost integer;
begin
  -- Find next eligible job.
  -- IMPORTANT: qualify column names and avoid ambiguous identifiers.
  select jq.*
    into v_job
  from public.job_queue jq
  where jq.user_id = p_user_id
    and jq.status in ('queued')          -- only queued jobs are leasable
    and (jq.run_at is null or jq.run_at <= p_now)
    and (jq.locked_at is null or jq.locked_at < (p_now - interval '15 minutes'))
  order by
    jq.priority desc nulls last,
    coalesce(jq.first_enqueued_at, jq.created_at) asc
  for update skip locked
  limit 1;

  if not found then
    return;
  end if;

  -- Determine tier (default free) and burst multiplier (default 1.0)
  select coalesce(utm.tier, 'free')
    into v_tier
  from public.job_queue_user_tiers utm
  where utm.user_id = p_user_id;

  v_burst := 1.0;

  -- Compute cost using your pricing table (kind defaults to 'default')
  select public.job_queue_compute_cost(
    p_user_id,
    v_tier,
    coalesce(v_job.job_type, 'default'),
    v_burst,
    coalesce(v_job.priority, 0)
  )
  into v_cost;

  -- Enforce budget / credits (if your scheduler decisions / effective budget function exists, it will throttle upstream)
  -- Lease = lock + status running
  update public.job_queue jq
    set status = 'running',
        locked_at = p_now,
        locked_by = p_worker_id,
        started_at = coalesce(jq.started_at, p_now),
        cost = v_cost
  where jq.id = v_job.id
  returning jq.id, jq.job_type, jq.payload, jq.lane, jq.cost
  into job_id, kind, payload, lane, cost;

  -- Log decision / telemetry (if table exists)
  if exists (select 1 from pg_class c join pg_namespace n on n.oid=c.relnamespace where n.nspname='public' and c.relname='job_queue_scheduler_decisions') then
    insert into public.job_queue_scheduler_decisions(user_id, decision, reason, lane, meta)
    values (p_user_id, 'leased', 'leased_next_job', coalesce(v_job.lane,'default'),
            jsonb_build_object('job_id', v_job.id, 'cost', v_cost, 'kind', coalesce(v_job.job_type,'default')));
  end if;

  return;
end $$;


ALTER FUNCTION "public"."job_queue_lease_any_c7"("p_user_id" "uuid", "p_worker_id" "text", "p_now" timestamp with time zone) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_lease_any_next"("p_locked_by" "text", "p_lock_seconds" integer DEFAULT 300) RETURNS TABLE("id" "uuid", "user_id" "uuid", "job_type" "text", "status" "text", "run_at" timestamp with time zone, "priority" integer, "payload" "jsonb", "attempts" integer, "max_attempts" integer, "correlation_id" "uuid", "idempotency_key" "text")
    LANGUAGE "plpgsql"
    AS $$
declare
  v_id uuid;
begin
  select jq.id
    into v_id
  from public.job_queue jq
  where jq.status = 'queued'
    and jq.run_at <= now()
    and jq.attempts < jq.max_attempts
    and (
      jq.locked_at is null
      or jq.locked_at < (now() - make_interval(secs => p_lock_seconds))
    )
  order by jq.priority asc, jq.run_at asc, jq.created_at asc
  for update skip locked
  limit 1;

  if v_id is null then
    return;
  end if;

  update public.job_queue
  set
    status = 'running',
    started_at = coalesce(started_at, now()),
    locked_at = now(),
    locked_by = p_locked_by,
    updated_at = now()
  where id = v_id;

  return query
    select
      jq.id, jq.user_id, jq.job_type, jq.status, jq.run_at, jq.priority,
      jq.payload, jq.attempts, jq.max_attempts, jq.correlation_id, jq.idempotency_key
    from public.job_queue jq
    where jq.id = v_id;
end;
$$;


ALTER FUNCTION "public"."job_queue_lease_any_next"("p_locked_by" "text", "p_lock_seconds" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_lease_any_scheduled"("p_locked_by" "text", "p_lock_seconds" integer DEFAULT 300, "p_max_running_per_user" integer DEFAULT 3) RETURNS TABLE("id" "uuid", "user_id" "uuid", "job_type" "text", "status" "text", "run_at" timestamp with time zone, "priority" integer, "payload" "jsonb", "attempts" integer, "max_attempts" integer, "correlation_id" "uuid", "idempotency_key" "text")
    LANGUAGE "plpgsql"
    AS $$
declare
  v_id uuid;
  v_user_id uuid;
begin
  -- Find the next eligible job with concurrency check
  select jq.id, jq.user_id
    into v_id, v_user_id
  from public.job_queue jq
  where jq.status = 'queued'
    and jq.run_at <= now()
    and jq.attempts < jq.max_attempts
    and (
      jq.locked_at is null
      or jq.locked_at < (now() - make_interval(secs => p_lock_seconds))
    )
    -- Concurrency cap: user must have fewer than max_running_per_user running jobs
    and (
      select count(*)
      from public.job_queue jq2
      where jq2.user_id = jq.user_id
        and jq2.status = 'running'
    ) < p_max_running_per_user
  order by
    -- Lane priority: interactive > default > cron
    case jq.lane
      when 'interactive' then 1
      when 'default' then 2
      when 'cron' then 3
      else 4
    end,
    -- Then priority ASC (lower number = higher priority)
    jq.priority asc,
    -- Then run_at ASC
    jq.run_at asc,
    -- Then created_at ASC (FIFO within same priority)
    jq.created_at asc
  for update skip locked
  limit 1;

  if v_id is null then
    return;
  end if;

  -- Atomically lease the job
  update public.job_queue
  set
    status = 'running',
    started_at = coalesce(started_at, now()),
    locked_at = now(),
    locked_by = p_locked_by,
    updated_at = now()
  where id = v_id;

  -- Return the leased job
  return query
    select
      jq.id, jq.user_id, jq.job_type, jq.status, jq.run_at, jq.priority,
      jq.payload, jq.attempts, jq.max_attempts, jq.correlation_id, jq.idempotency_key
    from public.job_queue jq
    where jq.id = v_id;
end;
$$;


ALTER FUNCTION "public"."job_queue_lease_any_scheduled"("p_locked_by" "text", "p_lock_seconds" integer, "p_max_running_per_user" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_lease_next"("p_user_id" "uuid", "p_locked_by" "text", "p_lock_seconds" integer DEFAULT 300) RETURNS TABLE("id" "uuid", "user_id" "uuid", "job_type" "text", "status" "text", "run_at" timestamp with time zone, "priority" integer, "payload" "jsonb", "attempts" integer, "max_attempts" integer, "correlation_id" "uuid", "idempotency_key" "text")
    LANGUAGE "plpgsql"
    AS $$
declare
  v_id uuid;
begin
  select jq.id
    into v_id
  from public.job_queue jq
  where jq.user_id = p_user_id
    and jq.status = 'queued'
    and jq.run_at <= now()
    and jq.attempts < jq.max_attempts
    and (
      jq.locked_at is null
      or jq.locked_at < (now() - make_interval(secs => p_lock_seconds))
    )
  order by jq.priority asc, jq.run_at asc, jq.created_at asc
  for update skip locked
  limit 1;

  if v_id is null then
    return;
  end if;

  update public.job_queue
  set
    status = 'running',
    started_at = coalesce(started_at, now()),
    locked_at = now(),
    locked_by = p_locked_by,
    updated_at = now()
  where id = v_id;

  return query
    select
      jq.id, jq.user_id, jq.job_type, jq.status, jq.run_at, jq.priority,
      jq.payload, jq.attempts, jq.max_attempts, jq.correlation_id, jq.idempotency_key
    from public.job_queue jq
    where jq.id = v_id;
end;
$$;


ALTER FUNCTION "public"."job_queue_lease_next"("p_user_id" "uuid", "p_locked_by" "text", "p_lock_seconds" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_recover_stuck"("p_lock_age_seconds" integer DEFAULT 600) RETURNS integer
    LANGUAGE "plpgsql"
    AS $$
declare
  v_count int;
begin
  -- Atomically update stuck jobs
  with stuck as (
    update public.job_queue
    set
      status = 'queued',
      run_at = now(),
      locked_at = null,
      locked_by = null,
      finished_at = null,
      started_at = null,
      last_error = 'Recovered stuck job',
      updated_at = now()
    where status = 'running'
      and locked_at is not null
      and locked_at < (now() - make_interval(secs => p_lock_age_seconds))
    returning id
  )
  select count(*) into v_count from stuck;

  return v_count;
end;
$$;


ALTER FUNCTION "public"."job_queue_recover_stuck"("p_lock_age_seconds" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_recover_stuck_running_c8"("p_batch" integer DEFAULT 50, "p_stale_heartbeat_seconds" integer DEFAULT 300) RETURNS TABLE("recovered_count" integer, "recovered_ids" "uuid"[])
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
declare
  v_now timestamptz := now();
begin
  with candidates as (
    select id
      from public.job_queue
     where status = 'running'
       and (
         lease_expires_at is null
         or lease_expires_at <= v_now
         or heartbeat_at is null
         or heartbeat_at <= v_now - make_interval(secs => greatest(p_stale_heartbeat_seconds, 60))
       )
     order by coalesce(lease_expires_at, to_timestamp(0)) asc
     limit greatest(p_batch, 1)
     for update skip locked
  ),
  updated as (
    update public.job_queue jq
       set status = 'queued',
           locked_by = null,
           lease_expires_at = null,
           heartbeat_at = null,
           scheduled_at = v_now,
           last_error = concat('stuck_running_recovered @ ', v_now)
      from candidates c
     where jq.id = c.id
   returning jq.id
  )
  select count(*), coalesce(array_agg(id), '{}'::uuid[])
    into recovered_count, recovered_ids
    from updated;

  return next;
end;
$$;


ALTER FUNCTION "public"."job_queue_recover_stuck_running_c8"("p_batch" integer, "p_stale_heartbeat_seconds" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_recover_stuck_running_c8_count"("p_batch" integer DEFAULT 50, "p_stale_heartbeat_seconds" integer DEFAULT 300) RETURNS integer
    LANGUAGE "sql" SECURITY DEFINER
    AS $$
  select recovered_count
  from public.job_queue_recover_stuck_running_c8(p_batch, p_stale_heartbeat_seconds)
  limit 1;
$$;


ALTER FUNCTION "public"."job_queue_recover_stuck_running_c8_count"("p_batch" integer, "p_stale_heartbeat_seconds" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_retry_backoff"("attempts" integer) RETURNS interval
    LANGUAGE "plpgsql"
    AS $$
declare
  v_secs int;
begin
  v_secs := least(900, 30 * (2 ^ greatest(attempts - 1, 0)));
  return make_interval(secs => v_secs);
end;
$$;


ALTER FUNCTION "public"."job_queue_retry_backoff"("attempts" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_runs"("p_user_id" "uuid", "p_limit" integer DEFAULT 50) RETURNS TABLE("correlation_id" "uuid", "last_ts" timestamp with time zone, "queued" integer, "running" integer, "succeeded" integer, "failed" integer)
    LANGUAGE "plpgsql"
    AS $$
begin
  return query
  select
    jq.correlation_id,
    max(jq.created_at) as last_ts,
    count(*) filter (where jq.status = 'queued')::int as queued,
    count(*) filter (where jq.status = 'running')::int as running,
    count(*) filter (where jq.status = 'succeeded')::int as succeeded,
    count(*) filter (where jq.status = 'failed')::int as failed
  from public.job_queue jq
  where jq.user_id = p_user_id
    and jq.correlation_id is not null
  group by jq.correlation_id
  order by max(jq.created_at) desc
  limit p_limit;
end;
$$;


ALTER FUNCTION "public"."job_queue_runs"("p_user_id" "uuid", "p_limit" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_sla_escalate_c9"("p_now" timestamp with time zone DEFAULT "now"(), "p_priority_bump" integer DEFAULT 50, "p_lane_when_breached" "text" DEFAULT 'fast'::"text") RETURNS integer
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
declare
  v_updated int := 0;
begin
  with breached as (
    select id
    from public.job_queue
    where status = 'queued'
      and locked_at is null
      and sla_minutes is not null
      and first_enqueued_at is not null
      and (p_now - first_enqueued_at) >= (sla_minutes * interval '1 minute')
  ),
  upd as (
    update public.job_queue jq
    set
      priority = greatest(coalesce(jq.priority,0), 0) + p_priority_bump,
      lane = case when coalesce(jq.lane,'default') = p_lane_when_breached then jq.lane else p_lane_when_breached end
    where jq.id in (select id from breached)
    returning jq.id
  )
  select count(*) into v_updated from upd;

  return v_updated;
end;
$$;


ALTER FUNCTION "public"."job_queue_sla_escalate_c9"("p_now" timestamp with time zone, "p_priority_bump" integer, "p_lane_when_breached" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_start_c8"("p_job_id" "uuid", "p_worker_id" "text") RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
begin
  update public.job_queue
  set
    status = 'running',
    started_at = now(),
    locked_at = now(),
    locked_by = p_worker_id,
    updated_at = now()
  where id = p_job_id
    and status = 'queued';

  if not found then
    raise exception 'Job % is not in queued state', p_job_id;
  end if;
end;
$$;


ALTER FUNCTION "public"."job_queue_start_c8"("p_job_id" "uuid", "p_worker_id" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."job_queue_start_c8"("p_job_id" "uuid", "p_worker_id" "text", "p_lease_seconds" integer DEFAULT 120) RETURNS TABLE("id" "uuid", "status" "text", "payload" "jsonb", "attempts" integer, "max_attempts" integer, "started_at" timestamp with time zone, "lease_expires_at" timestamp with time zone)
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
declare
  v_now timestamptz := now();
begin
  -- Atomically claim only if it is queued and due.
  update public.job_queue jq
     set status = 'running',
         started_at = coalesce(jq.started_at, v_now),
         started_at = v_now,
         locked_by = p_worker_id,
         heartbeat_at = v_now,
         lease_expires_at = v_now + make_interval(secs => greatest(p_lease_seconds, 15))
   where jq.id = p_job_id
     and jq.status = 'queued'
     and (jq.scheduled_at is null or jq.scheduled_at <= v_now)
  returning
    jq.id,
    jq.status,
    jq.payload,
    jq.attempts,
    jq.max_attempts,
    jq.started_at,
    jq.lease_expires_at
  into
    id,
    status,
    payload,
    attempts,
    max_attempts,
    started_at,
    lease_expires_at;

  if not found then
    -- Return zero rows => worker treats as "not claimable"
    return;
  end if;

  return next;
end;
$$;


ALTER FUNCTION "public"."job_queue_start_c8"("p_job_id" "uuid", "p_worker_id" "text", "p_lease_seconds" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."log_activity"("p_user_id" "uuid", "p_source" "text", "p_event_ts" timestamp with time zone, "p_event_type" "text", "p_title" "text", "p_detail" "text", "p_payload" "jsonb") RETURNS "uuid"
    LANGUAGE "plpgsql" SECURITY DEFINER
    SET "search_path" TO 'public'
    AS $$
declare
  v_id uuid;
begin
  if p_user_id is null then
    raise exception 'log_activity: p_user_id is required';
  end if;

  insert into public.activity_events (
    user_id,
    user_id_uuid,
    user_id_text,
    source,
    event_type,
    title,
    detail,
    payload,
    event_ts,
    created_at
  ) values (
    p_user_id,
    p_user_id,
    p_user_id::text,
    coalesce(p_source, 'system'),
    p_event_type,
    p_title,
    p_detail,
    coalesce(p_payload, '{}'::jsonb),
    coalesce(p_event_ts, now()),
    now()
  )
  returning id into v_id;

  return v_id;
end;
$$;


ALTER FUNCTION "public"."log_activity"("p_user_id" "uuid", "p_source" "text", "p_event_ts" timestamp with time zone, "p_event_type" "text", "p_title" "text", "p_detail" "text", "p_payload" "jsonb") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."prevent_activity_event_updates"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
begin
  raise exception 'activity_events is immutable';
end;
$$;


ALTER FUNCTION "public"."prevent_activity_event_updates"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."prevent_writes_to_merged_contacts"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
begin
  if exists (
    select 1 from crm_contacts
    where id = new.contact_id
      and status = 'merged'
  ) then
    raise exception 'Cannot write to merged contact_id %', new.contact_id;
  end if;
  return new;
end;
$$;


ALTER FUNCTION "public"."prevent_writes_to_merged_contacts"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."prune_job_queue_budget_rollover"() RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
begin
  delete from public.job_queue_budget_rollover
  where expires_at < now();
end;
$$;


ALTER FUNCTION "public"."prune_job_queue_budget_rollover"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."pulse_assert_valid_user_id_uuid"("p_user_id_uuid" "uuid", "p_table" "text") RETURNS "void"
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
begin
  if p_user_id_uuid is null then
    raise exception 'Canon violation: user_id_uuid is NULL (table=%)', p_table;
  end if;

  if not exists (select 1 from public.identity_users iu where iu.id = p_user_id_uuid) then
    raise exception 'Canon violation: user_id_uuid missing in identity_users (table=% user_id_uuid=%)',
      p_table, p_user_id_uuid;
  end if;

  if exists (
    select 1 from public.identity_users iu
    where iu.id = p_user_id_uuid and iu.is_archived = true
  ) then
    raise exception 'Canon violation: archived identity cannot own new rows (table=% user_id_uuid=%)',
      p_table, p_user_id_uuid;
  end if;
end
$$;


ALTER FUNCTION "public"."pulse_assert_valid_user_id_uuid"("p_user_id_uuid" "uuid", "p_table" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."pulse_canon_gate"() RETURNS "void"
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $_$
declare
  v_count int;
begin
  -- Existing canon assertions (already in your system)
  perform public.assert_schema_identity();
  perform public.assert_no_user_id_fks();

  -- Optional: if your audit view exists, require it to be clean
  -- (This is your strongest "single pane of glass" signal.)
  if to_regclass('public.user_id_canon_audit') is not null then
    execute $q$
      select count(*)
      from public.user_id_canon_audit
      where
        user_id_not_text = true
        or rls_enabled = false
        or has_pulse_user_owns_row = false
        or user_id_fk_violations_global > 0
    $q$ into v_count;

    if v_count > 0 then
      raise exception 'PULSE CANON GATE FAILED: user_id_canon_audit has % violating rows', v_count;
    end if;
  end if;
end;
$_$;


ALTER FUNCTION "public"."pulse_canon_gate"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."pulse_guard_canon_ddl"() RETURNS "event_trigger"
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
declare
  r record;
  obj_schema text;
  obj_name text;
  ddl_txt text;
  has_user_id boolean;
  v_mode text;
  v_allowed boolean := false;
begin
  ddl_txt := coalesce(current_query(), '');

  select mode into v_mode
  from public.canon_mode
  where id = true;

  for r in select * from pg_event_trigger_ddl_commands()
  loop
    obj_schema := split_part(r.object_identity, '.', 1);
    obj_name   := split_part(r.object_identity, '.', 2);

    if obj_schema = '' or obj_name = '' then
      continue;
    end if;

    -- Migration bypass only when in v2_uuid mode and table is allowlisted
    if v_mode = 'v2_uuid' then
      select exists (
        select 1
        from public.canon_migration_allowlist a
        where a.table_schema = obj_schema
          and a.table_name = obj_name
      ) into v_allowed;
    end if;

    -- 1) Block disabling RLS on any table that has user_id column
    if r.command_tag = 'ALTER TABLE' and ddl_txt ilike '%disable row level security%' then
      select exists (
        select 1
        from information_schema.columns
        where table_schema = obj_schema
          and table_name = obj_name
          and column_name = 'user_id'
      ) into has_user_id;

      if has_user_id then
        raise exception 'CANON LOCK: cannot DISABLE RLS on %.% (table has user_id)', obj_schema, obj_name;
      end if;
    end if;

    -- 2) Block DROP/ALTER of canonical policy pulse_user_owns_row except allowlisted during v2 migration
    if (r.command_tag in ('DROP POLICY','ALTER POLICY')) then
      if ddl_txt ilike '%pulse_user_owns_row%' then
        if not v_allowed then
          raise exception 'CANON LOCK: pulse_user_owns_row policy is protected and cannot be altered/dropped';
        end if;
      end if;
    end if;

  end loop;
end;
$$;


ALTER FUNCTION "public"."pulse_guard_canon_ddl"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."pulse_resolve_user_uuid"("p_any_user_id" "text") RETURNS "uuid"
    LANGUAGE "plpgsql" STABLE
    AS $$
declare
  v uuid;
begin
  -- 1) If already a UUID string, use it.
  v := public.pulse_try_uuid(p_any_user_id);
  if v is not null then
    return v;
  end if;

  -- 2) Try canonical mapping tables if present (supports a few likely prod names).
  if to_regclass('public.pulse_users') is not null then
    if exists (
      select 1
      from information_schema.columns
      where table_schema='public' and table_name='pulse_users' and column_name='clerk_user_id'
    ) then
      if exists (
        select 1
        from information_schema.columns
        where table_schema='public' and table_name='pulse_users' and column_name='id'
      ) then
        select pu.id into v
        from public.pulse_users pu
        where pu.clerk_user_id = p_any_user_id
        limit 1;
        return v;
      elsif exists (
        select 1
        from information_schema.columns
        where table_schema='public' and table_name='pulse_users' and column_name='user_id'
      ) then
        select pu.user_id into v
        from public.pulse_users pu
        where pu.clerk_user_id = p_any_user_id
        limit 1;
        return v;
      end if;
    end if;
  end if;

  if to_regclass('public.users') is not null then
    if exists (
      select 1
      from information_schema.columns
      where table_schema='public' and table_name='users' and column_name='clerk_user_id'
    ) then
      if exists (
        select 1
        from information_schema.columns
        where table_schema='public' and table_name='users' and column_name='id'
      ) then
        select u.id into v
        from public.users u
        where u.clerk_user_id = p_any_user_id
        limit 1;
        return v;
      elsif exists (
        select 1
        from information_schema.columns
        where table_schema='public' and table_name='users' and column_name='user_id'
      ) then
        select u.user_id into v
        from public.users u
        where u.clerk_user_id = p_any_user_id
        limit 1;
        return v;
      end if;
    end if;
  end if;

  -- 3) No mapping found.
  return null;
end;
$$;


ALTER FUNCTION "public"."pulse_resolve_user_uuid"("p_any_user_id" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."pulse_sync_legacy_user_id"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
begin
  -- If user_id_uuid is missing but auth.uid exists, fill it.
  if new.user_id_uuid is null then
    new.user_id_uuid := auth.uid();
  end if;

  -- If legacy user_id column exists, force it to match UUID text.
  begin
    new.user_id := new.user_id_uuid::text;
  exception when undefined_column then
    -- table has no legacy user_id column; ignore.
    null;
  end;

  return new;
end;
$$;


ALTER FUNCTION "public"."pulse_sync_legacy_user_id"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."pulse_try_uuid"("p_text" "text") RETURNS "uuid"
    LANGUAGE "plpgsql" IMMUTABLE
    AS $$
begin
  if p_text is null then
    return null;
  end if;
  return p_text::uuid;
exception when others then
  return null;
end;
$$;


ALTER FUNCTION "public"."pulse_try_uuid"("p_text" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."pulse_uuid_from_clerk"("p_clerk_user_id" "text") RETURNS "uuid"
    LANGUAGE "sql" IMMUTABLE
    AS $$
  select uuid_generate_v5('8b1d3f2e-7c3b-4c8e-a2c9-3e7fd2d9c2a1'::uuid, coalesce(p_clerk_user_id,''));
$$;


ALTER FUNCTION "public"."pulse_uuid_from_clerk"("p_clerk_user_id" "text") OWNER TO "postgres";


COMMENT ON FUNCTION "public"."pulse_uuid_from_clerk"("p_clerk_user_id" "text") IS 'Deterministic UUID v5 for Clerk user IDs. Ensures stable identity across all tables without auth.users.';



CREATE OR REPLACE FUNCTION "public"."refresh_contact_intel"("p_contact_id" "uuid", "p_owner_user_id" "text") RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
declare
  v_last_touch_at timestamptz;
  v_last_touch_type text;
  v_touch_30d int;
  v_overdue int;
  v_unanswered int;
  v_score int := 50;
  v_drivers text[] := '{}'::text[];
  v_flags text[] := '{}'::text[];
  v_next_due timestamptz;
  v_summary text := '';
begin
  -- last touch: most recent event of any type
  select occurred_at, type
    into v_last_touch_at, v_last_touch_type
  from public.crm_contact_events
  where contact_id = p_contact_id and owner_user_id = p_owner_user_id
  order by occurred_at desc
  limit 1;

  -- touch frequency last 30d
  select count(*)
    into v_touch_30d
  from public.crm_contact_events
  where contact_id = p_contact_id
    and owner_user_id = p_owner_user_id
    and occurred_at >= (now() - interval '30 days');

  -- Overdue/unanswered: look for explicit counts in latest intel_update metadata if you emit them,
  -- otherwise default 0. (Keeps behavior stable until email/task ingestion is wired.)
  select coalesce((metadata->>'overdueTasks')::int, 0),
         coalesce((metadata->>'unansweredInbound')::int, 0)
    into v_overdue, v_unanswered
  from public.crm_contact_events
  where contact_id = p_contact_id
    and owner_user_id = p_owner_user_id
    and type in ('intel_update','system')
  order by occurred_at desc
  limit 1;

  v_overdue := coalesce(v_overdue, 0);
  v_unanswered := coalesce(v_unanswered, 0);
  v_touch_30d := coalesce(v_touch_30d, 0);

  -- Deterministic scoring (mirrors your TS logic roughly)
  if v_last_touch_at is not null then
    if (now() - v_last_touch_at) <= interval '1 day' then
      v_score := v_score + 20; v_drivers := array_append(v_drivers, 'Very recent interaction');
    elsif (now() - v_last_touch_at) <= interval '7 days' then
      v_score := v_score + 15; v_drivers := array_append(v_drivers, 'Touched within the week');
    elsif (now() - v_last_touch_at) <= interval '14 days' then
      v_score := v_score + 10; v_drivers := array_append(v_drivers, 'Touched within 2 weeks');
    elsif (now() - v_last_touch_at) <= interval '30 days' then
      v_score := v_score + 5; v_drivers := array_append(v_drivers, 'Touched within the month');
    else
      v_score := v_score - 10; v_flags := array_append(v_flags, 'No touch in 30+ days');
    end if;
  else
    v_flags := array_append(v_flags, 'No interactions recorded');
  end if;

  if v_touch_30d >= 4 then
    v_score := v_score + 20; v_drivers := array_append(v_drivers, 'High engagement (4+ touches/month)');
  elsif v_touch_30d >= 2 then
    v_score := v_score + 10; v_drivers := array_append(v_drivers, 'Regular engagement');
  elsif v_touch_30d = 1 then
    v_score := v_score + 5;
  end if;

  if v_overdue > 0 then
    v_score := v_score - least(v_overdue * 5, 20);
    v_flags := array_append(v_flags, v_overdue::text || ' overdue task(s)');
  end if;

  if v_unanswered > 0 then
    v_score := v_score - least(v_unanswered * 5, 15);
    v_flags := array_append(v_flags, v_unanswered::text || ' unanswered inbound email(s)');
  end if;

  v_score := greatest(0, least(100, v_score));

  -- next touch due (business logic placeholder)
  if v_last_touch_at is not null then
    v_next_due := v_last_touch_at + interval '14 days';
  else
    v_next_due := now() + interval '7 days';
  end if;

  v_summary :=
    'Last touch: ' || coalesce(to_char(v_last_touch_at, 'YYYY-MM-DD'), 'never')
    || coalesce(' via ' || v_last_touch_type, '')
    || '. Touches 30d: ' || v_touch_30d::text
    || '. Overdue: ' || v_overdue::text
    || '. Unanswered: ' || v_unanswered::text
    || '.';

  insert into public.crm_contact_intel (
    contact_id, owner_user_id,
    relationship_score, relationship_trend_30d,
    drivers, risk_flags,
    next_touch_due_at, last_touch_at, last_touch_type,
    overdue_tasks_count, unanswered_inbound_count, touch_frequency_30d,
    ai_summary,
    updated_at
  )
  values (
    p_contact_id, p_owner_user_id,
    v_score, 0,
    v_drivers, v_flags,
    v_next_due, v_last_touch_at, v_last_touch_type,
    v_overdue, v_unanswered, v_touch_30d,
    v_summary,
    now()
  )
  on conflict (owner_user_id, contact_id) do update set
    relationship_score = excluded.relationship_score,
    relationship_trend_30d = excluded.relationship_trend_30d,
    drivers = excluded.drivers,
    risk_flags = excluded.risk_flags,
    next_touch_due_at = excluded.next_touch_due_at,
    last_touch_at = excluded.last_touch_at,
    last_touch_type = excluded.last_touch_type,
    overdue_tasks_count = excluded.overdue_tasks_count,
    unanswered_inbound_count = excluded.unanswered_inbound_count,
    touch_frequency_30d = excluded.touch_frequency_30d,
    ai_summary = excluded.ai_summary,
    updated_at = now();

end $$;


ALTER FUNCTION "public"."refresh_contact_intel"("p_contact_id" "uuid", "p_owner_user_id" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."refresh_email_threads_for_owner"("p_owner_user_id" "text") RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
begin
  with last_e as (
    select
      e.owner_user_id,
      e.thread_id,
      e.received_at,
      e.subject,
      e.snippet,
      e.from_email,
      e.to_emails,
      e.is_read,
      e.is_starred,
      e.labels,
      row_number() over (
        partition by e.owner_user_id, e.thread_id
        order by e.received_at desc nulls last, e.created_at desc
      ) as rn
    from public.emails e
    where e.owner_user_id = p_owner_user_id
  )
  update public.email_threads t
  set
    last_message_at   = le.received_at,
    subject           = coalesce(t.subject, le.subject),
    snippet           = coalesce(t.snippet, le.snippet),
    last_message_from = le.from_email,
    last_message_to   = array_to_string(le.to_emails, ', '),
    unread            = coalesce(t.unread, (not le.is_read)),
    starred           = coalesce(t.starred, le.is_starred),
    category = coalesce(
      t.category,
      case
        when le.labels @> array['CATEGORY_PROMOTIONS'] then 'promotions'
        when le.labels @> array['CATEGORY_SOCIAL']     then 'social'
        when le.labels @> array['CATEGORY_UPDATES']    then 'updates'
        when le.labels @> array['CATEGORY_FORUMS']     then 'forums'
        else 'primary'
      end
    ),
    importance = coalesce(
      t.importance,
      case when le.labels @> array['IMPORTANT'] then 'high' else 'normal' end
    )
  from last_e le
  where
    le.rn = 1
    and t.owner_user_id = le.owner_user_id
    and t.thread_id::text = le.thread_id::text;
end;
$$;


ALTER FUNCTION "public"."refresh_email_threads_for_owner"("p_owner_user_id" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."refresh_email_threads_for_pairs"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
begin
  with touched as (
    select distinct owner_user_id, thread_id
    from new_rows
    where owner_user_id is not null and thread_id is not null
  ),
  latest as (
    select
      t.owner_user_id,
      t.thread_id,
      e.received_at,
      e.subject,
      e.snippet,
      e.from_email,
      e.to_emails,
      e.is_read,
      e.is_starred,
      e.labels
    from touched t
    join lateral (
      select *
      from public.emails e
      where e.owner_user_id = t.owner_user_id
        and e.thread_id::text = t.thread_id::text
      order by e.received_at desc nulls last, e.created_at desc
      limit 1
    ) e on true
  )
  update public.email_threads th
  set
    last_message_at   = lt.received_at,
    subject           = coalesce(th.subject, lt.subject),
    snippet           = coalesce(th.snippet, lt.snippet),
    last_message_from = lt.from_email,
    last_message_to   = array_to_string(lt.to_emails, ', '),
    unread            = (not lt.is_read),
    starred           = coalesce(th.starred, lt.is_starred),
    category = coalesce(
      th.category,
      case
        when lt.labels @> array['CATEGORY_PROMOTIONS'] then 'promotions'
        when lt.labels @> array['CATEGORY_SOCIAL']     then 'social'
        when lt.labels @> array['CATEGORY_UPDATES']    then 'updates'
        when lt.labels @> array['CATEGORY_FORUMS']     then 'forums'
        else 'primary'
      end
    ),
    importance = coalesce(
      th.importance,
      case when lt.labels @> array['IMPORTANT'] then 'high' else 'normal' end
    ),
    last_activity_at = coalesce(lt.received_at, th.last_email_at, th.updated_at, th.created_at)
  from latest lt
  where th.owner_user_id = lt.owner_user_id
    and th.thread_id::text = lt.thread_id::text;

  return null;
end;
$$;


ALTER FUNCTION "public"."refresh_email_threads_for_pairs"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."reset_monthly_usage"() RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
BEGIN
  UPDATE user_profiles 
  SET 
    usage_cents_this_month = 0,
    usage_reset_at = NOW()
  WHERE usage_reset_at IS NULL 
     OR usage_reset_at < date_trunc('month', NOW());
END;
$$;


ALTER FUNCTION "public"."reset_monthly_usage"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."rpc_artifact_link_insert"("p_user_id" "uuid", "p_trace_id" "uuid", "p_execution_id" "uuid", "p_execution_run_id" "uuid", "p_from_type" "text", "p_from_id" "uuid", "p_from_key" "text", "p_relation" "text", "p_meta" "jsonb", "p_to_type" "text", "p_to_id" "uuid", "p_to_key" "text") RETURNS "uuid"
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
declare
  v_id uuid;
begin
  insert into public.artifact_links(
    user_id, trace_id, execution_id, execution_run_id,
    from_type, from_id, from_key,
    relation, meta,
    to_type, to_id, to_key
  )
  values (
    p_user_id, p_trace_id, p_execution_id, p_execution_run_id,
    p_from_type, p_from_id, p_from_key,
    p_relation, coalesce(p_meta,'{}'::jsonb),
    p_to_type, p_to_id, p_to_key
  )
  returning id into v_id;

  return v_id;
end;
$$;


ALTER FUNCTION "public"."rpc_artifact_link_insert"("p_user_id" "uuid", "p_trace_id" "uuid", "p_execution_id" "uuid", "p_execution_run_id" "uuid", "p_from_type" "text", "p_from_id" "uuid", "p_from_key" "text", "p_relation" "text", "p_meta" "jsonb", "p_to_type" "text", "p_to_id" "uuid", "p_to_key" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."rpc_cron_release_lock"("p_key" "text") RETURNS boolean
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
begin
  update public.cron_locks
  set locked_until = now()
  where key = p_key;
  return found;
end;
$$;


ALTER FUNCTION "public"."rpc_cron_release_lock"("p_key" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."rpc_cron_try_lock"("p_key" "text", "p_ttl_seconds" integer, "p_holder" "text" DEFAULT NULL::"text") RETURNS boolean
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
declare
  v_now timestamptz := now();
  v_until timestamptz := v_now + make_interval(secs => greatest(1, p_ttl_seconds));
begin
  -- Try insert first
  insert into public.cron_locks(key, locked_until, holder)
  values (p_key, v_until, p_holder)
  on conflict (key) do nothing;

  -- If exists and expired, take it
  update public.cron_locks
  set locked_until = v_until,
      holder = p_holder
  where key = p_key
    and locked_until <= v_now;

  -- Acquired if lock is ours and not expired
  return exists (
    select 1 from public.cron_locks
    where key = p_key
      and locked_until > v_now
      and (p_holder is null or holder = p_holder)
  );
end;
$$;


ALTER FUNCTION "public"."rpc_cron_try_lock"("p_key" "text", "p_ttl_seconds" integer, "p_holder" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."rpc_execution_cancel"("p_execution_id" "uuid", "p_reason" "text" DEFAULT NULL::"text") RETURNS boolean
    LANGUAGE "plpgsql"
    AS $$
begin
  update public.executions
  set status = 'cancelled',
      cancelled_at = now(),
      cancel_reason = p_reason
  where id = p_execution_id
    and user_id = auth.uid()
    and status in ('queued','claimed','running');

  return found;
end;
$$;


ALTER FUNCTION "public"."rpc_execution_cancel"("p_execution_id" "uuid", "p_reason" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."rpc_execution_claim_next"("p_now" timestamp with time zone DEFAULT "now"()) RETURNS TABLE("execution_id" "uuid", "kind" "text", "payload" "jsonb", "run_at" timestamp with time zone, "priority" integer, "attempts" integer, "max_attempts" integer)
    LANGUAGE "plpgsql"
    AS $$
begin
  return query
  with cte as (
    select e.*
    from public.executions e
    where e.user_id = auth.uid()
      and e.status = 'queued'
      and e.run_at <= p_now
      and (e.next_retry_at is null or e.next_retry_at <= p_now)
      and e.attempts < e.max_attempts
    order by e.priority desc, e.run_at asc, e.created_at asc
    for update skip locked
    limit 1
  )
  update public.executions e2
  set status = 'claimed'
  from cte
  where e2.id = cte.id
  returning
    e2.id as execution_id,
    e2.kind,
    e2.payload,
    e2.run_at,
    e2.priority,
    e2.attempts,
    e2.max_attempts;
end;
$$;


ALTER FUNCTION "public"."rpc_execution_claim_next"("p_now" timestamp with time zone) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."rpc_execution_drift_radar"("p_user_id" "text", "p_kind" "text" DEFAULT NULL::"text", "p_baseline_days" integer DEFAULT 7, "p_recent_hours" integer DEFAULT 6) RETURNS TABLE("kind" "text", "baseline_runs" integer, "baseline_failures" integer, "baseline_failure_rate" numeric, "baseline_p95_duration_ms" numeric, "recent_runs" integer, "recent_failures" integer, "recent_failure_rate" numeric, "recent_p95_duration_ms" numeric, "drift_failure_rate_delta" numeric, "drift_p95_duration_delta_ms" numeric)
    LANGUAGE "sql" SECURITY DEFINER
    AS $$
with base as (
  select
    e.kind,
    (extract(epoch from (r.finished_at - r.started_at)) * 1000.0) as duration_ms,
    (case when r.status = 'failed' then 1 else 0 end) as is_failed
  from public.execution_runs r
  join public.executions e on e.id = r.execution_id
  where r.user_id_text = p_user_id
    and r.started_at >= now() - make_interval(days => p_baseline_days)
    and r.finished_at is not null
    and (p_kind is null or e.kind = p_kind)
),
recent as (
  select
    e.kind,
    (extract(epoch from (r.finished_at - r.started_at)) * 1000.0) as duration_ms,
    (case when r.status = 'failed' then 1 else 0 end) as is_failed
  from public.execution_runs r
  join public.executions e on e.id = r.execution_id
  where r.user_id_text = p_user_id
    and r.started_at >= now() - make_interval(hours => p_recent_hours)
    and r.finished_at is not null
    and (p_kind is null or e.kind = p_kind)
),
base_agg as (
  select
    kind,
    count(*)::int as runs,
    sum(is_failed)::int as failures,
    (sum(is_failed)::numeric / nullif(count(*),0)) as failure_rate,
    percentile_cont(0.95) within group (order by duration_ms) as p95_ms
  from base
  group by kind
),
recent_agg as (
  select
    kind,
    count(*)::int as runs,
    sum(is_failed)::int as failures,
    (sum(is_failed)::numeric / nullif(count(*),0)) as failure_rate,
    percentile_cont(0.95) within group (order by duration_ms) as p95_ms
  from recent
  group by kind
)
select
  coalesce(b.kind, r.kind) as kind,

  coalesce(b.runs, 0) as baseline_runs,
  coalesce(b.failures, 0) as baseline_failures,
  coalesce(b.failure_rate, 0) as baseline_failure_rate,
  coalesce(b.p95_ms, 0) as baseline_p95_duration_ms,

  coalesce(r.runs, 0) as recent_runs,
  coalesce(r.failures, 0) as recent_failures,
  coalesce(r.failure_rate, 0) as recent_failure_rate,
  coalesce(r.p95_ms, 0) as recent_p95_duration_ms,

  (coalesce(r.failure_rate, 0) - coalesce(b.failure_rate, 0)) as drift_failure_rate_delta,
  (coalesce(r.p95_ms, 0) - coalesce(b.p95_ms, 0)) as drift_p95_duration_delta_ms
from base_agg b
full outer join recent_agg r using (kind)
order by
  abs(coalesce(r.failure_rate,0) - coalesce(b.failure_rate,0)) desc,
  abs(coalesce(r.p95_ms,0) - coalesce(b.p95_ms,0)) desc;
$$;


ALTER FUNCTION "public"."rpc_execution_drift_radar"("p_user_id" "text", "p_kind" "text", "p_baseline_days" integer, "p_recent_hours" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."rpc_execution_enqueue"("p_kind" "text", "p_payload" "jsonb", "p_run_at" timestamp with time zone DEFAULT "now"(), "p_priority" integer DEFAULT 0, "p_dedupe_key" "text" DEFAULT NULL::"text", "p_max_attempts" integer DEFAULT 5) RETURNS "uuid"
    LANGUAGE "plpgsql"
    AS $$
declare
  v_id uuid;
begin
  insert into public.executions(user_id, kind, payload, run_at, priority, dedupe_key, max_attempts)
  values (auth.uid(), p_kind, coalesce(p_payload,'{}'::jsonb), coalesce(p_run_at, now()), coalesce(p_priority,0), p_dedupe_key, coalesce(p_max_attempts,5))
  on conflict (user_id, dedupe_key)
  do update set id = public.executions.id
  returning id into v_id;

  return v_id;
end;
$$;


ALTER FUNCTION "public"."rpc_execution_enqueue"("p_kind" "text", "p_payload" "jsonb", "p_run_at" timestamp with time zone, "p_priority" integer, "p_dedupe_key" "text", "p_max_attempts" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."rpc_execution_finish_run"("p_run_id" "uuid", "p_status" "text", "p_output" "jsonb" DEFAULT '{}'::"jsonb", "p_error" "text" DEFAULT NULL::"text") RETURNS "uuid"
    LANGUAGE "plpgsql"
    AS $$
declare
  v_run public.execution_runs%rowtype;
  v_exec public.executions%rowtype;
  v_next_retry timestamptz;
  v_backoff_secs int;
begin
  select * into v_run
  from public.execution_runs
  where id = p_run_id
    and user_id = auth.uid()
  for update;

  if not found then
    raise exception 'run not found';
  end if;

  select * into v_exec
  from public.executions
  where id = v_run.execution_id
    and user_id = auth.uid()
  for update;

  if not found then
    raise exception 'execution not found';
  end if;

  update public.execution_runs
  set status = p_status,
      finished_at = now(),
      output = coalesce(p_output,'{}'::jsonb),
      error = p_error
  where id = v_run.id;

  if p_status = 'succeeded' then
    update public.executions
    set status = 'succeeded',
        last_error = null,
        next_retry_at = null
    where id = v_exec.id;

  elsif p_status = 'cancelled' then
    update public.executions
    set status = 'cancelled',
        cancelled_at = coalesce(cancelled_at, now())
    where id = v_exec.id;

  else
    -- failure â†’ requeue with exponential backoff, unless max attempts reached
    v_backoff_secs := least(3600, (2 ^ greatest(0, v_exec.attempts)) * 10); -- 10s,20s,40s,... up to 1hr
    v_next_retry := now() + make_interval(secs => v_backoff_secs);

    if v_exec.attempts >= v_exec.max_attempts then
      update public.executions
      set status = 'failed',
          last_error = p_error,
          next_retry_at = null
      where id = v_exec.id;
    else
      update public.executions
      set status = 'queued',
          last_error = p_error,
          next_retry_at = v_next_retry
      where id = v_exec.id;
    end if;
  end if;

  return v_exec.id;
end;
$$;


ALTER FUNCTION "public"."rpc_execution_finish_run"("p_run_id" "uuid", "p_status" "text", "p_output" "jsonb", "p_error" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."rpc_execution_start_run"("p_execution_id" "uuid") RETURNS "uuid"
    LANGUAGE "plpgsql"
    AS $$
declare
  v_e public.executions%rowtype;
  v_run_id uuid;
begin
  select * into v_e
  from public.executions
  where id = p_execution_id
    and user_id = auth.uid()
  for update;

  if not found then
    raise exception 'execution not found';
  end if;

  if v_e.status = 'cancelled' then
    insert into public.execution_runs(execution_id, user_id, status, attempt, error)
    values (v_e.id, auth.uid(), 'cancelled', v_e.attempts + 1, 'cancelled before start')
    returning id into v_run_id;
    return v_run_id;
  end if;

  if v_e.status <> 'claimed' then
    raise exception 'execution not in claimed status';
  end if;

  update public.executions
  set status = 'running',
      attempts = attempts + 1
  where id = v_e.id;

  insert into public.execution_runs(execution_id, user_id, status, attempt)
  values (v_e.id, auth.uid(), 'running', v_e.attempts + 1)
  returning id into v_run_id;

  return v_run_id;
end;
$$;


ALTER FUNCTION "public"."rpc_execution_start_run"("p_execution_id" "uuid") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."rpc_ops_audit_insert"("p_actor_user_id" "text", "p_actor_is_admin" boolean, "p_target_user_id" "text", "p_action" "text", "p_resource_type" "text", "p_resource_id" "text", "p_meta" "jsonb", "p_ip" "text", "p_user_agent" "text") RETURNS "uuid"
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
declare
  v_id uuid;
begin
  insert into public.ops_audit_log(
    actor_user_id, actor_is_admin, target_user_id,
    action, resource_type, resource_id,
    meta, ip, user_agent
  )
  values (
    p_actor_user_id,
    coalesce(p_actor_is_admin,false),
    p_target_user_id,
    p_action,
    p_resource_type,
    p_resource_id,
    coalesce(p_meta,'{}'::jsonb),
    p_ip,
    p_user_agent
  )
  returning id into v_id;

  return v_id;
end;
$$;


ALTER FUNCTION "public"."rpc_ops_audit_insert"("p_actor_user_id" "text", "p_actor_is_admin" boolean, "p_target_user_id" "text", "p_action" "text", "p_resource_type" "text", "p_resource_id" "text", "p_meta" "jsonb", "p_ip" "text", "p_user_agent" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."rpc_scheduler_tick"("p_now" timestamp with time zone DEFAULT "now"()) RETURNS "jsonb"
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
declare
  v_user record;
  v_bucket_1 text;
  v_bucket_5 text;
  v_bucket_15 text;
  v_inserted int := 0;
begin
  -- buckets for dedupe keys
  v_bucket_1 := public.fn_time_bucket_key(p_now, 1);
  v_bucket_5 := public.fn_time_bucket_key(p_now, 5);
  v_bucket_15 := public.fn_time_bucket_key(p_now, 15);

  for v_user in
    select user_id from public.scheduler_targets where is_enabled = true
  loop
    -- Every 5 min: inbox triage
    insert into public.executions(user_id, kind, payload, run_at, priority, dedupe_key, max_attempts, status)
    values (
      v_user.user_id,
      'inbox.triage',
      jsonb_build_object('mode','inbox','limit',10),
      p_now,
      8,
      'recurring.inbox.triage.' || v_bucket_5,
      5,
      'queued'
    )
    on conflict (user_id, dedupe_key) do nothing;

    if found then v_inserted := v_inserted + 1; end if;

    -- Every 5 min: email flush
    insert into public.executions(user_id, kind, payload, run_at, priority, dedupe_key, max_attempts, status)
    values (
      v_user.user_id,
      'email.flush',
      jsonb_build_object('limit',25),
      p_now,
      7,
      'recurring.email.flush.' || v_bucket_5,
      5,
      'queued'
    )
    on conflict (user_id, dedupe_key) do nothing;

    if found then v_inserted := v_inserted + 1; end if;

    -- Every 15 min: refresh quest checkpoints (+ quest.completed evidence + bonus XP via your handler)
    insert into public.executions(user_id, kind, payload, run_at, priority, dedupe_key, max_attempts, status)
    values (
      v_user.user_id,
      'quest.refresh_today',
      jsonb_build_object('questKeys', jsonb_build_array('daily_workout','deep_work','discipline_20'), 'emitCompletionEvidence', true),
      p_now,
      6,
      'recurring.quest.refresh_today.' || v_bucket_15,
      5,
      'queued'
    )
    on conflict (user_id, dedupe_key) do nothing;

    if found then v_inserted := v_inserted + 1; end if;

  end loop;

  return jsonb_build_object(
    'ok', true,
    'now', p_now,
    'inserted', v_inserted
  );
end;
$$;


ALTER FUNCTION "public"."rpc_scheduler_tick"("p_now" timestamp with time zone) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."rpc_trace_search"("p_user_id" "uuid", "p_since" timestamp with time zone DEFAULT NULL::timestamp with time zone, "p_until" timestamp with time zone DEFAULT NULL::timestamp with time zone, "p_kind" "text" DEFAULT NULL::"text", "p_status" "text" DEFAULT NULL::"text", "p_has_error" boolean DEFAULT NULL::boolean, "p_q" "text" DEFAULT NULL::"text", "p_limit" integer DEFAULT 50, "p_offset" integer DEFAULT 0) RETURNS TABLE("trace_id" "uuid", "first_started_at" timestamp with time zone, "last_finished_at" timestamp with time zone, "run_count" integer, "failed_count" integer, "last_status" "text", "last_error" "text", "kinds" "text")
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
begin
  return query
  with runs as (
    select
      r.trace_id,
      r.started_at,
      r.finished_at,
      r.status,
      r.error,
      e.kind
    from public.execution_runs r
    join public.executions e on e.id = r.execution_id
    where r.user_id = p_user_id
      and r.trace_id is not null
      and (p_since is null or r.started_at >= p_since)
      and (p_until is null or r.started_at <= p_until)
      and (p_kind is null or e.kind = p_kind)
      and (p_status is null or r.status = p_status)
      and (p_has_error is null or (p_has_error = true and r.error is not null) or (p_has_error = false and r.error is null))
  ),
  matched as (
    select distinct trace_id from runs
    union
    select distinct l.trace_id
    from public.execution_logs l
    where l.user_id = p_user_id
      and l.trace_id is not null
      and (p_since is null or l.created_at >= p_since)
      and (p_until is null or l.created_at <= p_until)
      and (p_q is not null and l.message ilike ('%' || p_q || '%'))
  ),
  filtered as (
    select r.*
    from runs r
    where (p_q is null)
       or (r.error is not null and r.error ilike ('%' || p_q || '%'))
       or (r.trace_id in (select trace_id from matched))
  ),
  last_run as (
    select distinct on (trace_id)
      trace_id, status as last_status, error as last_error, started_at
    from filtered
    order by trace_id, started_at desc
  )
  select
    f.trace_id,
    min(f.started_at) as first_started_at,
    max(f.finished_at) as last_finished_at,
    count(*)::int as run_count,
    sum(case when f.status = 'failed' then 1 else 0 end)::int as failed_count,
    (select lr.last_status from last_run lr where lr.trace_id = f.trace_id),
    (select lr.last_error from last_run lr where lr.trace_id = f.trace_id),
    string_agg(distinct f.kind, ', ' order by f.kind) as kinds
  from filtered f
  group by f.trace_id
  order by max(f.started_at) desc
  limit greatest(1, least(200, p_limit))
  offset greatest(0, p_offset);
end;
$$;


ALTER FUNCTION "public"."rpc_trace_search"("p_user_id" "uuid", "p_since" timestamp with time zone, "p_until" timestamp with time zone, "p_kind" "text", "p_status" "text", "p_has_error" boolean, "p_q" "text", "p_limit" integer, "p_offset" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."rpc_xp_create_eval_run"("p_evaluator_key" "text", "p_evaluator_version" integer, "p_evidence_id" "uuid", "p_result_xp" "jsonb", "p_result_meta" "jsonb") RETURNS "uuid"
    LANGUAGE "plpgsql"
    AS $$
declare
  v_id uuid;
begin
  insert into public.xp_evaluation_runs(user_id, evaluator_key, evaluator_version, evidence_id, result_xp, result_meta)
  values (
    auth.uid(),
    p_evaluator_key,
    p_evaluator_version,
    p_evidence_id,
    coalesce(p_result_xp, '{}'::jsonb),
    coalesce(p_result_meta, '{}'::jsonb)
  )
  on conflict (user_id, evidence_id, evaluator_key, evaluator_version)
  do update set id = public.xp_evaluation_runs.id
  returning id into v_id;

  return v_id;
end;
$$;


ALTER FUNCTION "public"."rpc_xp_create_eval_run"("p_evaluator_key" "text", "p_evaluator_version" integer, "p_evidence_id" "uuid", "p_result_xp" "jsonb", "p_result_meta" "jsonb") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."rpc_xp_issue_from_eval_run"("p_eval_run_id" "uuid") RETURNS integer
    LANGUAGE "plpgsql"
    AS $$
declare
  v_run record;
  v_k text;
  v_amount int;
  v_count int := 0;
begin
  select *
  into v_run
  from public.xp_evaluation_runs
  where id = p_eval_run_id
    and user_id = auth.uid();

  if not found then
    raise exception 'eval_run not found or not owned';
  end if;

  for v_k, v_amount in
    select key, (value::text)::int
    from jsonb_each(v_run.result_xp)
  loop
    -- only accept keys that map to xp_kind enum
    begin
      insert into public.xp_ledger(
        user_id,
        xp_type,
        amount,
        source_kind,
        source_id,
        memo,
        evaluator_key,
        evaluator_version,
        evidence_id
      )
      values (
        auth.uid(),
        v_k::public.xp_kind,
        v_amount,
        'evaluation',
        v_run.id,
        'Issued from evaluation run',
        v_run.evaluator_key,
        v_run.evaluator_version,
        v_run.evidence_id
      )
      on conflict (user_id, xp_type, source_kind, source_id)
      do nothing;

      if found then
        v_count := v_count + 1;
      end if;
    exception when others then
      -- ignore unknown xp keys or bad casts
      continue;
    end;
  end loop;

  return v_count;
end;
$$;


ALTER FUNCTION "public"."rpc_xp_issue_from_eval_run"("p_eval_run_id" "uuid") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."rpc_xp_record_evidence"("p_event_id" "uuid", "p_evidence_type" "text", "p_evidence_payload" "jsonb", "p_confidence" numeric, "p_source" "text") RETURNS "uuid"
    LANGUAGE "plpgsql"
    AS $$
declare
  v_id uuid;
begin
  insert into public.life_evidence(user_id, life_event_id, evidence_type, evidence_payload, confidence, source)
  values (auth.uid(), p_event_id, p_evidence_type, coalesce(p_evidence_payload, '{}'::jsonb), coalesce(p_confidence, 1.0), coalesce(p_source, 'ui'))
  returning id into v_id;

  return v_id;
end;
$$;


ALTER FUNCTION "public"."rpc_xp_record_evidence"("p_event_id" "uuid", "p_evidence_type" "text", "p_evidence_payload" "jsonb", "p_confidence" numeric, "p_source" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."rpc_xp_reverse_ledger_entry"("p_ledger_id" "uuid", "p_memo" "text") RETURNS "uuid"
    LANGUAGE "plpgsql"
    AS $$
declare
  v_row record;
  v_new_id uuid;
begin
  select *
  into v_row
  from public.xp_ledger
  where id = p_ledger_id
    and user_id = auth.uid();

  if not found then
    raise exception 'ledger entry not found or not owned';
  end if;

  insert into public.xp_ledger(
    user_id, xp_type, amount, source_kind, source_id, memo,
    evaluator_key, evaluator_version, evidence_id, reversal_of
  )
  values (
    auth.uid(),
    v_row.xp_type,
    -v_row.amount,
    'reversal',
    v_row.id,
    coalesce(p_memo, 'Reversal'),
    v_row.evaluator_key,
    v_row.evaluator_version,
    v_row.evidence_id,
    v_row.id
  )
  returning id into v_new_id;

  return v_new_id;
end;
$$;


ALTER FUNCTION "public"."rpc_xp_reverse_ledger_entry"("p_ledger_id" "uuid", "p_memo" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."search_fragments_by_embedding"("query_embedding" "public"."vector", "match_user_id" "text", "match_count" integer DEFAULT 10, "min_importance" numeric DEFAULT 0) RETURNS TABLE("id" "uuid", "user_id" "text", "raw_event_id" "uuid", "fragment_type" "text", "content" "text", "metadata" "jsonb", "importance" numeric, "time_scope" "text", "occurred_at" timestamp with time zone, "expires_at" timestamp with time zone, "created_at" timestamp with time zone, "updated_at" timestamp with time zone, "similarity" double precision)
    LANGUAGE "plpgsql"
    AS $$
begin
  return query
  select
    f.id,
    f.user_id,
    f.raw_event_id,
    f.fragment_type,
    f.content,
    f.metadata,
    f.importance,
    f.time_scope,
    f.occurred_at,
    f.expires_at,
    f.created_at,
    f.updated_at,
    1 - (e.embedding <=> query_embedding) as similarity
  from tb_embeddings e
  join tb_memory_fragments f on e.fragment_id = f.id
  where e.user_id = match_user_id
    and f.importance >= min_importance
    and (f.expires_at is null or f.expires_at > now())
  order by e.embedding <=> query_embedding
  limit match_count;
end;
$$;


ALTER FUNCTION "public"."search_fragments_by_embedding"("query_embedding" "public"."vector", "match_user_id" "text", "match_count" integer, "min_importance" numeric) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."search_memories"("query_embedding" "public"."vector", "match_user_id" "text", "match_types" "text"[], "match_categories" "text"[], "min_importance" integer, "match_count" integer) RETURNS TABLE("id" "uuid", "user_id" "text", "type" "text", "category" "text", "content" "text", "context" "text", "importance" integer, "tags" "text"[], "source" "text", "source_id" "text", "access_count" integer, "created_at" timestamp with time zone, "updated_at" timestamp with time zone, "similarity" double precision)
    LANGUAGE "plpgsql"
    AS $$
BEGIN
  RETURN QUERY
  SELECT
    m.id, m.user_id, m.type, m.category, m.content, m.context,
    m.importance, m.tags, m.source, m.source_id, m.access_count,
    m.created_at, m.updated_at,
    1 - (m.embedding <=> query_embedding) AS similarity
  FROM memories m
  WHERE m.user_id = match_user_id
    AND m.importance >= min_importance
    AND (match_types IS NULL OR m.type = ANY(match_types))
    AND (match_categories IS NULL OR m.category = ANY(match_categories))
    AND m.embedding IS NOT NULL
  ORDER BY m.embedding <=> query_embedding
  LIMIT match_count;
END;
$$;


ALTER FUNCTION "public"."search_memories"("query_embedding" "public"."vector", "match_user_id" "text", "match_types" "text"[], "match_categories" "text"[], "min_importance" integer, "match_count" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."seed_default_domains"("p_user_id" "text") RETURNS "void"
    LANGUAGE "plpgsql"
    AS $$
BEGIN
  INSERT INTO life_domains (user_id, key, label, weight)
  VALUES
    (p_user_id, 'work', 'Work & Career', 3),
    (p_user_id, 'health', 'Health & Fitness', 3),
    (p_user_id, 'relationships', 'Relationships', 3),
    (p_user_id, 'finance', 'Finance', 2),
    (p_user_id, 'growth', 'Personal Growth', 2),
    (p_user_id, 'recovery', 'Rest & Recovery', 2)
  ON CONFLICT (user_id, key) DO NOTHING;
END;
$$;


ALTER FUNCTION "public"."seed_default_domains"("p_user_id" "text") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."set_referral_code"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
BEGIN
  IF NEW.referral_code IS NULL THEN
    NEW.referral_code := generate_referral_code();
  END IF;
  RETURN NEW;
END;
$$;


ALTER FUNCTION "public"."set_referral_code"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."set_updated_at"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
begin
  new.updated_at = now();
  return new;
end $$;


ALTER FUNCTION "public"."set_updated_at"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."sync_users_clerk_ids"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
BEGIN
  IF NEW.clerk_user_id IS NULL AND NEW.clerk_id IS NOT NULL THEN
    NEW.clerk_user_id := NEW.clerk_id;
  END IF;

  IF NEW.clerk_id IS NULL AND NEW.clerk_user_id IS NOT NULL THEN
    NEW.clerk_id := NEW.clerk_user_id;
  END IF;

  RETURN NEW;
END;
$$;


ALTER FUNCTION "public"."sync_users_clerk_ids"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."tasks_enforce_completion"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
begin
  if new.status = 'completed' and new.completed_at is null then
    new.completed_at := now();
  end if;

  if new.status <> 'completed' and new.completed_at is not null then
    new.completed_at := null;
  end if;

  return new;
end;
$$;


ALTER FUNCTION "public"."tasks_enforce_completion"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."tg_set_updated_at"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
begin
  new.updated_at = now();
  return new;
end;
$$;


ALTER FUNCTION "public"."tg_set_updated_at"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."tg_set_user_id_text"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
begin
  -- If the old uuid user_id is present, derive text.
  if new.user_id_text is null and new.user_id is not null then
    new.user_id_text := new.user_id::text;
  end if;

  -- If text is present but uuid is null, we DO NOT attempt to parse it.
  -- Clerk IDs aren't UUIDs; uuid column will be removed later.

  return new;
end;
$$;


ALTER FUNCTION "public"."tg_set_user_id_text"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."trg_refresh_threads_after_email_insert"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
begin
  perform public.refresh_email_threads_for_owner(new.owner_user_id);
  return new;
end;
$$;


ALTER FUNCTION "public"."trg_refresh_threads_after_email_insert"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."update_autonomy_actions_updated_at"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$$;


ALTER FUNCTION "public"."update_autonomy_actions_updated_at"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."update_calendar_accounts_updated_at"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$$;


ALTER FUNCTION "public"."update_calendar_accounts_updated_at"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."update_calendar_events_cache_updated_at"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$$;


ALTER FUNCTION "public"."update_calendar_events_cache_updated_at"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."update_day_plans_updated_at"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$$;


ALTER FUNCTION "public"."update_day_plans_updated_at"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."update_delegated_drafts_updated_at"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$$;


ALTER FUNCTION "public"."update_delegated_drafts_updated_at"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."update_entity_importance_trigger"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
begin
  update tb_entities
  set importance = compute_entity_importance(NEW.entity_id, NEW.user_id)
  where id = NEW.entity_id;
  return NEW;
end;
$$;


ALTER FUNCTION "public"."update_entity_importance_trigger"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."update_life_domains_updated_at"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$$;


ALTER FUNCTION "public"."update_life_domains_updated_at"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."update_notification_preferences_updated_at"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$$;


ALTER FUNCTION "public"."update_notification_preferences_updated_at"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."update_plan_items_updated_at"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$$;


ALTER FUNCTION "public"."update_plan_items_updated_at"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."update_updated_at"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
BEGIN
  NEW.updated_at := NOW();
  RETURN NEW;
END;
$$;


ALTER FUNCTION "public"."update_updated_at"() OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."upsert_third_brain_memory"("p_user_id" "text", "p_category" "text", "p_key" "text", "p_content" "text", "p_importance" integer DEFAULT 1, "p_metadata" "jsonb" DEFAULT '{}'::"jsonb") RETURNS "uuid"
    LANGUAGE "plpgsql" SECURITY DEFINER
    AS $$
DECLARE
  v_id UUID;
BEGIN
  INSERT INTO third_brain_memories (user_id, category, key, content, importance, metadata, last_updated_at)
  VALUES (p_user_id, p_category, p_key, p_content, p_importance, p_metadata, NOW())
  ON CONFLICT (user_id, key) 
  DO UPDATE SET 
    content = EXCLUDED.content,
    importance = EXCLUDED.importance,
    metadata = third_brain_memories.metadata || EXCLUDED.metadata,
    last_updated_at = NOW()
  RETURNING id INTO v_id;
  
  RETURN v_id;
END;
$$;


ALTER FUNCTION "public"."upsert_third_brain_memory"("p_user_id" "text", "p_category" "text", "p_key" "text", "p_content" "text", "p_importance" integer, "p_metadata" "jsonb") OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."user_daily_activity_rollup_read"("p_days" integer DEFAULT 30) RETURNS TABLE("day" "date", "event_count" bigint)
    LANGUAGE "plpgsql" SECURITY DEFINER
    SET "search_path" TO 'public'
    AS $$
declare
  v_rel regclass;
  v_days int := greatest(coalesce(p_days, 30), 1);
begin
  -- Auto-discover rollup relation (matview/view/table) in public
  select c.oid::regclass
    into v_rel
  from pg_class c
  join pg_namespace n on n.oid = c.relnamespace
  where n.nspname = 'public'
    and c.relkind in ('m','v','r')
    and c.relname ilike 'user_daily_activity_rollup%'
    and exists (
      select 1
      from information_schema.columns ic
      where ic.table_schema = 'public'
        and ic.table_name = c.relname
        and ic.column_name = 'user_id'
    )
    and exists (
      select 1
      from information_schema.columns ic
      where ic.table_schema = 'public'
        and ic.table_name = c.relname
        and ic.column_name = 'day'
    )
  order by
    case c.relkind when 'm' then 1 when 'v' then 2 else 3 end,
    c.relname
  limit 1;

  if v_rel is null then
    raise exception using
      message = 'No rollup relation found in public matching user_daily_activity_rollup% with columns (user_id, day).';
  end if;

  return query execute format(
    'select r.day, r.event_count
       from %s r
      where r.user_id = auth.uid()
        and r.day >= (current_date - (%s - 1))
      order by r.day desc',
    v_rel,
    v_days
  );
end;
$$;


ALTER FUNCTION "public"."user_daily_activity_rollup_read"("p_days" integer) OWNER TO "postgres";


CREATE OR REPLACE FUNCTION "public"."utc_day_bounds"("p_day" "date") RETURNS TABLE("day_start" timestamp with time zone, "day_end" timestamp with time zone)
    LANGUAGE "sql"
    AS $$
  select
    (p_day::timestamptz) at time zone 'utc' as day_start,
    ((p_day + 1)::timestamptz) at time zone 'utc' as day_end
$$;


ALTER FUNCTION "public"."utc_day_bounds"("p_day" "date") OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."_pulse_dropped_policies" (
    "dropped_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "schemaname" "text" NOT NULL,
    "tablename" "text" NOT NULL,
    "policyname" "text" NOT NULL,
    "policy_cmd" "text",
    "policy_roles" "text"[],
    "policy_qual" "text",
    "policy_with_check" "text"
);


ALTER TABLE "public"."_pulse_dropped_policies" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."_pulse_dropped_user_id_fks" (
    "dropped_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "table_schema" "text" NOT NULL,
    "table_name" "text" NOT NULL,
    "constraint_name" "text" NOT NULL,
    "constraint_def" "text" NOT NULL
);


ALTER TABLE "public"."_pulse_dropped_user_id_fks" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."_pulse_dropped_views" (
    "dropped_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "view_schema" "text" NOT NULL,
    "view_name" "text" NOT NULL,
    "view_definition" "text" NOT NULL
);


ALTER TABLE "public"."_pulse_dropped_views" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."_pulse_quarantine_rows" (
    "id" bigint NOT NULL,
    "table_name" "text" NOT NULL,
    "row_pk" "jsonb",
    "reason" "text" NOT NULL,
    "quarantined_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "row_data" "jsonb" NOT NULL
);


ALTER TABLE "public"."_pulse_quarantine_rows" OWNER TO "postgres";


CREATE SEQUENCE IF NOT EXISTS "public"."_pulse_quarantine_rows_id_seq"
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE "public"."_pulse_quarantine_rows_id_seq" OWNER TO "postgres";


ALTER SEQUENCE "public"."_pulse_quarantine_rows_id_seq" OWNED BY "public"."_pulse_quarantine_rows"."id";



CREATE TABLE IF NOT EXISTS "public"."achievements" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "achievement_key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "icon" "text",
    "xp_reward" integer DEFAULT 0,
    "unlocked_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_achievements" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."achievements" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."activity_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id" "uuid" DEFAULT "auth"."uid"(),
    "source" "text" DEFAULT 'system'::"text" NOT NULL,
    "event_type" "text" NOT NULL,
    "title" "text" NOT NULL,
    "detail" "text",
    "payload" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    "event_ts" timestamp with time zone DEFAULT "now"() NOT NULL,
    "immutable" boolean DEFAULT true,
    "event_name" "text",
    "event_source" "text",
    "entity_type" "text",
    "entity_id" "text",
    "metadata" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    CONSTRAINT "pulse_activity_events_single_user_id_source" CHECK ((((
CASE
    WHEN ("user_id_uuid" IS NOT NULL) THEN 1
    ELSE 0
END +
CASE
    WHEN ("user_id_text" IS NOT NULL) THEN 1
    ELSE 0
END) +
CASE
    WHEN ("user_id" IS NOT NULL) THEN 1
    ELSE 0
END) = 1)),
    CONSTRAINT "pulse_user_id_text_only_activity_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."activity_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."ag_agents" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "capabilities" "jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."ag_agents" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."ag_messages" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "run_id" "uuid" NOT NULL,
    "user_id" "text",
    "role" "text" NOT NULL,
    "agent_key" "text",
    "content" "jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_ag_messages" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."ag_messages" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."ag_runs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "agent_key" "text" NOT NULL,
    "topic" "text",
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_ag_runs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."ag_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."agi_actions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "run_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "action" "jsonb" NOT NULL,
    "status" "text" DEFAULT 'planned'::"text" NOT NULL,
    "executed_at" timestamp with time zone,
    "error" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_agi_actions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."agi_actions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."agi_agent_profiles" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "agent_name" "text" NOT NULL,
    "config" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "last_updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_agi_agent_profiles" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."agi_agent_profiles" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."agi_feedback" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "action_id" "uuid" NOT NULL,
    "feedback_type" "text" NOT NULL,
    "comment" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_agi_feedback" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."agi_feedback" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."agi_policies" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "enabled" boolean DEFAULT true NOT NULL,
    "trigger" "jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_agi_policies" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."agi_policies" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."agi_runs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "started_at" timestamp with time zone NOT NULL,
    "finished_at" timestamp with time zone NOT NULL,
    "trigger" "jsonb" NOT NULL,
    "world_snapshot" "jsonb" NOT NULL,
    "agent_results" "jsonb" NOT NULL,
    "final_plan" "jsonb" NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_agi_runs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."agi_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."agi_scenario_runs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "scenario_key" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_agi_scenario_runs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."agi_scenario_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."agi_scenarios" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."agi_scenarios" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."agi_telemetry" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text",
    "org_id" "uuid",
    "run_id" "uuid",
    "agent_name" "text",
    "action_count" integer,
    "duration_ms" integer,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_agi_telemetry" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."agi_telemetry" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."agi_user_profile" (
    "user_id" "text" NOT NULL,
    "priorities" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "capabilities" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "autonomy_style" "text" DEFAULT 'balanced'::"text" NOT NULL,
    "rituals" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "focus_areas" "text"[] DEFAULT ARRAY[]::"text"[],
    "tone" "text" DEFAULT 'default'::"text" NOT NULL,
    "notification_preferences" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "predictive_assistance" boolean DEFAULT true NOT NULL,
    "hard_limits" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_agi_user_profile" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."agi_user_profile" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."align_feedback" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "source" "text" NOT NULL,
    "context" "text" NOT NULL,
    "feedback_type" "text" NOT NULL,
    "message" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_align_feedback" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."align_feedback" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."align_global_policies" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "key" "text" NOT NULL,
    "description" "text" NOT NULL,
    "rules" "jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."align_global_policies" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."align_user_profiles" (
    "user_id" "text" NOT NULL,
    "core_values" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "boundaries" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "tone_preferences" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "alignment_mode" "text" DEFAULT 'balanced'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_align_user_profiles" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."align_user_profiles" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."align_violations" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text",
    "context" "text" NOT NULL,
    "request_summary" "text" NOT NULL,
    "output_snippet" "text" NOT NULL,
    "violation_types" "text"[] NOT NULL,
    "severity" "text" NOT NULL,
    "raw_details" "jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_align_violations" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."align_violations" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."alignment_evaluations" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "evaluated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "source" "text" NOT NULL,
    "context_type" "text" NOT NULL,
    "context_id" "text",
    "input_summary" "text",
    "ethical_risk" numeric NOT NULL,
    "value_alignment" numeric NOT NULL,
    "red_flags" "jsonb",
    "approvals" "jsonb",
    "recommended_adjustment" "text",
    "final_recommendation" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_alignment_evaluations" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."alignment_evaluations" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."archetype_definitions" (
    "id" "text" NOT NULL,
    "display_name" "text" NOT NULL,
    "description" "text" NOT NULL,
    "healthy_expression" "jsonb",
    "shadow_expression" "jsonb",
    "core_gifts" "jsonb",
    "core_risks" "jsonb",
    "owner_user_id" "text"
);


ALTER TABLE "public"."archetype_definitions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."archetype_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "archetype_id" "text" NOT NULL,
    "mode" "text" NOT NULL,
    "intensity" numeric NOT NULL,
    "source" "text",
    "source_id" "uuid",
    "description" "text",
    "linked_canon_event_id" "uuid",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_archetype_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."archetype_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."archetype_snapshots" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "snapshot_time" timestamp with time zone DEFAULT "now"(),
    "current_mix" "jsonb",
    "rising_archetypes" "jsonb",
    "fading_archetypes" "jsonb",
    "narrative_summary" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_archetype_snapshots" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."archetype_snapshots" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."artifact_links" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "trace_id" "uuid",
    "execution_id" "uuid",
    "execution_run_id" "uuid",
    "from_type" "text" NOT NULL,
    "from_id" "uuid",
    "from_key" "text",
    "relation" "text" NOT NULL,
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "to_type" "text" NOT NULL,
    "to_id" "uuid",
    "to_key" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_artifact_links" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."artifact_links" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."attention_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "occurred_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "frame_id" "uuid",
    "from_item_id" "uuid",
    "to_item_id" "uuid",
    "reason" "text",
    "notes" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_attention_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."attention_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."autonomy_actions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "type" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "related_insight_id" "uuid",
    "status" "text" DEFAULT 'suggested'::"text",
    "scheduled_for" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "autonomy_actions_status_check" CHECK (("status" = ANY (ARRAY['suggested'::"text", 'scheduled'::"text", 'ignored'::"text", 'completed'::"text"]))),
    CONSTRAINT "autonomy_actions_type_check" CHECK (("type" = ANY (ARRAY['task'::"text", 'follow_up'::"text", 'habit_nudge'::"text", 'reflection'::"text", 'briefing'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_autonomy_actions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."autonomy_actions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."autopilot_jobs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "status" "text" DEFAULT 'queued'::"text" NOT NULL,
    "requested_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "started_at" timestamp with time zone,
    "finished_at" timestamp with time zone,
    "error" "text",
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "autopilot_jobs_status_check" CHECK (("status" = ANY (ARRAY['queued'::"text", 'running'::"text", 'complete'::"text", 'failed'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_autopilot_jobs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."autopilot_jobs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."autopilot_suggestions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "job_id" "uuid",
    "kind" "text" NOT NULL,
    "title" "text" NOT NULL,
    "details" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "priority" integer DEFAULT 50 NOT NULL,
    "status" "text" DEFAULT 'open'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "autopilot_suggestions_status_check" CHECK (("status" = ANY (ARRAY['open'::"text", 'dismissed'::"text", 'snoozed'::"text", 'accepted'::"text", 'completed'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_autopilot_suggestions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."autopilot_suggestions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."behavior_predictions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "entity_type" "text" NOT NULL,
    "entity_id" "text" NOT NULL,
    "target_type" "text" NOT NULL,
    "target_id" "text",
    "horizon" "text" NOT NULL,
    "prediction_time" timestamp with time zone DEFAULT "now"() NOT NULL,
    "outcome_label" "text" NOT NULL,
    "probability" numeric NOT NULL,
    "reasoning_summary" "text",
    "features_used" "jsonb",
    "recommended_intervention" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_behavior_predictions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."behavior_predictions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."brain_capabilities" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "capability_key" "text" NOT NULL,
    "enabled" boolean DEFAULT false NOT NULL,
    "level" numeric,
    "source_subsystems" "text"[],
    "notes" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_brain_capabilities" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."brain_capabilities" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."brain_changelog" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "subsystem_id" "text",
    "change_type" "text" NOT NULL,
    "description" "text" NOT NULL,
    "metadata" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_brain_changelog" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."brain_changelog" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."brain_entries" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "title" "text" NOT NULL,
    "content" "text" NOT NULL,
    "source" "text",
    "source_id" "text",
    "tags" "text"[] DEFAULT '{}'::"text"[] NOT NULL,
    "metadata" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_brain_entries" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."brain_entries" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."brain_error_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text",
    "occurred_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "subsystem_id" "text",
    "severity" "text" NOT NULL,
    "error_code" "text",
    "message" "text" NOT NULL,
    "context" "jsonb",
    "resolved" boolean DEFAULT false NOT NULL,
    "resolved_at" timestamp with time zone,
    "resolution_notes" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_brain_error_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."brain_error_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."brain_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "source" "text" NOT NULL,
    "event_type" "text" NOT NULL,
    "event_time" timestamp with time zone NOT NULL,
    "payload" "jsonb" NOT NULL,
    "correlation_id" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_brain_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."brain_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."brain_health_snapshots" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "snapshot_time" timestamp with time zone DEFAULT "now"() NOT NULL,
    "overall_health" numeric NOT NULL,
    "coverage_score" numeric,
    "error_pressure" numeric,
    "latency_pressure" numeric,
    "data_freshness_score" numeric,
    "subsystem_scores" "jsonb",
    "missing_subsystems" "jsonb",
    "notes" "text",
    "recommendations" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_brain_health_snapshots" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."brain_health_snapshots" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."brain_subsystems" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "region" "text" NOT NULL,
    "status" "text" DEFAULT 'planned'::"text" NOT NULL,
    "version" "text" DEFAULT 'v1'::"text" NOT NULL,
    "description" "text",
    "config" "jsonb",
    "metrics" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_brain_subsystems" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."brain_subsystems" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."brainstem_status" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "region" "text" NOT NULL,
    "status" "text" NOT NULL,
    "last_heartbeat_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "meta" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_brainstem_status" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."brainstem_status" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."branch_comparisons" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "tree_id" "uuid" NOT NULL,
    "compared_run_ids" "uuid"[] NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "summary" "text",
    "recommendation" "text",
    "key_differences" "jsonb",
    "owner_user_id" "text"
);


ALTER TABLE "public"."branch_comparisons" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."branch_simulation_runs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "tree_id" "uuid" NOT NULL,
    "root_node_id" "uuid" NOT NULL,
    "leaf_node_id" "uuid" NOT NULL,
    "path_node_ids" "uuid"[] NOT NULL,
    "run_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "parameters" "jsonb",
    "results" "jsonb",
    "narrative_summary" "text",
    "scores" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."branch_simulation_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."butler_notifications" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "intervention_id" "uuid",
    "trigger_type" "text" NOT NULL,
    "intervention_type" "text" NOT NULL,
    "message" "text" NOT NULL,
    "suggested_actions" "jsonb" DEFAULT '[]'::"jsonb",
    "urgency" "text" DEFAULT 'medium'::"text",
    "metadata" "jsonb" DEFAULT '{}'::"jsonb",
    "status" "text" DEFAULT 'pending'::"text",
    "delivered_at" timestamp with time zone,
    "acted_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_butler_notifications" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."butler_notifications" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."butler_snoozes" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "intervention_id" "uuid",
    "notification_id" "uuid",
    "snooze_until" timestamp with time zone NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_butler_snoozes" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."butler_snoozes" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."calendar_accounts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "provider" "text" DEFAULT 'google'::"text" NOT NULL,
    "provider_account_id" "text" NOT NULL,
    "access_token" "text" NOT NULL,
    "refresh_token" "text",
    "token_expires_at" timestamp with time zone,
    "calendar_id" "text" DEFAULT 'primary'::"text",
    "sync_enabled" boolean DEFAULT true,
    "last_synced_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_calendar_accounts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."calendar_accounts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."calendar_events_cache" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "provider" "text" DEFAULT 'google'::"text" NOT NULL,
    "external_id" "text" NOT NULL,
    "calendar_id" "text" DEFAULT 'primary'::"text" NOT NULL,
    "title" "text",
    "description" "text",
    "location" "text",
    "start_time" timestamp with time zone NOT NULL,
    "end_time" timestamp with time zone NOT NULL,
    "all_day" boolean DEFAULT false,
    "status" "text" DEFAULT 'confirmed'::"text",
    "attendees" "jsonb" DEFAULT '[]'::"jsonb",
    "organizer" "jsonb",
    "recurrence" "text"[],
    "html_link" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "calendar_events_cache_status_check" CHECK (("status" = ANY (ARRAY['confirmed'::"text", 'tentative'::"text", 'cancelled'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_calendar_events_cache" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."calendar_events_cache" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."call_intelligence_settings" (
    "user_id" "text" NOT NULL,
    "enabled" boolean DEFAULT false NOT NULL,
    "auto_consent_for_outbound" boolean DEFAULT false NOT NULL,
    "auto_consent_for_inbound" boolean DEFAULT false NOT NULL,
    "region" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_call_intelligence_settings" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."call_intelligence_settings" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."call_links" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "call_id" "uuid" NOT NULL,
    "entity_type" "text" NOT NULL,
    "entity_id" "uuid" NOT NULL,
    "confidence" numeric DEFAULT 1.0 NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."call_links" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."call_segments" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "call_id" "uuid" NOT NULL,
    "segment_index" integer NOT NULL,
    "speaker" "text" NOT NULL,
    "transcript" "text" NOT NULL,
    "started_at" timestamp with time zone,
    "ended_at" timestamp with time zone,
    "metadata" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."call_segments" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."call_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "org_id" "uuid",
    "from_number" "text",
    "to_number" "text",
    "provider" "text",
    "provider_call_id" "text",
    "direction" "text" DEFAULT 'outbound'::"text" NOT NULL,
    "started_at" timestamp with time zone NOT NULL,
    "ended_at" timestamp with time zone,
    "consent_given" boolean DEFAULT false NOT NULL,
    "label" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_call_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."call_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."call_summaries" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "call_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "high_level_summary" "text",
    "decisions" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "followups" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "entities" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "raw" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_call_summaries" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."call_summaries" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."calls" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text",
    "contact_id" "uuid",
    "direction" "text" NOT NULL,
    "from_number" "text",
    "to_number" "text",
    "duration_sec" integer,
    "recording_url" "text",
    "transcript" "text",
    "summary_short" "text",
    "summary_detailed" "text",
    "sentiment" "text",
    "action_items" "jsonb",
    "tags" "text"[],
    "twilio_call_sid" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "deal_id" "uuid",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_calls" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."calls" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."campaign_enrollments" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "campaign_id" "uuid",
    "user_id" "text" NOT NULL,
    "relationship_id" "uuid",
    "contact_email" "text",
    "contact_name" "text",
    "current_step_index" integer DEFAULT 0,
    "status" "text" DEFAULT 'active'::"text",
    "next_step_at" timestamp with time zone,
    "completed_steps" "text"[] DEFAULT '{}'::"text"[],
    "started_at" timestamp with time zone NOT NULL,
    "completed_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "campaign_enrollments_status_check" CHECK (("status" = ANY (ARRAY['active'::"text", 'completed'::"text", 'paused'::"text", 'exited'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_campaign_enrollments" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."campaign_enrollments" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."campaigns" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "type" "text" NOT NULL,
    "status" "text" DEFAULT 'draft'::"text",
    "target_criteria" "jsonb",
    "steps" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "enrolled_count" integer DEFAULT 0,
    "completed_count" integer DEFAULT 0,
    "started_at" timestamp with time zone,
    "completed_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "campaigns_status_check" CHECK (("status" = ANY (ARRAY['draft'::"text", 'active'::"text", 'paused'::"text", 'completed'::"text"]))),
    CONSTRAINT "campaigns_type_check" CHECK (("type" = ANY (ARRAY['nurture'::"text", 'followup'::"text", 'outreach'::"text", 'reactivation'::"text", 'custom'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_campaigns" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."campaigns" OWNER TO "postgres";


CREATE OR REPLACE VIEW "public"."canon_dashboard" AS
 WITH "tables" AS (
         SELECT "c_1"."table_schema",
            "c_1"."table_name"
           FROM "information_schema"."tables" "c_1"
          WHERE ((("c_1"."table_schema")::"name" = 'public'::"name") AND (("c_1"."table_type")::"text" = 'BASE TABLE'::"text"))
        ), "cols" AS (
         SELECT "columns"."table_name",
            "bool_or"((("columns"."column_name")::"name" = 'user_id'::"name")) AS "has_user_id_text",
            "bool_or"((("columns"."column_name")::"name" = 'user_id_uuid'::"name")) AS "has_user_id_uuid"
           FROM "information_schema"."columns"
          WHERE (("columns"."table_schema")::"name" = 'public'::"name")
          GROUP BY "columns"."table_name"
        ), "types" AS (
         SELECT "columns"."table_name",
            "max"((
                CASE
                    WHEN (("columns"."column_name")::"name" = 'user_id'::"name") THEN ("columns"."data_type")::character varying
                    ELSE NULL::character varying
                END)::"text") AS "user_id_type",
            "max"((
                CASE
                    WHEN (("columns"."column_name")::"name" = 'user_id_uuid'::"name") THEN ("columns"."data_type")::character varying
                    ELSE NULL::character varying
                END)::"text") AS "user_id_uuid_type"
           FROM "information_schema"."columns"
          WHERE (("columns"."table_schema")::"name" = 'public'::"name")
          GROUP BY "columns"."table_name"
        ), "rls" AS (
         SELECT "pg_policies"."tablename" AS "table_name",
            "bool_or"(("pg_policies"."policyname" = 'pulse_user_owns_row'::"name")) AS "has_canonical_policy"
           FROM "pg_policies"
          WHERE ("pg_policies"."schemaname" = 'public'::"name")
          GROUP BY "pg_policies"."tablename"
        )
 SELECT "t"."table_name",
    "c"."has_user_id_text",
    "c"."has_user_id_uuid",
    "ty"."user_id_type",
    "ty"."user_id_uuid_type",
    COALESCE("r"."has_canonical_policy", false) AS "has_pulse_user_owns_row",
        CASE
            WHEN ("c"."has_user_id_uuid" AND ("ty"."user_id_uuid_type" = 'uuid'::"text") AND COALESCE("r"."has_canonical_policy", false)) THEN 'green'::"text"
            WHEN ("c"."has_user_id_text" AND (NOT "c"."has_user_id_uuid")) THEN 'needs_uuid_migration'::"text"
            WHEN ("c"."has_user_id_uuid" AND (NOT COALESCE("r"."has_canonical_policy", false))) THEN 'policy_missing'::"text"
            WHEN ("c"."has_user_id_text" AND "c"."has_user_id_uuid") THEN 'dual_identity'::"text"
            ELSE 'non_user_table'::"text"
        END AS "status",
        CASE
            WHEN ("c"."has_user_id_text" AND (NOT "c"."has_user_id_uuid")) THEN 100
            WHEN ("c"."has_user_id_text" AND "c"."has_user_id_uuid") THEN 80
            WHEN ("c"."has_user_id_uuid" AND (NOT COALESCE("r"."has_canonical_policy", false))) THEN 60
            ELSE 0
        END AS "migration_priority"
   FROM ((("tables" "t"
     LEFT JOIN "cols" "c" ON ((("c"."table_name")::"name" = ("t"."table_name")::"name")))
     LEFT JOIN "types" "ty" ON ((("ty"."table_name")::"name" = ("t"."table_name")::"name")))
     LEFT JOIN "rls" "r" ON (("r"."table_name" = ("t"."table_name")::"name")))
  ORDER BY
        CASE
            WHEN ("c"."has_user_id_text" AND (NOT "c"."has_user_id_uuid")) THEN 100
            WHEN ("c"."has_user_id_text" AND "c"."has_user_id_uuid") THEN 80
            WHEN ("c"."has_user_id_uuid" AND (NOT COALESCE("r"."has_canonical_policy", false))) THEN 60
            ELSE 0
        END DESC, "t"."table_name";


ALTER VIEW "public"."canon_dashboard" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."canon_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "event_type" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "emotional_tone" "jsonb",
    "consequences" "jsonb",
    "importance" numeric NOT NULL,
    "attached_chapter" "uuid",
    "source" "text",
    "source_id" "uuid",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_canon_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."canon_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."identity_users" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "clerk_user_id" "text" NOT NULL,
    "email" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "identity_kind" "text" DEFAULT 'human'::"text" NOT NULL,
    "is_archived" boolean DEFAULT false NOT NULL,
    "archived_at" timestamp with time zone,
    CONSTRAINT "identity_users_id_not_zero" CHECK (("id" <> '00000000-0000-0000-0000-000000000000'::"uuid")),
    CONSTRAINT "identity_users_identity_kind_chk" CHECK (("identity_kind" = ANY (ARRAY['human'::"text", 'system'::"text", 'orphan'::"text"])))
);


ALTER TABLE "public"."identity_users" OWNER TO "postgres";


COMMENT ON TABLE "public"."identity_users" IS 'Canonical identity registry. Maps Clerk user_id (text) to canonical UUID used everywhere as user_id_uuid.';



CREATE OR REPLACE VIEW "public"."canon_health_summary" AS
 SELECT ( SELECT "count"(*) AS "count"
           FROM "public"."identity_users") AS "identity_users_total",
    ( SELECT "count"(*) AS "count"
           FROM "public"."identity_users"
          WHERE (("identity_users"."identity_kind" = 'human'::"text") AND ("identity_users"."is_archived" = false))) AS "identities_human_active",
    ( SELECT "count"(*) AS "count"
           FROM "public"."identity_users"
          WHERE ("identity_users"."identity_kind" = 'system'::"text")) AS "identities_system",
    ( SELECT "count"(*) AS "count"
           FROM "public"."identity_users"
          WHERE (("identity_users"."identity_kind" = 'orphan'::"text") AND ("identity_users"."is_archived" = false))) AS "identities_orphan_active",
    ( SELECT "count"(*) AS "count"
           FROM "public"."identity_users"
          WHERE (("identity_users"."identity_kind" = 'orphan'::"text") AND ("identity_users"."is_archived" = true))) AS "identities_orphan_archived",
    ( SELECT "count"(*) AS "count"
           FROM "public"."_pulse_quarantine_rows") AS "quarantine_rows_total";


ALTER VIEW "public"."canon_health_summary" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."canon_migration_allowlist" (
    "table_schema" "text" DEFAULT 'public'::"text" NOT NULL,
    "table_name" "text" NOT NULL
);


ALTER TABLE "public"."canon_migration_allowlist" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."canon_mode" (
    "id" boolean DEFAULT true NOT NULL,
    "mode" "text" NOT NULL,
    "activated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    CONSTRAINT "canon_mode_mode_check" CHECK (("mode" = ANY (ARRAY['v1'::"text", 'v1_text'::"text", 'v2_uuid_safe'::"text", 'v2_uuid_hard'::"text"])))
);


ALTER TABLE "public"."canon_mode" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."canon_timeline_index" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "chapter_id" "uuid",
    "event_id" "uuid",
    "timeline_position" numeric NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_canon_timeline_index" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."canon_timeline_index" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."canonical_schema_rules" (
    "id" bigint NOT NULL,
    "domain" "text" NOT NULL,
    "table_schema" "text" DEFAULT 'public'::"text" NOT NULL,
    "table_name" "text" NOT NULL,
    "column_name" "text" NOT NULL,
    "data_type" "text" NOT NULL,
    "is_nullable" boolean NOT NULL,
    "column_default" "text",
    "notes" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."canonical_schema_rules" OWNER TO "postgres";


CREATE SEQUENCE IF NOT EXISTS "public"."canonical_schema_rules_id_seq"
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE "public"."canonical_schema_rules_id_seq" OWNER TO "postgres";


ALTER SEQUENCE "public"."canonical_schema_rules_id_seq" OWNED BY "public"."canonical_schema_rules"."id";



CREATE TABLE IF NOT EXISTS "public"."chapter_archetypes" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "chapter_id" "uuid" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "archetype_mix" "jsonb",
    "primary_archetype_id" "text",
    "notes" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_chapter_archetypes" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."chapter_archetypes" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."civilization_domain_mappings" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "domain_id" "uuid" NOT NULL,
    "node_id" "uuid" NOT NULL,
    "weight" numeric(4,2) DEFAULT 1.0,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_civilization_domain_mappings" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."civilization_domain_mappings" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."civilization_domain_state" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "domain_id" "uuid" NOT NULL,
    "snapshot_date" "date" NOT NULL,
    "activity_score" numeric(5,2),
    "tension_score" numeric(5,2),
    "health_score" numeric(5,2),
    "summary" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."civilization_domain_state" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."civilization_domains" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "is_active" boolean DEFAULT true NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_civilization_domains" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."civilization_domains" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."civilization_patterns" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "domain" "text" NOT NULL,
    "key" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description_md" "text" NOT NULL,
    "pattern" "jsonb" NOT NULL,
    "stats" "jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."civilization_patterns" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."civilization_settings" (
    "user_id" "text" NOT NULL,
    "scoreboards_enabled" boolean DEFAULT false NOT NULL,
    "allow_anonymous_global" boolean DEFAULT false NOT NULL,
    "allow_handle_global" boolean DEFAULT false NOT NULL,
    "public_handle" "text",
    "vertical_prefs" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_civilization_settings" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."civilization_settings" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."coach_council_deliberations" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "session_id" "uuid" NOT NULL,
    "coach_id" "text" NOT NULL,
    "phase" "text" NOT NULL,
    "content" "jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."coach_council_deliberations" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."coach_council_members" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "session_id" "uuid" NOT NULL,
    "coach_id" "text" NOT NULL,
    "persona_id" "uuid",
    "role" "text",
    "weight" numeric(4,2) DEFAULT 1.0,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."coach_council_members" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."coach_council_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text",
    "request_id" "text",
    "primary_coach_id" "text" NOT NULL,
    "council_mode" "text" NOT NULL,
    "trigger_reason" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_coach_council_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."coach_council_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."coach_council_summary" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "session_id" "uuid" NOT NULL,
    "final_answer" "text" NOT NULL,
    "summary_json" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."coach_council_summary" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."coach_generated_scenarios" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "input_prompt" "text" NOT NULL,
    "generated_scenario" "jsonb" NOT NULL,
    "difficulty_rating" "text",
    "quality_score" numeric(5,2),
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_coach_generated_scenarios" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."coach_generated_scenarios" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."coach_multi_agent_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "scenario_id" "uuid",
    "agents" "text"[] DEFAULT '{}'::"text"[] NOT NULL,
    "transcript" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "agent_contributions" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_coach_multi_agent_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."coach_multi_agent_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."coach_roleplay_scenarios" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "coach_id" "text" NOT NULL,
    "scenario_type" "text" NOT NULL,
    "name" "text" NOT NULL,
    "config" "jsonb" NOT NULL,
    "is_default" boolean DEFAULT false,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."coach_roleplay_scenarios" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."coach_scenarios" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "coach_type" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "difficulty" "text" DEFAULT 'beginner'::"text" NOT NULL,
    "topic_tags" "text"[] DEFAULT '{}'::"text"[],
    "customer_profile" "jsonb",
    "constraints" "jsonb",
    "initial_prompt" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."coach_scenarios" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."coach_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text",
    "coach" "text" NOT NULL,
    "summary" "text",
    "insights" "jsonb",
    "goals_discussed" "text"[],
    "action_items" "text"[],
    "mood" "text",
    "breakthrough" boolean DEFAULT false,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_coach_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."coach_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."coach_training_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "coach_id" "text" NOT NULL,
    "scenario_type" "text" NOT NULL,
    "skill_nodes" "text"[] DEFAULT '{}'::"text"[],
    "success_rating" integer,
    "llm_difficulty" "text",
    "transcript" "jsonb",
    "key_takeaways" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "difficulty" "text" DEFAULT 'beginner'::"text",
    "performance_score" numeric(5,2),
    "feedback_summary" "jsonb",
    "xp_awarded" "jsonb",
    "belt_progression" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_coach_training_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."coach_training_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."coach_user_preferences" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "coach_type" "text" NOT NULL,
    "tone" "text" DEFAULT 'supportive'::"text" NOT NULL,
    "difficulty_pref" "text" DEFAULT 'auto'::"text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_coach_user_preferences" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."coach_user_preferences" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."coach_voice_overrides" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "coach_id" "text" NOT NULL,
    "voice_profile_id" "uuid" NOT NULL,
    "emotion_overrides" "jsonb" DEFAULT '{}'::"jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."coach_voice_overrides" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."coach_voice_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "transcript" "text",
    "audio_url" "text",
    "coaching_summary" "jsonb",
    "sentiment_curve" "jsonb",
    "patterns_detected" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_coach_voice_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."coach_voice_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."cognitive_hypotheses" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "label" "text" NOT NULL,
    "description" "text" NOT NULL,
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "evidence_for" "jsonb",
    "evidence_against" "jsonb",
    "confidence" numeric DEFAULT 0.5 NOT NULL,
    "last_evaluated_at" timestamp with time zone,
    "tags" "text"[],
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_cognitive_hypotheses" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."cognitive_hypotheses" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."cognitive_insights" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "run_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "source_phase" "text" NOT NULL,
    "category" "text" NOT NULL,
    "label" "text" NOT NULL,
    "description" "text" NOT NULL,
    "importance" numeric NOT NULL,
    "confidence" numeric NOT NULL,
    "scope" "text",
    "related_entities" "jsonb",
    "recommended_actions" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_cognitive_insights" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."cognitive_insights" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."cognitive_phases" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "run_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "phase_name" "text" NOT NULL,
    "started_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "finished_at" timestamp with time zone,
    "status" "text" DEFAULT 'running'::"text" NOT NULL,
    "details" "jsonb",
    "error_summary" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_cognitive_phases" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."cognitive_phases" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."cognitive_runs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "started_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "finished_at" timestamp with time zone,
    "kind" "text" NOT NULL,
    "trigger_type" "text" NOT NULL,
    "trigger_source" "text",
    "trigger_reference" "jsonb",
    "status" "text" DEFAULT 'running'::"text" NOT NULL,
    "summary" "text",
    "overall_confidence" numeric,
    "safety_flags" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_cognitive_runs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."cognitive_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."cognitive_self_reflections" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "run_id" "uuid",
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "perspective" "text" NOT NULL,
    "content" "text" NOT NULL,
    "referenced_subsystems" "text"[],
    "referenced_issues" "jsonb",
    "followup_hints" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_cognitive_self_reflections" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."cognitive_self_reflections" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."cognitive_update_actions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "run_id" "uuid",
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "target_system" "text" NOT NULL,
    "action_kind" "text" NOT NULL,
    "payload" "jsonb" NOT NULL,
    "autonomy_level" "text" NOT NULL,
    "importance" numeric NOT NULL,
    "confidence" numeric NOT NULL,
    "safety_risk" numeric NOT NULL,
    "status" "text" DEFAULT 'pending'::"text" NOT NULL,
    "status_details" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_cognitive_update_actions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."cognitive_update_actions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."communication_programs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "config" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."communication_programs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."communication_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "program_key" "text" NOT NULL,
    "mode" "text" NOT NULL,
    "context" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "score" numeric,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "completed_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_communication_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."communication_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."communication_turns" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "session_id" "uuid" NOT NULL,
    "turn_index" integer NOT NULL,
    "speaker" "text" NOT NULL,
    "content" "text" NOT NULL,
    "metadata" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."communication_turns" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."conscious_conflicts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "frame_id" "uuid",
    "item_a_id" "uuid",
    "item_b_id" "uuid",
    "conflict_kind" "text" NOT NULL,
    "severity" numeric NOT NULL,
    "description" "text" NOT NULL,
    "suggested_resolutions" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_conscious_conflicts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."conscious_conflicts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."conscious_frames" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "frame_time" timestamp with time zone DEFAULT "now"() NOT NULL,
    "trigger_kind" "text",
    "trigger_source" "text",
    "trigger_reference" "jsonb",
    "summary" "text",
    "dominant_context" "jsonb",
    "overall_urgency" numeric,
    "overall_complexity" numeric,
    "overall_load" numeric,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_conscious_frames" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."conscious_frames" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."conscious_insights" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "generated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "state_date" "date",
    "source" "text" NOT NULL,
    "importance" numeric DEFAULT 0.5 NOT NULL,
    "urgency" numeric DEFAULT 0.5 NOT NULL,
    "domain" "text",
    "title" "text" NOT NULL,
    "summary" "text" NOT NULL,
    "suggested_action" "text",
    "linked_thread_ids" "uuid"[],
    "linked_event_ids" "uuid"[],
    "delivered_at" timestamp with time zone,
    "dismissed_at" timestamp with time zone,
    "user_feedback" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_conscious_insights" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."conscious_insights" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."conscious_items" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "frame_id" "uuid" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "source_subsystem" "text" NOT NULL,
    "kind" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "payload" "jsonb",
    "domain" "text",
    "tags" "text"[],
    "attention_score" numeric NOT NULL,
    "urgency" numeric NOT NULL,
    "importance" numeric NOT NULL,
    "emotional_salience" numeric NOT NULL,
    "selected" boolean DEFAULT false NOT NULL,
    "resolution_status" "text" DEFAULT 'open'::"text" NOT NULL,
    "resolution_notes" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_conscious_items" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."conscious_items" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."conscious_links" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "from_item_id" "uuid" NOT NULL,
    "to_item_id" "uuid" NOT NULL,
    "link_type" "text" NOT NULL,
    "weight" numeric DEFAULT 0.5 NOT NULL,
    "notes" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_conscious_links" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."conscious_links" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."contact_dates" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "contact_id" "uuid" NOT NULL,
    "type" "text" NOT NULL,
    "date" "date" NOT NULL,
    "recurrence" "text",
    "notes" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_contact_dates" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."contact_dates" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."contact_emails" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "contact_id" "uuid" NOT NULL,
    "email" "text" NOT NULL,
    "label" "text",
    "is_primary" boolean DEFAULT false NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "provider" "text" DEFAULT 'unknown'::"text" NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "contact_emails_provider_check" CHECK (("provider" = ANY (ARRAY['gmail'::"text", 'outlook'::"text", 'imap'::"text", 'exchange'::"text", 'other'::"text", 'unknown'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_contact_emails" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."contact_emails" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."contact_facts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "contact_id" "uuid" NOT NULL,
    "key" "text" NOT NULL,
    "value_text" "text",
    "value_json" "jsonb",
    "value_date" "date",
    "confidence" numeric DEFAULT 1.0 NOT NULL,
    "source" "text" DEFAULT 'manual'::"text" NOT NULL,
    "source_ref" "text",
    "last_confirmed_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_contact_facts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."contact_facts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."contact_identity_intel" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "contact_id" "uuid" NOT NULL,
    "raw_public_data" "jsonb",
    "raw_news" "jsonb",
    "raw_social_profiles" "jsonb",
    "raw_company_info" "jsonb",
    "inferred_personality" "jsonb",
    "inferred_values" "jsonb",
    "inferred_goals" "jsonb",
    "inferred_fears" "jsonb",
    "inferred_drivers" "jsonb",
    "inferred_conflict_style" "text",
    "inferred_persuasion_style" "jsonb",
    "inferred_communication_style" "jsonb",
    "inferred_professional_background" "jsonb",
    "summarised_identity" "text",
    "last_refreshed" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_contact_identity_intel" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."contact_identity_intel" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."contact_influence_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "contact_id" "uuid" NOT NULL,
    "context" "jsonb",
    "suggested_channel" "text",
    "suggested_message" "text",
    "suggested_summary" "text",
    "suggestion_type" "text",
    "model_metadata" "jsonb",
    "user_action" "text",
    "user_feedback" "text",
    "actual_outcome" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_contact_influence_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."contact_influence_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."contact_intelligence_sources" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "contact_id" "uuid" NOT NULL,
    "source" "text" NOT NULL,
    "url" "text",
    "data" "jsonb",
    "fetched_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_contact_intelligence_sources" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."contact_intelligence_sources" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."contact_phones" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "contact_id" "uuid" NOT NULL,
    "phone" "text" NOT NULL,
    "label" "text",
    "is_primary" boolean DEFAULT false NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_contact_phones" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."contact_phones" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."contact_playbooks" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "contact_id" "uuid" NOT NULL,
    "playbook" "jsonb" NOT NULL,
    "generated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_contact_playbooks" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."contact_playbooks" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."contact_relationship_scores" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "contact_id" "uuid" NOT NULL,
    "familiarity_score" numeric,
    "trust_score" numeric,
    "warmth_score" numeric,
    "influence_score" numeric,
    "power_balance_score" numeric,
    "last_updated" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_contact_relationship_scores" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."contact_relationship_scores" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."contact_relationships" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "from_contact_id" "uuid" NOT NULL,
    "to_contact_id" "uuid" NOT NULL,
    "relation" "text" NOT NULL,
    "notes" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_contact_relationships" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."contact_relationships" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."contact_tag_links" (
    "user_id" "text" NOT NULL,
    "contact_id" "uuid" NOT NULL,
    "tag_id" "uuid" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_contact_tag_links" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."contact_tag_links" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."contact_tags" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "name" "text" NOT NULL,
    "category" "text",
    "color" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_contact_tags" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."contact_tags" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."contacts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "name" "text" NOT NULL,
    "email" "text",
    "phone" "text",
    "company" "text",
    "title" "text",
    "industry" "text",
    "linkedin" "text",
    "website" "text",
    "birthday" "date",
    "address" "text",
    "city" "text",
    "state" "text",
    "zip" "text",
    "interests" "text",
    "relationship" "text",
    "status" "text" DEFAULT 'New'::"text",
    "how_we_met" "text",
    "introduced_by" "text",
    "notes" "text",
    "tags" "text"[],
    "last_contact" timestamp with time zone,
    "next_followup" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "ai_intel" "jsonb",
    "intel_updated_at" timestamp with time zone,
    "last_interaction_type" "text",
    "primary_channel" "text",
    "vip_level" "text",
    "notes_short" "text",
    "owner_user_id" "text",
    "first_name" "text",
    "last_name" "text",
    "full_name" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_contacts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."contacts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."cortex_anomalies" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "area_key" "text" NOT NULL,
    "window_date" "date" NOT NULL,
    "scope" "text" NOT NULL,
    "scope_ref" "text",
    "severity" numeric,
    "summary" "text" NOT NULL,
    "expected" "jsonb",
    "observed" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_cortex_anomalies" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."cortex_anomalies" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."cortex_areas" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "is_active" boolean DEFAULT true NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_cortex_areas" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."cortex_areas" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."cortex_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "area_key" "text" NOT NULL,
    "source" "text" NOT NULL,
    "event_type" "text" NOT NULL,
    "event_time" timestamp with time zone NOT NULL,
    "context_id" "text",
    "context_type" "text",
    "payload" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_cortex_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."cortex_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."cortex_patterns" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "area_key" "text" NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "pattern_type" "text" NOT NULL,
    "signal_keys" "text"[] NOT NULL,
    "stats" "jsonb",
    "examples" "jsonb",
    "strength" numeric,
    "last_observed_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_cortex_patterns" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."cortex_patterns" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."cortex_predictions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "area_key" "text" NOT NULL,
    "kind" "text" NOT NULL,
    "target_scope" "text" NOT NULL,
    "target_ref" "text",
    "horizon" "text",
    "summary" "text" NOT NULL,
    "details" "jsonb",
    "confidence" numeric,
    "pattern_ids" "uuid"[],
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "valid_until" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_cortex_predictions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."cortex_predictions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."cortex_signals" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "area_key" "text" NOT NULL,
    "window_date" "date" NOT NULL,
    "scope" "text" NOT NULL,
    "scope_ref" "text",
    "key" "text" NOT NULL,
    "value_numeric" double precision,
    "value_json" "jsonb",
    "sample_count" integer,
    "meta" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_cortex_signals" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."cortex_signals" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."council_consensus" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "session_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "consensus_recommendation" "text" NOT NULL,
    "summary" "jsonb",
    "voting_breakdown" "jsonb",
    "overall_confidence" numeric NOT NULL,
    "risk_profile" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_council_consensus" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."council_consensus" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."council_decision_dossiers" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "session_id" "uuid",
    "decision_label" "text" NOT NULL,
    "question" "text" NOT NULL,
    "context" "jsonb",
    "consensus_id" "uuid",
    "user_choice" "text",
    "user_notes" "text",
    "outcome" "jsonb",
    "learnings" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_council_decision_dossiers" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."council_decision_dossiers" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."council_members" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "role_id" "text" NOT NULL,
    "display_name" "text" NOT NULL,
    "description" "text" NOT NULL,
    "enabled" boolean DEFAULT true NOT NULL,
    "weight" numeric DEFAULT 1.0 NOT NULL,
    "config" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_council_members" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."council_members" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."council_opinions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "session_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "member_role_id" "text" NOT NULL,
    "stance" "text" NOT NULL,
    "recommendation" "text" NOT NULL,
    "rationale" "jsonb",
    "confidence" numeric NOT NULL,
    "suggested_conditions" "jsonb",
    "raw_payload" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_council_opinions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."council_opinions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."council_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "completed_at" timestamp with time zone,
    "status" "text" DEFAULT 'in_progress'::"text" NOT NULL,
    "topic" "text" NOT NULL,
    "question" "text" NOT NULL,
    "context" "jsonb",
    "trigger_source" "text",
    "timescale" "text",
    "importance" numeric DEFAULT 0.5 NOT NULL,
    "snapshot_id" "uuid",
    "equilibrium_id" "uuid",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_council_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."council_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."creative_artifacts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "idea_id" "uuid",
    "session_id" "uuid",
    "kind" "text" NOT NULL,
    "title" "text" NOT NULL,
    "content" "jsonb",
    "linked_workspace_thread_id" "uuid",
    "linked_project_id" "uuid",
    "quality_score" numeric,
    "usage_metrics" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_creative_artifacts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."creative_artifacts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."creative_assets" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "project_id" "uuid",
    "session_id" "uuid",
    "kind" "text" NOT NULL,
    "title" "text",
    "content" "text",
    "metadata" "jsonb",
    "related_node_id" "uuid",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_creative_assets" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."creative_assets" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."creative_evaluations" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "idea_id" "uuid",
    "artifact_id" "uuid",
    "evaluator" "text" NOT NULL,
    "scores" "jsonb",
    "comments" "text",
    "decision" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_creative_evaluations" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."creative_evaluations" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."creative_ideas" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "session_id" "uuid" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "title" "text" NOT NULL,
    "description" "text" NOT NULL,
    "category" "text",
    "tags" "text"[],
    "raw_payload" "jsonb",
    "score_overall" numeric,
    "score_alignment" numeric,
    "score_impact" numeric,
    "score_feasibility" numeric,
    "score_energy_fit" numeric,
    "status" "text" DEFAULT 'proposed'::"text" NOT NULL,
    "status_reason" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_creative_ideas" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."creative_ideas" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."creative_patterns" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "pattern_key" "text" NOT NULL,
    "description" "text",
    "characteristics" "jsonb",
    "anti_patterns" "jsonb",
    "recommendations" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_creative_patterns" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."creative_patterns" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."creative_projects" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "kind" "text" NOT NULL,
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "related_node_id" "uuid",
    "tags" "text"[] DEFAULT '{}'::"text"[],
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_creative_projects" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."creative_projects" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."creative_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "topic" "text" NOT NULL,
    "context" "jsonb",
    "goal" "text",
    "domain" "text",
    "mode" "text",
    "status" "text" DEFAULT 'open'::"text" NOT NULL,
    "meta" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_creative_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."creative_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."creative_style_profiles" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "tone" "text",
    "constraints" "jsonb",
    "examples" "jsonb",
    "is_default" boolean DEFAULT false NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_creative_style_profiles" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."creative_style_profiles" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."crm_alerts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "type" "text" NOT NULL,
    "contact_id" "uuid",
    "deal_id" "uuid",
    "title" "text" NOT NULL,
    "body" "text" NOT NULL,
    "severity" integer DEFAULT 1,
    "is_positive" boolean DEFAULT false,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "seen_at" timestamp with time zone,
    "dismissed_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_crm_alerts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."crm_alerts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."crm_contact_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "contact_id" "uuid" NOT NULL,
    "owner_user_id" "text" NOT NULL,
    "type" "text" NOT NULL,
    "title" "text",
    "body" "text",
    "occurred_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "metadata" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."crm_contact_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."crm_contact_facts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "contact_id" "uuid" NOT NULL,
    "owner_user_id" "text" NOT NULL,
    "key" "text" NOT NULL,
    "value" "text" NOT NULL,
    "source" "text" DEFAULT 'manual'::"text",
    "source_url" "text",
    "confidence" integer DEFAULT 80,
    "evidence" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "pinned" boolean DEFAULT false NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."crm_contact_facts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."crm_contact_intel" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "contact_id" "uuid" NOT NULL,
    "owner_user_id" "text" NOT NULL,
    "relationship_score" integer DEFAULT 50 NOT NULL,
    "relationship_trend_30d" integer DEFAULT 0 NOT NULL,
    "drivers" "text"[] DEFAULT '{}'::"text"[] NOT NULL,
    "risk_flags" "text"[] DEFAULT '{}'::"text"[] NOT NULL,
    "next_touch_due_at" timestamp with time zone,
    "last_touch_at" timestamp with time zone,
    "last_touch_type" "text",
    "overdue_tasks_count" integer DEFAULT 0 NOT NULL,
    "unanswered_inbound_count" integer DEFAULT 0 NOT NULL,
    "touch_frequency_30d" integer DEFAULT 0 NOT NULL,
    "ai_summary" "text",
    "source" "text" DEFAULT 'internal'::"text",
    "source_url" "text",
    "confidence" integer DEFAULT 50,
    "evidence" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "expires_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "brief_md" "text" DEFAULT ''::"text" NOT NULL,
    "personality" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "relationship" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "next_actions" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "version" integer DEFAULT 1 NOT NULL
);


ALTER TABLE "public"."crm_contact_intel" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."crm_contact_intel_sources" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "contact_id" "uuid" NOT NULL,
    "source_url" "text",
    "source_domain" "text",
    "source_type" "text" NOT NULL,
    "title" "text",
    "snippet" "text",
    "published_at" timestamp with time zone,
    "query" "text",
    "brave_rank" integer,
    "match_score" integer DEFAULT 0 NOT NULL,
    "match_evidence" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "seen_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "captured_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "content" "text"
);


ALTER TABLE "public"."crm_contact_intel_sources" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."crm_contact_org_links" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "contact_id" "uuid" NOT NULL,
    "organization_id" "uuid" NOT NULL,
    "role" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_crm_contact_org_links" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."crm_contact_org_links" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."crm_contact_photo_candidates" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "contact_id" "uuid" NOT NULL,
    "image_url" "text" NOT NULL,
    "source_url" "text" NOT NULL,
    "source_domain" "text",
    "caption" "text",
    "confidence" integer DEFAULT 0 NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."crm_contact_photo_candidates" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."crm_contacts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "full_name" "text" NOT NULL,
    "first_name" "text",
    "last_name" "text",
    "nickname" "text",
    "primary_email" "text",
    "primary_phone" "text",
    "company_name" "text",
    "title" "text",
    "type" "text",
    "tags" "text"[] DEFAULT '{}'::"text"[],
    "timezone" "text",
    "relationship_importance" integer DEFAULT 1,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "tb_node_id" "uuid",
    "intel_summary" "text",
    "display_name" "text",
    "job_title" "text",
    "status" "text" DEFAULT 'active'::"text",
    "merged_into_contact_id" "uuid",
    "normalized_email" "text",
    "normalized_phone" "text",
    "normalized_full_name" "text",
    "photo_url" "text",
    "photo_source_url" "text",
    "photo_confidence" integer,
    "photo_updated_at" timestamp with time zone,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_crm_contacts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."crm_contacts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."crm_deal_contacts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "deal_id" "uuid" NOT NULL,
    "contact_id" "uuid" NOT NULL,
    "role" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_crm_deal_contacts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."crm_deal_contacts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."crm_deal_health" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "deal_id" "uuid" NOT NULL,
    "score" integer NOT NULL,
    "risk_level" integer NOT NULL,
    "last_interaction_at" timestamp with time zone,
    "days_stalled" integer,
    "notes" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_crm_deal_health" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."crm_deal_health" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."crm_deals" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "name" "text" NOT NULL,
    "stage" "text" NOT NULL,
    "amount" numeric(14,2),
    "currency" "text" DEFAULT 'USD'::"text",
    "close_date" "date",
    "probability" integer DEFAULT 0,
    "source" "text",
    "tags" "text"[] DEFAULT '{}'::"text"[],
    "primary_contact_id" "uuid",
    "organization_id" "uuid",
    "pipeline" "text" DEFAULT 'default'::"text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "tb_node_id" "uuid",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_crm_deals" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."crm_deals" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."crm_interactions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "contact_id" "uuid",
    "deal_id" "uuid",
    "type" "text" NOT NULL,
    "channel" "text",
    "occurred_at" timestamp with time zone NOT NULL,
    "subject" "text",
    "summary" "text",
    "sentiment" "text",
    "importance" integer DEFAULT 1,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_crm_interactions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."crm_interactions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."crm_organizations" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "name" "text" NOT NULL,
    "industry" "text",
    "website" "text",
    "size" "text",
    "tags" "text"[] DEFAULT '{}'::"text"[],
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "tb_node_id" "uuid",
    "intel_summary" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_crm_organizations" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."crm_organizations" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."crm_relationship_health" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "contact_id" "uuid" NOT NULL,
    "score" integer NOT NULL,
    "last_interaction_at" timestamp with time zone,
    "next_suggested_checkin_at" timestamp with time zone,
    "momentum" "text",
    "notes" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_crm_relationship_health" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."crm_relationship_health" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."crm_tasks" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "owner_user_id" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "status" "text" DEFAULT 'open'::"text" NOT NULL,
    "priority" integer DEFAULT 2 NOT NULL,
    "due_at" timestamp with time zone,
    "org_id" "uuid",
    "contact_id" "uuid",
    "deal_id" "uuid",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "source_table" "text",
    "source_id" "text"
);


ALTER TABLE "public"."crm_tasks" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."cron_locks" (
    "key" "text" NOT NULL,
    "locked_until" timestamp with time zone NOT NULL,
    "holder" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."cron_locks" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."cultural_domains" (
    "id" "text" NOT NULL,
    "display_name" "text" NOT NULL,
    "description" "text" NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."cultural_domains" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."cultural_highlights" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "domain" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text" NOT NULL,
    "importance" numeric DEFAULT 0.5 NOT NULL,
    "suggestion" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_cultural_highlights" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."cultural_highlights" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."cultural_inference_snapshots" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "domain" "text" NOT NULL,
    "snapshot_time" timestamp with time zone DEFAULT "now"() NOT NULL,
    "inferred_profile" "jsonb",
    "confidence" numeric NOT NULL,
    "evidence" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_cultural_inference_snapshots" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."cultural_inference_snapshots" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."cultural_predictions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "domain" "text" NOT NULL,
    "context" "jsonb",
    "predicted_response" "jsonb",
    "recommended_strategy" "jsonb",
    "confidence" numeric,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_cultural_predictions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."cultural_predictions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."cultural_profiles" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "domain" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "norms" "jsonb",
    "risk_tolerance" "jsonb",
    "communication_style" "jsonb",
    "approval_dynamics" "jsonb",
    "decision_patterns" "jsonb",
    "cultural_rules" "jsonb",
    "cultural_red_flags" "jsonb",
    "cultural_opportunities" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_cultural_profiles" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."cultural_profiles" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."cultural_signals" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "domain" "text" NOT NULL,
    "source" "text" NOT NULL,
    "content" "jsonb",
    "weight" numeric DEFAULT 0.5 NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_cultural_signals" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."cultural_signals" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."culture_alignment_log" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "context_id" "uuid" NOT NULL,
    "evaluated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "alignment_overall" numeric NOT NULL,
    "strengths" "jsonb",
    "friction_points" "jsonb",
    "risk_areas" "jsonb",
    "suggestions" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_culture_alignment_log" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."culture_alignment_log" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."culture_contexts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "kind" "text" NOT NULL,
    "description" "text",
    "priority" numeric DEFAULT 0.5 NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_culture_contexts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."culture_contexts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."culture_norm_logs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "context_id" "uuid" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "source" "text",
    "summary" "text",
    "tags" "text"[],
    "weight" numeric DEFAULT 0.5 NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_culture_norm_logs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."culture_norm_logs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."culture_profiles" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "context_id" "uuid" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "norms" "jsonb",
    "communication_style" "jsonb",
    "success_markers" "jsonb",
    "taboo_behaviors" "jsonb",
    "political_sensitivities" "jsonb",
    "language_patterns" "jsonb",
    "decision_making_style" "jsonb",
    "hidden_rules" "jsonb",
    "summary" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_culture_profiles" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."culture_profiles" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."daily_briefs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    "day" "date" NOT NULL,
    "title" "text" DEFAULT 'Daily Brief'::"text" NOT NULL,
    "content" "text" DEFAULT ''::"text" NOT NULL,
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."daily_briefs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."daily_quest_generation_runs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "quest_date" "date" NOT NULL,
    "algo_version" "text" DEFAULT 'v1'::"text" NOT NULL,
    "signals" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "selections" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_daily_quest_generation_runs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."daily_quest_generation_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."daily_timeline_views" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "date" "date" NOT NULL,
    "timeline_id" "uuid",
    "branch_run_id" "uuid",
    "mode" "text" DEFAULT 'day_projection'::"text" NOT NULL,
    "summary" "text",
    "key_metrics" "jsonb",
    "suggested_actions" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_daily_timeline_views" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."daily_timeline_views" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."dash_layouts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "layout_mode" "text" DEFAULT 'adaptive'::"text" NOT NULL,
    "hidden_panels" "text"[] DEFAULT '{}'::"text"[] NOT NULL,
    "pinned_panels" "text"[] DEFAULT '{}'::"text"[] NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_dash_layouts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."dash_layouts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."dash_panels" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "default_weight" numeric DEFAULT 1.0 NOT NULL,
    "config_schema" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."dash_panels" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."dashboard_telemetry" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "event_type" "text" NOT NULL,
    "widget_key" "text",
    "metadata" "jsonb" DEFAULT '{}'::"jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_dashboard_telemetry" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."dashboard_telemetry" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."dashboard_telemetry_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "event_name" "text" NOT NULL,
    "payload" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "occurred_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_dashboard_telemetry_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."dashboard_telemetry_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."day_plans" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "date" "date" NOT NULL,
    "summary" "text",
    "focus_areas" "jsonb" DEFAULT '[]'::"jsonb",
    "energy_notes" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_day_plans" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."day_plans" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."deal_archetype_runs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "deal_id" "uuid" NOT NULL,
    "archetype_id" "uuid" NOT NULL,
    "confidence" numeric(3,2),
    "signals" "jsonb",
    "recommended_strategy" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "deal_archetype_runs_confidence_check" CHECK ((("confidence" >= (0)::numeric) AND ("confidence" <= (1)::numeric))),
    CONSTRAINT "pulse_user_id_text_only_deal_archetype_runs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."deal_archetype_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."deal_archetypes" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "archetype_id" "uuid",
    "name" "text" NOT NULL,
    "slug" "text" NOT NULL,
    "description" "text",
    "negotiation_style" "text",
    "financial_behavior" "jsonb",
    "psychological_tells" "jsonb",
    "recommended_counterplays" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."deal_archetypes" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."deal_intelligence" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "deal_id" "uuid",
    "risk_summary" "text",
    "blockers" "jsonb",
    "next_steps" "jsonb",
    "stall_indicators" "jsonb",
    "momentum_score" numeric,
    "confidence" numeric,
    "generated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."deal_intelligence" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."deal_participants" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "deal_id" "uuid" NOT NULL,
    "contact_id" "uuid",
    "role" "text",
    "importance" numeric DEFAULT 0.5,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."deal_participants" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."deal_stages" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    "key" "text" NOT NULL,
    "label" "text" NOT NULL,
    "sort_order" integer DEFAULT 0 NOT NULL,
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL
);


ALTER TABLE "public"."deal_stages" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."deals" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "name" "text" NOT NULL,
    "company" "text",
    "contact_name" "text",
    "contact_email" "text",
    "contact_phone" "text",
    "stage" "text" DEFAULT 'lead'::"text",
    "value" numeric(15,2),
    "loan_type" "text",
    "notes" "text",
    "last_contact" timestamp with time zone,
    "next_action" "text",
    "next_action_date" timestamp with time zone,
    "probability" integer DEFAULT 50,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "close_date" "date",
    "user_id" "text" NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "deals_stage_check" CHECK (("stage" = ANY (ARRAY['lead'::"text", 'qualified'::"text", 'proposal'::"text", 'negotiation'::"text", 'application'::"text", 'processing'::"text", 'underwriting'::"text", 'approved'::"text", 'closed_won'::"text", 'closed_lost'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_deals" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."deals" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."decision_options" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "decision_id" "uuid" NOT NULL,
    "label" "text" NOT NULL,
    "description" "text",
    "is_default" boolean DEFAULT false,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."decision_options" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."decision_scenarios" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "decision_id" "uuid" NOT NULL,
    "option_id" "uuid" NOT NULL,
    "name" "text" NOT NULL,
    "parameters" "jsonb",
    "simulated_outcomes" "jsonb",
    "narrative_summary" "text",
    "risk_score" numeric(4,2),
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."decision_scenarios" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."decision_tree_edges" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "tree_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "from_node_id" "uuid" NOT NULL,
    "to_node_id" "uuid" NOT NULL,
    "label" "text",
    "description" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_decision_tree_edges" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."decision_tree_edges" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."decision_tree_nodes" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "tree_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "parent_node_id" "uuid",
    "depth" integer DEFAULT 0 NOT NULL,
    "label" "text" NOT NULL,
    "description" "text",
    "related_decision_option_id" "uuid",
    "related_timeline_id" "uuid",
    "pivot_at_date" "date",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_decision_tree_nodes" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."decision_tree_nodes" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."decision_trees" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "decision_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_decision_trees" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."decision_trees" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."decisions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "domain_id" "uuid",
    "objective_id" "uuid",
    "title" "text" NOT NULL,
    "description" "text",
    "context" "jsonb",
    "importance" integer DEFAULT 3,
    "status" "text" DEFAULT 'open'::"text" NOT NULL,
    "chosen_option" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "decided_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_decisions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."decisions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."delegated_drafts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "type" "text" NOT NULL,
    "target" "text",
    "subject" "text",
    "body" "text" NOT NULL,
    "related_insight_id" "uuid",
    "context" "jsonb",
    "status" "text" DEFAULT 'pending'::"text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "related_event_id" "uuid",
    "auto_generated" boolean DEFAULT false,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "delegated_drafts_status_check" CHECK (("status" = ANY (ARRAY['pending'::"text", 'approved'::"text", 'edited'::"text", 'sent'::"text", 'discarded'::"text"]))),
    CONSTRAINT "delegated_drafts_type_check" CHECK (("type" = ANY (ARRAY['email'::"text", 'message'::"text", 'note'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_delegated_drafts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."delegated_drafts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."desire_profiles" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "entity_type" "text" NOT NULL,
    "entity_id" "text" NOT NULL,
    "last_refreshed_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "summary" "text",
    "priorities" "jsonb",
    "avoidance_triggers" "jsonb",
    "preferred_styles" "jsonb",
    "reward_signals" "jsonb",
    "long_term_desires" "jsonb",
    "short_term_preferences" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_desire_profiles" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."desire_profiles" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."desire_signals" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "entity_type" "text" NOT NULL,
    "entity_id" "text" NOT NULL,
    "source" "text" NOT NULL,
    "signal_time" timestamp with time zone DEFAULT "now"() NOT NULL,
    "context" "text",
    "kind" "text" NOT NULL,
    "description" "text",
    "features" "jsonb",
    "valence" numeric,
    "weight" numeric DEFAULT 1,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_desire_signals" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."desire_signals" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."destiny_alignment_log" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "arc_id" "uuid",
    "evaluated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "alignment_overall" numeric NOT NULL,
    "alignment_by_domain" "jsonb",
    "narrative_consistency" numeric,
    "tension_notes" "jsonb",
    "course_correction_suggestions" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_destiny_alignment_log" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."destiny_alignment_log" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."destiny_anchor_choices" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "timeline_id" "uuid" NOT NULL,
    "chosen_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "strength" "text" DEFAULT 'soft'::"text" NOT NULL,
    "notes" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_destiny_anchor_choices" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."destiny_anchor_choices" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."destiny_arcs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "blueprint_id" "uuid" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "name" "text" NOT NULL,
    "logline" "text",
    "arc_start" "date" NOT NULL,
    "arc_end" "date" NOT NULL,
    "focus_domains" "jsonb",
    "guiding_principles" "jsonb",
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "is_current" boolean DEFAULT false NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_destiny_arcs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."destiny_arcs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."destiny_blueprints" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "tagline" "text",
    "horizon_years" integer NOT NULL,
    "description" "text",
    "identity_themes" "jsonb",
    "domain_targets" "jsonb",
    "non_negotiables" "jsonb",
    "tradeoff_philosophy" "jsonb",
    "is_archived" boolean DEFAULT false NOT NULL,
    "is_primary" boolean DEFAULT false NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_destiny_blueprints" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."destiny_blueprints" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."destiny_checkpoints" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "arc_id" "uuid" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "label" "text" NOT NULL,
    "description" "text",
    "target_date" "date",
    "domain" "text",
    "metrics" "jsonb",
    "importance" numeric DEFAULT 0.7 NOT NULL,
    "status" "text" DEFAULT 'planned'::"text" NOT NULL,
    "reached_at" timestamp with time zone,
    "missed_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_destiny_checkpoints" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."destiny_checkpoints" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."destiny_milestones" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "waypoint_id" "uuid" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "target_date" "date",
    "status" "text" DEFAULT 'pending'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."destiny_milestones" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."destiny_simulation_runs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "timeline_id" "uuid" NOT NULL,
    "run_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "parameters" "jsonb",
    "results" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."destiny_simulation_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."destiny_timeline_scores" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "timeline_id" "uuid" NOT NULL,
    "snapshot_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "feasibility_score" numeric(4,2),
    "alignment_score" numeric(4,2),
    "risk_score" numeric(4,2),
    "emotional_fit_score" numeric(4,2),
    "simulation_summary" "jsonb",
    "narrative_summary" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."destiny_timeline_scores" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."destiny_timelines" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "key" "text",
    "name" "text" NOT NULL,
    "description" "text",
    "time_horizon_years" numeric(4,1),
    "archetype" "text",
    "mythic_frame" "text",
    "primary_domains" "text"[] DEFAULT '{}'::"text"[],
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "is_active" boolean DEFAULT true NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_destiny_timelines" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."destiny_timelines" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."destiny_waypoints" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "timeline_id" "uuid" NOT NULL,
    "ordering" integer NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "target_date" "date",
    "related_node_id" "uuid",
    "strategic_objective_id" "uuid",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."destiny_waypoints" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."domain_kpis" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "domain_key" "text" NOT NULL,
    "period_start" "date" NOT NULL,
    "period_end" "date" NOT NULL,
    "score" integer,
    "metrics" "jsonb" DEFAULT '{}'::"jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "domain_kpis_score_check" CHECK ((("score" >= 0) AND ("score" <= 100))),
    CONSTRAINT "pulse_user_id_text_only_domain_kpis" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."domain_kpis" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."efc_action_sequences" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "sequence_type" "text" NOT NULL,
    "title" "text" NOT NULL,
    "action_ids" "uuid"[] NOT NULL,
    "total_minutes" integer NOT NULL,
    "energy_flow" "text"[] DEFAULT '{}'::"text"[],
    "metadata" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "valid_until" timestamp with time zone,
    "completed" boolean DEFAULT false NOT NULL,
    "completed_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_efc_action_sequences" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."efc_action_sequences" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."efc_commitments" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "commitment_type" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "made_to" "text",
    "made_to_entity_id" "uuid",
    "made_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "due_at" timestamp with time zone,
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "progress" numeric DEFAULT 0 NOT NULL,
    "check_ins" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "related_entity_ids" "uuid"[] DEFAULT '{}'::"uuid"[],
    "source_fragment_ids" "uuid"[] DEFAULT '{}'::"uuid"[],
    "metadata" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_efc_commitments" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."efc_commitments" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."efc_energy_states" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "energy_level" "text" NOT NULL,
    "trend" "text",
    "factors" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "optimal_task_types" "text"[] DEFAULT '{}'::"text"[],
    "avoid_task_types" "text"[] DEFAULT '{}'::"text"[],
    "notes" "text",
    "recorded_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_efc_energy_states" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."efc_energy_states" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."efc_execution_log" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "action_id" "uuid",
    "event_type" "text" NOT NULL,
    "duration_minutes" integer,
    "energy_before" "text",
    "energy_after" "text",
    "satisfaction_score" integer,
    "notes" "text",
    "metadata" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_efc_execution_log" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."efc_execution_log" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."efc_generated_actions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "action_type" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "reasoning" "text" NOT NULL,
    "urgency" "text" NOT NULL,
    "importance" "text" NOT NULL,
    "estimated_minutes" integer DEFAULT 30 NOT NULL,
    "energy_required" "text" DEFAULT 'medium'::"text" NOT NULL,
    "best_time_block" "text",
    "dependencies" "uuid"[] DEFAULT '{}'::"uuid"[],
    "related_entity_ids" "uuid"[] DEFAULT '{}'::"uuid"[],
    "related_fragment_ids" "uuid"[] DEFAULT '{}'::"uuid"[],
    "confidence" numeric DEFAULT 0.7 NOT NULL,
    "priority_score" numeric DEFAULT 50 NOT NULL,
    "metadata" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "status" "text" DEFAULT 'suggested'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "expires_at" timestamp with time zone,
    "accepted_at" timestamp with time zone,
    "completed_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_efc_generated_actions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."efc_generated_actions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."efc_nudges" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "commitment_id" "uuid",
    "action_id" "uuid",
    "nudge_type" "text" NOT NULL,
    "message" "text" NOT NULL,
    "urgency" "text" DEFAULT 'today'::"text" NOT NULL,
    "suggested_action_data" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "acknowledged" boolean DEFAULT false NOT NULL,
    "acknowledged_at" timestamp with time zone,
    "snoozed_until" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_efc_nudges" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."efc_nudges" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."email_accounts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "provider" "text" NOT NULL,
    "email_address" "text" NOT NULL,
    "provider_user_id" "text" NOT NULL,
    "access_token" "text",
    "refresh_token" "text",
    "token_expires_at" timestamp with time zone,
    "sync_cursor" "text",
    "last_synced_at" timestamp with time zone,
    "is_primary" boolean DEFAULT false NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_email_accounts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."email_accounts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."email_actions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "email_id" "uuid",
    "message_id" "text",
    "action_type" "text" NOT NULL,
    "description" "text" NOT NULL,
    "from_name" "text",
    "from_email" "text",
    "subject" "text",
    "priority" "text" DEFAULT 'medium'::"text",
    "due_date" "date",
    "status" "text" DEFAULT 'pending'::"text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "completed_at" timestamp with time zone,
    "action_owner" "text" DEFAULT 'user'::"text",
    "urgency" "text" DEFAULT 'normal'::"text",
    "deal_id" "uuid",
    "deal_name" "text",
    "deal_value" numeric,
    "contact_id" "uuid",
    "snoozed_until" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_email_actions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."email_actions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."email_daily_briefs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "brief_date" "date" DEFAULT CURRENT_DATE NOT NULL,
    "summary" "text",
    "urgent_count" integer DEFAULT 0,
    "response_needed_count" integer DEFAULT 0,
    "commitments_due_count" integer DEFAULT 0,
    "deals_at_risk" "jsonb",
    "key_actions" "jsonb",
    "generated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_email_daily_briefs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."email_daily_briefs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."email_drafts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    "email_thread_id" "uuid" NOT NULL,
    "subject" "text",
    "body_text" "text" NOT NULL,
    "evidence" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "model_info" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "status" "text" DEFAULT 'draft'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "intent" "text" DEFAULT 'confirm'::"text" NOT NULL,
    "user_id" "text" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_email_drafts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."email_drafts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."email_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "direction" "text" NOT NULL,
    "message_id" "text",
    "thread_id" "text",
    "from_email" "text",
    "to_email" "text",
    "subject" "text",
    "snippet" "text",
    "received_at" timestamp with time zone,
    "triage_label" "text",
    "triage_confidence" numeric,
    "triage_payload" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "in_reply_to" "text",
    "references" "text"[],
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_email_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."email_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."email_followups" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "email_thread_id" "uuid" NOT NULL,
    "due_at" timestamp with time zone NOT NULL,
    "note" "text",
    "state" "text" DEFAULT 'open'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_email_followups" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."email_followups" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."email_items" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "message_id" "text" NOT NULL,
    "thread_id" "text",
    "subject" "text",
    "snippet" "text",
    "body_text" "text",
    "from_email" "text",
    "from_name" "text",
    "to_emails" "jsonb",
    "received_at" timestamp with time zone,
    "is_read" boolean DEFAULT false,
    "has_action" boolean DEFAULT false,
    "priority_score" integer DEFAULT 0,
    "ai_summary" "text",
    "extracted_actions" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "is_forwarded" boolean DEFAULT false,
    "original_sender_name" "text",
    "original_sender_email" "text",
    "needs_response" boolean DEFAULT false,
    "response_urgency" "text" DEFAULT 'normal'::"text",
    "waiting_since" timestamp with time zone,
    "responded_at" timestamp with time zone,
    "deal_id" "uuid",
    "contact_id" "uuid",
    "deal_value" numeric,
    "category" "text",
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_email_items" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."email_items" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."email_messages" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "email_account_id" "uuid" NOT NULL,
    "thread_id" "uuid" NOT NULL,
    "remote_message_id" "text" NOT NULL,
    "from_address" "text" NOT NULL,
    "to_addresses" "text"[] DEFAULT '{}'::"text"[] NOT NULL,
    "cc_addresses" "text"[] DEFAULT '{}'::"text"[] NOT NULL,
    "bcc_addresses" "text"[] DEFAULT '{}'::"text"[] NOT NULL,
    "sent_at" timestamp with time zone,
    "subject" "text",
    "snippet" "text",
    "body_html" "text",
    "body_text" "text",
    "is_read" boolean DEFAULT false NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."email_messages" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."email_resolution" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "email_thread_id" "uuid" NOT NULL,
    "state" "text" NOT NULL,
    "why" "text" NOT NULL,
    "evidence" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "next_action_at" timestamp with time zone,
    "linked_task_id" "uuid",
    "confidence" integer DEFAULT 100 NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_email_resolution" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."email_resolution" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."email_send_audit" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id" "text" NOT NULL,
    "outbox_id" "uuid" NOT NULL,
    "action" "text" NOT NULL,
    "detail" "jsonb",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_email_send_audit" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."email_send_audit" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."email_suggested_drafts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "source_event_id" "uuid",
    "kind" "text" NOT NULL,
    "to_email" "text" NOT NULL,
    "subject" "text" NOT NULL,
    "body" "text" NOT NULL,
    "safe_checksum" "text" NOT NULL,
    "active" boolean DEFAULT true NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "context" "jsonb",
    "why" "text",
    "user_id_uuid" "uuid" NOT NULL,
    "thread_id" "text",
    "prompt_hash" "text",
    CONSTRAINT "pulse_user_id_text_only_email_suggested_drafts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."email_suggested_drafts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."email_threads" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "thread_id" "text" NOT NULL,
    "subject" "text",
    "contact_name" "text",
    "contact_email" "text",
    "deal_id" "uuid",
    "deal_name" "text",
    "deal_value" numeric,
    "email_count" integer DEFAULT 0,
    "last_email_at" timestamp with time zone,
    "needs_response" boolean DEFAULT false,
    "waiting_on" "text",
    "health" "text" DEFAULT 'active'::"text",
    "days_since_activity" integer DEFAULT 0,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "snippet" "text",
    "last_message_from" "text",
    "last_message_to" "text",
    "last_message_at" timestamp with time zone,
    "unread" boolean DEFAULT false,
    "starred" boolean DEFAULT false,
    "importance" "text",
    "category" "text",
    "last_activity_at" timestamp with time zone,
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_email_threads" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."email_threads" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."email_triage_items" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "email_thread_id" "uuid" NOT NULL,
    "urgency" "text" DEFAULT 'later'::"text" NOT NULL,
    "suggested_action" "text" DEFAULT 'reply'::"text" NOT NULL,
    "why" "text" NOT NULL,
    "evidence" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "score" integer DEFAULT 0 NOT NULL,
    "next_action_at" timestamp with time zone,
    "state" "text" DEFAULT 'open'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "email_triage_items_evidence_is_object" CHECK (("jsonb_typeof"("evidence") = 'object'::"text")),
    CONSTRAINT "email_triage_items_state_chk" CHECK (("state" = ANY (ARRAY['triaged'::"text", 'suggested'::"text", 'done'::"text"]))),
    CONSTRAINT "email_triage_items_suggested_action_chk" CHECK (("suggested_action" = ANY (ARRAY['reply'::"text", 'followup'::"text", 'task'::"text", 'ignore'::"text"]))),
    CONSTRAINT "email_triage_items_urgency_chk" CHECK (("urgency" = ANY (ARRAY['p0'::"text", 'p1'::"text", 'p2'::"text", 'p3'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_email_triage_items" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."email_triage_items" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."emails" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "gmail_id" "text",
    "thread_id" "text",
    "from_email" "text",
    "from_name" "text",
    "to_emails" "text"[],
    "subject" "text",
    "snippet" "text",
    "has_attachments" boolean DEFAULT false,
    "is_read" boolean DEFAULT false,
    "is_starred" boolean DEFAULT false,
    "labels" "text"[],
    "received_at" timestamp with time zone,
    "contact_id" "uuid",
    "deal_id" "uuid",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "category" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_emails" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."emails" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."emo_adaptive_responses" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "emotion_state" "text" NOT NULL,
    "intensity_threshold" numeric DEFAULT 0.5 NOT NULL,
    "response_type" "text" NOT NULL,
    "response_config" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "enabled" boolean DEFAULT true NOT NULL,
    "times_triggered" integer DEFAULT 0 NOT NULL,
    "last_triggered_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_emo_adaptive_responses" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."emo_adaptive_responses" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."emo_checkins" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "checkin_type" "text" DEFAULT 'manual'::"text" NOT NULL,
    "emotion" "text" NOT NULL,
    "intensity" numeric NOT NULL,
    "energy_level" numeric,
    "notes" "text",
    "context_tags" "text"[] DEFAULT '{}'::"text"[],
    "photo_url" "text",
    "location" "text",
    "weather" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_emo_checkins" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."emo_checkins" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."emo_goals" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "goal_type" "text" NOT NULL,
    "target_emotion" "text" NOT NULL,
    "target_intensity" numeric,
    "current_baseline" numeric,
    "strategies" "text"[] DEFAULT '{}'::"text"[],
    "progress_notes" "text",
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_emo_goals" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."emo_goals" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."emo_interventions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "intervention_type" "text" NOT NULL,
    "intervention_name" "text" NOT NULL,
    "target_emotion" "text",
    "effectiveness_score" numeric,
    "times_used" integer DEFAULT 0 NOT NULL,
    "times_effective" integer DEFAULT 0 NOT NULL,
    "average_shift" numeric,
    "notes" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_emo_interventions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."emo_interventions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."emo_profiles" (
    "user_id" "text" NOT NULL,
    "baselines" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "triggers" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "regulators" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "patterns" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_emo_profiles" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."emo_profiles" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."emo_states" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "source" "text" NOT NULL,
    "source_id" "text",
    "detected_emotion" "text" NOT NULL,
    "intensity" numeric NOT NULL,
    "confidence" numeric NOT NULL,
    "valence" numeric,
    "arousal" numeric,
    "tags" "text"[] DEFAULT '{}'::"text"[],
    "raw_signal" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "context_summary" "text",
    "occurred_at" timestamp with time zone NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_emo_states" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."emo_states" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."emo_transitions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "from_emotion" "text" NOT NULL,
    "to_emotion" "text" NOT NULL,
    "from_intensity" numeric NOT NULL,
    "to_intensity" numeric NOT NULL,
    "trigger_type" "text",
    "trigger_description" "text",
    "duration_minutes" integer,
    "intervention_used" "text",
    "occurred_at" timestamp with time zone NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_emo_transitions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."emo_transitions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."emotion_channel_settings" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "channel" "text" NOT NULL,
    "context" "text",
    "tone_preferences" "jsonb",
    "length_preferences" "jsonb",
    "interruption_rules" "jsonb",
    "sensitivity_rules" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_emotion_channel_settings" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."emotion_channel_settings" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."emotion_interaction_log" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "occurred_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "channel" "text" NOT NULL,
    "context" "text",
    "input_emotion_state" "jsonb",
    "input_somatic_state" "jsonb",
    "response_style" "jsonb",
    "intervention_kind" "text",
    "outcome_emotion_state" "jsonb",
    "user_feedback" "jsonb",
    "resonance_score" numeric,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_emotion_interaction_log" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."emotion_interaction_log" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."emotion_resonance_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "interaction_id" "uuid",
    "direction" "text" NOT NULL,
    "magnitude" numeric NOT NULL,
    "summary" "text" NOT NULL,
    "pattern_tags" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_emotion_resonance_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."emotion_resonance_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."emotion_samples" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "source" "text" NOT NULL,
    "sampled_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "valence" numeric,
    "arousal" numeric,
    "labels" "text"[],
    "confidence" numeric,
    "payload" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_emotion_samples" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."emotion_samples" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."emotion_state_daily" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "state_date" "date" NOT NULL,
    "avg_valence" numeric,
    "avg_arousal" numeric,
    "dominant_labels" "text"[],
    "stress_score" numeric,
    "resilience_score" numeric,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_emotion_state_daily" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."emotion_state_daily" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."emotion_style_profile" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "baseline_style" "jsonb",
    "crisis_style" "jsonb",
    "hype_style" "jsonb",
    "reflective_style" "jsonb",
    "emotion_to_style_map" "jsonb",
    "persona_preferences" "jsonb",
    "boundaries" "jsonb",
    "summary" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_emotion_style_profile" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."emotion_style_profile" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."emotional_checkins" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "mood" integer NOT NULL,
    "energy" integer NOT NULL,
    "stress" integer NOT NULL,
    "notes" "text",
    "category" "text",
    "ai_insight" "text",
    "checked_in_at" timestamp with time zone DEFAULT "now"(),
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "emotional_checkins_energy_check" CHECK ((("energy" >= 1) AND ("energy" <= 10))),
    CONSTRAINT "emotional_checkins_mood_check" CHECK ((("mood" >= 1) AND ("mood" <= 10))),
    CONSTRAINT "emotional_checkins_stress_check" CHECK ((("stress" >= 1) AND ("stress" <= 10))),
    CONSTRAINT "pulse_user_id_text_only_emotional_checkins" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."emotional_checkins" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."emotional_patterns" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "pattern_type" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "confidence" real,
    "data" "jsonb" DEFAULT '{}'::"jsonb",
    "first_detected_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "last_confirmed_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "occurrences" integer DEFAULT 1,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "emotional_patterns_confidence_check" CHECK ((("confidence" >= (0)::double precision) AND ("confidence" <= (1)::double precision))),
    CONSTRAINT "pulse_user_id_text_only_emotional_patterns" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."emotional_patterns" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."emotional_support_logs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "trigger" "text",
    "intervention_type" "text",
    "content" "text",
    "user_feedback" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_emotional_support_logs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."emotional_support_logs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."empathic_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "source" "text" NOT NULL,
    "context" "jsonb",
    "detected_user_state" "jsonb",
    "detected_other_state" "jsonb",
    "chosen_style" "jsonb",
    "suggested_message" "jsonb",
    "outcome" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_empathic_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."empathic_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."ethical_policies" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text",
    "scope" "text" NOT NULL,
    "domain" "text",
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "priority" integer DEFAULT 100 NOT NULL,
    "is_active" boolean DEFAULT true NOT NULL,
    "rule" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_ethical_policies" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."ethical_policies" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."execution_logs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "execution_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "level" "text" DEFAULT 'info'::"text" NOT NULL,
    "message" "text" NOT NULL,
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "trace_id" "uuid",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_execution_logs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."execution_logs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."execution_runs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "execution_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "status" "text" NOT NULL,
    "started_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "finished_at" timestamp with time zone,
    "attempt" integer NOT NULL,
    "output" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "error" "text",
    "trace_id" "uuid",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_execution_runs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."execution_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."executions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "kind" "text" NOT NULL,
    "payload" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "run_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "priority" integer DEFAULT 0 NOT NULL,
    "status" "text" DEFAULT 'queued'::"text" NOT NULL,
    "attempts" integer DEFAULT 0 NOT NULL,
    "max_attempts" integer DEFAULT 5 NOT NULL,
    "last_error" "text",
    "next_retry_at" timestamp with time zone,
    "dedupe_key" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "cancelled_at" timestamp with time zone,
    "cancel_reason" "text",
    "user_id_text" "text"
);


ALTER TABLE "public"."executions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."executive_council_members" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "name" "text" NOT NULL,
    "slug" "text" NOT NULL,
    "description" "text",
    "role" "text",
    "archetype_tags" "jsonb",
    "voice_profile_id" "uuid",
    "is_system_default" boolean DEFAULT false NOT NULL,
    "is_active" boolean DEFAULT true NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_executive_council_members" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."executive_council_members" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."executive_council_votes" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "decision_id" "uuid" NOT NULL,
    "member_id" "uuid" NOT NULL,
    "option_id" "uuid" NOT NULL,
    "rationale" "text",
    "concerns" "jsonb",
    "confidence" numeric(3,2),
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    CONSTRAINT "executive_council_votes_confidence_check" CHECK ((("confidence" >= (0)::numeric) AND ("confidence" <= (1)::numeric)))
);


ALTER TABLE "public"."executive_council_votes" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."executive_summaries" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "period_type" "text" NOT NULL,
    "period_start" "date" NOT NULL,
    "period_end" "date" NOT NULL,
    "overall_score" integer,
    "summary" "text",
    "highlights" "jsonb" DEFAULT '[]'::"jsonb",
    "concerns" "jsonb" DEFAULT '[]'::"jsonb",
    "recommendations" "jsonb" DEFAULT '[]'::"jsonb",
    "domain_scores" "jsonb" DEFAULT '{}'::"jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "executive_summaries_overall_score_check" CHECK ((("overall_score" >= 0) AND ("overall_score" <= 100))),
    CONSTRAINT "executive_summaries_period_type_check" CHECK (("period_type" = ANY (ARRAY['weekly'::"text", 'monthly'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_executive_summaries" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."executive_summaries" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."experience_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "occurred_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "source" "text" NOT NULL,
    "kind" "text" NOT NULL,
    "ref_type" "text",
    "ref_id" "text",
    "description" "text",
    "context" "jsonb",
    "expectation" "jsonb",
    "outcome" "jsonb",
    "evaluation" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_experience_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."experience_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."experiment_metrics" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "source_module" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."experiment_metrics" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."experiment_templates" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "domain" "text" NOT NULL,
    "config" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."experiment_templates" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."feedback" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "message_id" "text",
    "rating" "text" NOT NULL,
    "category" "text",
    "comment" "text",
    "correction" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "feedback_rating_check" CHECK (("rating" = ANY (ARRAY['positive'::"text", 'negative'::"text", 'neutral'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_feedback" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."feedback" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."finance_accounts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "name" "text" NOT NULL,
    "type" "text" NOT NULL,
    "institution" "text",
    "currency" "text" DEFAULT 'USD'::"text" NOT NULL,
    "is_active" boolean DEFAULT true NOT NULL,
    "balance" numeric(14,2) DEFAULT 0.00,
    "last_synced_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_finance_accounts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."finance_accounts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."finance_alerts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "type" "text" NOT NULL,
    "title" "text" NOT NULL,
    "body" "text" NOT NULL,
    "severity" integer DEFAULT 1,
    "is_positive" boolean DEFAULT false,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "seen_at" timestamp with time zone,
    "dismissed_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_finance_alerts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."finance_alerts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."finance_budgets" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "month" "date" NOT NULL,
    "category" "text" NOT NULL,
    "amount" numeric(14,2) NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_finance_budgets" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."finance_budgets" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."finance_goals" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "name" "text" NOT NULL,
    "type" "text" NOT NULL,
    "target_amount" numeric(14,2),
    "current_amount" numeric(14,2) DEFAULT 0.00,
    "deadline" "date",
    "linked_account_id" "uuid",
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_finance_goals" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."finance_goals" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."finance_snapshots" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "period_start" "date" NOT NULL,
    "period_type" "text" NOT NULL,
    "income" numeric(14,2) DEFAULT 0.00,
    "expenses" numeric(14,2) DEFAULT 0.00,
    "savings" numeric(14,2) DEFAULT 0.00,
    "debt_paydown" numeric(14,2) DEFAULT 0.00,
    "net_cashflow" numeric(14,2) DEFAULT 0.00,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_finance_snapshots" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."finance_snapshots" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."finance_transactions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "account_id" "uuid" NOT NULL,
    "date" "date" NOT NULL,
    "description" "text",
    "amount" numeric(14,2) NOT NULL,
    "category" "text",
    "subcategory" "text",
    "is_transfer" boolean DEFAULT false,
    "metadata" "jsonb" DEFAULT '{}'::"jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_finance_transactions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."finance_transactions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."financial_accounts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "entity_id" "uuid" NOT NULL,
    "name" "text" NOT NULL,
    "code" "text",
    "type" "text" NOT NULL,
    "subtype" "text",
    "is_active" boolean DEFAULT true NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."financial_accounts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."financial_budget_envelopes" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "budget_id" "uuid" NOT NULL,
    "name" "text" NOT NULL,
    "account_id" "uuid",
    "target_amount" numeric NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."financial_budget_envelopes" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."financial_budgets" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "entity_id" "uuid" NOT NULL,
    "name" "text" NOT NULL,
    "period" "text" NOT NULL,
    "start_date" "date",
    "end_date" "date",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."financial_budgets" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."financial_connections" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "entity_id" "uuid",
    "provider" "text" NOT NULL,
    "name" "text" NOT NULL,
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_financial_connections" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."financial_connections" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."financial_entities" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text",
    "org_id" "uuid",
    "household_id" "uuid",
    "scope" "text" DEFAULT 'personal'::"text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_financial_entities" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."financial_entities" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."financial_imported_transactions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "connection_id" "uuid" NOT NULL,
    "raw_id" "text",
    "posted_at" timestamp with time zone NOT NULL,
    "amount" numeric NOT NULL,
    "currency" "text" DEFAULT 'USD'::"text" NOT NULL,
    "description" "text",
    "raw" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "ledger_entry_id" "uuid",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."financial_imported_transactions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."financial_ledger_entries" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "entity_id" "uuid" NOT NULL,
    "description" "text",
    "event_date" "date" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "source" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."financial_ledger_entries" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."financial_ledger_lines" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "entry_id" "uuid" NOT NULL,
    "account_id" "uuid" NOT NULL,
    "debit" numeric DEFAULT 0 NOT NULL,
    "credit" numeric DEFAULT 0 NOT NULL,
    "memo" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."financial_ledger_lines" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."financial_snapshots" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "entity_id" "uuid" NOT NULL,
    "as_of_date" "date" NOT NULL,
    "net_worth" numeric,
    "cash_balance" numeric,
    "total_debt" numeric,
    "trailing_30d_spend" numeric,
    "trailing_30d_income" numeric,
    "data" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."financial_snapshots" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."focus_locks" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "started_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "ends_at" timestamp with time zone NOT NULL,
    "minutes" integer NOT NULL,
    "playbook_title" "text",
    "playbook_do" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_focus_locks" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."focus_locks" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."focus_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "session_type" "text" DEFAULT 'pomodoro'::"text",
    "duration_minutes" integer DEFAULT 25,
    "status" "text" DEFAULT 'active'::"text",
    "started_at" timestamp with time zone DEFAULT "now"(),
    "completed_at" timestamp with time zone,
    "notes" "text",
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_focus_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."focus_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."follow_ups" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "person_name" "text" NOT NULL,
    "company" "text",
    "email" "text",
    "phone" "text",
    "type" "text" DEFAULT 'email'::"text",
    "status" "text" DEFAULT 'pending'::"text",
    "priority" "text" DEFAULT 'medium'::"text",
    "due_date" timestamp with time zone,
    "subject" "text",
    "notes" "text",
    "last_action" "text",
    "last_action_date" timestamp with time zone,
    "deal_id" "uuid",
    "contact_id" "uuid",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    "title" "text" DEFAULT ''::"text" NOT NULL,
    "body" "text" DEFAULT ''::"text" NOT NULL,
    "due_at" timestamp with time zone,
    "source" "text",
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    CONSTRAINT "follow_ups_priority_check" CHECK (("priority" = ANY (ARRAY['low'::"text", 'medium'::"text", 'high'::"text"]))),
    CONSTRAINT "follow_ups_status_check" CHECK (("status" = ANY (ARRAY['pending'::"text", 'sent'::"text", 'responded'::"text", 'done'::"text", 'snoozed'::"text"]))),
    CONSTRAINT "follow_ups_status_chk" CHECK (("status" = ANY (ARRAY['open'::"text", 'snoozed'::"text", 'done'::"text"]))),
    CONSTRAINT "follow_ups_type_check" CHECK (("type" = ANY (ARRAY['email'::"text", 'call'::"text", 'text'::"text", 'meeting'::"text", 'linkedin'::"text", 'other'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_follow_ups" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."follow_ups" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."gift_ideas" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "contact_id" "uuid" NOT NULL,
    "occasion" "text",
    "idea" "text" NOT NULL,
    "price_range" "text",
    "why" "text",
    "status" "text" DEFAULT 'idea'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_gift_ideas" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."gift_ideas" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."goal_hierarchy" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "timescale" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "importance" numeric NOT NULL,
    "alignment" "jsonb",
    "feasibility" "jsonb",
    "dependencies" "jsonb",
    "blockers" "jsonb",
    "status" "text" DEFAULT 'active'::"text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_goal_hierarchy" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."goal_hierarchy" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."goals" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "category" "text",
    "target_value" numeric(15,2),
    "current_value" numeric(15,2) DEFAULT 0,
    "unit" "text",
    "due_date" timestamp with time zone,
    "status" "text" DEFAULT 'active'::"text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "goals_status_check" CHECK (("status" = ANY (ARRAY['active'::"text", 'completed'::"text", 'abandoned'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_goals" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."goals" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."guardrail_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "occurred_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "source" "text" NOT NULL,
    "context_type" "text" NOT NULL,
    "context_id" "text",
    "policy_keys" "text"[],
    "action" "text" NOT NULL,
    "message_to_user" "text",
    "details" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_guardrail_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."guardrail_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."habit_completions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "habit_id" "uuid",
    "completed_at" timestamp with time zone DEFAULT "now"(),
    "count" integer DEFAULT 1,
    "notes" "text",
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_habit_completions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."habit_completions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."habit_logs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "habit_id" "uuid" NOT NULL,
    "occurred_on" "date" NOT NULL,
    "count" integer DEFAULT 1 NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "occurred_at" timestamp with time zone DEFAULT "now"(),
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_habit_logs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."habit_logs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."habit_streaks" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "habit_id" "uuid",
    "habit_name" "text" NOT NULL,
    "current_streak" integer DEFAULT 0,
    "longest_streak" integer DEFAULT 0,
    "last_completed" "date",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_habit_streaks" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."habit_streaks" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."habits" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "frequency" "text" DEFAULT 'daily'::"text",
    "target_count" integer DEFAULT 1,
    "xp_per_completion" integer DEFAULT 5,
    "icon" "text",
    "color" "text",
    "is_active" boolean DEFAULT true,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "streak" integer DEFAULT 0,
    "best_streak" integer DEFAULT 0,
    "owner_user_id" "text",
    "user_id" "text" NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "habits_frequency_check" CHECK (("frequency" = ANY (ARRAY['daily'::"text", 'weekly'::"text", 'weekdays'::"text", 'custom'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_habits" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."habits" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."pulse_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id" "text",
    "session_id" "text",
    "request_id" "text",
    "event_name" "text" NOT NULL,
    "feature_id" "text",
    "path" "text",
    "method" "text",
    "status" integer,
    "latency_ms" integer,
    "referrer" "text",
    "user_agent" "text",
    "properties" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    "event_fingerprint" "text",
    CONSTRAINT "pulse_events_user_id_uuid_not_zero" CHECK (("user_id_uuid" <> '00000000-0000-0000-0000-000000000000'::"uuid")),
    CONSTRAINT "pulse_user_id_text_only_pulse_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."pulse_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."tasks" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "status" "text" DEFAULT 'todo'::"text",
    "due_date" timestamp with time zone,
    "project" "text",
    "tags" "text"[],
    "xp" integer DEFAULT 10,
    "completed_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "deal_id" "uuid",
    "owner_user_id" "text",
    "user_id" "text" NOT NULL,
    "due_at" timestamp with time zone,
    "defer_until" timestamp with time zone,
    "priority" integer DEFAULT 0 NOT NULL,
    "title" "text" NOT NULL,
    "blocked_reason" "text",
    "source" "text",
    "context" "text",
    "ai_triage" "jsonb",
    "ai_triaged_at" timestamp with time zone,
    "trace_id" "uuid",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_tasks" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text")),
    CONSTRAINT "tasks_priority_range" CHECK ((("priority" >= '-10'::integer) AND ("priority" <= 10))),
    CONSTRAINT "tasks_status_check" CHECK (("status" = ANY (ARRAY['todo'::"text", 'in_progress'::"text", 'done'::"text", 'cancelled'::"text"]))),
    CONSTRAINT "tasks_status_chk" CHECK ((COALESCE("status", 'open'::"text") = ANY (ARRAY['open'::"text", 'in_progress'::"text", 'blocked'::"text", 'done'::"text", 'archived'::"text"])))
);


ALTER TABLE "public"."tasks" OWNER TO "postgres";


COMMENT ON COLUMN "public"."tasks"."description" IS 'Optional task body/notes.';



COMMENT ON COLUMN "public"."tasks"."status" IS 'Canonical task lifecycle status.';



COMMENT ON COLUMN "public"."tasks"."completed_at" IS 'Timestamp when task was completed.';



COMMENT ON COLUMN "public"."tasks"."due_at" IS 'Optional due datetime for task scheduling/triage (canonical tasks engine).';



COMMENT ON COLUMN "public"."tasks"."defer_until" IS 'If set, task should not surface for execution/triage until this datetime.';



COMMENT ON COLUMN "public"."tasks"."priority" IS 'Higher = more important. 0 is default.';



COMMENT ON COLUMN "public"."tasks"."title" IS 'Canonical task title (required by execution feed).';



COMMENT ON COLUMN "public"."tasks"."blocked_reason" IS 'Optional reason a task is blocked.';



COMMENT ON COLUMN "public"."tasks"."source" IS 'Origin of task creation.';



COMMENT ON COLUMN "public"."tasks"."context" IS 'User-defined or AI-assigned context bucket.';



COMMENT ON COLUMN "public"."tasks"."ai_triage" IS 'Raw AI triage result (priority/context/due/defer/status rationale).';



COMMENT ON COLUMN "public"."tasks"."ai_triaged_at" IS 'When AI triage last ran.';



CREATE OR REPLACE VIEW "public"."health_core_summary" AS
 SELECT ( SELECT "count"(*) AS "count"
           FROM "public"."identity_users"
          WHERE ("identity_users"."is_archived" = false)) AS "active_identities",
    ( SELECT "count"(*) AS "count"
           FROM "public"."pulse_events"
          WHERE ("pulse_events"."user_id_uuid" = '00000000-0000-0000-0000-000000000000'::"uuid")) AS "zero_uuid_events_total",
    ( SELECT "count"(*) AS "count"
           FROM "public"."pulse_events"
          WHERE (("pulse_events"."created_at" > ("now"() - '24:00:00'::interval)) AND ("pulse_events"."user_id_uuid" = '00000000-0000-0000-0000-000000000000'::"uuid"))) AS "zero_uuid_events_24h",
    ( SELECT "count"(*) AS "count"
           FROM "public"."follow_ups"
          WHERE ("follow_ups"."user_id_uuid" IS NULL)) AS "follow_ups_null_owner",
    ( SELECT "count"(*) AS "count"
           FROM "public"."tasks"
          WHERE ("tasks"."user_id_uuid" IS NULL)) AS "tasks_null_owner",
    ( SELECT "count"(*) AS "count"
           FROM "public"."deals"
          WHERE ("deals"."user_id_uuid" IS NULL)) AS "deals_null_owner";


ALTER VIEW "public"."health_core_summary" OWNER TO "postgres";


CREATE OR REPLACE VIEW "public"."health_rls_status" AS
 SELECT "schemaname",
    "tablename",
    "rowsecurity"
   FROM "pg_tables"
  WHERE (("schemaname" = 'public'::"name") AND ("tablename" = ANY (ARRAY['follow_ups'::"name", 'tasks'::"name", 'deals'::"name", 'inbox_items'::"name", 'inbox_actions'::"name", 'inbox_rules'::"name", 'inbox_rule_runs'::"name", 'inbox_rule_outcomes'::"name"])));


ALTER VIEW "public"."health_rls_status" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."household_members" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "household_id" "uuid",
    "user_id" "text",
    "role" "text" DEFAULT 'member'::"text",
    "permissions" "jsonb" DEFAULT '{}'::"jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_household_members" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."household_members" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."households" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "name" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."households" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."id_aspirations" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "aspiration_type" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "time_horizon" "text",
    "importance" numeric DEFAULT 0.5 NOT NULL,
    "progress" numeric DEFAULT 0 NOT NULL,
    "milestones" "jsonb" DEFAULT '[]'::"jsonb",
    "blockers" "text"[] DEFAULT '{}'::"text"[],
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_id_aspirations" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."id_aspirations" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."id_beliefs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "belief_statement" "text" NOT NULL,
    "category" "text",
    "is_empowering" boolean,
    "confidence" numeric DEFAULT 0.5 NOT NULL,
    "source" "text",
    "challenges" "text"[] DEFAULT '{}'::"text"[],
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_id_beliefs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."id_beliefs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."id_growth_areas" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "area_name" "text" NOT NULL,
    "category" "text",
    "description" "text",
    "current_level" numeric,
    "target_level" numeric,
    "priority" "text" DEFAULT 'medium'::"text" NOT NULL,
    "strategies" "text"[] DEFAULT '{}'::"text"[],
    "progress_notes" "text",
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_id_growth_areas" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."id_growth_areas" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."id_momentum_daily" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "identity_id" "uuid",
    "date" "date" NOT NULL,
    "net_momentum" numeric(4,3) DEFAULT 0,
    "alignment_score" numeric(3,2) DEFAULT 0.5,
    "actions_count" integer DEFAULT 0,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_id_momentum_daily" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."id_momentum_daily" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."id_narrative_chapters" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "chapter_title" "text" NOT NULL,
    "time_period" "text",
    "start_date" "date",
    "end_date" "date",
    "summary" "text" NOT NULL,
    "key_events" "text"[] DEFAULT '{}'::"text"[],
    "lessons_learned" "text"[] DEFAULT '{}'::"text"[],
    "defining_moments" "text"[] DEFAULT '{}'::"text"[],
    "emotional_tone" "text",
    "chapter_order" integer,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_id_narrative_chapters" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."id_narrative_chapters" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."id_roles" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "role_name" "text" NOT NULL,
    "description" "text",
    "importance" numeric DEFAULT 0.5 NOT NULL,
    "time_allocation" numeric,
    "satisfaction" numeric,
    "aspirations" "text",
    "tensions" "text"[] DEFAULT '{}'::"text"[],
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_id_roles" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."id_roles" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."id_snapshots" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "snapshot_date" "date" NOT NULL,
    "life_satisfaction" numeric,
    "authenticity_score" numeric,
    "top_values" "text"[] DEFAULT '{}'::"text"[],
    "current_roles" "text"[] DEFAULT '{}'::"text"[],
    "growth_focus" "text",
    "biggest_challenge" "text",
    "biggest_win" "text",
    "reflections" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_id_snapshots" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."id_snapshots" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."id_strengths" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "strength_name" "text" NOT NULL,
    "category" "text",
    "description" "text",
    "confidence" numeric DEFAULT 0.5 NOT NULL,
    "source" "text",
    "evidence_count" integer DEFAULT 0 NOT NULL,
    "last_demonstrated_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_id_strengths" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."id_strengths" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."id_values" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "value_name" "text" NOT NULL,
    "description" "text",
    "importance_rank" integer,
    "confidence" numeric DEFAULT 0.5 NOT NULL,
    "source" "text",
    "evidence_fragments" "uuid"[] DEFAULT '{}'::"uuid"[],
    "active" boolean DEFAULT true NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_id_values" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."id_values" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."identity_arcs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "start_date" "date",
    "projected_end_date" "date",
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "associated_roles" "text"[],
    "driving_values" "text"[],
    "related_theme_keys" "text"[],
    "progress" numeric,
    "evidence" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_identity_arcs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."identity_arcs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."identity_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "event_type" "text" NOT NULL,
    "payload" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "occurred_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_identity_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."identity_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."identity_transforms" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "occurred_at" timestamp with time zone DEFAULT "now"(),
    "previous_identity" "jsonb",
    "new_identity" "jsonb",
    "catalysts" "jsonb",
    "emotions" "jsonb",
    "narrative_explanation" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_identity_transforms" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."identity_transforms" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."inbox_actions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    "inbox_item_id" "uuid" NOT NULL,
    "action_type" "text" NOT NULL,
    "target_table" "text",
    "target_id" "uuid",
    "payload" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."inbox_actions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."inbox_items" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    "source" "text" DEFAULT 'manual'::"text" NOT NULL,
    "source_thread_id" "text",
    "source_message_id" "text",
    "from_email" "text",
    "from_name" "text",
    "subject" "text",
    "snippet" "text",
    "body" "text",
    "received_at" timestamp with time zone,
    "is_unread" boolean DEFAULT true NOT NULL,
    "is_archived" boolean DEFAULT false NOT NULL,
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "triage_status" "text" DEFAULT 'new'::"text" NOT NULL,
    "triage_priority" "text" DEFAULT 'normal'::"text" NOT NULL,
    "suggested_action" "text",
    "suggested_due_at" timestamp with time zone,
    "triaged_at" timestamp with time zone,
    "triage_meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    CONSTRAINT "inbox_items_triage_priority_chk" CHECK (("triage_priority" = ANY (ARRAY['low'::"text", 'normal'::"text", 'high'::"text"]))),
    CONSTRAINT "inbox_items_triage_status_chk" CHECK (("triage_status" = ANY (ARRAY['new'::"text", 'needs_reply'::"text", 'to_do'::"text", 'waiting'::"text", 'done'::"text", 'ignored'::"text"])))
);


ALTER TABLE "public"."inbox_items" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."inbox_rule_outcomes" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    "run_id" "uuid" NOT NULL,
    "inbox_item_id" "uuid" NOT NULL,
    "rule_id" "uuid",
    "matched" boolean DEFAULT false NOT NULL,
    "action_type" "text",
    "target_table" "text",
    "target_id" "uuid",
    "note" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."inbox_rule_outcomes" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."inbox_rule_runs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    "started_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "finished_at" timestamp with time zone,
    "status" "text" DEFAULT 'running'::"text" NOT NULL,
    "processed_count" integer DEFAULT 0 NOT NULL,
    "matched_count" integer DEFAULT 0 NOT NULL,
    "actions_count" integer DEFAULT 0 NOT NULL,
    "error" "text",
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL
);


ALTER TABLE "public"."inbox_rule_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."inbox_rules" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    "enabled" boolean DEFAULT true NOT NULL,
    "priority" integer DEFAULT 100 NOT NULL,
    "match_from_email" "text",
    "match_subject_contains" "text",
    "match_body_contains" "text",
    "match_snippet_contains" "text",
    "action_type" "text" NOT NULL,
    "action_title_template" "text",
    "action_due_minutes" integer,
    "action_status" "text",
    "action_archive" boolean DEFAULT false NOT NULL,
    "action_mark_read" boolean DEFAULT true NOT NULL,
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."inbox_rules" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."inbox_triage_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    "inbox_item_id" "uuid" NOT NULL,
    "event_type" "text" NOT NULL,
    "from_value" "text",
    "to_value" "text",
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."inbox_triage_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."industries" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "name" "text" NOT NULL,
    "icon" "text",
    "sort_order" integer DEFAULT 0,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."industries" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."inner_monologue_entries" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "source" "text" NOT NULL,
    "state_date" "date",
    "thread_ids" "uuid"[],
    "kind" "text" NOT NULL,
    "importance" numeric DEFAULT 0.5 NOT NULL,
    "content" "text" NOT NULL,
    "annotations" "jsonb",
    "created_from" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_inner_monologue_entries" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."inner_monologue_entries" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."inner_monologue_turns" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "frame_id" "uuid",
    "focus_item_id" "uuid",
    "step_index" integer NOT NULL,
    "mode" "text" NOT NULL,
    "content" "text" NOT NULL,
    "referenced_subsystems" "text"[],
    "derived_actions" "jsonb",
    "emotional_tone" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_inner_monologue_turns" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."inner_monologue_turns" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."interaction_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "contact_id" "uuid",
    "type" "text" NOT NULL,
    "summary" "text" NOT NULL,
    "occurred_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "payload_ref" "jsonb",
    "extracted_fact_ids" "uuid"[] DEFAULT '{}'::"uuid"[],
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_interaction_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."interaction_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."interactions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text",
    "contact_id" "uuid",
    "type" "text" NOT NULL,
    "summary" "text",
    "notes" "text",
    "metadata" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_interactions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."interactions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_categories" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "industry_id" "uuid",
    "name" "text" NOT NULL,
    "icon" "text",
    "sort_order" integer DEFAULT 0,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."job_categories" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_graph_nodes" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "job_title_id" "uuid",
    "parent_id" "uuid",
    "label" "text" NOT NULL,
    "description" "text",
    "level" integer DEFAULT 0,
    "path" "text",
    "industry_id" "uuid",
    "is_leaf" boolean DEFAULT false,
    "is_active" boolean DEFAULT true,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."job_graph_nodes" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_kpis" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "job_graph_node_id" "uuid",
    "kpi_key" "text" NOT NULL,
    "label" "text" NOT NULL,
    "description" "text",
    "target_value" numeric,
    "target_period" "text",
    "weight" numeric DEFAULT 1.0,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."job_kpis" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_provider_health" (
    "provider" "text" NOT NULL,
    "window_minutes" integer DEFAULT 60 NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "total" integer DEFAULT 0 NOT NULL,
    "failed" integer DEFAULT 0 NOT NULL,
    "completed" integer DEFAULT 0 NOT NULL,
    "failure_rate" numeric DEFAULT 0 NOT NULL,
    "status" "text" DEFAULT 'unknown'::"text" NOT NULL,
    "base_delay_seconds" integer DEFAULT 30 NOT NULL,
    "max_delay_seconds" integer DEFAULT 900 NOT NULL,
    "multiplier" numeric DEFAULT 1.0 NOT NULL
);


ALTER TABLE "public"."job_provider_health" OWNER TO "postgres";


CREATE OR REPLACE VIEW "public"."job_provider_health_view" AS
 SELECT "provider",
    "status",
    "failure_rate",
    "total",
    "failed",
    "completed",
    "window_minutes",
    "updated_at"
   FROM "public"."job_provider_health"
  ORDER BY "status" DESC, "failure_rate" DESC;


ALTER VIEW "public"."job_provider_health_view" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_provider_incidents" (
    "id" bigint NOT NULL,
    "provider" "text" NOT NULL,
    "at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "status" "text" NOT NULL,
    "failure_rate" numeric,
    "sample_total" integer,
    "sample_failed" integer,
    "meta" "jsonb"
);


ALTER TABLE "public"."job_provider_incidents" OWNER TO "postgres";


CREATE SEQUENCE IF NOT EXISTS "public"."job_provider_incidents_id_seq"
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE "public"."job_provider_incidents_id_seq" OWNER TO "postgres";


ALTER SEQUENCE "public"."job_provider_incidents_id_seq" OWNED BY "public"."job_provider_incidents"."id";



CREATE OR REPLACE VIEW "public"."job_provider_incidents_recent" AS
 SELECT "id",
    "provider",
    "at",
    "status",
    "failure_rate",
    "sample_total",
    "sample_failed",
    "meta"
   FROM "public"."job_provider_incidents"
  ORDER BY "at" DESC
 LIMIT 200;


ALTER VIEW "public"."job_provider_incidents_recent" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_queue" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "job_type" "text" NOT NULL,
    "status" "text" DEFAULT 'queued'::"text" NOT NULL,
    "payload" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "idempotency_key" "text",
    "correlation_id" "uuid" DEFAULT "gen_random_uuid"(),
    "priority" integer DEFAULT 100 NOT NULL,
    "attempts" integer DEFAULT 0 NOT NULL,
    "max_attempts" integer DEFAULT 3 NOT NULL,
    "scheduled_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "started_at" timestamp with time zone,
    "finished_at" timestamp with time zone,
    "last_error" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "run_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "locked_at" timestamp with time zone,
    "locked_by" "text",
    "cost" integer DEFAULT 1 NOT NULL,
    "lane" "text" DEFAULT 'default'::"text" NOT NULL,
    "first_enqueued_at" timestamp with time zone,
    "deferral_count" integer DEFAULT 0 NOT NULL,
    "sla_minutes" integer,
    "agent_id" "uuid",
    "lease_expires_at" timestamp with time zone,
    "heartbeat_at" timestamp with time zone,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "job_queue_status_check" CHECK (("status" = ANY (ARRAY['queued'::"text", 'running'::"text", 'succeeded'::"text", 'failed'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_job_queue" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."job_queue" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_queue_agent_budgets" (
    "agent_id" "uuid" NOT NULL,
    "daily_budget" integer DEFAULT 50 NOT NULL,
    "burst_multiplier" numeric DEFAULT 1.0 NOT NULL,
    "decay_rate" numeric DEFAULT 0.0 NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."job_queue_agent_budgets" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_queue_agents" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "name" "text" NOT NULL,
    "enabled" boolean DEFAULT true NOT NULL,
    "max_concurrency" integer DEFAULT 2 NOT NULL,
    "lane" "text" DEFAULT 'normal'::"text" NOT NULL,
    "kind_allowlist" "text"[] DEFAULT '{}'::"text"[] NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_job_queue_agents" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."job_queue_agents" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_queue_alerts" (
    "id" bigint NOT NULL,
    "severity" "text" NOT NULL,
    "code" "text" NOT NULL,
    "message" "text" NOT NULL,
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."job_queue_alerts" OWNER TO "postgres";


CREATE SEQUENCE IF NOT EXISTS "public"."job_queue_alerts_id_seq"
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE "public"."job_queue_alerts_id_seq" OWNER TO "postgres";


ALTER SEQUENCE "public"."job_queue_alerts_id_seq" OWNED BY "public"."job_queue_alerts"."id";



CREATE TABLE IF NOT EXISTS "public"."job_queue_budget_ledger" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "day" "date" NOT NULL,
    "job_id" "uuid",
    "delta" integer NOT NULL,
    "reason" "text" NOT NULL,
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "ts" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_job_queue_budget_ledger" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."job_queue_budget_ledger" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_queue_budget_rollover" (
    "user_id" "text" NOT NULL,
    "tier" "text" NOT NULL,
    "day" "date" NOT NULL,
    "carried_forward" integer DEFAULT 0 NOT NULL,
    "expires_at" timestamp with time zone NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_job_queue_budget_rollover" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."job_queue_budget_rollover" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_queue_credit_balances" (
    "user_id" "text" NOT NULL,
    "balance" integer DEFAULT 0 NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_job_queue_credit_balances" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."job_queue_credit_balances" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_queue_credits_ledger" (
    "id" bigint NOT NULL,
    "user_id" "text" NOT NULL,
    "day" "date" NOT NULL,
    "delta" integer NOT NULL,
    "reason" "text" NOT NULL,
    "job_id" "uuid",
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_job_queue_credits_ledger" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."job_queue_credits_ledger" OWNER TO "postgres";


CREATE SEQUENCE IF NOT EXISTS "public"."job_queue_credits_ledger_id_seq"
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE "public"."job_queue_credits_ledger_id_seq" OWNER TO "postgres";


ALTER SEQUENCE "public"."job_queue_credits_ledger_id_seq" OWNED BY "public"."job_queue_credits_ledger"."id";



CREATE TABLE IF NOT EXISTS "public"."job_queue_daily_budget" (
    "user_id" "text" NOT NULL,
    "day" "date" NOT NULL,
    "budget" integer DEFAULT 100 NOT NULL,
    "spent" integer DEFAULT 0 NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "tier" "text" DEFAULT 'free'::"text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_job_queue_daily_budget" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."job_queue_daily_budget" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_queue_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "job_id" "uuid" NOT NULL,
    "ts" timestamp with time zone DEFAULT "now"() NOT NULL,
    "level" "text" DEFAULT 'info'::"text" NOT NULL,
    "message" "text" NOT NULL,
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL
);


ALTER TABLE "public"."job_queue_events" OWNER TO "postgres";


CREATE OR REPLACE VIEW "public"."job_queue_events_c9" AS
 SELECT "id",
    "job_id",
    "ts" AS "at",
    COALESCE(NULLIF(("meta" ->> 'event'::"text"), ''::"text"), NULLIF(("meta" ->> 'type'::"text"), ''::"text"), NULLIF("message", ''::"text"), 'unknown'::"text") AS "event",
    "level",
    "message",
    "meta"
   FROM "public"."job_queue_events";


ALTER VIEW "public"."job_queue_events_c9" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_queue_fairness_ledger" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "job_id" "uuid",
    "user_id" "text" NOT NULL,
    "lane" "text",
    "reason" "text" NOT NULL,
    "score_delta" integer NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "ts" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_job_queue_fairness_ledger" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."job_queue_fairness_ledger" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_queue_health_snapshots" (
    "id" bigint NOT NULL,
    "window_start" timestamp with time zone NOT NULL,
    "window_end" timestamp with time zone NOT NULL,
    "queue_depth" integer NOT NULL,
    "mean_wait_seconds" numeric,
    "p95_wait_seconds" numeric,
    "starvation_count" integer DEFAULT 0 NOT NULL,
    "sla_breach_count" integer DEFAULT 0 NOT NULL,
    "retry_pressure" numeric,
    "score" integer NOT NULL,
    "status" "text" NOT NULL,
    "warnings" "text"[] DEFAULT '{}'::"text"[] NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."job_queue_health_snapshots" OWNER TO "postgres";


CREATE SEQUENCE IF NOT EXISTS "public"."job_queue_health_snapshots_id_seq"
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE "public"."job_queue_health_snapshots_id_seq" OWNER TO "postgres";


ALTER SEQUENCE "public"."job_queue_health_snapshots_id_seq" OWNED BY "public"."job_queue_health_snapshots"."id";



CREATE TABLE IF NOT EXISTS "public"."job_queue_lane_quota" (
    "user_id" "text" NOT NULL,
    "day" "date" NOT NULL,
    "lane" "text" NOT NULL,
    "quota" integer NOT NULL,
    "used" integer DEFAULT 0 NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_job_queue_lane_quota" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."job_queue_lane_quota" OWNER TO "postgres";


CREATE OR REPLACE VIEW "public"."job_queue_metrics_daily" AS
 SELECT "date_trunc"('day'::"text", "at") AS "day",
    "count"(*) FILTER (WHERE ("event" = 'completed'::"text")) AS "completed",
    "count"(*) FILTER (WHERE ("event" = 'failed'::"text")) AS "failed",
    "count"(*) FILTER (WHERE ("event" = 'recovered_stuck'::"text")) AS "recovered_stuck"
   FROM "public"."job_queue_events_c9"
  GROUP BY ("date_trunc"('day'::"text", "at"))
  ORDER BY ("date_trunc"('day'::"text", "at")) DESC;


ALTER VIEW "public"."job_queue_metrics_daily" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_queue_pricing" (
    "id" bigint NOT NULL,
    "tier" "text" NOT NULL,
    "kind" "text" NOT NULL,
    "base_cost" integer DEFAULT 1 NOT NULL,
    "burst_surcharge" numeric DEFAULT 0.0 NOT NULL,
    "priority_surcharge" numeric DEFAULT 0.0 NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."job_queue_pricing" OWNER TO "postgres";


CREATE SEQUENCE IF NOT EXISTS "public"."job_queue_pricing_id_seq"
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE "public"."job_queue_pricing_id_seq" OWNER TO "postgres";


ALTER SEQUENCE "public"."job_queue_pricing_id_seq" OWNED BY "public"."job_queue_pricing"."id";



CREATE TABLE IF NOT EXISTS "public"."job_queue_rate_window" (
    "user_id" "text" NOT NULL,
    "window_start" timestamp with time zone NOT NULL,
    "window_seconds" integer NOT NULL,
    "max_jobs" integer NOT NULL,
    "spent" integer DEFAULT 0 NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_job_queue_rate_window" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."job_queue_rate_window" OWNER TO "postgres";


CREATE OR REPLACE VIEW "public"."job_queue_reliability_24h" AS
 WITH "e" AS (
         SELECT ("job_queue_events"."meta" ->> 'event'::"text") AS "event",
            "job_queue_events"."ts"
           FROM "public"."job_queue_events"
          WHERE (("job_queue_events"."ts" >= ("now"() - '24:00:00'::interval)) AND (("job_queue_events"."meta" ->> 'event'::"text") = ANY (ARRAY['started'::"text", 'completed'::"text", 'failed'::"text", 'retry_scheduled'::"text", 'recovered_stuck'::"text", 'lost_lease'::"text"])))
        )
 SELECT "count"(*) FILTER (WHERE ("event" = 'started'::"text")) AS "started",
    "count"(*) FILTER (WHERE ("event" = 'completed'::"text")) AS "completed",
    "count"(*) FILTER (WHERE ("event" = 'failed'::"text")) AS "failed",
    "count"(*) FILTER (WHERE ("event" = 'retry_scheduled'::"text")) AS "retry_scheduled",
    "count"(*) FILTER (WHERE ("event" = 'recovered_stuck'::"text")) AS "recovered_stuck",
    "count"(*) FILTER (WHERE ("event" = 'lost_lease'::"text")) AS "lost_lease",
        CASE
            WHEN ("count"(*) FILTER (WHERE ("event" = ANY (ARRAY['completed'::"text", 'failed'::"text"]))) = 0) THEN (0)::numeric
            ELSE (("count"(*) FILTER (WHERE ("event" = 'completed'::"text")))::numeric / ("count"(*) FILTER (WHERE ("event" = ANY (ARRAY['completed'::"text", 'failed'::"text"]))))::numeric)
        END AS "success_rate"
   FROM "e";


ALTER VIEW "public"."job_queue_reliability_24h" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_queue_results" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "job_id" "uuid" NOT NULL,
    "status" "text" NOT NULL,
    "output" "jsonb",
    "error" "text",
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."job_queue_results" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_queue_scheduler_decisions" (
    "id" bigint NOT NULL,
    "job_id" "uuid",
    "user_id" "text",
    "decision" "text" NOT NULL,
    "reason" "text" NOT NULL,
    "lane" "text",
    "queue_depth" integer DEFAULT 0 NOT NULL,
    "user_budget_remaining" integer,
    "user_effective_budget" integer,
    "system_load_score" numeric,
    "starvation_risk" boolean DEFAULT false NOT NULL,
    "sla_risk" boolean DEFAULT false NOT NULL,
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_job_queue_scheduler_decisions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."job_queue_scheduler_decisions" OWNER TO "postgres";


CREATE SEQUENCE IF NOT EXISTS "public"."job_queue_scheduler_decisions_id_seq"
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE "public"."job_queue_scheduler_decisions_id_seq" OWNER TO "postgres";


ALTER SEQUENCE "public"."job_queue_scheduler_decisions_id_seq" OWNED BY "public"."job_queue_scheduler_decisions"."id";



CREATE TABLE IF NOT EXISTS "public"."job_queue_tiers" (
    "tier" "text" NOT NULL,
    "daily_budget" integer NOT NULL,
    "burst_multiplier" numeric DEFAULT 1.0 NOT NULL,
    "decay_rate" numeric DEFAULT 0.0 NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."job_queue_tiers" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_queue_user_tiers" (
    "user_id" "text" NOT NULL,
    "tier" "text" NOT NULL,
    "effective_from" timestamp with time zone DEFAULT "now"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_job_queue_user_tiers" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."job_queue_user_tiers" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_requests" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "suggested_industry" "text",
    "suggested_category" "text",
    "suggested_title" "text" NOT NULL,
    "description" "text",
    "status" "text" DEFAULT 'pending'::"text",
    "admin_notes" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "job_requests_status_check" CHECK (("status" = ANY (ARRAY['pending'::"text", 'approved'::"text", 'rejected'::"text", 'merged'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_job_requests" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."job_requests" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_runs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "job_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "job_type" "text" NOT NULL,
    "status" "text" NOT NULL,
    "attempt" integer NOT NULL,
    "started_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "finished_at" timestamp with time zone,
    "duration_ms" integer,
    "result" "jsonb",
    "error" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "job_runs_status_check" CHECK (("status" = ANY (ARRAY['running'::"text", 'succeeded'::"text", 'failed'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_job_runs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."job_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_scorecards" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "job_graph_node_id" "uuid",
    "date" "date" NOT NULL,
    "kpi_values" "jsonb",
    "kpi_scores" "jsonb",
    "overall_score" numeric,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_job_scorecards" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."job_scorecards" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_titles" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "category_id" "uuid",
    "name" "text" NOT NULL,
    "aliases" "text"[],
    "description" "text",
    "typical_metrics" "text"[],
    "is_active" boolean DEFAULT true,
    "user_count" integer DEFAULT 0,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."job_titles" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."job_verticals" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text",
    "job_title" "text" NOT NULL,
    "pack" "jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_job_verticals" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."job_verticals" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."journal_entries" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "title" "text" NOT NULL,
    "date" "date" DEFAULT CURRENT_DATE,
    "mode" "text",
    "mood" integer,
    "primary_theme" "text",
    "wins" "text"[],
    "challenges" "text"[],
    "gratitude" "text"[],
    "lessons" "text"[],
    "tomorrow_focus" "text",
    "transcript" "text",
    "xp_earned" integer DEFAULT 50,
    "reflection_streak" integer DEFAULT 1,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "entry_date" "date" DEFAULT ("now"())::"date",
    "occurred_at" timestamp with time zone DEFAULT "now"(),
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_journal_entries" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."journal_entries" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."knowledge_context_links" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "context_id" "uuid" NOT NULL,
    "node_id" "uuid",
    "edge_id" "uuid",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "knowledge_context_links_check" CHECK ((((("node_id" IS NOT NULL))::integer + (("edge_id" IS NOT NULL))::integer) = 1)),
    CONSTRAINT "pulse_user_id_text_only_knowledge_context_links" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."knowledge_context_links" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."knowledge_contexts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "kind" "text" NOT NULL,
    "title" "text",
    "description" "text",
    "started_at" timestamp with time zone,
    "ended_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_knowledge_contexts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."knowledge_contexts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."knowledge_edges" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "from_node_id" "uuid" NOT NULL,
    "to_node_id" "uuid" NOT NULL,
    "relation" "text" NOT NULL,
    "weight" numeric(4,2) DEFAULT 1.0,
    "direction" "text" DEFAULT 'directed'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_knowledge_edges" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."knowledge_edges" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."knowledge_nodes" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "kind" "text" NOT NULL,
    "external_ref" "text",
    "title" "text" NOT NULL,
    "summary" "text",
    "tags" "text"[] DEFAULT '{}'::"text"[],
    "importance" numeric(4,2) DEFAULT 0.0,
    "last_touched_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_knowledge_nodes" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."knowledge_nodes" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."lb_daily_metrics" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "date" "date" NOT NULL,
    "metrics" "jsonb" DEFAULT '{}'::"jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_lb_daily_metrics" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."lb_daily_metrics" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."lb_insights" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "title" "text" NOT NULL,
    "content" "text" NOT NULL,
    "insight_type" "text" DEFAULT 'pattern'::"text",
    "significance" numeric(3,2) DEFAULT 0.5,
    "time_range" "text",
    "source_data" "jsonb" DEFAULT '{}'::"jsonb",
    "status" "text" DEFAULT 'unread'::"text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_lb_insights" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."lb_insights" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."league_members" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "league_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "display_mode" "text" DEFAULT 'anonymous'::"text" NOT NULL,
    "public_handle" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_league_members" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."league_members" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."league_scores" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "league_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "score" numeric DEFAULT 0 NOT NULL,
    "tier" "text",
    "rank" integer,
    "components" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_league_scores" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."league_scores" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."leagues" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "vertical_key" "text",
    "scope" "text" DEFAULT 'global'::"text" NOT NULL,
    "org_id" "uuid",
    "season_key" "text",
    "started_at" timestamp with time zone NOT NULL,
    "ends_at" timestamp with time zone,
    "config" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."leagues" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."life_arc_autopilot_runs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "run_type" "text" NOT NULL,
    "run_date" "date" NOT NULL,
    "status" "text" DEFAULT 'success'::"text" NOT NULL,
    "details" "jsonb" DEFAULT '{}'::"jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_life_arc_autopilot_runs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."life_arc_autopilot_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."life_arc_autopilot_suggestions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "owner_user_id" "text",
    "policy_id" "uuid",
    "run_id" "uuid",
    "suggestion_type" "text" NOT NULL,
    "title" "text" NOT NULL,
    "detail" "text" NOT NULL,
    "priority" "text" DEFAULT 'medium'::"text" NOT NULL,
    "entity_type" "text",
    "entity_id" "text",
    "status" "text" DEFAULT 'open'::"text" NOT NULL,
    "snoozed_until" timestamp with time zone,
    "idempotency_key" "text" NOT NULL,
    "metadata" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "life_arc_autopilot_suggestions_priority_chk" CHECK (("priority" = ANY (ARRAY['low'::"text", 'medium'::"text", 'high'::"text"]))),
    CONSTRAINT "life_arc_autopilot_suggestions_status_chk" CHECK (("status" = ANY (ARRAY['open'::"text", 'dismissed'::"text", 'snoozed'::"text", 'accepted'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_life_arc_autopilot_suggestions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."life_arc_autopilot_suggestions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."life_arc_checkpoints" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "arc_id" "uuid" NOT NULL,
    "date" "date" DEFAULT "now"() NOT NULL,
    "summary" "text",
    "progress_score" integer,
    "risk_flags" "text"[],
    "metadata" "jsonb" DEFAULT '{}'::"jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."life_arc_checkpoints" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."life_arc_daily_focus" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "focus_date" "date" NOT NULL,
    "arc_id" "uuid" NOT NULL,
    "quest_id" "uuid",
    "autopilot_action_id" "uuid",
    "status" "text" DEFAULT 'planned'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_life_arc_daily_focus" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."life_arc_daily_focus" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."life_arc_objectives" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "arc_id" "uuid" NOT NULL,
    "week_start_date" "date" NOT NULL,
    "summary" "text" NOT NULL,
    "target_quests" integer DEFAULT 0,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_life_arc_objectives" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."life_arc_objectives" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."life_arc_quests" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "arc_id" "uuid" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "status" "text" DEFAULT 'open'::"text" NOT NULL,
    "due_date" "date",
    "difficulty" integer DEFAULT 1,
    "impact" integer DEFAULT 1,
    "source_hint" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."life_arc_quests" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."life_arc_risk_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "arc_id" "uuid" NOT NULL,
    "risk_type" "text" NOT NULL,
    "severity" integer DEFAULT 1 NOT NULL,
    "description" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_life_arc_risk_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."life_arc_risk_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."life_arc_sources" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "arc_id" "uuid" NOT NULL,
    "source_type" "text" NOT NULL,
    "source_id" "uuid",
    "weight" numeric(4,2) DEFAULT 1.0,
    "metadata" "jsonb" DEFAULT '{}'::"jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."life_arc_sources" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."life_arcs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "priority" integer DEFAULT 1 NOT NULL,
    "start_date" "date" DEFAULT "now"(),
    "target_date" "date",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_life_arcs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."life_arcs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."life_canon_entries" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "arc_id" "uuid",
    "session_id" "uuid",
    "title" "text" NOT NULL,
    "entry_type" "text" DEFAULT 'mythic'::"text" NOT NULL,
    "content" "text" NOT NULL,
    "tags" "text"[] DEFAULT '{}'::"text"[] NOT NULL,
    "metadata" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_life_canon_entries" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."life_canon_entries" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."life_canon_snapshots" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "snapshot_time" timestamp with time zone DEFAULT "now"(),
    "active_chapter" "jsonb",
    "recent_events" "jsonb",
    "active_themes" "jsonb",
    "narrative_summary" "text",
    "predicted_next_chapter" "jsonb",
    "upcoming_turning_points" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_life_canon_snapshots" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."life_canon_snapshots" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."life_chapters" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "chapter_index" integer NOT NULL,
    "title" "text" NOT NULL,
    "tagline" "text",
    "start_date" "date" NOT NULL,
    "end_date" "date",
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "dominant_themes" "text"[],
    "primary_roles" "text"[],
    "emotional_tone" "jsonb",
    "summary" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_life_chapters" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."life_chapters" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."life_domains" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "key" "text" NOT NULL,
    "label" "text" NOT NULL,
    "weight" integer DEFAULT 1,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "life_domains_weight_check" CHECK ((("weight" >= 1) AND ("weight" <= 5))),
    CONSTRAINT "pulse_user_id_text_only_life_domains" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."life_domains" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."life_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "occurred_at" timestamp with time zone NOT NULL,
    "kind" "text" NOT NULL,
    "source" "text" NOT NULL,
    "ref_type" "text",
    "ref_id" "text",
    "title" "text" NOT NULL,
    "summary" "text",
    "impact" numeric DEFAULT 0.5 NOT NULL,
    "emotional_valence" numeric,
    "tags" "text"[],
    "chapter_id" "uuid",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_life_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."life_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."life_evidence" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "life_event_id" "uuid",
    "evidence_type" "text" NOT NULL,
    "evidence_payload" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "confidence" numeric(5,4) DEFAULT 1.0000 NOT NULL,
    "source" "text" DEFAULT 'ui'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "trace_id" "uuid",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_life_evidence" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."life_evidence" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."life_themes" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "domain" "text"[],
    "first_appeared_at" "date",
    "last_active_at" "date",
    "strength" numeric,
    "example_event_ids" "uuid"[],
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_life_themes" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."life_themes" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."long_chapters" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "chapter_title" "text" NOT NULL,
    "start_date" "date" NOT NULL,
    "end_date" "date",
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "primary_focus" "text",
    "themes" "text"[] DEFAULT '{}'::"text"[],
    "challenges" "text"[] DEFAULT '{}'::"text"[],
    "achievements" "text"[] DEFAULT '{}'::"text"[],
    "avg_wellbeing" numeric,
    "growth_areas" "text"[] DEFAULT '{}'::"text"[],
    "key_relationships" "text"[] DEFAULT '{}'::"text"[],
    "opening_summary" "text",
    "closing_summary" "text",
    "lessons_learned" "text"[] DEFAULT '{}'::"text"[],
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_long_chapters" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."long_chapters" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."long_milestones" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "milestone_type" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "occurred_at" "date" NOT NULL,
    "significance_score" numeric DEFAULT 0.5 NOT NULL,
    "life_areas_affected" "text"[] DEFAULT '{}'::"text"[],
    "emotional_impact" "text",
    "long_term_effects" "text",
    "chapter_id" "uuid",
    "related_entity_ids" "uuid"[] DEFAULT '{}'::"uuid"[],
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_long_milestones" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."long_milestones" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."long_predictions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "prediction_type" "text" NOT NULL,
    "metric_name" "text",
    "description" "text" NOT NULL,
    "predicted_date" "date",
    "confidence" numeric NOT NULL,
    "current_value" numeric,
    "predicted_value" numeric,
    "basis" "text",
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "actual_value" numeric,
    "outcome_notes" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "resolved_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_long_predictions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."long_predictions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."long_snapshots" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "snapshot_type" "text" NOT NULL,
    "period_start" "date" NOT NULL,
    "period_end" "date" NOT NULL,
    "avg_emotional_valence" numeric,
    "emotional_volatility" numeric,
    "dominant_emotions" "text"[] DEFAULT '{}'::"text"[],
    "tasks_completed" integer DEFAULT 0,
    "goals_achieved" integer DEFAULT 0,
    "avg_productivity_score" numeric,
    "active_values" "text"[] DEFAULT '{}'::"text"[],
    "active_roles" "text"[] DEFAULT '{}'::"text"[],
    "strengths_demonstrated" "text"[] DEFAULT '{}'::"text"[],
    "avg_energy_level" numeric,
    "energy_pattern" "jsonb",
    "active_relationships" integer DEFAULT 0,
    "interaction_count" integer DEFAULT 0,
    "insights_generated" integer DEFAULT 0,
    "patterns_identified" integer DEFAULT 0,
    "commitments_kept_rate" numeric,
    "metrics_data" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "narrative_summary" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_long_snapshots" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."long_snapshots" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."long_trajectories" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "attribute_name" "text" NOT NULL,
    "category" "text",
    "current_level" numeric NOT NULL,
    "target_level" numeric,
    "history" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "growth_rate" numeric,
    "time_to_target" integer,
    "blockers" "text"[] DEFAULT '{}'::"text"[],
    "accelerators" "text"[] DEFAULT '{}'::"text"[],
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_long_trajectories" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."long_trajectories" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."long_trends" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "trend_type" "text" NOT NULL,
    "metric_name" "text" NOT NULL,
    "description" "text" NOT NULL,
    "confidence" numeric NOT NULL,
    "start_date" "date",
    "data_points" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "slope" numeric,
    "seasonality" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_long_trends" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."long_trends" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mc_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "event_type" "text" NOT NULL,
    "event_data" "jsonb" DEFAULT '{}'::"jsonb",
    "source" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mc_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mc_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mc_interventions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "intervention_type" "text" NOT NULL,
    "trigger_type" "text",
    "trigger_data" "jsonb" DEFAULT '{}'::"jsonb",
    "message" "text",
    "suggested_actions" "jsonb" DEFAULT '[]'::"jsonb",
    "urgency" "text" DEFAULT 'medium'::"text",
    "status" "text" DEFAULT 'pending'::"text",
    "outcome" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "acted_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mc_interventions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mc_interventions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mc_strategy_profiles" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "nudge_frequency" "text" DEFAULT 'normal'::"text",
    "allowed_interventions" "text"[] DEFAULT ARRAY['gentle_nudge'::"text", 'micro_plan'::"text", 'focus_session_invite'::"text"],
    "disallowed_interventions" "text"[] DEFAULT ARRAY[]::"text"[],
    "quiet_hours_start" time without time zone,
    "quiet_hours_end" time without time zone,
    "preferred_channels" "text"[] DEFAULT ARRAY['in_app'::"text"],
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mc_strategy_profiles" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mc_strategy_profiles" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mem_archives" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "compression_id" "uuid",
    "original_fragments" "jsonb" NOT NULL,
    "archived_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mem_archives" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mem_archives" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mem_compressed" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "compression_type" "text" NOT NULL,
    "time_period_start" timestamp with time zone,
    "time_period_end" timestamp with time zone,
    "topic" "text",
    "entity_id" "uuid",
    "summary" "text" NOT NULL,
    "key_facts" "text"[] DEFAULT '{}'::"text"[],
    "emotional_tone" "text",
    "importance_score" numeric DEFAULT 0.5 NOT NULL,
    "source_fragment_count" integer NOT NULL,
    "source_fragment_ids" "uuid"[] DEFAULT '{}'::"uuid"[],
    "embedding" "public"."vector"(1536),
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mem_compressed" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mem_compressed" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mem_compression_jobs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "job_type" "text" NOT NULL,
    "compression_type" "text" NOT NULL,
    "status" "text" DEFAULT 'pending'::"text" NOT NULL,
    "fragments_processed" integer DEFAULT 0,
    "compressions_created" integer DEFAULT 0,
    "started_at" timestamp with time zone,
    "completed_at" timestamp with time zone,
    "error_message" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mem_compression_jobs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mem_compression_jobs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mem_compression_settings" (
    "user_id" "text" NOT NULL,
    "auto_compress_enabled" boolean DEFAULT true NOT NULL,
    "daily_compress_after_days" integer DEFAULT 7 NOT NULL,
    "weekly_compress_after_days" integer DEFAULT 30 NOT NULL,
    "monthly_compress_after_days" integer DEFAULT 90 NOT NULL,
    "min_fragments_for_compression" integer DEFAULT 5 NOT NULL,
    "preserve_high_importance" boolean DEFAULT true NOT NULL,
    "importance_threshold" numeric DEFAULT 0.8 NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mem_compression_settings" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mem_compression_settings" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."memories" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "type" "text" NOT NULL,
    "category" "text" NOT NULL,
    "content" "text" NOT NULL,
    "context" "text",
    "importance" integer DEFAULT 5,
    "embedding" "public"."vector"(1536),
    "tags" "text"[] DEFAULT '{}'::"text"[],
    "source" "text",
    "source_id" "text",
    "expires_at" timestamp with time zone,
    "access_count" integer DEFAULT 0,
    "last_accessed_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "memories_importance_check" CHECK ((("importance" >= 1) AND ("importance" <= 10))),
    CONSTRAINT "memories_type_check" CHECK (("type" = ANY (ARRAY['fact'::"text", 'preference'::"text", 'pattern'::"text", 'insight'::"text", 'decision'::"text", 'goal'::"text", 'relationship'::"text", 'event'::"text", 'feedback'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_memories" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."memories" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."memory_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "node_id" "uuid",
    "context_id" "uuid",
    "source" "text" NOT NULL,
    "action" "text" NOT NULL,
    "weight" numeric(4,2) DEFAULT 1.0,
    "occurred_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_memory_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."memory_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."memory_patterns" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "pattern_type" "text" NOT NULL,
    "description" "text" NOT NULL,
    "frequency" integer DEFAULT 1,
    "confidence" double precision DEFAULT 0.5,
    "last_occurred" timestamp with time zone NOT NULL,
    "data" "jsonb" DEFAULT '{}'::"jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_memory_patterns" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."memory_patterns" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mind_models" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "entity_type" "text" NOT NULL,
    "entity_id" "text" NOT NULL,
    "last_refreshed_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "summary" "text",
    "cognitive_style" "jsonb",
    "emotional_pattern" "jsonb",
    "conflict_pattern" "jsonb",
    "trust_model" "jsonb",
    "perception_of_user" "jsonb",
    "typical_reactions" "jsonb",
    "constraints" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mind_models" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mind_models" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."motor_routine_metrics" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "routine_id" "uuid" NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "executions_total" integer DEFAULT 0 NOT NULL,
    "executions_success" integer DEFAULT 0 NOT NULL,
    "executions_partial" integer DEFAULT 0 NOT NULL,
    "executions_failed" integer DEFAULT 0 NOT NULL,
    "avg_duration_ms" numeric,
    "avg_steps_executed" numeric,
    "user_feedback" "jsonb",
    "optimization_notes" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_motor_routine_metrics" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."motor_routine_metrics" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."motor_routine_runs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "routine_id" "uuid" NOT NULL,
    "trigger_id" "uuid",
    "started_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "finished_at" timestamp with time zone,
    "status" "text" DEFAULT 'running'::"text" NOT NULL,
    "error_summary" "text",
    "steps_executed" integer DEFAULT 0,
    "steps_total" integer DEFAULT 0,
    "context" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_motor_routine_runs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."motor_routine_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."motor_routine_steps" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "routine_id" "uuid" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "step_index" integer NOT NULL,
    "kind" "text" NOT NULL,
    "label" "text",
    "params" "jsonb",
    "depends_on" integer[],
    "error_policy" "text" DEFAULT 'continue'::"text",
    "retry_config" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_motor_routine_steps" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."motor_routine_steps" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."motor_routine_triggers" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "routine_id" "uuid" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "trigger_type" "text" NOT NULL,
    "schedule" "text",
    "event_filter" "jsonb",
    "state_condition" "jsonb",
    "enabled" boolean DEFAULT true NOT NULL,
    "last_fired_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_motor_routine_triggers" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."motor_routine_triggers" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."motor_routines" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "key" "text",
    "name" "text" NOT NULL,
    "description" "text",
    "domain" "text",
    "category" "text",
    "source" "text",
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "config" "jsonb",
    "last_compiled_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_motor_routines" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."motor_routines" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mythic_achievements" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "archetype_id" "text" NOT NULL,
    "code" "text" NOT NULL,
    "label" "text" NOT NULL,
    "description" "text",
    "meta" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mythic_achievements" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mythic_achievements" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mythic_archetypes" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "kind" "text" NOT NULL,
    "name" "text" NOT NULL,
    "slug" "text" NOT NULL,
    "description" "text",
    "shadow_side" "text",
    "gift_side" "text",
    "triggers" "jsonb",
    "strengths" "jsonb",
    "pitfalls" "jsonb",
    "recommended_strategies" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    CONSTRAINT "mythic_archetypes_kind_check" CHECK (("kind" = ANY (ARRAY['life'::"text", 'deal'::"text", 'power'::"text"])))
);


ALTER TABLE "public"."mythic_archetypes" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mythic_arcs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "title" "text" NOT NULL,
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "current_act" integer DEFAULT 1 NOT NULL,
    "logline" "text",
    "call_to_adventure" "text",
    "refusal" "text",
    "trials" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "allies" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "shadow" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "transformation" "text",
    "identity_claim" "text",
    "open_loops" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mythic_arcs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mythic_arcs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mythic_belt_levels" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "archetype_id" "text" NOT NULL,
    "belt_rank" integer NOT NULL,
    "belt_name" "text" NOT NULL,
    "display_label" "text",
    "required_xp" integer NOT NULL,
    "min_time_days" integer,
    "owner_user_id" "text"
);


ALTER TABLE "public"."mythic_belt_levels" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mythic_belt_progress" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "archetype_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "current_xp" integer DEFAULT 0 NOT NULL,
    "current_belt_rank" integer DEFAULT 1 NOT NULL,
    "last_promotion_at" timestamp with time zone,
    "total_missions_completed" integer DEFAULT 0 NOT NULL,
    "streak_days" integer DEFAULT 0 NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mythic_belt_progress" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mythic_belt_progress" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mythic_coach_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "mode" "text" NOT NULL,
    "source" "text" NOT NULL,
    "life_chapter_id" "uuid",
    "dominant_archetype_id" "uuid",
    "deal_id" "uuid",
    "deal_archetype_run_id" "uuid",
    "input_summary" "text",
    "coach_response" "text",
    "used_playbook_ids" "uuid"[],
    "insights" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mythic_coach_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mythic_coach_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mythic_playbooks" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "archetype_id" "uuid",
    "context" "text" NOT NULL,
    "name" "text" NOT NULL,
    "slug" "text" NOT NULL,
    "description" "text",
    "triggers" "jsonb",
    "actions" "jsonb",
    "example_language" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."mythic_playbooks" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mythic_quests" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "arc_id" "uuid",
    "title" "text" NOT NULL,
    "description" "text",
    "difficulty" integer DEFAULT 2 NOT NULL,
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "linked_task_ids" "uuid"[] DEFAULT '{}'::"uuid"[] NOT NULL,
    "reward_xp" integer DEFAULT 100 NOT NULL,
    "due_date" "date",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "completed_at" timestamp with time zone,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mythic_quests" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mythic_quests" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mythic_rituals" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "arc_id" "uuid",
    "name" "text" NOT NULL,
    "why" "text",
    "cadence" "text" DEFAULT 'daily'::"text" NOT NULL,
    "linked_habit_id" "uuid",
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mythic_rituals" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mythic_rituals" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mythic_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "session_type" "text" NOT NULL,
    "framework" "text" NOT NULL,
    "chapter_id" "uuid",
    "script_generated" "text",
    "ssml" "text",
    "audio_url" "text",
    "insights" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "arc_id" "uuid",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mythic_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mythic_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mythic_training_focus" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "primary_targets" "jsonb",
    "secondary_targets" "jsonb",
    "rationale" "text",
    "linked_chapter_id" "uuid",
    "linked_snapshot_id" "uuid",
    "linked_archetype_snapshot_id" "uuid",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mythic_training_focus" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mythic_training_focus" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mythic_training_missions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "due_date" "date",
    "archetype_id" "text" NOT NULL,
    "plan_id" "uuid",
    "title" "text" NOT NULL,
    "description" "text",
    "cadence" "text" NOT NULL,
    "estimated_effort_minutes" integer,
    "xp_value" integer DEFAULT 10 NOT NULL,
    "tags" "text"[],
    "status" "text" DEFAULT 'pending'::"text" NOT NULL,
    "completed_at" timestamp with time zone,
    "completion_notes" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mythic_training_missions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mythic_training_missions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mythic_training_plans" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "archetype_id" "text" NOT NULL,
    "plan_label" "text" NOT NULL,
    "description" "text",
    "duration_days" integer NOT NULL,
    "intensity" "text" NOT NULL,
    "goals" "jsonb",
    "constraints" "jsonb",
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "progress" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mythic_training_plans" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mythic_training_plans" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mythic_training_reflections" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "period_start" "date" NOT NULL,
    "period_end" "date" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "archetype_id" "text" NOT NULL,
    "self_rating" numeric,
    "coach_rating" numeric,
    "wins" "jsonb",
    "challenges" "jsonb",
    "adjustments" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mythic_training_reflections" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mythic_training_reflections" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."mythic_voice_mappings" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "scope" "text" DEFAULT 'system'::"text" NOT NULL,
    "archetype_id" "text",
    "mode" "text",
    "intensity" "text",
    "voice_profile_id" "uuid" NOT NULL,
    "style_overrides" "jsonb",
    "is_default" boolean DEFAULT false NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_mythic_voice_mappings" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."mythic_voice_mappings" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."narrative_snapshots" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "snapshot_at" timestamp with time zone NOT NULL,
    "scope" "text" DEFAULT 'weekly'::"text" NOT NULL,
    "chapter_id" "uuid",
    "active_theme_keys" "text"[],
    "active_identity_arc_keys" "text"[],
    "tensions" "jsonb",
    "opportunities" "jsonb",
    "narrative_summary" "text",
    "short_logline" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_narrative_snapshots" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."narrative_snapshots" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."notes" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "content" "text" NOT NULL,
    "type" "text" DEFAULT 'note'::"text",
    "processed" boolean DEFAULT false,
    "processed_as" "text",
    "processed_id" "uuid",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "notes_type_check" CHECK (("type" = ANY (ARRAY['note'::"text", 'idea'::"text", 'task'::"text", 'reminder'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_notes" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."notes" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."notification_log" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "type" "text" NOT NULL,
    "title" "text" NOT NULL,
    "body" "text",
    "data" "jsonb" DEFAULT '{}'::"jsonb",
    "status" "text" DEFAULT 'sent'::"text",
    "error_message" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "notification_log_status_check" CHECK (("status" = ANY (ARRAY['sent'::"text", 'delivered'::"text", 'clicked'::"text", 'dismissed'::"text", 'failed'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_notification_log" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."notification_log" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."notification_preferences" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "autonomy_suggestions" boolean DEFAULT true,
    "third_brain_insights" boolean DEFAULT true,
    "delegation_drafts" boolean DEFAULT true,
    "daily_briefing" boolean DEFAULT true,
    "emotional_checkin_reminder" boolean DEFAULT false,
    "quiet_hours_enabled" boolean DEFAULT false,
    "quiet_hours_start" time without time zone DEFAULT '22:00:00'::time without time zone,
    "quiet_hours_end" time without time zone DEFAULT '07:00:00'::time without time zone,
    "max_per_hour" integer DEFAULT 5,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_notification_preferences" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."notification_preferences" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."notification_queue" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "type" "text" NOT NULL,
    "priority" "text" DEFAULT 'normal'::"text",
    "title" "text" NOT NULL,
    "body" "text",
    "data" "jsonb",
    "url" "text",
    "group_key" "text",
    "expires_at" timestamp with time zone,
    "status" "text" DEFAULT 'queued'::"text",
    "sent_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "notification_queue_priority_check" CHECK (("priority" = ANY (ARRAY['low'::"text", 'normal'::"text", 'high'::"text", 'urgent'::"text"]))),
    CONSTRAINT "notification_queue_status_check" CHECK (("status" = ANY (ARRAY['queued'::"text", 'sent'::"text", 'expired'::"text", 'failed'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_notification_queue" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."notification_queue" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."onboarding_conversations" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "messages" "jsonb" DEFAULT '[]'::"jsonb",
    "partial_profile" "jsonb" DEFAULT '{}'::"jsonb",
    "is_complete" boolean DEFAULT false,
    "question_count" integer DEFAULT 0,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_onboarding_conversations" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."onboarding_conversations" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."onboarding_state" (
    "user_id" "text" NOT NULL,
    "step" "text" NOT NULL,
    "data" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_onboarding_state" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."onboarding_state" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."ops_audit_log" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "actor_user_id" "text" NOT NULL,
    "actor_is_admin" boolean DEFAULT false NOT NULL,
    "target_user_id" "text",
    "action" "text" NOT NULL,
    "resource_type" "text",
    "resource_id" "text",
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "ip" "text",
    "user_agent" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."ops_audit_log" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."ops_automation_locks" (
    "key" "text" NOT NULL,
    "enabled" boolean DEFAULT false NOT NULL,
    "reason" "text",
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_by" "text"
);


ALTER TABLE "public"."ops_automation_locks" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."ops_incident_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "incident_id" "uuid",
    "source" "text" NOT NULL,
    "event_type" "text" NOT NULL,
    "level" "text" DEFAULT 'info'::"text" NOT NULL,
    "summary" "text" NOT NULL,
    "link" "text",
    "payload" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL
);


ALTER TABLE "public"."ops_incident_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."ops_incidents" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "status" "text" DEFAULT 'open'::"text" NOT NULL,
    "severity" "text" DEFAULT 'sev2'::"text" NOT NULL,
    "title" "text" NOT NULL,
    "summary" "text",
    "triggering_run_url" "text",
    "rollback_pr_url" "text",
    "resolved_at" timestamp with time zone
);


ALTER TABLE "public"."ops_incidents" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."org_members" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "org_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "role" "text" DEFAULT 'member'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_org_members" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."org_members" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."organizations" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "name" "text" NOT NULL,
    "slug" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."organizations" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."persona_arc_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "persona_id" "uuid" NOT NULL,
    "coach_id" "text",
    "arc_id" "uuid",
    "phase_key" "text",
    "event_type" "text",
    "title" "text",
    "description" "text",
    "created_at" timestamp without time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_persona_arc_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."persona_arc_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."persona_archetype_stats" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "archetype_id" "uuid" NOT NULL,
    "coach_id" "text",
    "sample_size" integer DEFAULT 0 NOT NULL,
    "avg_approval_rate" numeric(5,2) DEFAULT 0,
    "avg_rejection_rate" numeric(5,2) DEFAULT 0,
    "avg_emotional_improvement" numeric(5,2) DEFAULT 0,
    "best_for_traits" "jsonb" DEFAULT '{}'::"jsonb",
    "last_aggregated_at" timestamp without time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."persona_archetype_stats" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."persona_archetypes" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text" NOT NULL,
    "dna_pattern" "jsonb" NOT NULL,
    "tuning_pattern" "jsonb" NOT NULL,
    "typical_motion_profiles" "jsonb" NOT NULL,
    "created_at" timestamp without time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."persona_archetypes" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."persona_companion_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "persona_id" "uuid" NOT NULL,
    "coach_id" "text",
    "event_type" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "tags" "text"[] DEFAULT '{}'::"text"[],
    "emotion_state" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_persona_companion_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."persona_companion_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."persona_companion_highlights" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "persona_id" "uuid" NOT NULL,
    "coach_id" "text",
    "highlight_type" "text" NOT NULL,
    "summary" "text" NOT NULL,
    "importance" integer DEFAULT 1 NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_persona_companion_highlights" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."persona_companion_highlights" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."persona_companion_state" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "persona_id" "uuid" NOT NULL,
    "coach_id" "text",
    "warmth_score" integer DEFAULT 50 NOT NULL,
    "trust_score" integer DEFAULT 50 NOT NULL,
    "familiarity_score" integer DEFAULT 50 NOT NULL,
    "last_interaction_at" timestamp with time zone,
    "total_interactions" integer DEFAULT 0 NOT NULL,
    "bond_level" "text" DEFAULT 'acquaintance'::"text",
    "flags" "text"[] DEFAULT '{}'::"text"[],
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_persona_companion_state" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."persona_companion_state" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."persona_dna_templates" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "archetype" "text" NOT NULL,
    "base_traits" "jsonb" NOT NULL,
    "style_axes" "jsonb" NOT NULL,
    "safety_profile" "jsonb" NOT NULL,
    "default_motion_profile" "jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."persona_dna_templates" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."persona_interaction_stats" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "persona_key" "text" NOT NULL,
    "total_sessions" integer DEFAULT 0,
    "total_messages" integer DEFAULT 0,
    "last_session_at" timestamp with time zone,
    "last_feedback_score" numeric(4,2),
    "avg_feedback_score" numeric(4,2),
    "last_adaptation_reason" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_persona_interaction_stats" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."persona_interaction_stats" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."persona_memory_snapshots" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "persona_key" "text" NOT NULL,
    "snapshot_type" "text" NOT NULL,
    "content" "jsonb" NOT NULL,
    "last_updated_at" timestamp with time zone DEFAULT "now"(),
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_persona_memory_snapshots" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."persona_memory_snapshots" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."persona_microstyle_prefs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "persona_id" "uuid" NOT NULL,
    "coach_id" "text",
    "nickname" "text",
    "preferred_address" "text",
    "forbidden_phrases" "text"[] DEFAULT '{}'::"text"[],
    "favorite_phrases" "text"[] DEFAULT '{}'::"text"[],
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_persona_microstyle_prefs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."persona_microstyle_prefs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."persona_style_variants" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "persona_key" "text" NOT NULL,
    "variant_key" "text" NOT NULL,
    "label" "text" NOT NULL,
    "description" "text",
    "trait_overrides" "jsonb" NOT NULL,
    "motion_overrides" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."persona_style_variants" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."persona_user_arc" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "persona_id" "uuid" NOT NULL,
    "coach_id" "text",
    "current_phase_key" "text",
    "phase_started_at" timestamp without time zone DEFAULT "now"(),
    "arc_started_at" timestamp without time zone DEFAULT "now"(),
    "projected_next_phase_key" "text",
    "projected_next_phase_date" "date",
    "long_term_theme" "text",
    "long_term_goal" "jsonb",
    "last_updated_at" timestamp without time zone DEFAULT "now"(),
    "metadata" "jsonb" DEFAULT '{}'::"jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_persona_user_arc" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."persona_user_arc" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."personal_heuristics" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "key" "text" NOT NULL,
    "description" "text" NOT NULL,
    "domain" "text",
    "rule" "jsonb",
    "strength" numeric DEFAULT 0.5 NOT NULL,
    "last_used_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_personal_heuristics" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."personal_heuristics" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."personas" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "tone" "text" DEFAULT 'professional'::"text",
    "verbosity" "text" DEFAULT 'balanced'::"text",
    "traits" "text"[] DEFAULT '{}'::"text"[],
    "system_prompt" "text" NOT NULL,
    "context" "text",
    "is_default" boolean DEFAULT false,
    "is_active" boolean DEFAULT false,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "personas_tone_check" CHECK (("tone" = ANY (ARRAY['formal'::"text", 'casual'::"text", 'friendly'::"text", 'professional'::"text", 'motivational'::"text"]))),
    CONSTRAINT "personas_verbosity_check" CHECK (("verbosity" = ANY (ARRAY['concise'::"text", 'balanced'::"text", 'detailed'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_personas" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."personas" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."philosophy_exercises" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "lesson_id" "uuid" NOT NULL,
    "key" "text" NOT NULL,
    "prompt_md" "text" NOT NULL,
    "type" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."philosophy_exercises" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."philosophy_lessons" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "school_key" "text" NOT NULL,
    "key" "text" NOT NULL,
    "title" "text" NOT NULL,
    "content_md" "text" NOT NULL,
    "difficulty" integer DEFAULT 1 NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."philosophy_lessons" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."philosophy_schools" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."philosophy_schools" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."plan_items" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "day_plan_id" "uuid" NOT NULL,
    "type" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "status" "text" DEFAULT 'planned'::"text",
    "scheduled_for" timestamp with time zone,
    "priority" integer DEFAULT 2,
    "source" "text",
    "source_id" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "plan_items_priority_check" CHECK ((("priority" >= 1) AND ("priority" <= 3))),
    CONSTRAINT "plan_items_status_check" CHECK (("status" = ANY (ARRAY['planned'::"text", 'in_progress'::"text", 'completed'::"text", 'skipped'::"text"]))),
    CONSTRAINT "plan_items_type_check" CHECK (("type" = ANY (ARRAY['task'::"text", 'block'::"text", 'relationship'::"text", 'health'::"text", 'reflection'::"text"]))),
    CONSTRAINT "pulse_user_id_text_only_plan_items" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."plan_items" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."planning_constraints" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "session_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "kind" "text" NOT NULL,
    "label" "text" NOT NULL,
    "description" "text",
    "payload" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_planning_constraints" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."planning_constraints" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."planning_decisions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "session_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "decision_kind" "text" NOT NULL,
    "target_type" "text" NOT NULL,
    "target_id" "text",
    "priority" numeric,
    "rationale" "text",
    "applied" boolean DEFAULT false NOT NULL,
    "applied_at" timestamp with time zone,
    "applied_result" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_planning_decisions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."planning_decisions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."planning_overrides" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "session_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "target_type" "text" NOT NULL,
    "target_id" "text",
    "change_kind" "text" NOT NULL,
    "before_state" "jsonb",
    "after_state" "jsonb",
    "notes" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_planning_overrides" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."planning_overrides" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."planning_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "kind" "text" NOT NULL,
    "trigger_source" "text",
    "context" "jsonb",
    "summary" "text",
    "alignment_score" numeric,
    "stress_budget" numeric,
    "energy_budget" numeric,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_planning_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."planning_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."plugin_api_keys" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "name" "text" NOT NULL,
    "key_hash" "text" NOT NULL,
    "key_prefix" "text" NOT NULL,
    "scopes" "text"[] DEFAULT '{}'::"text"[] NOT NULL,
    "rate_limit" integer DEFAULT 1000 NOT NULL,
    "is_active" boolean DEFAULT true NOT NULL,
    "last_used_at" timestamp with time zone,
    "usage_count" integer DEFAULT 0 NOT NULL,
    "expires_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_plugin_api_keys" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."plugin_api_keys" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."plugin_automations" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "trigger_plugin_id" "uuid",
    "trigger_event" "text" NOT NULL,
    "trigger_conditions" "jsonb" DEFAULT '{}'::"jsonb",
    "action_plugin_id" "uuid",
    "action_type" "text" NOT NULL,
    "action_config" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "is_active" boolean DEFAULT true NOT NULL,
    "last_triggered_at" timestamp with time zone,
    "trigger_count" integer DEFAULT 0 NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_plugin_automations" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."plugin_automations" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."plugin_data" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_plugin_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "data_key" "text" NOT NULL,
    "data_value" "jsonb" NOT NULL,
    "expires_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_plugin_data" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."plugin_data" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."plugin_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_plugin_id" "uuid",
    "user_id" "text" NOT NULL,
    "plugin_slug" "text" NOT NULL,
    "event_type" "text" NOT NULL,
    "event_name" "text" NOT NULL,
    "input_data" "jsonb",
    "output_data" "jsonb",
    "error_message" "text",
    "duration_ms" integer,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_plugin_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."plugin_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."plugin_webhooks" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_plugin_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "webhook_url" "text" NOT NULL,
    "secret_hash" "text" NOT NULL,
    "events" "text"[] NOT NULL,
    "is_active" boolean DEFAULT true NOT NULL,
    "last_triggered_at" timestamp with time zone,
    "failure_count" integer DEFAULT 0 NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_plugin_webhooks" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."plugin_webhooks" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."plugins" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "slug" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "version" "text" DEFAULT '1.0.0'::"text" NOT NULL,
    "author" "text",
    "author_url" "text",
    "icon_url" "text",
    "plugin_type" "text" NOT NULL,
    "capabilities" "text"[] DEFAULT '{}'::"text"[],
    "config_schema" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "is_official" boolean DEFAULT false NOT NULL,
    "is_public" boolean DEFAULT true NOT NULL,
    "downloads" integer DEFAULT 0 NOT NULL,
    "rating" numeric,
    "rating_count" integer DEFAULT 0 NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."plugins" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."prefrontal_goals" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "scope" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "priority" integer DEFAULT 3 NOT NULL,
    "target_date" "date",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_prefrontal_goals" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."prefrontal_goals" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."presence_daily_summaries" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "summary_date" "date" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "events_generated" integer DEFAULT 0 NOT NULL,
    "events_surfaced" integer DEFAULT 0 NOT NULL,
    "notifications_sent" integer DEFAULT 0 NOT NULL,
    "emails_sent" integer DEFAULT 0 NOT NULL,
    "user_ack_liked" integer DEFAULT 0 NOT NULL,
    "user_ack_dismissed" integer DEFAULT 0 NOT NULL,
    "user_ack_acted" integer DEFAULT 0 NOT NULL,
    "user_ack_snoozed" integer DEFAULT 0 NOT NULL,
    "presence_level_effective" numeric,
    "notes" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_presence_daily_summaries" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."presence_daily_summaries" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."presence_decisions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "presence_event_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "decision" "text" NOT NULL,
    "chosen_channel" "text",
    "scheduled_for" timestamp with time zone,
    "rationale" "jsonb",
    "state_snapshot" "jsonb",
    "executed" boolean DEFAULT false NOT NULL,
    "executed_at" timestamp with time zone,
    "execution_error" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_presence_decisions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."presence_decisions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."presence_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "source" "text" NOT NULL,
    "origin_id" "text",
    "kind" "text" NOT NULL,
    "title" "text" NOT NULL,
    "body" "text" NOT NULL,
    "importance" numeric NOT NULL,
    "urgency" numeric NOT NULL,
    "domain" "text",
    "suggested_channel" "text",
    "suggested_time_window" "jsonb",
    "context" "jsonb",
    "consumed" boolean DEFAULT false NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_presence_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."presence_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."proactive_interventions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "type" "text" NOT NULL,
    "priority" "text" NOT NULL,
    "title" "text" NOT NULL,
    "message" "text" NOT NULL,
    "action_type" "text",
    "action_data" "jsonb" DEFAULT '{}'::"jsonb",
    "trigger_reason" "text",
    "status" "text" DEFAULT 'pending'::"text",
    "expires_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "acted_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_proactive_interventions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."proactive_interventions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."profiles" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "clerk_user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"()
);


ALTER TABLE "public"."profiles" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."pulse_brain_preferences" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "presence_level" numeric DEFAULT 0.5 NOT NULL,
    "proactivity_level" numeric DEFAULT 0.5 NOT NULL,
    "emotional_intensity" numeric DEFAULT 0.5 NOT NULL,
    "depth_of_reflection" numeric DEFAULT 0.5 NOT NULL,
    "privacy_sensitivity" numeric DEFAULT 0.8 NOT NULL,
    "allow_autonomous_tweaks" boolean DEFAULT true NOT NULL,
    "allow_relationship_feedback" boolean DEFAULT true NOT NULL,
    "allow_financial_nudges" boolean DEFAULT false NOT NULL,
    "allow_health_nudges" boolean DEFAULT true NOT NULL,
    "preferred_voice_profile" "text",
    "preferred_persona_style" "text",
    "ui_mode" "text" DEFAULT 'standard'::"text" NOT NULL,
    "notes" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_pulse_brain_preferences" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."pulse_brain_preferences" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."pulse_brain_surface_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "source" "text" NOT NULL,
    "origin_id" "text",
    "category" "text" NOT NULL,
    "title" "text" NOT NULL,
    "body" "text" NOT NULL,
    "importance" numeric NOT NULL,
    "emotional_tone" "text",
    "delivery_channel" "text" NOT NULL,
    "delivery_context" "jsonb",
    "dismissed" boolean DEFAULT false NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_pulse_brain_surface_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."pulse_brain_surface_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."pulse_docs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "category" "text" NOT NULL,
    "slug" "text" NOT NULL,
    "title" "text" NOT NULL,
    "content_md" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."pulse_docs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."pulse_insight_acknowledgements" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "surface_event_id" "uuid",
    "reaction" "text" NOT NULL,
    "notes" "text",
    "followup_preferences" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_pulse_insight_acknowledgements" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."pulse_insight_acknowledgements" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."pulse_introduction_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "completed_at" timestamp with time zone,
    "version" "text" DEFAULT 'v1'::"text" NOT NULL,
    "status" "text" DEFAULT 'in_progress'::"text" NOT NULL,
    "steps_completed" "jsonb",
    "initial_brain_summary" "jsonb",
    "initial_preferences" "jsonb",
    "narrative_intro" "text",
    "user_reaction" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_pulse_introduction_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."pulse_introduction_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."push_subscriptions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "endpoint" "text" NOT NULL,
    "p256dh" "text" NOT NULL,
    "auth" "text" NOT NULL,
    "user_agent" "text",
    "device_name" "text",
    "enabled" boolean DEFAULT true,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "last_used_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_push_subscriptions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."push_subscriptions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."quest_catalog" (
    "quest_key" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text" NOT NULL,
    "base_target" integer DEFAULT 1 NOT NULL,
    "base_reward_xp" integer DEFAULT 25 NOT NULL,
    "tags" "text"[] DEFAULT '{}'::"text"[] NOT NULL,
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "is_active" boolean DEFAULT true NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."quest_catalog" OWNER TO "postgres";


COMMENT ON TABLE "public"."quest_catalog" IS 'Quest templates used by personalized daily quest generator.';



COMMENT ON COLUMN "public"."quest_catalog"."quest_key" IS 'Stable quest identifier used in daily_quests.quest_key.';



CREATE TABLE IF NOT EXISTS "public"."quest_completions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "quest_id" "text" NOT NULL,
    "quest_type" "text" NOT NULL,
    "quest_title" "text",
    "difficulty" "text" DEFAULT 'medium'::"text",
    "xp_earned" integer DEFAULT 0,
    "completed_at" timestamp with time zone DEFAULT "now"(),
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_quest_completions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."quest_completions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."referral_rewards" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "referrer_user_id" "text" NOT NULL,
    "referred_user_id" "text" NOT NULL,
    "reward_type" "text" DEFAULT 'signup'::"text",
    "reward_cents" integer DEFAULT 0,
    "status" "text" DEFAULT 'pending'::"text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "credited_at" timestamp with time zone,
    "owner_user_id" "text",
    CONSTRAINT "referral_rewards_status_check" CHECK (("status" = ANY (ARRAY['pending'::"text", 'credited'::"text", 'expired'::"text"])))
);


ALTER TABLE "public"."referral_rewards" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."relational_identities" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "contact_id" "uuid",
    "external_ref" "text",
    "display_name" "text" NOT NULL,
    "role" "text",
    "domain" "text",
    "importance" numeric DEFAULT 0.5 NOT NULL,
    "closeness" numeric DEFAULT 0.5 NOT NULL,
    "influence" numeric DEFAULT 0.5 NOT NULL,
    "core_traits" "jsonb",
    "values_profile" "jsonb",
    "preferences" "jsonb",
    "sensitivities" "jsonb",
    "motivations" "jsonb",
    "model_confidence" numeric DEFAULT 0.5 NOT NULL,
    "last_interaction_at" timestamp with time zone,
    "last_model_update_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_relational_identities" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."relational_identities" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."relational_predictions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "relational_identity_id" "uuid" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "context" "jsonb",
    "horizon" "text",
    "predicted_reaction" "jsonb",
    "predicted_effect_on_relationship" "jsonb",
    "confidence" numeric,
    "recommendation" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_relational_predictions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."relational_predictions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."relational_state_snapshots" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "relational_identity_id" "uuid" NOT NULL,
    "snapshot_time" timestamp with time zone DEFAULT "now"() NOT NULL,
    "relationship_health" numeric,
    "trust_level" numeric,
    "tension_level" numeric,
    "connection_frequency" numeric,
    "reciprocity_score" numeric,
    "current_mode" "text",
    "recent_events" "jsonb",
    "perceived_other_state" "jsonb",
    "risk_flags" "jsonb",
    "opportunity_flags" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_relational_state_snapshots" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."relational_state_snapshots" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."relationship_highlights" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "relational_identity_id" "uuid",
    "kind" "text" NOT NULL,
    "label" "text" NOT NULL,
    "description" "text" NOT NULL,
    "importance" numeric NOT NULL,
    "suggested_action" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_relationship_highlights" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."relationship_highlights" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."relationship_interactions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "relationship_id" "uuid",
    "type" "text" NOT NULL,
    "direction" "text" NOT NULL,
    "subject" "text",
    "summary" "text",
    "sentiment" "text" DEFAULT 'neutral'::"text",
    "occurred_at" timestamp with time zone NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_relationship_interactions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text")),
    CONSTRAINT "relationship_interactions_direction_check" CHECK (("direction" = ANY (ARRAY['inbound'::"text", 'outbound'::"text"]))),
    CONSTRAINT "relationship_interactions_sentiment_check" CHECK (("sentiment" = ANY (ARRAY['positive'::"text", 'neutral'::"text", 'negative'::"text"]))),
    CONSTRAINT "relationship_interactions_type_check" CHECK (("type" = ANY (ARRAY['email'::"text", 'call'::"text", 'meeting'::"text", 'message'::"text", 'note'::"text"])))
);


ALTER TABLE "public"."relationship_interactions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."relationships" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "contact_id" "uuid",
    "name" "text" NOT NULL,
    "email" "text",
    "phone" "text",
    "company" "text",
    "role" "text",
    "relationship" "text" DEFAULT 'personal'::"text",
    "importance" "text" DEFAULT 'normal'::"text",
    "health_score" integer DEFAULT 75,
    "last_contact_at" timestamp with time zone,
    "next_followup_at" timestamp with time zone,
    "followup_cadence_days" integer DEFAULT 30,
    "interaction_count" integer DEFAULT 0,
    "notes" "text",
    "tags" "text"[] DEFAULT '{}'::"text"[],
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_relationships" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text")),
    CONSTRAINT "relationships_health_score_check" CHECK ((("health_score" >= 0) AND ("health_score" <= 100))),
    CONSTRAINT "relationships_importance_check" CHECK (("importance" = ANY (ARRAY['low'::"text", 'normal'::"text", 'key'::"text", 'vip'::"text"]))),
    CONSTRAINT "relationships_relationship_check" CHECK (("relationship" = ANY (ARRAY['colleague'::"text", 'client'::"text", 'prospect'::"text", 'vendor'::"text", 'personal'::"text", 'mentor'::"text", 'mentee'::"text"])))
);


ALTER TABLE "public"."relationships" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."reminder_subscriptions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "title" "text" NOT NULL,
    "body" "text" NOT NULL,
    "severity" "text" DEFAULT 'info'::"text" NOT NULL,
    "source_type" "text" NOT NULL,
    "source_id" "uuid" NOT NULL,
    "kind" "text" NOT NULL,
    "next_run_at" timestamp with time zone NOT NULL,
    "active" boolean DEFAULT true NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "handled_at" timestamp with time zone,
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_reminder_subscriptions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."reminder_subscriptions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."reply_drafts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    "inbox_item_id" "uuid" NOT NULL,
    "subject" "text",
    "body" "text" DEFAULT ''::"text" NOT NULL,
    "status" "text" DEFAULT 'draft'::"text" NOT NULL,
    "meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "to_email" "text",
    "cc" "text",
    "bcc" "text",
    "send_at" timestamp with time zone,
    "outbox_id" "uuid",
    "provider_message_id" "text",
    "last_error" "text",
    CONSTRAINT "reply_drafts_status_chk" CHECK (("status" = ANY (ARRAY['draft'::"text", 'ready'::"text", 'sent'::"text", 'archived'::"text"])))
);


ALTER TABLE "public"."reply_drafts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."response_style_profiles" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "speaking_style" "jsonb",
    "coach_biases" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."response_style_profiles" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."safety_incidents" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text",
    "coach_id" "text",
    "persona_id" "uuid",
    "policy_key" "text",
    "incident_type" "text",
    "category" "text",
    "severity" integer,
    "user_input_excerpt" "text",
    "model_output_excerpt" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "metadata" "jsonb" DEFAULT '{}'::"jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_safety_incidents" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."safety_incidents" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."safety_policies" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "policy_json" "jsonb" NOT NULL,
    "is_active" boolean DEFAULT true,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."safety_policies" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."scheduler_targets" (
    "user_id" "text" NOT NULL,
    "is_enabled" boolean DEFAULT true NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_scheduler_targets" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."scheduler_targets" OWNER TO "postgres";


CREATE OR REPLACE VIEW "public"."schema_identity_violations" AS
 SELECT "table_schema",
    "table_name",
    "column_name",
    "data_type"
   FROM "information_schema"."columns" "c"
  WHERE ((("table_schema")::"name" = 'public'::"name") AND (("column_name")::"name" = 'user_id'::"name") AND (("data_type")::"text" <> 'text'::"text"));


ALTER VIEW "public"."schema_identity_violations" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."self_identity_snapshots" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "taken_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "source" "text" NOT NULL,
    "roles" "jsonb",
    "values" "jsonb",
    "strengths" "jsonb",
    "vulnerabilities" "jsonb",
    "self_story" "text",
    "mythic_archetypes" "jsonb",
    "domain_balance" "jsonb",
    "overall_self_alignment" numeric(4,2),
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_self_identity_snapshots" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."self_identity_snapshots" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."self_mirror_deltas" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "from_snapshot_id" "uuid" NOT NULL,
    "to_snapshot_id" "uuid" NOT NULL,
    "period_start" "date" NOT NULL,
    "period_end" "date" NOT NULL,
    "alignment_change" numeric,
    "drift_change" numeric,
    "self_compassion_change" numeric,
    "identity_shifts" "jsonb",
    "behavior_shifts" "jsonb",
    "emotional_shifts" "jsonb",
    "relational_shifts" "jsonb",
    "somatic_shifts" "jsonb",
    "summary" "text",
    "key_questions" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_self_mirror_deltas" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."self_mirror_deltas" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."self_mirror_facets" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "score" numeric(5,2),
    "trend" "text",
    "last_updated_at" timestamp with time zone DEFAULT "now"(),
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_self_mirror_facets" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."self_mirror_facets" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."self_mirror_highlights" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "snapshot_id" "uuid",
    "delta_id" "uuid",
    "kind" "text" NOT NULL,
    "label" "text" NOT NULL,
    "description" "text" NOT NULL,
    "domain" "text",
    "importance" numeric NOT NULL,
    "suggested_action" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_self_mirror_highlights" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."self_mirror_highlights" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."self_mirror_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "mode" "text" NOT NULL,
    "started_at" timestamp with time zone DEFAULT "now"(),
    "completed_at" timestamp with time zone,
    "snapshot_id" "uuid",
    "script" "text",
    "summary" "text",
    "insights" "jsonb",
    "followup_actions" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_self_mirror_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."self_mirror_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."self_mirror_snapshots" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "snapshot_date" "date" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "identity_state" "jsonb",
    "destiny_state" "jsonb",
    "narrative_state" "jsonb",
    "values_alignment" "jsonb",
    "behavior_profile" "jsonb",
    "emotional_profile" "jsonb",
    "relational_profile" "jsonb",
    "somatic_profile" "jsonb",
    "overall_alignment" numeric,
    "drift_score" numeric,
    "self_compassion_score" numeric,
    "narrative_summary" "text",
    "mirror_insights" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_self_mirror_snapshots" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."self_mirror_snapshots" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."self_perception_signals" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "source" "text" NOT NULL,
    "category" "text" NOT NULL,
    "direction" "text" NOT NULL,
    "weight" numeric(4,2) DEFAULT 1.0,
    "description" "text",
    "occurred_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_self_perception_signals" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."self_perception_signals" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."sim_decision_trees" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "simulation_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "root_decision" "text" NOT NULL,
    "tree_data" "jsonb" NOT NULL,
    "optimal_path" "jsonb",
    "total_branches" integer,
    "max_depth" integer,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_sim_decision_trees" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."sim_decision_trees" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."sim_history" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "simulation_id" "uuid",
    "what_if_id" "uuid",
    "predicted_outcome" "text" NOT NULL,
    "confidence" numeric NOT NULL,
    "predicted_date" "date",
    "actual_outcome" "text",
    "accuracy_score" numeric,
    "lessons_learned" "text",
    "factors_missed" "text"[] DEFAULT '{}'::"text"[],
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "resolved_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_sim_history" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."sim_history" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."sim_runs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "scenario_id" "uuid",
    "user_id" "text" NOT NULL,
    "input_snapshot" "jsonb" DEFAULT '{}'::"jsonb",
    "outcomes" "jsonb" DEFAULT '{}'::"jsonb",
    "insights" "text"[],
    "risks" "text"[],
    "opportunities" "text"[],
    "recommended_actions" "text"[],
    "confidence_score" numeric(3,2) DEFAULT 0.7,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_sim_runs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."sim_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."sim_scenarios" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "simulation_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "scenario_name" "text" NOT NULL,
    "scenario_type" "text" NOT NULL,
    "assumptions" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "decisions" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "projected_outcomes" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "probability" numeric,
    "desirability" numeric,
    "impact_areas" "jsonb" DEFAULT '{}'::"jsonb",
    "risks" "text"[] DEFAULT '{}'::"text"[],
    "opportunities" "text"[] DEFAULT '{}'::"text"[],
    "narrative" "text",
    "key_milestones" "jsonb" DEFAULT '[]'::"jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_sim_scenarios" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."sim_scenarios" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."sim_simulations" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "simulation_type" "text" NOT NULL,
    "status" "text" DEFAULT 'draft'::"text" NOT NULL,
    "base_scenario" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "variables" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "time_horizon" "text",
    "outcomes" "jsonb" DEFAULT '[]'::"jsonb",
    "recommended_path" "text",
    "confidence" numeric,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "completed_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_sim_simulations" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."sim_simulations" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."sim_templates" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "category" "text" NOT NULL,
    "required_inputs" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "variable_definitions" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "outcome_dimensions" "jsonb" DEFAULT '[]'::"jsonb" NOT NULL,
    "analysis_prompt" "text",
    "scenario_prompt" "text",
    "is_public" boolean DEFAULT true NOT NULL,
    "created_by" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."sim_templates" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."sim_what_ifs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "question" "text" NOT NULL,
    "category" "text",
    "key_factors" "text"[] DEFAULT '{}'::"text"[],
    "potential_outcomes" "jsonb" DEFAULT '[]'::"jsonb",
    "risks" "text"[] DEFAULT '{}'::"text"[],
    "benefits" "text"[] DEFAULT '{}'::"text"[],
    "recommendation" "text",
    "was_helpful" boolean,
    "user_notes" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_sim_what_ifs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."sim_what_ifs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."simulation_fix_plans" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "run_id" "uuid" NOT NULL,
    "request_id" "text" NOT NULL,
    "step_id" "text" NOT NULL,
    "step_title" "text",
    "status" "text" DEFAULT 'created'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "generated_at" timestamp with time zone,
    "error" "text",
    "plan_markdown" "text",
    "patch_json" "jsonb",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_simulation_fix_plans" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."simulation_fix_plans" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."simulation_metrics" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "simulation_id" "uuid",
    "label" "text" NOT NULL,
    "value" numeric,
    "day_offset" integer,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."simulation_metrics" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."simulation_models" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "version" "text" DEFAULT 'v2'::"text" NOT NULL,
    "state" "jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_simulation_models" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."simulation_models" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."simulation_outcomes" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "run_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "generated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "comparison_summary" "text",
    "best_timelines" "jsonb",
    "worst_timelines" "jsonb",
    "key_tradeoffs" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_simulation_outcomes" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."simulation_outcomes" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."simulation_policies" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text",
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "domain" "text",
    "policy_spec" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_simulation_policies" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."simulation_policies" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."simulation_runs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "scenario_name" "text" NOT NULL,
    "parameters" "jsonb",
    "output" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_simulation_runs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."simulation_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."simulation_steps" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "timeline_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "step_index" integer NOT NULL,
    "step_date" "date",
    "horizon_label" "text",
    "metrics" "jsonb",
    "events" "jsonb",
    "narrative_snippet" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_simulation_steps" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."simulation_steps" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."simulation_timelines" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "run_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "policy_key" "text" NOT NULL,
    "label" "text",
    "narrative_label" "text",
    "score_overall" numeric,
    "score_work" numeric,
    "score_health" numeric,
    "score_relationships" numeric,
    "score_finance" numeric,
    "score_self_respect" numeric,
    "score_alignment" numeric,
    "score_burnout_risk" numeric,
    "summary" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_simulation_timelines" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."simulation_timelines" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."sms_messages" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text",
    "direction" "text" NOT NULL,
    "from_number" "text" NOT NULL,
    "to_number" "text" NOT NULL,
    "body" "text" NOT NULL,
    "twilio_message_sid" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "deal_id" "uuid",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_sms_messages" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."sms_messages" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."social_edges" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "from_node_type" "text" NOT NULL,
    "from_node_id" "text" NOT NULL,
    "to_node_type" "text" NOT NULL,
    "to_node_id" "text" NOT NULL,
    "relationship_type" "text",
    "strength" numeric,
    "trust" numeric,
    "tension" numeric,
    "drift" numeric,
    "influence" numeric,
    "positivity" numeric,
    "last_updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_social_edges" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."social_edges" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."social_entities" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "source" "text",
    "external_id" "text",
    "kind" "text" NOT NULL,
    "display_name" "text" NOT NULL,
    "role_label" "text",
    "importance" numeric,
    "tags" "text"[],
    "last_interaction_at" timestamp with time zone,
    "interaction_summary" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_social_entities" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."social_entities" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."social_insights" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "generated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "scope" "text" DEFAULT 'snapshot'::"text" NOT NULL,
    "summary" "text",
    "top_relationships" "jsonb",
    "drift_warnings" "jsonb",
    "tension_hotspots" "jsonb",
    "reachout_opportunities" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_social_insights" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."social_insights" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."social_nodes" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "node_type" "text" NOT NULL,
    "node_id" "text" NOT NULL,
    "label" "text",
    "roles" "text"[],
    "importance_score" numeric,
    "last_interaction_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_social_nodes" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."social_nodes" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."social_recommendations" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "recommended_for_date" "date",
    "entity_id" "uuid",
    "edge_id" "uuid",
    "kind" "text" NOT NULL,
    "label" "text" NOT NULL,
    "suggestion" "text" NOT NULL,
    "priority" numeric NOT NULL,
    "domain" "text",
    "status" "text" DEFAULT 'pending'::"text" NOT NULL,
    "completed_at" timestamp with time zone,
    "user_feedback" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_social_recommendations" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."social_recommendations" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."social_risk_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "entity_id" "uuid",
    "edge_id" "uuid",
    "risk_kind" "text" NOT NULL,
    "severity" numeric NOT NULL,
    "timeframe" "text",
    "summary" "text" NOT NULL,
    "context" "jsonb",
    "resolved_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_social_risk_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."social_risk_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."social_state_snapshots" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "snapshot_date" "date" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "overall_health" numeric,
    "overall_tension" numeric,
    "overall_drift" numeric,
    "overall_support" numeric,
    "key_issues" "jsonb",
    "key_opportunities" "jsonb",
    "narrative_summary" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_social_state_snapshots" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."social_state_snapshots" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."somatic_alerts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "occurred_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "metrics_date" "date",
    "kind" "text" NOT NULL,
    "severity" numeric NOT NULL,
    "summary" "text" NOT NULL,
    "recommended_action" "text",
    "context" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_somatic_alerts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."somatic_alerts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."somatic_daily_metrics" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "metrics_date" "date" NOT NULL,
    "total_screen_minutes" integer,
    "night_screen_minutes" integer,
    "unlock_count" integer,
    "notification_count" integer,
    "deep_work_disruptions" integer,
    "focus_app_minutes" integer,
    "social_app_minutes" integer,
    "entertainment_minutes" integer,
    "messaging_minutes" integer,
    "navigation_minutes" integer,
    "sleep_duration_minutes" integer,
    "sleep_efficiency" numeric,
    "sleep_quality_score" numeric,
    "bedtime_local" time without time zone,
    "wake_time_local" time without time zone,
    "resting_heart_rate" numeric,
    "hr_variability" numeric,
    "step_count" integer,
    "activity_minutes" integer,
    "sedentary_minutes" integer,
    "recovery_score" numeric,
    "stimulation_score" numeric,
    "fatigue_score" numeric,
    "stress_load_score" numeric,
    "circadian_alignment" numeric,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_somatic_daily_metrics" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."somatic_daily_metrics" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."somatic_device_settings" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "phone_integration_enabled" boolean DEFAULT false NOT NULL,
    "app_usage_enabled" boolean DEFAULT false NOT NULL,
    "notifications_enabled" boolean DEFAULT false NOT NULL,
    "location_enabled" boolean DEFAULT false NOT NULL,
    "wearable_integration_enabled" boolean DEFAULT false NOT NULL,
    "sleep_data_enabled" boolean DEFAULT false NOT NULL,
    "heart_data_enabled" boolean DEFAULT false NOT NULL,
    "steps_data_enabled" boolean DEFAULT false NOT NULL,
    "last_updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "notes" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_somatic_device_settings" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."somatic_device_settings" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."somatic_patterns" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "last_refreshed_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "chronotype" "text",
    "best_focus_windows" "jsonb",
    "low_energy_windows" "jsonb",
    "social_energy_windows" "jsonb",
    "crash_patterns" "jsonb",
    "stimulation_sensitivity" "jsonb",
    "exercise_effects" "jsonb",
    "caffeine_like_patterns" "jsonb",
    "summary" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_somatic_patterns" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."somatic_patterns" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."somatic_raw_device_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "occurred_at" timestamp with time zone NOT NULL,
    "source" "text" NOT NULL,
    "kind" "text" NOT NULL,
    "metadata" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_somatic_raw_device_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."somatic_raw_device_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."somatic_samples" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "source" "text" NOT NULL,
    "sampled_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "metric" "text" NOT NULL,
    "value_numeric" numeric,
    "value_json" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_somatic_samples" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."somatic_samples" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."somatic_state_daily" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "state_date" "date" NOT NULL,
    "sleep_hours" numeric,
    "sleep_quality" numeric,
    "energy_score" numeric,
    "fatigue_risk" numeric,
    "notes" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_somatic_state_daily" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."somatic_state_daily" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."strategic_conflicts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "conflict_type" "text",
    "description" "text",
    "severity" numeric NOT NULL,
    "involved_goals" "jsonb",
    "subsystem_inputs" "jsonb",
    "recommended_resolutions" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_strategic_conflicts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."strategic_conflicts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."strategic_domains" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "name" "text" NOT NULL,
    "slug" "text" NOT NULL,
    "description" "text",
    "is_active" boolean DEFAULT true NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_strategic_domains" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."strategic_domains" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."strategic_equilibria" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "equilibrium" "jsonb",
    "rationale" "jsonb",
    "predicted_outcomes" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_strategic_equilibria" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."strategic_equilibria" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."strategic_objectives" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "domain_id" "uuid" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "timeframe_start" "date",
    "timeframe_end" "date",
    "priority" integer DEFAULT 3,
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "success_metrics" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_strategic_objectives" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."strategic_objectives" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."strategic_plans" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "objective_id" "uuid" NOT NULL,
    "primary_playbook_id" "uuid",
    "name" "text" NOT NULL,
    "summary" "text",
    "assumptions" "jsonb",
    "risk_register" "jsonb",
    "status" "text" DEFAULT 'draft'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_strategic_plans" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."strategic_plans" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."strategic_playbooks" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "name" "text" NOT NULL,
    "slug" "text" NOT NULL,
    "description" "text",
    "domain_hint" "text",
    "prerequisites" "jsonb",
    "key_moves" "jsonb",
    "risks" "jsonb",
    "metrics" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."strategic_playbooks" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."strategic_review_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "session_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "event_type" "text" NOT NULL,
    "ref_id" "uuid",
    "payload" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_strategic_review_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."strategic_review_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."strategic_state_snapshots" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "snapshot_time" timestamp with time zone DEFAULT "now"() NOT NULL,
    "active_goals" "jsonb",
    "dominant_needs" "jsonb",
    "predicted_risks" "jsonb",
    "opportunities" "jsonb",
    "subsystem_signals" "jsonb",
    "conflicts" "jsonb",
    "chosen_equilibrium" "jsonb",
    "confidence" numeric DEFAULT 0.5 NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_strategic_state_snapshots" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."strategic_state_snapshots" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."strategist_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "completed_at" timestamp with time zone,
    "status" "text" DEFAULT 'in_progress'::"text" NOT NULL,
    "snapshot_id" "uuid",
    "equilibrium_id" "uuid",
    "intro_narrative" "text",
    "key_points" "jsonb",
    "user_reaction" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_strategist_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."strategist_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."strategy_actions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "pillar_id" "uuid" NOT NULL,
    "life_arc_id" "uuid",
    "title" "text" NOT NULL,
    "description" "text",
    "cadence" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."strategy_actions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."strategy_feedback" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "recommendation_id" "uuid",
    "session_id" "uuid",
    "reaction" "text" NOT NULL,
    "notes" "text",
    "prefs_patch" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_strategy_feedback" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."strategy_feedback" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."strategy_paths" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "snapshot_id" "uuid" NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text" NOT NULL,
    "pros" "text" NOT NULL,
    "cons" "text" NOT NULL,
    "risk_level" integer DEFAULT 1 NOT NULL,
    "opportunity_level" integer DEFAULT 1 NOT NULL,
    "score" numeric(4,2) DEFAULT 0.0 NOT NULL,
    "is_selected" boolean DEFAULT false,
    "owner_user_id" "text"
);


ALTER TABLE "public"."strategy_paths" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."strategy_pillars" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "snapshot_id" "uuid" NOT NULL,
    "path_id" "uuid" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "category" "text",
    "priority" integer DEFAULT 1,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."strategy_pillars" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."strategy_recommendations" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "title" "text",
    "description" "text",
    "timescale" "text",
    "priority" numeric,
    "context" "jsonb",
    "recommended_actions" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_strategy_recommendations" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."strategy_recommendations" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."strategy_snapshots" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "horizon_days" integer NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "model" "jsonb" NOT NULL,
    "summary" "text" NOT NULL,
    "chosen_path_key" "text",
    "confidence" numeric(4,2) DEFAULT 0.5,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_strategy_snapshots" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."strategy_snapshots" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."streaks" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "streak_type" "text" NOT NULL,
    "current_count" integer DEFAULT 0,
    "longest_count" integer DEFAULT 0,
    "last_activity_date" "date",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_streaks" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."streaks" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."system_capabilities" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "module_id" "uuid" NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "api_route" "text",
    "config_path" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."system_capabilities" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."system_capability_health" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "capability_id" "uuid" NOT NULL,
    "status" "text" NOT NULL,
    "status_reason" "text",
    "error_count" integer DEFAULT 0,
    "last_error_at" timestamp with time zone,
    "avg_latency_ms" integer,
    "last_check_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."system_capability_health" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."system_changelog" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "module_id" "uuid",
    "tags" "jsonb",
    "experiment_id" "uuid",
    "created_by" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."system_changelog" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."system_diagnostics_findings" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "run_id" "uuid" NOT NULL,
    "severity" "text" NOT NULL,
    "category" "text" NOT NULL,
    "module_id" "uuid",
    "capability_id" "uuid",
    "title" "text" NOT NULL,
    "description" "text",
    "recommendation" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."system_diagnostics_findings" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."system_diagnostics_runs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "run_type" "text" NOT NULL,
    "initiated_by" "text" NOT NULL,
    "status" "text" NOT NULL,
    "summary" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "completed_at" timestamp with time zone,
    "owner_user_id" "text"
);


ALTER TABLE "public"."system_diagnostics_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."system_experiment_runs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "experiment_id" "uuid" NOT NULL,
    "variant" "text" NOT NULL,
    "parameters" "jsonb",
    "metrics_before" "jsonb",
    "metrics_after" "jsonb",
    "result_summary" "text",
    "outcome" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."system_experiment_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."system_experiments" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "name" "text" NOT NULL,
    "hypothesis" "text" NOT NULL,
    "description" "text",
    "idea_ids" "uuid"[],
    "target_metrics" "jsonb",
    "status" "text" DEFAULT 'planned'::"text" NOT NULL,
    "created_by" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "started_at" timestamp with time zone,
    "completed_at" timestamp with time zone,
    "owner_user_id" "text"
);


ALTER TABLE "public"."system_experiments" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."system_improvement_ideas" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "source" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text",
    "module_id" "uuid",
    "capability_id" "uuid",
    "severity" "text",
    "impact_area" "text",
    "effort_estimate" "text",
    "status" "text" DEFAULT 'backlog'::"text" NOT NULL,
    "created_by" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."system_improvement_ideas" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."system_module_health" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "module_id" "uuid" NOT NULL,
    "status" "text" NOT NULL,
    "status_reason" "text",
    "error_count" integer DEFAULT 0,
    "last_error_at" timestamp with time zone,
    "avg_latency_ms" integer,
    "last_check_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."system_module_health" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."system_module_metrics" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "module_id" "uuid" NOT NULL,
    "date" "date" NOT NULL,
    "invocation_count" integer DEFAULT 0,
    "error_count" integer DEFAULT 0,
    "avg_latency_ms" integer,
    "user_touch_count" integer DEFAULT 0,
    "last_invocation_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."system_module_metrics" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."system_modules" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "category" "text" NOT NULL,
    "docs_url" "text",
    "owner" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."system_modules" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."system_user_feedback" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text",
    "module_id" "uuid",
    "capability_id" "uuid",
    "context" "jsonb",
    "rating" integer,
    "comment" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_system_user_feedback" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."system_user_feedback" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."task_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "task_id" "uuid" NOT NULL,
    "user_id" "text",
    "event_type" "text" NOT NULL,
    "note" "text",
    "payload" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_task_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."task_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."tb_chapters" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "title" "text" NOT NULL,
    "summary_md" "text" NOT NULL,
    "period_start" "date" NOT NULL,
    "period_end" "date" NOT NULL,
    "tags" "text"[],
    "key_node_ids" "uuid"[],
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_tb_chapters" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."tb_chapters" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."tb_context_snapshots" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "snapshot_type" "text" NOT NULL,
    "snapshot_date" "date",
    "context_data" "jsonb" NOT NULL,
    "active_entities" "uuid"[] DEFAULT '{}'::"uuid"[],
    "active_goals" "uuid"[] DEFAULT '{}'::"uuid"[],
    "energy_level" numeric,
    "mood" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_tb_context_snapshots" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."tb_context_snapshots" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."tb_edges" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "from_node_id" "uuid" NOT NULL,
    "to_node_id" "uuid" NOT NULL,
    "kind" "text" NOT NULL,
    "weight" numeric,
    "props" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_tb_edges" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."tb_edges" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."tb_embeddings" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "fragment_id" "uuid" NOT NULL,
    "embedding" "public"."vector"(1536),
    "model" "text" DEFAULT 'text-embedding-3-small'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_tb_embeddings" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."tb_embeddings" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."tb_entities" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "entity_type" "text" NOT NULL,
    "name" "text" NOT NULL,
    "aliases" "text"[] DEFAULT '{}'::"text"[],
    "canonical_key" "text",
    "description" "text",
    "metadata" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "importance" numeric DEFAULT 5 NOT NULL,
    "first_seen_at" timestamp with time zone,
    "last_seen_at" timestamp with time zone,
    "mention_count" integer DEFAULT 1 NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_tb_entities" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."tb_entities" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."tb_entity_edges" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "from_entity_id" "uuid" NOT NULL,
    "to_entity_id" "uuid" NOT NULL,
    "relation_type" "text" NOT NULL,
    "weight" numeric DEFAULT 0.5 NOT NULL,
    "bidirectional" boolean DEFAULT false NOT NULL,
    "metadata" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "evidence_fragment_ids" "uuid"[] DEFAULT '{}'::"uuid"[],
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_tb_entity_edges" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."tb_entity_edges" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."tb_entity_fragment_links" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "entity_id" "uuid" NOT NULL,
    "fragment_id" "uuid" NOT NULL,
    "relevance" numeric DEFAULT 0.5 NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_tb_entity_fragment_links" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."tb_entity_fragment_links" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."tb_insights" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "category" "text" NOT NULL,
    "subcategory" "text",
    "title" "text" NOT NULL,
    "body" "text" NOT NULL,
    "importance" numeric DEFAULT 5 NOT NULL,
    "confidence" numeric DEFAULT 0.7 NOT NULL,
    "actionable" boolean DEFAULT false NOT NULL,
    "suggested_action" "text",
    "metadata" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "source_fragment_ids" "uuid"[] DEFAULT '{}'::"uuid"[],
    "source_entity_ids" "uuid"[] DEFAULT '{}'::"uuid"[],
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "expires_at" timestamp with time zone,
    "status" "text" DEFAULT 'pending'::"text" NOT NULL,
    "dismissed_at" timestamp with time zone,
    "dismissed_reason" "text",
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_tb_insights" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."tb_insights" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."tb_memory_fragments" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "raw_event_id" "uuid",
    "fragment_type" "text" NOT NULL,
    "content" "text" NOT NULL,
    "metadata" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "importance" numeric DEFAULT 5 NOT NULL,
    "time_scope" "text",
    "occurred_at" timestamp with time zone,
    "expires_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_tb_memory_fragments" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."tb_memory_fragments" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."tb_node_types" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "schema" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."tb_node_types" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."tb_nodes" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "org_id" "uuid",
    "household_id" "uuid",
    "type" "text" NOT NULL,
    "source_table" "text",
    "source_id" "text",
    "props" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "started_at" timestamp with time zone,
    "ended_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_tb_nodes" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."tb_nodes" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."tb_raw_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "source" "text" NOT NULL,
    "source_id" "text",
    "occurred_at" timestamp with time zone NOT NULL,
    "payload" "jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "processed" boolean DEFAULT false NOT NULL,
    "processing_error" "text",
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_tb_raw_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."tb_raw_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."tb_user_patterns" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "pattern_type" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text" NOT NULL,
    "confidence" numeric DEFAULT 0.5 NOT NULL,
    "evidence_count" integer DEFAULT 1 NOT NULL,
    "metadata" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "first_observed_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "last_observed_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_tb_user_patterns" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."tb_user_patterns" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."teachings" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "type" "text" NOT NULL,
    "category" "text" NOT NULL,
    "trigger" "text",
    "instruction" "text" NOT NULL,
    "examples" "jsonb" DEFAULT '[]'::"jsonb",
    "priority" integer DEFAULT 5,
    "is_active" boolean DEFAULT true,
    "usage_count" integer DEFAULT 0,
    "last_used_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_teachings" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text")),
    CONSTRAINT "teachings_priority_check" CHECK ((("priority" >= 1) AND ("priority" <= 10))),
    CONSTRAINT "teachings_type_check" CHECK (("type" = ANY (ARRAY['preference'::"text", 'correction'::"text", 'shortcut'::"text", 'rule'::"text", 'context'::"text", 'persona'::"text", 'template'::"text"])))
);


ALTER TABLE "public"."teachings" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."theory_of_mind_profiles" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "entity_id" "uuid" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "core_traits" "jsonb",
    "motivational_drivers" "jsonb",
    "stress_triggers" "jsonb",
    "soothing_patterns" "jsonb",
    "conflict_patterns" "jsonb",
    "communication_style" "jsonb",
    "current_state_hypothesis" "jsonb",
    "summary" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_theory_of_mind_profiles" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."theory_of_mind_profiles" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."third_brain_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "type" "text" NOT NULL,
    "source" "text" NOT NULL,
    "title" "text",
    "summary" "text",
    "raw_payload" "jsonb" DEFAULT '{}'::"jsonb",
    "occurred_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_third_brain_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."third_brain_events" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."third_brain_insights" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "kind" "text" NOT NULL,
    "title" "text" NOT NULL,
    "description" "text" NOT NULL,
    "related_key" "text",
    "severity" integer DEFAULT 1,
    "status" "text" DEFAULT 'open'::"text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "acted_at" timestamp with time zone,
    "expires_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_third_brain_insights" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text")),
    CONSTRAINT "third_brain_insights_severity_check" CHECK ((("severity" >= 1) AND ("severity" <= 5))),
    CONSTRAINT "third_brain_insights_status_check" CHECK (("status" = ANY (ARRAY['open'::"text", 'accepted'::"text", 'dismissed'::"text", 'done'::"text", 'snoozed'::"text"])))
);


ALTER TABLE "public"."third_brain_insights" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."third_brain_memories" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "category" "text" NOT NULL,
    "key" "text" NOT NULL,
    "importance" integer DEFAULT 1,
    "content" "text" NOT NULL,
    "metadata" "jsonb" DEFAULT '{}'::"jsonb",
    "last_updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_third_brain_memories" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text")),
    CONSTRAINT "third_brain_memories_importance_check" CHECK ((("importance" >= 1) AND ("importance" <= 5)))
);


ALTER TABLE "public"."third_brain_memories" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."timeline_coach_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "mode" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "completed_at" timestamp with time zone,
    "selected_timeline_ids" "uuid"[] DEFAULT '{}'::"uuid"[],
    "question" "text",
    "response" "text",
    "summary" "text",
    "recommendations" "jsonb",
    "followup_actions" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_timeline_coach_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."timeline_coach_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."timeline_commitments" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "decision_id" "uuid" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "kind" "text" NOT NULL,
    "label" "text" NOT NULL,
    "description" "text",
    "config" "jsonb",
    "domain" "text",
    "is_active" boolean DEFAULT true NOT NULL,
    "broken_count" integer DEFAULT 0 NOT NULL,
    "upheld_count" integer DEFAULT 0 NOT NULL,
    "last_evaluated_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_timeline_commitments" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."timeline_commitments" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."timeline_decisions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "run_id" "uuid",
    "chosen_timeline_id" "uuid",
    "horizon_days" integer NOT NULL,
    "label" "text",
    "rationale" "text",
    "perceived_benefits" "jsonb",
    "perceived_costs" "jsonb",
    "confidence" numeric,
    "season_start" "date",
    "season_end" "date",
    "is_current" boolean DEFAULT false NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_timeline_decisions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."timeline_decisions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."timeline_preference_profile" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "last_refreshed_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "domain_weights" "jsonb",
    "risk_tolerance" "jsonb",
    "time_preferences" "jsonb",
    "comfort_zones" "jsonb",
    "sacrifice_preferences" "jsonb",
    "summary" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_timeline_preference_profile" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."timeline_preference_profile" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."timeline_reflections" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "decision_id" "uuid" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "period_start" "date",
    "period_end" "date",
    "felt_outcome_summary" "text",
    "alignment_change" numeric,
    "satisfaction_score" numeric,
    "regrets" "jsonb",
    "surprises" "jsonb",
    "lessons" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_timeline_reflections" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."timeline_reflections" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."usage_logs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "feature" "text" NOT NULL,
    "tokens_used" integer DEFAULT 0,
    "cost_cents" integer DEFAULT 0,
    "model" "text",
    "metadata" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_usage_logs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."usage_logs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."user_agi_settings" (
    "user_id" "text" NOT NULL,
    "level" "text" DEFAULT 'assist'::"text" NOT NULL,
    "max_actions_per_run" integer DEFAULT 10 NOT NULL,
    "max_runs_per_day" integer DEFAULT 12 NOT NULL,
    "require_confirmation_for_high_impact" boolean DEFAULT true NOT NULL,
    "last_updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_user_agi_settings" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."user_agi_settings" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."user_archetype_profiles" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "dominant_archetypes" "jsonb",
    "suppressed_archetypes" "jsonb",
    "context_notes" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_user_archetype_profiles" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."user_archetype_profiles" OWNER TO "postgres";


CREATE OR REPLACE VIEW "public"."user_daily_activity_rollup" AS
 SELECT "user_id",
    ("date_trunc"('day'::"text", COALESCE("event_ts", "created_at")))::"date" AS "day",
    "count"(*) AS "event_count"
   FROM "public"."activity_events"
  GROUP BY "user_id", (("date_trunc"('day'::"text", COALESCE("event_ts", "created_at")))::"date");


ALTER VIEW "public"."user_daily_activity_rollup" OWNER TO "postgres";


COMMENT ON VIEW "public"."user_daily_activity_rollup" IS 'Canon-safe daily rollup view over activity_events. Columns: user_id, day, event_count. Consumed via user_daily_activity_rollup_read(p_days).';



CREATE TABLE IF NOT EXISTS "public"."user_dashboard_layouts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "layout_data" "jsonb" NOT NULL,
    "is_active" boolean DEFAULT true,
    "version" integer DEFAULT 1,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_user_dashboard_layouts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."user_dashboard_layouts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."user_experiment_arms" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "experiment_id" "uuid" NOT NULL,
    "key" "text" NOT NULL,
    "description" "text",
    "intervention" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."user_experiment_arms" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."user_experiment_data_points" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "experiment_id" "uuid" NOT NULL,
    "arm_id" "uuid",
    "observed_at" "date" NOT NULL,
    "metric_key" "text" NOT NULL,
    "value" numeric NOT NULL,
    "metadata" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."user_experiment_data_points" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."user_experiment_results" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "experiment_id" "uuid" NOT NULL,
    "summary" "jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text"
);


ALTER TABLE "public"."user_experiment_results" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."user_experiments" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "template_key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "domain" "text" NOT NULL,
    "status" "text" DEFAULT 'planned'::"text" NOT NULL,
    "start_date" "date",
    "end_date" "date",
    "hypothesis" "text",
    "notes" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_user_experiments" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."user_experiments" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."user_focus_profile" (
    "user_id" "text" NOT NULL,
    "primary_focus" "text",
    "secondary_focus" "text",
    "self_description" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_user_focus_profile" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."user_focus_profile" OWNER TO "postgres";


CREATE OR REPLACE VIEW "public"."user_id_canon_audit" AS
 WITH "user_id_tables" AS (
         SELECT "col"."table_schema",
            "col"."table_name"
           FROM "information_schema"."columns" "col"
          WHERE ((("col"."table_schema")::"name" = 'public'::"name") AND (("col"."column_name")::"name" = 'user_id'::"name"))
        ), "rls_state" AS (
         SELECT "n"."nspname" AS "table_schema",
            "c"."relname" AS "table_name",
            "c"."relrowsecurity" AS "rls_enabled"
           FROM ("pg_class" "c"
             JOIN "pg_namespace" "n" ON (("n"."oid" = "c"."relnamespace")))
          WHERE (("n"."nspname" = 'public'::"name") AND ("c"."relkind" = 'r'::"char"))
        ), "policy_state" AS (
         SELECT "pg_policies"."schemaname" AS "table_schema",
            "pg_policies"."tablename" AS "table_name",
            "bool_or"(("pg_policies"."policyname" = 'pulse_user_owns_row'::"name")) AS "has_pulse_user_owns_row"
           FROM "pg_policies"
          WHERE ("pg_policies"."schemaname" = 'public'::"name")
          GROUP BY "pg_policies"."schemaname", "pg_policies"."tablename"
        ), "non_text_user_id" AS (
         SELECT "columns"."table_schema",
            "columns"."table_name",
            "columns"."data_type"
           FROM "information_schema"."columns"
          WHERE ((("columns"."table_schema")::"name" = 'public'::"name") AND (("columns"."column_name")::"name" = 'user_id'::"name") AND (("columns"."data_type")::"text" <> 'text'::"text"))
        ), "user_id_fk_count" AS (
         SELECT "count"(*) AS "fk_count"
           FROM ((("pg_constraint" "con"
             JOIN "pg_class" "rel" ON (("rel"."oid" = "con"."conrelid")))
             JOIN "pg_namespace" "nsp" ON (("nsp"."oid" = "rel"."relnamespace")))
             JOIN "pg_attribute" "att" ON ((("att"."attrelid" = "con"."conrelid") AND ("att"."attnum" = ANY ("con"."conkey")))))
          WHERE (("con"."contype" = 'f'::"char") AND ("nsp"."nspname" = 'public'::"name") AND ("att"."attname" = 'user_id'::"name"))
        )
 SELECT "t"."table_schema",
    "t"."table_name",
    ( SELECT "user_id_fk_count"."fk_count"
           FROM "user_id_fk_count") AS "user_id_fk_violations_global",
    ("nt"."data_type" IS NOT NULL) AS "user_id_not_text",
    "r"."rls_enabled",
    COALESCE("p"."has_pulse_user_owns_row", false) AS "has_pulse_user_owns_row"
   FROM ((("user_id_tables" "t"
     LEFT JOIN "rls_state" "r" ON ((("r"."table_schema" = ("t"."table_schema")::"name") AND ("r"."table_name" = ("t"."table_name")::"name"))))
     LEFT JOIN "policy_state" "p" ON ((("p"."table_schema" = ("t"."table_schema")::"name") AND ("p"."table_name" = ("t"."table_name")::"name"))))
     LEFT JOIN "non_text_user_id" "nt" ON (((("nt"."table_schema")::"name" = ("t"."table_schema")::"name") AND (("nt"."table_name")::"name" = ("t"."table_name")::"name"))))
  ORDER BY "t"."table_schema", "t"."table_name";


ALTER VIEW "public"."user_id_canon_audit" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."user_interview_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "answers" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "started_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "completed_at" timestamp with time zone,
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_user_interview_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text")),
    CONSTRAINT "user_interview_sessions_status_check" CHECK (("status" = ANY (ARRAY['active'::"text", 'completed'::"text", 'skipped'::"text"])))
);


ALTER TABLE "public"."user_interview_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."user_job_profiles" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "job_graph_node_id" "uuid",
    "custom_title" "text",
    "custom_notes" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_user_job_profiles" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."user_job_profiles" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."user_mythic_coach_settings" (
    "user_id" "text" NOT NULL,
    "intensity" "text" DEFAULT 'medium'::"text" NOT NULL,
    "tone" "text" DEFAULT 'grounded'::"text" NOT NULL,
    "session_length" "text" DEFAULT 'short'::"text" NOT NULL,
    "enabled" boolean DEFAULT true NOT NULL,
    "preferred_framework" "text" DEFAULT 'heros_journey'::"text",
    "last_daily_ritual_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_user_mythic_coach_settings" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."user_mythic_coach_settings" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."user_mythic_profile" (
    "user_id" "text" NOT NULL,
    "dominant_life_archetypes" "jsonb",
    "recurring_motifs" "jsonb",
    "current_chapter_id" "uuid",
    "current_phase" "text",
    "last_story_refresh_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_user_mythic_profile" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."user_mythic_profile" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."user_onboarding_state" (
    "user_id" "text" NOT NULL,
    "has_completed_core" boolean DEFAULT false,
    "has_seen_life_tour" boolean DEFAULT false,
    "has_seen_work_tour" boolean DEFAULT false,
    "has_seen_finance_tour" boolean DEFAULT false,
    "has_seen_relationships_tour" boolean DEFAULT false,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_user_onboarding_state" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."user_onboarding_state" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."user_packs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "pack_id" "text" NOT NULL,
    "pack_name" "text" NOT NULL,
    "installed_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "customizations" "jsonb" DEFAULT '{}'::"jsonb",
    "is_active" boolean DEFAULT true,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_user_packs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."user_packs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."user_persona_tuning" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "persona_key" "text" NOT NULL,
    "preferred_variant_key" "text",
    "trait_adjustments" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "motion_adjustments" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "last_updated_at" timestamp with time zone DEFAULT "now"(),
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_user_persona_tuning" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."user_persona_tuning" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."user_philosophy_progress" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "school_key" "text" NOT NULL,
    "lesson_id" "uuid",
    "exercise_id" "uuid",
    "status" "text" DEFAULT 'assigned'::"text" NOT NULL,
    "response" "text",
    "score" numeric,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "completed_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_user_philosophy_progress" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."user_philosophy_progress" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."user_plugins" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "plugin_id" "uuid" NOT NULL,
    "config" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "credentials_encrypted" "text",
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "last_sync_at" timestamp with time zone,
    "last_error" "text",
    "error_count" integer DEFAULT 0 NOT NULL,
    "total_syncs" integer DEFAULT 0 NOT NULL,
    "total_actions" integer DEFAULT 0 NOT NULL,
    "installed_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_user_plugins" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."user_plugins" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."user_prefs" (
    "user_id" "text" NOT NULL,
    "focus_mode_enabled" boolean DEFAULT false NOT NULL,
    "active_focus_task_id" "uuid",
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_user_prefs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."user_prefs" OWNER TO "postgres";


COMMENT ON TABLE "public"."user_prefs" IS 'Canonical per-user preferences for Pulse.';



COMMENT ON COLUMN "public"."user_prefs"."focus_mode_enabled" IS 'If true, UI restricts to active_focus_task_id.';



COMMENT ON COLUMN "public"."user_prefs"."active_focus_task_id" IS 'Task currently locked for Focus Mode.';



CREATE TABLE IF NOT EXISTS "public"."user_profiles" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "archetype" "text",
    "summary" "text",
    "profile_data" "jsonb" DEFAULT '{}'::"jsonb",
    "life_season" "text",
    "role_type" "text",
    "industry" "text",
    "specific_role" "text",
    "dashboard_density" numeric DEFAULT 0.5,
    "coach_style" "text" DEFAULT 'supportive'::"text",
    "gamification_level" "text" DEFAULT 'moderate'::"text",
    "onboarding_completed" boolean DEFAULT false,
    "onboarding_started_at" timestamp with time zone,
    "onboarding_completed_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "job_title_id" "uuid",
    "current_mood" integer,
    "current_energy" integer,
    "current_stress" integer,
    "last_checkin_at" timestamp with time zone,
    "philosophy_mentor" "text",
    "philosophy_streak" integer DEFAULT 0,
    "philosophy_last_practice" "text",
    "email" "text",
    "plan" "text" DEFAULT 'free'::"text",
    "usage_cents_this_month" integer DEFAULT 0,
    "usage_reset_at" timestamp with time zone,
    "token_balance_cents" integer DEFAULT 0,
    "free_month_credits" integer DEFAULT 0,
    "referral_code" "text",
    "referred_by_user_id" "uuid",
    "refund_eligible_at" timestamp with time zone,
    "intensity_level" integer DEFAULT 2,
    "stripe_customer_id" "text",
    "stripe_subscription_id" "text",
    "subscription_status" "text" DEFAULT 'inactive'::"text",
    "trial_ends_at" timestamp with time zone,
    "referred_by" "text",
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_user_profiles" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text")),
    CONSTRAINT "user_profiles_intensity_level_check" CHECK ((("intensity_level" >= 1) AND ("intensity_level" <= 7))),
    CONSTRAINT "user_profiles_plan_check" CHECK (("plan" = ANY (ARRAY['free'::"text", 'plus'::"text"])))
);


ALTER TABLE "public"."user_profiles" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."user_safety_settings" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "allow_mature_but_nonsexual" boolean DEFAULT false,
    "allow_direct_language" boolean DEFAULT true,
    "tone_sensitivity" "text" DEFAULT 'normal'::"text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_user_safety_settings" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."user_safety_settings" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."user_settings" (
    "user_id" "text" NOT NULL,
    "settings" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_user_settings" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."user_settings" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."users" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "clerk_user_id" "text" NOT NULL,
    "email" "text",
    "name" "text",
    "phone" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "clerk_id" "text"
);


ALTER TABLE "public"."users" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."value_profile" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "last_refreshed_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "summary" "text",
    "core_values" "jsonb",
    "role_priorities" "jsonb",
    "red_lines" "jsonb",
    "aspiration_statement" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_value_profile" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."value_profile" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."vault_access_log" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "item_id" "uuid",
    "action" "text" NOT NULL,
    "success" boolean NOT NULL,
    "ip_address" "text",
    "user_agent" "text",
    "failure_reason" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_vault_access_log" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."vault_access_log" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."vault_emergency_access" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "trusted_contact_email" "text" NOT NULL,
    "trusted_contact_name" "text",
    "encrypted_recovery_key" "text" NOT NULL,
    "waiting_period_days" integer DEFAULT 7 NOT NULL,
    "status" "text" DEFAULT 'pending'::"text" NOT NULL,
    "request_started_at" timestamp with time zone,
    "granted_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_vault_emergency_access" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."vault_emergency_access" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."vault_items" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "item_type" "text" NOT NULL,
    "item_name" "text" NOT NULL,
    "encrypted_data" "text" NOT NULL,
    "encryption_iv" "text" NOT NULL,
    "key_derivation_salt" "text" NOT NULL,
    "metadata" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "tags" "text"[] DEFAULT '{}'::"text"[],
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "accessed_at" timestamp with time zone,
    "expires_at" timestamp with time zone,
    "deleted" boolean DEFAULT false NOT NULL,
    "deleted_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_vault_items" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."vault_items" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."vault_keys" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "key_name" "text" DEFAULT 'primary'::"text" NOT NULL,
    "key_hash" "text" NOT NULL,
    "algorithm" "text" DEFAULT 'AES-256-GCM'::"text" NOT NULL,
    "kdf" "text" DEFAULT 'PBKDF2-SHA256'::"text" NOT NULL,
    "kdf_iterations" integer DEFAULT 100000 NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "last_used_at" timestamp with time zone,
    "revoked" boolean DEFAULT false NOT NULL,
    "revoked_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_vault_keys" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."vault_keys" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."vault_secure_notes" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "note_title" "text" NOT NULL,
    "encrypted_content" "text" NOT NULL,
    "encryption_iv" "text" NOT NULL,
    "key_derivation_salt" "text" NOT NULL,
    "category" "text",
    "tags" "text"[] DEFAULT '{}'::"text"[],
    "pinned" boolean DEFAULT false NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_vault_secure_notes" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."vault_secure_notes" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."vault_shares" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "item_id" "uuid" NOT NULL,
    "owner_user_id" "text" NOT NULL,
    "shared_with_user_id" "text",
    "share_token" "text",
    "encrypted_key" "text" NOT NULL,
    "permissions" "text"[] DEFAULT '{read}'::"text"[] NOT NULL,
    "expires_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "revoked" boolean DEFAULT false NOT NULL
);


ALTER TABLE "public"."vault_shares" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."vertical_metrics" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "vertical_key" "text" NOT NULL,
    "period_start" "date" NOT NULL,
    "period_end" "date" NOT NULL,
    "metrics" "jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_vertical_metrics" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."vertical_metrics" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."voice_profiles" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "style" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "default_speed" integer,
    "default_energy" integer,
    "default_intensity" integer,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text"
);


ALTER TABLE "public"."voice_profiles" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."voice_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "context" "text" DEFAULT 'ad_hoc'::"text" NOT NULL,
    "tag" "text",
    "started_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "ended_at" timestamp with time zone,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_voice_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."voice_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."voice_turns" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "session_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "turn_index" integer NOT NULL,
    "speaker" "text" NOT NULL,
    "transcript" "text" NOT NULL,
    "metadata" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_voice_turns" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."voice_turns" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."voicemails" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "caller_phone" "text",
    "caller_name" "text",
    "duration_seconds" integer,
    "transcript" "text",
    "audio_url" "text",
    "is_read" boolean DEFAULT false,
    "received_at" timestamp with time zone,
    "contact_id" "uuid",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "deal_id" "uuid",
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_voicemails" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."voicemails" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."weekly_plans" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "week_start" "date" NOT NULL,
    "week_end" "date" NOT NULL,
    "theme" "text",
    "top_priorities" "jsonb" DEFAULT '[]'::"jsonb",
    "goals" "jsonb" DEFAULT '[]'::"jsonb",
    "time_blocks" "jsonb" DEFAULT '[]'::"jsonb",
    "reflections" "jsonb",
    "status" "text" DEFAULT 'planning'::"text",
    "ai_summary" "text",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_weekly_plans" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text")),
    CONSTRAINT "weekly_plans_status_check" CHECK (("status" = ANY (ARRAY['planning'::"text", 'active'::"text", 'completed'::"text", 'reviewed'::"text"])))
);


ALTER TABLE "public"."weekly_plans" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."what_if_outcomes" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "run_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "narrative_baseline" "text",
    "narrative_alternate" "text",
    "metrics_baseline" "jsonb",
    "metrics_alternate" "jsonb",
    "highlight_differences" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_what_if_outcomes" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."what_if_outcomes" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."what_if_runs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "scenario_id" "uuid" NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "mode" "text" NOT NULL,
    "horizon" "text" NOT NULL,
    "baseline_timeline" "jsonb",
    "alternate_timeline" "jsonb",
    "deltas" "jsonb",
    "meta" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_what_if_runs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."what_if_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."what_if_scenarios" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "label" "text" NOT NULL,
    "description" "text",
    "origin_type" "text" NOT NULL,
    "origin_id" "uuid",
    "anchor_time" timestamp with time zone,
    "timescale" "text",
    "base_assumption" "text",
    "alternate_assumption" "text",
    "parameters" "jsonb",
    "status" "text" DEFAULT 'draft'::"text" NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_what_if_scenarios" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."what_if_scenarios" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."wisdom_lessons" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "scope" "text" NOT NULL,
    "domain" "text",
    "title" "text" NOT NULL,
    "summary" "text",
    "condition" "jsonb",
    "recommendation" "jsonb",
    "avoid" "jsonb",
    "evidence" "jsonb",
    "strength" numeric DEFAULT 0.5 NOT NULL,
    "usefulness" numeric DEFAULT 0.5 NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_wisdom_lessons" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."wisdom_lessons" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."wisdom_playbooks" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "key" "text" NOT NULL,
    "name" "text" NOT NULL,
    "description" "text",
    "domain" "text",
    "trigger_pattern" "jsonb",
    "lesson_ids" "uuid"[],
    "heuristic_ids" "uuid"[],
    "usage_count" integer DEFAULT 0 NOT NULL,
    "last_used_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_wisdom_playbooks" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."wisdom_playbooks" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."wisdom_refresh_runs" (
    "user_id" "text" NOT NULL,
    "last_run_at" timestamp with time zone,
    "last_status" "text",
    "last_error" "text",
    "started_at" timestamp with time zone,
    "finished_at" timestamp with time zone,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_wisdom_refresh_runs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."wisdom_refresh_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."work_scoreboard_days" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id_uuid" "uuid" NOT NULL,
    "day" "date" NOT NULL,
    "inbox_done_count" integer DEFAULT 0 NOT NULL,
    "tasks_done_count" integer DEFAULT 0 NOT NULL,
    "followups_done_count" integer DEFAULT 0 NOT NULL,
    "replies_sent_count" integer DEFAULT 0 NOT NULL,
    "autopilot_actions_count" integer DEFAULT 0 NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "updated_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."work_scoreboard_days" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."workspace_day_log" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "date" "date" NOT NULL,
    "chosen_focus_state_id" "uuid",
    "executed_timeline_id" "uuid",
    "summary" "text",
    "key_signals" "jsonb",
    "alignment_delta" numeric(4,2),
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_workspace_day_log" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."workspace_day_log" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."workspace_focus_sessions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "started_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "ended_at" timestamp with time zone,
    "state_date" "date" NOT NULL,
    "thread_ids" "uuid"[],
    "focus_mode" "text",
    "summary" "text",
    "outcome" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_workspace_focus_sessions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."workspace_focus_sessions" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."workspace_focus_states" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "active_timeline_id" "uuid",
    "active_branch_run_id" "uuid",
    "focus_mode" "text" DEFAULT 'normal'::"text" NOT NULL,
    "focus_tags" "text"[] DEFAULT '{}'::"text"[],
    "applied_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "expires_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_workspace_focus_states" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."workspace_focus_states" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."workspace_interrupts" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "triggered_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "source" "text" NOT NULL,
    "severity" numeric NOT NULL,
    "summary" "text" NOT NULL,
    "details" "jsonb",
    "resolved_at" timestamp with time zone,
    "resolution_action" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_workspace_interrupts" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."workspace_interrupts" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."workspace_state" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "state_date" "date" NOT NULL,
    "focus_mode" "text" DEFAULT 'normal'::"text" NOT NULL,
    "focus_theme" "text",
    "active_thread_ids" "uuid"[],
    "attention_budget_minutes" integer,
    "attention_load" numeric,
    "last_updated_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "narrative_chapter_id" "uuid",
    "narrative_logline" "text",
    "key_tensions" "jsonb",
    "key_opportunities" "jsonb",
    "wisdom_summary" "text",
    "ethical_alert" boolean DEFAULT false,
    "ethical_notes" "text",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_workspace_state" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."workspace_state" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."workspace_threads" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "kind" "text" NOT NULL,
    "source" "text",
    "ref_type" "text",
    "ref_id" "text",
    "title" "text" NOT NULL,
    "summary" "text",
    "importance" numeric DEFAULT 0.5 NOT NULL,
    "urgency" numeric DEFAULT 0.5 NOT NULL,
    "emotional_valence" numeric,
    "attention_cost_minutes" integer,
    "status" "text" DEFAULT 'active'::"text" NOT NULL,
    "snooze_until" timestamp with time zone,
    "last_touched_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "is_pinned" boolean DEFAULT false,
    "carry_forward" boolean DEFAULT true,
    "last_evaluated_at" timestamp with time zone,
    "wisdom_tags" "text"[],
    "risk_flags" "jsonb",
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_workspace_threads" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."workspace_threads" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."workspace_timeline_links" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "state_date" "date" NOT NULL,
    "thread_id" "uuid" NOT NULL,
    "timeline_id" "uuid" NOT NULL,
    "projected_impact" "jsonb",
    "risk_if_ignored" "jsonb",
    "opportunity_if_addressed" "jsonb",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "owner_user_id" "text",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_workspace_timeline_links" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."workspace_timeline_links" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."workspaces" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "owner_user_id" "text" NOT NULL,
    "name" "text" DEFAULT 'Personal'::"text" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."workspaces" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."xp_evaluation_runs" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "evaluator_key" "text" NOT NULL,
    "evaluator_version" integer NOT NULL,
    "evidence_id" "uuid" NOT NULL,
    "result_xp" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "result_meta" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_xp_evaluation_runs" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."xp_evaluation_runs" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."xp_evaluators" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "key" "text" NOT NULL,
    "version" integer NOT NULL,
    "is_active" boolean DEFAULT true NOT NULL,
    "description" "text",
    "config" "jsonb" DEFAULT '{}'::"jsonb" NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL
);


ALTER TABLE "public"."xp_evaluators" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."xp_events" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "category" "text" DEFAULT 'DXP'::"text" NOT NULL,
    "activity" "text" NOT NULL,
    "source_type" "text",
    "source_id" "uuid",
    "base_xp" integer DEFAULT 0 NOT NULL,
    "final_xp" integer DEFAULT 0 NOT NULL,
    "was_crit" boolean DEFAULT false NOT NULL,
    "crit_multiplier" numeric DEFAULT 1 NOT NULL,
    "identity_bonus" integer DEFAULT 0 NOT NULL,
    "notes" "text",
    "occurred_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "ref_table" "text",
    "ref_id" "uuid",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_xp_events" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."xp_events" OWNER TO "postgres";


COMMENT ON COLUMN "public"."xp_events"."ref_table" IS 'Canonical reference table name (e.g. tasks).';



COMMENT ON COLUMN "public"."xp_events"."ref_id" IS 'Canonical reference row id (uuid).';



CREATE TABLE IF NOT EXISTS "public"."xp_ledger" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "xp_type" "public"."xp_kind" NOT NULL,
    "amount" integer NOT NULL,
    "source_kind" "text" NOT NULL,
    "source_id" "uuid",
    "memo" "text",
    "evaluator_key" "text",
    "evaluator_version" integer,
    "evidence_id" "uuid",
    "created_at" timestamp with time zone DEFAULT "now"() NOT NULL,
    "reversal_of" "uuid",
    "user_id_text" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_xp_ledger" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."xp_ledger" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."xp_transactions" (
    "id" "uuid" DEFAULT "gen_random_uuid"() NOT NULL,
    "user_id" "text" NOT NULL,
    "amount" integer NOT NULL,
    "reason" "text" NOT NULL,
    "source_type" "text",
    "source_id" "uuid",
    "created_at" timestamp with time zone DEFAULT "now"(),
    "owner_user_id" "text",
    "user_id_uuid" "uuid" NOT NULL,
    CONSTRAINT "pulse_user_id_text_only_xp_transactions" CHECK ((("pg_typeof"("user_id"))::"text" = 'text'::"text"))
);


ALTER TABLE "public"."xp_transactions" OWNER TO "postgres";


ALTER TABLE ONLY "public"."_pulse_quarantine_rows" ALTER COLUMN "id" SET DEFAULT "nextval"('"public"."_pulse_quarantine_rows_id_seq"'::"regclass");



ALTER TABLE ONLY "public"."canonical_schema_rules" ALTER COLUMN "id" SET DEFAULT "nextval"('"public"."canonical_schema_rules_id_seq"'::"regclass");



ALTER TABLE ONLY "public"."job_provider_incidents" ALTER COLUMN "id" SET DEFAULT "nextval"('"public"."job_provider_incidents_id_seq"'::"regclass");



ALTER TABLE ONLY "public"."job_queue_alerts" ALTER COLUMN "id" SET DEFAULT "nextval"('"public"."job_queue_alerts_id_seq"'::"regclass");



ALTER TABLE ONLY "public"."job_queue_credits_ledger" ALTER COLUMN "id" SET DEFAULT "nextval"('"public"."job_queue_credits_ledger_id_seq"'::"regclass");



ALTER TABLE ONLY "public"."job_queue_health_snapshots" ALTER COLUMN "id" SET DEFAULT "nextval"('"public"."job_queue_health_snapshots_id_seq"'::"regclass");



ALTER TABLE ONLY "public"."job_queue_pricing" ALTER COLUMN "id" SET DEFAULT "nextval"('"public"."job_queue_pricing_id_seq"'::"regclass");



ALTER TABLE ONLY "public"."job_queue_scheduler_decisions" ALTER COLUMN "id" SET DEFAULT "nextval"('"public"."job_queue_scheduler_decisions_id_seq"'::"regclass");



ALTER TABLE ONLY "public"."_pulse_quarantine_rows"
    ADD CONSTRAINT "_pulse_quarantine_rows_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."achievements"
    ADD CONSTRAINT "achievements_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."achievements"
    ADD CONSTRAINT "achievements_user_id_achievement_key_key" UNIQUE ("user_id", "achievement_key");



ALTER TABLE ONLY "public"."activity_events"
    ADD CONSTRAINT "activity_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."ag_agents"
    ADD CONSTRAINT "ag_agents_key_key" UNIQUE ("key");



ALTER TABLE ONLY "public"."ag_agents"
    ADD CONSTRAINT "ag_agents_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."ag_messages"
    ADD CONSTRAINT "ag_messages_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."ag_runs"
    ADD CONSTRAINT "ag_runs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."agi_actions"
    ADD CONSTRAINT "agi_actions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."agi_agent_profiles"
    ADD CONSTRAINT "agi_agent_profiles_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."agi_feedback"
    ADD CONSTRAINT "agi_feedback_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."agi_policies"
    ADD CONSTRAINT "agi_policies_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."agi_runs"
    ADD CONSTRAINT "agi_runs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."agi_scenario_runs"
    ADD CONSTRAINT "agi_scenario_runs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."agi_scenarios"
    ADD CONSTRAINT "agi_scenarios_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."agi_telemetry"
    ADD CONSTRAINT "agi_telemetry_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."agi_user_profile"
    ADD CONSTRAINT "agi_user_profile_pkey" PRIMARY KEY ("user_id");



ALTER TABLE ONLY "public"."align_feedback"
    ADD CONSTRAINT "align_feedback_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."align_global_policies"
    ADD CONSTRAINT "align_global_policies_key_key" UNIQUE ("key");



ALTER TABLE ONLY "public"."align_global_policies"
    ADD CONSTRAINT "align_global_policies_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."align_user_profiles"
    ADD CONSTRAINT "align_user_profiles_pkey" PRIMARY KEY ("user_id");



ALTER TABLE ONLY "public"."align_violations"
    ADD CONSTRAINT "align_violations_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."alignment_evaluations"
    ADD CONSTRAINT "alignment_evaluations_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."archetype_definitions"
    ADD CONSTRAINT "archetype_definitions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."archetype_events"
    ADD CONSTRAINT "archetype_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."archetype_snapshots"
    ADD CONSTRAINT "archetype_snapshots_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."artifact_links"
    ADD CONSTRAINT "artifact_links_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."attention_events"
    ADD CONSTRAINT "attention_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."autonomy_actions"
    ADD CONSTRAINT "autonomy_actions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."autopilot_jobs"
    ADD CONSTRAINT "autopilot_jobs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."autopilot_suggestions"
    ADD CONSTRAINT "autopilot_suggestions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."behavior_predictions"
    ADD CONSTRAINT "behavior_predictions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."brain_capabilities"
    ADD CONSTRAINT "brain_capabilities_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."brain_changelog"
    ADD CONSTRAINT "brain_changelog_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."brain_entries"
    ADD CONSTRAINT "brain_entries_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."brain_error_events"
    ADD CONSTRAINT "brain_error_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."brain_events"
    ADD CONSTRAINT "brain_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."brain_health_snapshots"
    ADD CONSTRAINT "brain_health_snapshots_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."brain_subsystems"
    ADD CONSTRAINT "brain_subsystems_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."brain_subsystems"
    ADD CONSTRAINT "brain_subsystems_user_id_key_key" UNIQUE ("user_id", "key");



ALTER TABLE ONLY "public"."brainstem_status"
    ADD CONSTRAINT "brainstem_status_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."brainstem_status"
    ADD CONSTRAINT "brainstem_status_user_id_region_key" UNIQUE ("user_id", "region");



ALTER TABLE ONLY "public"."branch_comparisons"
    ADD CONSTRAINT "branch_comparisons_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."branch_simulation_runs"
    ADD CONSTRAINT "branch_simulation_runs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."butler_notifications"
    ADD CONSTRAINT "butler_notifications_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."butler_snoozes"
    ADD CONSTRAINT "butler_snoozes_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."calendar_accounts"
    ADD CONSTRAINT "calendar_accounts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."calendar_accounts"
    ADD CONSTRAINT "calendar_accounts_user_id_provider_key" UNIQUE ("user_id", "provider");



ALTER TABLE ONLY "public"."calendar_events_cache"
    ADD CONSTRAINT "calendar_events_cache_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."calendar_events_cache"
    ADD CONSTRAINT "calendar_events_cache_user_id_provider_external_id_key" UNIQUE ("user_id", "provider", "external_id");



ALTER TABLE ONLY "public"."call_intelligence_settings"
    ADD CONSTRAINT "call_intelligence_settings_pkey" PRIMARY KEY ("user_id");



ALTER TABLE ONLY "public"."call_links"
    ADD CONSTRAINT "call_links_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."call_segments"
    ADD CONSTRAINT "call_segments_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."call_sessions"
    ADD CONSTRAINT "call_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."call_summaries"
    ADD CONSTRAINT "call_summaries_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."calls"
    ADD CONSTRAINT "calls_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."campaign_enrollments"
    ADD CONSTRAINT "campaign_enrollments_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."campaigns"
    ADD CONSTRAINT "campaigns_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."canon_events"
    ADD CONSTRAINT "canon_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."canon_migration_allowlist"
    ADD CONSTRAINT "canon_migration_allowlist_pkey" PRIMARY KEY ("table_schema", "table_name");



ALTER TABLE ONLY "public"."canon_mode"
    ADD CONSTRAINT "canon_mode_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."canon_timeline_index"
    ADD CONSTRAINT "canon_timeline_index_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."canonical_schema_rules"
    ADD CONSTRAINT "canonical_schema_rules_domain_table_schema_table_name_colum_key" UNIQUE ("domain", "table_schema", "table_name", "column_name");



ALTER TABLE ONLY "public"."canonical_schema_rules"
    ADD CONSTRAINT "canonical_schema_rules_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."chapter_archetypes"
    ADD CONSTRAINT "chapter_archetypes_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."civilization_domain_mappings"
    ADD CONSTRAINT "civilization_domain_mappings_domain_id_node_id_key" UNIQUE ("domain_id", "node_id");



ALTER TABLE ONLY "public"."civilization_domain_mappings"
    ADD CONSTRAINT "civilization_domain_mappings_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."civilization_domain_state"
    ADD CONSTRAINT "civilization_domain_state_domain_id_snapshot_date_key" UNIQUE ("domain_id", "snapshot_date");



ALTER TABLE ONLY "public"."civilization_domain_state"
    ADD CONSTRAINT "civilization_domain_state_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."civilization_domains"
    ADD CONSTRAINT "civilization_domains_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."civilization_patterns"
    ADD CONSTRAINT "civilization_patterns_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."civilization_settings"
    ADD CONSTRAINT "civilization_settings_pkey" PRIMARY KEY ("user_id");



ALTER TABLE ONLY "public"."coach_council_deliberations"
    ADD CONSTRAINT "coach_council_deliberations_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."coach_council_members"
    ADD CONSTRAINT "coach_council_members_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."coach_council_sessions"
    ADD CONSTRAINT "coach_council_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."coach_council_summary"
    ADD CONSTRAINT "coach_council_summary_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."coach_generated_scenarios"
    ADD CONSTRAINT "coach_generated_scenarios_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."coach_multi_agent_sessions"
    ADD CONSTRAINT "coach_multi_agent_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."coach_roleplay_scenarios"
    ADD CONSTRAINT "coach_roleplay_scenarios_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."coach_scenarios"
    ADD CONSTRAINT "coach_scenarios_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."coach_sessions"
    ADD CONSTRAINT "coach_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."coach_training_sessions"
    ADD CONSTRAINT "coach_training_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."coach_user_preferences"
    ADD CONSTRAINT "coach_user_preferences_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."coach_user_preferences"
    ADD CONSTRAINT "coach_user_preferences_user_id_coach_type_key" UNIQUE ("user_id", "coach_type");



ALTER TABLE ONLY "public"."coach_voice_overrides"
    ADD CONSTRAINT "coach_voice_overrides_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."coach_voice_sessions"
    ADD CONSTRAINT "coach_voice_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."cognitive_hypotheses"
    ADD CONSTRAINT "cognitive_hypotheses_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."cognitive_insights"
    ADD CONSTRAINT "cognitive_insights_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."cognitive_phases"
    ADD CONSTRAINT "cognitive_phases_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."cognitive_runs"
    ADD CONSTRAINT "cognitive_runs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."cognitive_self_reflections"
    ADD CONSTRAINT "cognitive_self_reflections_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."cognitive_update_actions"
    ADD CONSTRAINT "cognitive_update_actions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."communication_programs"
    ADD CONSTRAINT "communication_programs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."communication_sessions"
    ADD CONSTRAINT "communication_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."communication_turns"
    ADD CONSTRAINT "communication_turns_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."conscious_conflicts"
    ADD CONSTRAINT "conscious_conflicts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."conscious_frames"
    ADD CONSTRAINT "conscious_frames_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."conscious_insights"
    ADD CONSTRAINT "conscious_insights_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."conscious_items"
    ADD CONSTRAINT "conscious_items_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."conscious_links"
    ADD CONSTRAINT "conscious_links_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."contact_dates"
    ADD CONSTRAINT "contact_dates_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."contact_emails"
    ADD CONSTRAINT "contact_emails_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."contact_facts"
    ADD CONSTRAINT "contact_facts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."contact_identity_intel"
    ADD CONSTRAINT "contact_identity_intel_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."contact_influence_events"
    ADD CONSTRAINT "contact_influence_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."contact_intelligence_sources"
    ADD CONSTRAINT "contact_intelligence_sources_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."contact_phones"
    ADD CONSTRAINT "contact_phones_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."contact_playbooks"
    ADD CONSTRAINT "contact_playbooks_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."contact_playbooks"
    ADD CONSTRAINT "contact_playbooks_user_id_contact_id_key" UNIQUE ("user_id", "contact_id");



ALTER TABLE ONLY "public"."contact_relationship_scores"
    ADD CONSTRAINT "contact_relationship_scores_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."contact_relationship_scores"
    ADD CONSTRAINT "contact_relationship_scores_user_id_contact_id_key" UNIQUE ("user_id", "contact_id");



ALTER TABLE ONLY "public"."contact_relationships"
    ADD CONSTRAINT "contact_relationships_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."contact_tag_links"
    ADD CONSTRAINT "contact_tag_links_pkey" PRIMARY KEY ("contact_id", "tag_id");



ALTER TABLE ONLY "public"."contact_tags"
    ADD CONSTRAINT "contact_tags_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."contact_tags"
    ADD CONSTRAINT "contact_tags_user_id_name_key" UNIQUE ("user_id", "name");



ALTER TABLE ONLY "public"."contacts"
    ADD CONSTRAINT "contacts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."cortex_anomalies"
    ADD CONSTRAINT "cortex_anomalies_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."cortex_areas"
    ADD CONSTRAINT "cortex_areas_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."cortex_areas"
    ADD CONSTRAINT "cortex_areas_user_id_key_key" UNIQUE ("user_id", "key");



ALTER TABLE ONLY "public"."cortex_events"
    ADD CONSTRAINT "cortex_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."cortex_patterns"
    ADD CONSTRAINT "cortex_patterns_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."cortex_patterns"
    ADD CONSTRAINT "cortex_patterns_user_id_area_key_key_key" UNIQUE ("user_id", "area_key", "key");



ALTER TABLE ONLY "public"."cortex_predictions"
    ADD CONSTRAINT "cortex_predictions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."cortex_signals"
    ADD CONSTRAINT "cortex_signals_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."cortex_signals"
    ADD CONSTRAINT "cortex_signals_user_id_area_key_window_date_scope_scope_ref_key" UNIQUE ("user_id", "area_key", "window_date", "scope", "scope_ref", "key");



ALTER TABLE ONLY "public"."council_consensus"
    ADD CONSTRAINT "council_consensus_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."council_decision_dossiers"
    ADD CONSTRAINT "council_decision_dossiers_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."council_members"
    ADD CONSTRAINT "council_members_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."council_opinions"
    ADD CONSTRAINT "council_opinions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."council_sessions"
    ADD CONSTRAINT "council_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."creative_artifacts"
    ADD CONSTRAINT "creative_artifacts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."creative_assets"
    ADD CONSTRAINT "creative_assets_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."creative_evaluations"
    ADD CONSTRAINT "creative_evaluations_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."creative_ideas"
    ADD CONSTRAINT "creative_ideas_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."creative_patterns"
    ADD CONSTRAINT "creative_patterns_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."creative_projects"
    ADD CONSTRAINT "creative_projects_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."creative_sessions"
    ADD CONSTRAINT "creative_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."creative_style_profiles"
    ADD CONSTRAINT "creative_style_profiles_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."crm_alerts"
    ADD CONSTRAINT "crm_alerts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."crm_contact_events"
    ADD CONSTRAINT "crm_contact_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."crm_contact_facts"
    ADD CONSTRAINT "crm_contact_facts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."crm_contact_intel"
    ADD CONSTRAINT "crm_contact_intel_owner_user_id_contact_id_key" UNIQUE ("owner_user_id", "contact_id");



ALTER TABLE ONLY "public"."crm_contact_intel"
    ADD CONSTRAINT "crm_contact_intel_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."crm_contact_intel_sources"
    ADD CONSTRAINT "crm_contact_intel_sources_contact_id_source_url_key" UNIQUE ("contact_id", "source_url");



ALTER TABLE ONLY "public"."crm_contact_intel_sources"
    ADD CONSTRAINT "crm_contact_intel_sources_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."crm_contact_org_links"
    ADD CONSTRAINT "crm_contact_org_links_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."crm_contact_org_links"
    ADD CONSTRAINT "crm_contact_org_links_user_id_contact_id_organization_id_key" UNIQUE ("user_id", "contact_id", "organization_id");



ALTER TABLE ONLY "public"."crm_contact_photo_candidates"
    ADD CONSTRAINT "crm_contact_photo_candidates_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."crm_contacts"
    ADD CONSTRAINT "crm_contacts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."crm_deal_contacts"
    ADD CONSTRAINT "crm_deal_contacts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."crm_deal_contacts"
    ADD CONSTRAINT "crm_deal_contacts_user_id_deal_id_contact_id_key" UNIQUE ("user_id", "deal_id", "contact_id");



ALTER TABLE ONLY "public"."crm_deal_health"
    ADD CONSTRAINT "crm_deal_health_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."crm_deal_health"
    ADD CONSTRAINT "crm_deal_health_user_id_deal_id_key" UNIQUE ("user_id", "deal_id");



ALTER TABLE ONLY "public"."crm_deals"
    ADD CONSTRAINT "crm_deals_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."crm_interactions"
    ADD CONSTRAINT "crm_interactions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."crm_organizations"
    ADD CONSTRAINT "crm_organizations_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."crm_relationship_health"
    ADD CONSTRAINT "crm_relationship_health_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."crm_relationship_health"
    ADD CONSTRAINT "crm_relationship_health_user_id_contact_id_key" UNIQUE ("user_id", "contact_id");



ALTER TABLE ONLY "public"."crm_tasks"
    ADD CONSTRAINT "crm_tasks_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."cron_locks"
    ADD CONSTRAINT "cron_locks_pkey" PRIMARY KEY ("key");



ALTER TABLE ONLY "public"."cultural_domains"
    ADD CONSTRAINT "cultural_domains_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."cultural_highlights"
    ADD CONSTRAINT "cultural_highlights_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."cultural_inference_snapshots"
    ADD CONSTRAINT "cultural_inference_snapshots_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."cultural_predictions"
    ADD CONSTRAINT "cultural_predictions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."cultural_profiles"
    ADD CONSTRAINT "cultural_profiles_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."cultural_signals"
    ADD CONSTRAINT "cultural_signals_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."culture_alignment_log"
    ADD CONSTRAINT "culture_alignment_log_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."culture_contexts"
    ADD CONSTRAINT "culture_contexts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."culture_norm_logs"
    ADD CONSTRAINT "culture_norm_logs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."culture_profiles"
    ADD CONSTRAINT "culture_profiles_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."daily_briefs"
    ADD CONSTRAINT "daily_briefs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."daily_briefs"
    ADD CONSTRAINT "daily_briefs_user_id_uuid_day_key" UNIQUE ("user_id_uuid", "day");



ALTER TABLE ONLY "public"."daily_quest_generation_runs"
    ADD CONSTRAINT "daily_quest_generation_runs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."daily_quests"
    ADD CONSTRAINT "daily_quests_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."daily_timeline_views"
    ADD CONSTRAINT "daily_timeline_views_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."daily_timeline_views"
    ADD CONSTRAINT "daily_timeline_views_user_id_date_timeline_id_branch_run_id_key" UNIQUE ("user_id", "date", "timeline_id", "branch_run_id", "mode");



ALTER TABLE ONLY "public"."dash_layouts"
    ADD CONSTRAINT "dash_layouts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."dash_layouts"
    ADD CONSTRAINT "dash_layouts_user_id_key" UNIQUE ("user_id");



ALTER TABLE ONLY "public"."dash_panels"
    ADD CONSTRAINT "dash_panels_key_key" UNIQUE ("key");



ALTER TABLE ONLY "public"."dash_panels"
    ADD CONSTRAINT "dash_panels_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."dashboard_telemetry_events"
    ADD CONSTRAINT "dashboard_telemetry_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."dashboard_telemetry"
    ADD CONSTRAINT "dashboard_telemetry_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."day_plans"
    ADD CONSTRAINT "day_plans_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."day_plans"
    ADD CONSTRAINT "day_plans_user_id_date_key" UNIQUE ("user_id", "date");



ALTER TABLE ONLY "public"."deal_archetype_runs"
    ADD CONSTRAINT "deal_archetype_runs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."deal_archetypes"
    ADD CONSTRAINT "deal_archetypes_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."deal_archetypes"
    ADD CONSTRAINT "deal_archetypes_slug_key" UNIQUE ("slug");



ALTER TABLE ONLY "public"."deal_intelligence"
    ADD CONSTRAINT "deal_intelligence_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."deal_participants"
    ADD CONSTRAINT "deal_participants_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."deal_stages"
    ADD CONSTRAINT "deal_stages_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."deal_stages"
    ADD CONSTRAINT "deal_stages_user_id_uuid_key_key" UNIQUE ("user_id_uuid", "key");



ALTER TABLE ONLY "public"."deals"
    ADD CONSTRAINT "deals_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."decision_options"
    ADD CONSTRAINT "decision_options_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."decision_scenarios"
    ADD CONSTRAINT "decision_scenarios_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."decision_tree_edges"
    ADD CONSTRAINT "decision_tree_edges_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."decision_tree_nodes"
    ADD CONSTRAINT "decision_tree_nodes_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."decision_trees"
    ADD CONSTRAINT "decision_trees_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."decisions"
    ADD CONSTRAINT "decisions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."delegated_drafts"
    ADD CONSTRAINT "delegated_drafts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."desire_profiles"
    ADD CONSTRAINT "desire_profiles_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."desire_profiles"
    ADD CONSTRAINT "desire_profiles_user_id_entity_type_entity_id_key" UNIQUE ("user_id", "entity_type", "entity_id");



ALTER TABLE ONLY "public"."desire_signals"
    ADD CONSTRAINT "desire_signals_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."destiny_alignment_log"
    ADD CONSTRAINT "destiny_alignment_log_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."destiny_anchor_choices"
    ADD CONSTRAINT "destiny_anchor_choices_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."destiny_arcs"
    ADD CONSTRAINT "destiny_arcs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."destiny_blueprints"
    ADD CONSTRAINT "destiny_blueprints_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."destiny_checkpoints"
    ADD CONSTRAINT "destiny_checkpoints_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."destiny_milestones"
    ADD CONSTRAINT "destiny_milestones_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."destiny_simulation_runs"
    ADD CONSTRAINT "destiny_simulation_runs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."destiny_timeline_scores"
    ADD CONSTRAINT "destiny_timeline_scores_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."destiny_timelines"
    ADD CONSTRAINT "destiny_timelines_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."destiny_waypoints"
    ADD CONSTRAINT "destiny_waypoints_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."domain_kpis"
    ADD CONSTRAINT "domain_kpis_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."domain_kpis"
    ADD CONSTRAINT "domain_kpis_user_id_domain_key_period_start_period_end_key" UNIQUE ("user_id", "domain_key", "period_start", "period_end");



ALTER TABLE ONLY "public"."efc_action_sequences"
    ADD CONSTRAINT "efc_action_sequences_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."efc_commitments"
    ADD CONSTRAINT "efc_commitments_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."efc_energy_states"
    ADD CONSTRAINT "efc_energy_states_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."efc_execution_log"
    ADD CONSTRAINT "efc_execution_log_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."efc_generated_actions"
    ADD CONSTRAINT "efc_generated_actions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."efc_nudges"
    ADD CONSTRAINT "efc_nudges_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."email_accounts"
    ADD CONSTRAINT "email_accounts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."email_accounts"
    ADD CONSTRAINT "email_accounts_user_id_provider_email_address_key" UNIQUE ("user_id", "provider", "email_address");



ALTER TABLE ONLY "public"."email_actions"
    ADD CONSTRAINT "email_actions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."email_daily_briefs"
    ADD CONSTRAINT "email_daily_briefs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."email_daily_briefs"
    ADD CONSTRAINT "email_daily_briefs_user_id_brief_date_key" UNIQUE ("user_id", "brief_date");



ALTER TABLE ONLY "public"."email_drafts"
    ADD CONSTRAINT "email_drafts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."email_events"
    ADD CONSTRAINT "email_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."email_followups"
    ADD CONSTRAINT "email_followups_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."email_items"
    ADD CONSTRAINT "email_items_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."email_items"
    ADD CONSTRAINT "email_items_user_id_message_id_key" UNIQUE ("user_id", "message_id");



ALTER TABLE ONLY "public"."email_messages"
    ADD CONSTRAINT "email_messages_email_account_id_remote_message_id_key" UNIQUE ("email_account_id", "remote_message_id");



ALTER TABLE ONLY "public"."email_messages"
    ADD CONSTRAINT "email_messages_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."email_outbox"
    ADD CONSTRAINT "email_outbox_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."email_resolution"
    ADD CONSTRAINT "email_resolution_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."email_send_audit"
    ADD CONSTRAINT "email_send_audit_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."email_suggested_drafts"
    ADD CONSTRAINT "email_suggested_drafts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."email_threads"
    ADD CONSTRAINT "email_threads_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."email_threads"
    ADD CONSTRAINT "email_threads_user_id_thread_id_key" UNIQUE ("user_id", "thread_id");



ALTER TABLE ONLY "public"."email_triage_items"
    ADD CONSTRAINT "email_triage_items_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."emails"
    ADD CONSTRAINT "emails_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."emo_adaptive_responses"
    ADD CONSTRAINT "emo_adaptive_responses_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."emo_checkins"
    ADD CONSTRAINT "emo_checkins_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."emo_goals"
    ADD CONSTRAINT "emo_goals_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."emo_interventions"
    ADD CONSTRAINT "emo_interventions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."emo_profiles"
    ADD CONSTRAINT "emo_profiles_pkey" PRIMARY KEY ("user_id");



ALTER TABLE ONLY "public"."emo_states"
    ADD CONSTRAINT "emo_states_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."emo_transitions"
    ADD CONSTRAINT "emo_transitions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."emotion_channel_settings"
    ADD CONSTRAINT "emotion_channel_settings_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."emotion_interaction_log"
    ADD CONSTRAINT "emotion_interaction_log_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."emotion_resonance_events"
    ADD CONSTRAINT "emotion_resonance_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."emotion_samples"
    ADD CONSTRAINT "emotion_samples_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."emotion_state_daily"
    ADD CONSTRAINT "emotion_state_daily_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."emotion_state_daily"
    ADD CONSTRAINT "emotion_state_daily_user_id_state_date_key" UNIQUE ("user_id", "state_date");



ALTER TABLE ONLY "public"."emotion_style_profile"
    ADD CONSTRAINT "emotion_style_profile_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."emotional_checkins"
    ADD CONSTRAINT "emotional_checkins_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."emotional_patterns"
    ADD CONSTRAINT "emotional_patterns_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."emotional_support_logs"
    ADD CONSTRAINT "emotional_support_logs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."empathic_events"
    ADD CONSTRAINT "empathic_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."ethical_policies"
    ADD CONSTRAINT "ethical_policies_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."ethical_policies"
    ADD CONSTRAINT "ethical_policies_user_id_scope_domain_key_key" UNIQUE ("user_id", "scope", "domain", "key");



ALTER TABLE ONLY "public"."execution_logs"
    ADD CONSTRAINT "execution_logs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."execution_runs"
    ADD CONSTRAINT "execution_runs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."executions"
    ADD CONSTRAINT "executions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."executive_council_members"
    ADD CONSTRAINT "executive_council_members_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."executive_council_votes"
    ADD CONSTRAINT "executive_council_votes_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."executive_summaries"
    ADD CONSTRAINT "executive_summaries_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."executive_summaries"
    ADD CONSTRAINT "executive_summaries_user_id_period_type_period_start_key" UNIQUE ("user_id", "period_type", "period_start");



ALTER TABLE ONLY "public"."experience_events"
    ADD CONSTRAINT "experience_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."experiment_metrics"
    ADD CONSTRAINT "experiment_metrics_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."experiment_templates"
    ADD CONSTRAINT "experiment_templates_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."feedback"
    ADD CONSTRAINT "feedback_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."finance_accounts"
    ADD CONSTRAINT "finance_accounts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."finance_alerts"
    ADD CONSTRAINT "finance_alerts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."finance_budgets"
    ADD CONSTRAINT "finance_budgets_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."finance_budgets"
    ADD CONSTRAINT "finance_budgets_user_id_month_category_key" UNIQUE ("user_id", "month", "category");



ALTER TABLE ONLY "public"."finance_goals"
    ADD CONSTRAINT "finance_goals_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."finance_snapshots"
    ADD CONSTRAINT "finance_snapshots_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."finance_snapshots"
    ADD CONSTRAINT "finance_snapshots_user_id_period_start_period_type_key" UNIQUE ("user_id", "period_start", "period_type");



ALTER TABLE ONLY "public"."finance_transactions"
    ADD CONSTRAINT "finance_transactions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."financial_accounts"
    ADD CONSTRAINT "financial_accounts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."financial_budget_envelopes"
    ADD CONSTRAINT "financial_budget_envelopes_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."financial_budgets"
    ADD CONSTRAINT "financial_budgets_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."financial_connections"
    ADD CONSTRAINT "financial_connections_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."financial_entities"
    ADD CONSTRAINT "financial_entities_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."financial_imported_transactions"
    ADD CONSTRAINT "financial_imported_transactions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."financial_ledger_entries"
    ADD CONSTRAINT "financial_ledger_entries_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."financial_ledger_lines"
    ADD CONSTRAINT "financial_ledger_lines_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."financial_snapshots"
    ADD CONSTRAINT "financial_snapshots_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."focus_locks"
    ADD CONSTRAINT "focus_locks_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."focus_sessions"
    ADD CONSTRAINT "focus_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."follow_ups"
    ADD CONSTRAINT "follow_ups_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."gift_ideas"
    ADD CONSTRAINT "gift_ideas_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."goal_hierarchy"
    ADD CONSTRAINT "goal_hierarchy_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."goals"
    ADD CONSTRAINT "goals_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."guardrail_events"
    ADD CONSTRAINT "guardrail_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."habit_completions"
    ADD CONSTRAINT "habit_completions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."habit_logs"
    ADD CONSTRAINT "habit_logs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."habit_streaks"
    ADD CONSTRAINT "habit_streaks_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."habit_streaks"
    ADD CONSTRAINT "habit_streaks_user_id_habit_name_key" UNIQUE ("user_id", "habit_name");



ALTER TABLE ONLY "public"."habits"
    ADD CONSTRAINT "habits_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."household_members"
    ADD CONSTRAINT "household_members_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."households"
    ADD CONSTRAINT "households_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."id_aspirations"
    ADD CONSTRAINT "id_aspirations_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."id_beliefs"
    ADD CONSTRAINT "id_beliefs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."id_growth_areas"
    ADD CONSTRAINT "id_growth_areas_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."id_momentum_daily"
    ADD CONSTRAINT "id_momentum_daily_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."id_momentum_daily"
    ADD CONSTRAINT "id_momentum_daily_user_id_identity_id_date_key" UNIQUE ("user_id", "identity_id", "date");



ALTER TABLE ONLY "public"."id_narrative_chapters"
    ADD CONSTRAINT "id_narrative_chapters_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."id_roles"
    ADD CONSTRAINT "id_roles_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."id_snapshots"
    ADD CONSTRAINT "id_snapshots_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."id_strengths"
    ADD CONSTRAINT "id_strengths_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."id_values"
    ADD CONSTRAINT "id_values_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."identity_arcs"
    ADD CONSTRAINT "identity_arcs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."identity_arcs"
    ADD CONSTRAINT "identity_arcs_user_id_key_key" UNIQUE ("user_id", "key");



ALTER TABLE ONLY "public"."identity_events"
    ADD CONSTRAINT "identity_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."identity_transforms"
    ADD CONSTRAINT "identity_transforms_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."identity_users"
    ADD CONSTRAINT "identity_users_clerk_user_id_key" UNIQUE ("clerk_user_id");



ALTER TABLE ONLY "public"."identity_users"
    ADD CONSTRAINT "identity_users_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."inbox_actions"
    ADD CONSTRAINT "inbox_actions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."inbox_items"
    ADD CONSTRAINT "inbox_items_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."inbox_rule_outcomes"
    ADD CONSTRAINT "inbox_rule_outcomes_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."inbox_rule_runs"
    ADD CONSTRAINT "inbox_rule_runs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."inbox_rules"
    ADD CONSTRAINT "inbox_rules_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."inbox_triage_events"
    ADD CONSTRAINT "inbox_triage_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."industries"
    ADD CONSTRAINT "industries_name_key" UNIQUE ("name");



ALTER TABLE ONLY "public"."industries"
    ADD CONSTRAINT "industries_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."inner_monologue_entries"
    ADD CONSTRAINT "inner_monologue_entries_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."inner_monologue_turns"
    ADD CONSTRAINT "inner_monologue_turns_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."interaction_events"
    ADD CONSTRAINT "interaction_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."interactions"
    ADD CONSTRAINT "interactions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_categories"
    ADD CONSTRAINT "job_categories_industry_id_name_key" UNIQUE ("industry_id", "name");



ALTER TABLE ONLY "public"."job_categories"
    ADD CONSTRAINT "job_categories_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_graph_nodes"
    ADD CONSTRAINT "job_graph_nodes_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_kpis"
    ADD CONSTRAINT "job_kpis_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_provider_health"
    ADD CONSTRAINT "job_provider_health_pkey" PRIMARY KEY ("provider");



ALTER TABLE ONLY "public"."job_provider_incidents"
    ADD CONSTRAINT "job_provider_incidents_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_queue_agent_budgets"
    ADD CONSTRAINT "job_queue_agent_budgets_pkey" PRIMARY KEY ("agent_id");



ALTER TABLE ONLY "public"."job_queue_agents"
    ADD CONSTRAINT "job_queue_agents_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_queue_alerts"
    ADD CONSTRAINT "job_queue_alerts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_queue_budget_ledger"
    ADD CONSTRAINT "job_queue_budget_ledger_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_queue_budget_rollover"
    ADD CONSTRAINT "job_queue_budget_rollover_pkey" PRIMARY KEY ("user_id", "day");



ALTER TABLE ONLY "public"."job_queue_credit_balances"
    ADD CONSTRAINT "job_queue_credit_balances_pkey" PRIMARY KEY ("user_id");



ALTER TABLE ONLY "public"."job_queue_credits_ledger"
    ADD CONSTRAINT "job_queue_credits_ledger_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_queue_daily_budget"
    ADD CONSTRAINT "job_queue_daily_budget_pkey" PRIMARY KEY ("user_id", "day");



ALTER TABLE ONLY "public"."job_queue_events"
    ADD CONSTRAINT "job_queue_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_queue_fairness_ledger"
    ADD CONSTRAINT "job_queue_fairness_ledger_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_queue_health_snapshots"
    ADD CONSTRAINT "job_queue_health_snapshots_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_queue_lane_quota"
    ADD CONSTRAINT "job_queue_lane_quota_pkey" PRIMARY KEY ("user_id", "day", "lane");



ALTER TABLE ONLY "public"."job_queue"
    ADD CONSTRAINT "job_queue_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_queue_pricing"
    ADD CONSTRAINT "job_queue_pricing_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_queue_pricing"
    ADD CONSTRAINT "job_queue_pricing_tier_kind_key" UNIQUE ("tier", "kind");



ALTER TABLE ONLY "public"."job_queue_rate_window"
    ADD CONSTRAINT "job_queue_rate_window_pkey" PRIMARY KEY ("user_id", "window_start", "window_seconds");



ALTER TABLE ONLY "public"."job_queue_results"
    ADD CONSTRAINT "job_queue_results_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_queue_scheduler_decisions"
    ADD CONSTRAINT "job_queue_scheduler_decisions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_queue_tiers"
    ADD CONSTRAINT "job_queue_tiers_pkey" PRIMARY KEY ("tier");



ALTER TABLE ONLY "public"."job_queue_user_tiers"
    ADD CONSTRAINT "job_queue_user_tiers_pkey" PRIMARY KEY ("user_id");



ALTER TABLE ONLY "public"."job_requests"
    ADD CONSTRAINT "job_requests_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_runs"
    ADD CONSTRAINT "job_runs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_scorecards"
    ADD CONSTRAINT "job_scorecards_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_scorecards"
    ADD CONSTRAINT "job_scorecards_user_id_job_graph_node_id_date_key" UNIQUE ("user_id", "job_graph_node_id", "date");



ALTER TABLE ONLY "public"."job_titles"
    ADD CONSTRAINT "job_titles_category_id_name_key" UNIQUE ("category_id", "name");



ALTER TABLE ONLY "public"."job_titles"
    ADD CONSTRAINT "job_titles_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."job_verticals"
    ADD CONSTRAINT "job_verticals_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."journal_entries"
    ADD CONSTRAINT "journal_entries_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."knowledge_context_links"
    ADD CONSTRAINT "knowledge_context_links_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."knowledge_contexts"
    ADD CONSTRAINT "knowledge_contexts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."knowledge_edges"
    ADD CONSTRAINT "knowledge_edges_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."knowledge_nodes"
    ADD CONSTRAINT "knowledge_nodes_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."lb_daily_metrics"
    ADD CONSTRAINT "lb_daily_metrics_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."lb_daily_metrics"
    ADD CONSTRAINT "lb_daily_metrics_user_id_date_key" UNIQUE ("user_id", "date");



ALTER TABLE ONLY "public"."lb_insights"
    ADD CONSTRAINT "lb_insights_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."league_members"
    ADD CONSTRAINT "league_members_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."league_scores"
    ADD CONSTRAINT "league_scores_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."leagues"
    ADD CONSTRAINT "leagues_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."life_arc_autopilot_runs"
    ADD CONSTRAINT "life_arc_autopilot_runs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."life_arc_autopilot_suggestions"
    ADD CONSTRAINT "life_arc_autopilot_suggestions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."life_arc_checkpoints"
    ADD CONSTRAINT "life_arc_checkpoints_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."life_arc_daily_focus"
    ADD CONSTRAINT "life_arc_daily_focus_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."life_arc_objectives"
    ADD CONSTRAINT "life_arc_objectives_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."life_arc_objectives"
    ADD CONSTRAINT "life_arc_objectives_user_id_arc_id_week_start_date_key" UNIQUE ("user_id", "arc_id", "week_start_date");



ALTER TABLE ONLY "public"."life_arc_quests"
    ADD CONSTRAINT "life_arc_quests_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."life_arc_risk_events"
    ADD CONSTRAINT "life_arc_risk_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."life_arc_sources"
    ADD CONSTRAINT "life_arc_sources_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."life_arcs"
    ADD CONSTRAINT "life_arcs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."life_canon_entries"
    ADD CONSTRAINT "life_canon_entries_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."life_canon_snapshots"
    ADD CONSTRAINT "life_canon_snapshots_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."life_chapters"
    ADD CONSTRAINT "life_chapters_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."life_chapters"
    ADD CONSTRAINT "life_chapters_user_id_chapter_index_key" UNIQUE ("user_id", "chapter_index");



ALTER TABLE ONLY "public"."life_domains"
    ADD CONSTRAINT "life_domains_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."life_domains"
    ADD CONSTRAINT "life_domains_user_id_key_key" UNIQUE ("user_id", "key");



ALTER TABLE ONLY "public"."life_events"
    ADD CONSTRAINT "life_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."life_evidence"
    ADD CONSTRAINT "life_evidence_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."life_themes"
    ADD CONSTRAINT "life_themes_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."life_themes"
    ADD CONSTRAINT "life_themes_user_id_key_key" UNIQUE ("user_id", "key");



ALTER TABLE ONLY "public"."long_chapters"
    ADD CONSTRAINT "long_chapters_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."long_milestones"
    ADD CONSTRAINT "long_milestones_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."long_predictions"
    ADD CONSTRAINT "long_predictions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."long_snapshots"
    ADD CONSTRAINT "long_snapshots_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."long_trajectories"
    ADD CONSTRAINT "long_trajectories_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."long_trends"
    ADD CONSTRAINT "long_trends_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mc_events"
    ADD CONSTRAINT "mc_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mc_interventions"
    ADD CONSTRAINT "mc_interventions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mc_strategy_profiles"
    ADD CONSTRAINT "mc_strategy_profiles_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mc_strategy_profiles"
    ADD CONSTRAINT "mc_strategy_profiles_user_id_key" UNIQUE ("user_id");



ALTER TABLE ONLY "public"."mem_archives"
    ADD CONSTRAINT "mem_archives_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mem_compressed"
    ADD CONSTRAINT "mem_compressed_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mem_compression_jobs"
    ADD CONSTRAINT "mem_compression_jobs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mem_compression_settings"
    ADD CONSTRAINT "mem_compression_settings_pkey" PRIMARY KEY ("user_id");



ALTER TABLE ONLY "public"."memories"
    ADD CONSTRAINT "memories_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."memory_events"
    ADD CONSTRAINT "memory_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."memory_patterns"
    ADD CONSTRAINT "memory_patterns_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."memory_patterns"
    ADD CONSTRAINT "memory_patterns_user_id_pattern_type_key" UNIQUE ("user_id", "pattern_type");



ALTER TABLE ONLY "public"."mind_models"
    ADD CONSTRAINT "mind_models_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mind_models"
    ADD CONSTRAINT "mind_models_user_id_entity_type_entity_id_key" UNIQUE ("user_id", "entity_type", "entity_id");



ALTER TABLE ONLY "public"."motor_routine_metrics"
    ADD CONSTRAINT "motor_routine_metrics_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."motor_routine_runs"
    ADD CONSTRAINT "motor_routine_runs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."motor_routine_steps"
    ADD CONSTRAINT "motor_routine_steps_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."motor_routine_triggers"
    ADD CONSTRAINT "motor_routine_triggers_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."motor_routines"
    ADD CONSTRAINT "motor_routines_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mythic_achievements"
    ADD CONSTRAINT "mythic_achievements_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mythic_archetypes"
    ADD CONSTRAINT "mythic_archetypes_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mythic_archetypes"
    ADD CONSTRAINT "mythic_archetypes_slug_key" UNIQUE ("slug");



ALTER TABLE ONLY "public"."mythic_arcs"
    ADD CONSTRAINT "mythic_arcs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mythic_belt_levels"
    ADD CONSTRAINT "mythic_belt_levels_archetype_id_belt_rank_key" UNIQUE ("archetype_id", "belt_rank");



ALTER TABLE ONLY "public"."mythic_belt_levels"
    ADD CONSTRAINT "mythic_belt_levels_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mythic_belt_progress"
    ADD CONSTRAINT "mythic_belt_progress_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mythic_coach_sessions"
    ADD CONSTRAINT "mythic_coach_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mythic_playbooks"
    ADD CONSTRAINT "mythic_playbooks_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mythic_playbooks"
    ADD CONSTRAINT "mythic_playbooks_slug_key" UNIQUE ("slug");



ALTER TABLE ONLY "public"."mythic_quests"
    ADD CONSTRAINT "mythic_quests_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mythic_rituals"
    ADD CONSTRAINT "mythic_rituals_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mythic_sessions"
    ADD CONSTRAINT "mythic_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mythic_training_focus"
    ADD CONSTRAINT "mythic_training_focus_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mythic_training_missions"
    ADD CONSTRAINT "mythic_training_missions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mythic_training_plans"
    ADD CONSTRAINT "mythic_training_plans_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mythic_training_reflections"
    ADD CONSTRAINT "mythic_training_reflections_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."mythic_voice_mappings"
    ADD CONSTRAINT "mythic_voice_mappings_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."narrative_snapshots"
    ADD CONSTRAINT "narrative_snapshots_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."notes"
    ADD CONSTRAINT "notes_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."notification_log"
    ADD CONSTRAINT "notification_log_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."notification_preferences"
    ADD CONSTRAINT "notification_preferences_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."notification_preferences"
    ADD CONSTRAINT "notification_preferences_user_id_key" UNIQUE ("user_id");



ALTER TABLE ONLY "public"."notification_queue"
    ADD CONSTRAINT "notification_queue_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."onboarding_conversations"
    ADD CONSTRAINT "onboarding_conversations_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."onboarding_state"
    ADD CONSTRAINT "onboarding_state_pkey" PRIMARY KEY ("user_id");



ALTER TABLE ONLY "public"."ops_audit_log"
    ADD CONSTRAINT "ops_audit_log_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."ops_automation_locks"
    ADD CONSTRAINT "ops_automation_locks_pkey" PRIMARY KEY ("key");



ALTER TABLE ONLY "public"."ops_incident_events"
    ADD CONSTRAINT "ops_incident_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."ops_incidents"
    ADD CONSTRAINT "ops_incidents_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."org_members"
    ADD CONSTRAINT "org_members_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."organizations"
    ADD CONSTRAINT "organizations_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."organizations"
    ADD CONSTRAINT "organizations_slug_key" UNIQUE ("slug");



ALTER TABLE ONLY "public"."persona_arc_events"
    ADD CONSTRAINT "persona_arc_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."persona_archetype_stats"
    ADD CONSTRAINT "persona_archetype_stats_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."persona_archetypes"
    ADD CONSTRAINT "persona_archetypes_key_key" UNIQUE ("key");



ALTER TABLE ONLY "public"."persona_archetypes"
    ADD CONSTRAINT "persona_archetypes_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."persona_companion_events"
    ADD CONSTRAINT "persona_companion_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."persona_companion_highlights"
    ADD CONSTRAINT "persona_companion_highlights_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."persona_companion_state"
    ADD CONSTRAINT "persona_companion_state_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."persona_dna_templates"
    ADD CONSTRAINT "persona_dna_templates_key_key" UNIQUE ("key");



ALTER TABLE ONLY "public"."persona_dna_templates"
    ADD CONSTRAINT "persona_dna_templates_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."persona_interaction_stats"
    ADD CONSTRAINT "persona_interaction_stats_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."persona_interaction_stats"
    ADD CONSTRAINT "persona_interaction_stats_user_id_persona_key_key" UNIQUE ("user_id", "persona_key");



ALTER TABLE ONLY "public"."persona_memory_snapshots"
    ADD CONSTRAINT "persona_memory_snapshots_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."persona_microstyle_prefs"
    ADD CONSTRAINT "persona_microstyle_prefs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."persona_style_variants"
    ADD CONSTRAINT "persona_style_variants_persona_key_variant_key_key" UNIQUE ("persona_key", "variant_key");



ALTER TABLE ONLY "public"."persona_style_variants"
    ADD CONSTRAINT "persona_style_variants_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."persona_user_arc"
    ADD CONSTRAINT "persona_user_arc_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."personal_heuristics"
    ADD CONSTRAINT "personal_heuristics_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."personal_heuristics"
    ADD CONSTRAINT "personal_heuristics_user_id_key_key" UNIQUE ("user_id", "key");



ALTER TABLE ONLY "public"."personas"
    ADD CONSTRAINT "personas_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."philosophy_exercises"
    ADD CONSTRAINT "philosophy_exercises_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."philosophy_lessons"
    ADD CONSTRAINT "philosophy_lessons_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."philosophy_schools"
    ADD CONSTRAINT "philosophy_schools_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."plan_items"
    ADD CONSTRAINT "plan_items_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."planning_constraints"
    ADD CONSTRAINT "planning_constraints_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."planning_decisions"
    ADD CONSTRAINT "planning_decisions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."planning_overrides"
    ADD CONSTRAINT "planning_overrides_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."planning_sessions"
    ADD CONSTRAINT "planning_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."plugin_api_keys"
    ADD CONSTRAINT "plugin_api_keys_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."plugin_automations"
    ADD CONSTRAINT "plugin_automations_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."plugin_data"
    ADD CONSTRAINT "plugin_data_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."plugin_events"
    ADD CONSTRAINT "plugin_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."plugin_webhooks"
    ADD CONSTRAINT "plugin_webhooks_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."plugins"
    ADD CONSTRAINT "plugins_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."plugins"
    ADD CONSTRAINT "plugins_slug_key" UNIQUE ("slug");



ALTER TABLE ONLY "public"."prefrontal_goals"
    ADD CONSTRAINT "prefrontal_goals_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."presence_daily_summaries"
    ADD CONSTRAINT "presence_daily_summaries_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."presence_decisions"
    ADD CONSTRAINT "presence_decisions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."presence_events"
    ADD CONSTRAINT "presence_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."proactive_interventions"
    ADD CONSTRAINT "proactive_interventions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."profiles"
    ADD CONSTRAINT "profiles_clerk_user_id_key" UNIQUE ("clerk_user_id");



ALTER TABLE ONLY "public"."profiles"
    ADD CONSTRAINT "profiles_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."pulse_brain_preferences"
    ADD CONSTRAINT "pulse_brain_preferences_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."pulse_brain_surface_events"
    ADD CONSTRAINT "pulse_brain_surface_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."pulse_docs"
    ADD CONSTRAINT "pulse_docs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."pulse_events"
    ADD CONSTRAINT "pulse_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."pulse_insight_acknowledgements"
    ADD CONSTRAINT "pulse_insight_acknowledgements_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."pulse_introduction_sessions"
    ADD CONSTRAINT "pulse_introduction_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."push_subscriptions"
    ADD CONSTRAINT "push_subscriptions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."push_subscriptions"
    ADD CONSTRAINT "push_subscriptions_user_id_endpoint_key" UNIQUE ("user_id", "endpoint");



ALTER TABLE ONLY "public"."quest_catalog"
    ADD CONSTRAINT "quest_catalog_pkey" PRIMARY KEY ("quest_key");



ALTER TABLE ONLY "public"."quest_completions"
    ADD CONSTRAINT "quest_completions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."referral_rewards"
    ADD CONSTRAINT "referral_rewards_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."relational_identities"
    ADD CONSTRAINT "relational_identities_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."relational_predictions"
    ADD CONSTRAINT "relational_predictions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."relational_state_snapshots"
    ADD CONSTRAINT "relational_state_snapshots_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."relationship_highlights"
    ADD CONSTRAINT "relationship_highlights_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."relationship_interactions"
    ADD CONSTRAINT "relationship_interactions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."relationships"
    ADD CONSTRAINT "relationships_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."reminder_subscriptions"
    ADD CONSTRAINT "reminder_subscriptions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."reply_drafts"
    ADD CONSTRAINT "reply_drafts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."response_style_profiles"
    ADD CONSTRAINT "response_style_profiles_key_key" UNIQUE ("key");



ALTER TABLE ONLY "public"."response_style_profiles"
    ADD CONSTRAINT "response_style_profiles_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."safety_incidents"
    ADD CONSTRAINT "safety_incidents_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."safety_policies"
    ADD CONSTRAINT "safety_policies_key_key" UNIQUE ("key");



ALTER TABLE ONLY "public"."safety_policies"
    ADD CONSTRAINT "safety_policies_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."scheduler_targets"
    ADD CONSTRAINT "scheduler_targets_pkey" PRIMARY KEY ("user_id");



ALTER TABLE ONLY "public"."self_identity_snapshots"
    ADD CONSTRAINT "self_identity_snapshots_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."self_mirror_deltas"
    ADD CONSTRAINT "self_mirror_deltas_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."self_mirror_facets"
    ADD CONSTRAINT "self_mirror_facets_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."self_mirror_facets"
    ADD CONSTRAINT "self_mirror_facets_user_id_key_key" UNIQUE ("user_id", "key");



ALTER TABLE ONLY "public"."self_mirror_highlights"
    ADD CONSTRAINT "self_mirror_highlights_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."self_mirror_sessions"
    ADD CONSTRAINT "self_mirror_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."self_mirror_snapshots"
    ADD CONSTRAINT "self_mirror_snapshots_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."self_perception_signals"
    ADD CONSTRAINT "self_perception_signals_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."sim_decision_trees"
    ADD CONSTRAINT "sim_decision_trees_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."sim_history"
    ADD CONSTRAINT "sim_history_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."sim_runs"
    ADD CONSTRAINT "sim_runs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."sim_scenarios"
    ADD CONSTRAINT "sim_scenarios_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."sim_simulations"
    ADD CONSTRAINT "sim_simulations_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."sim_templates"
    ADD CONSTRAINT "sim_templates_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."sim_what_ifs"
    ADD CONSTRAINT "sim_what_ifs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."simulation_fix_plans"
    ADD CONSTRAINT "simulation_fix_plans_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."simulation_metrics"
    ADD CONSTRAINT "simulation_metrics_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."simulation_models"
    ADD CONSTRAINT "simulation_models_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."simulation_outcomes"
    ADD CONSTRAINT "simulation_outcomes_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."simulation_policies"
    ADD CONSTRAINT "simulation_policies_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."simulation_policies"
    ADD CONSTRAINT "simulation_policies_user_id_key_key" UNIQUE ("user_id", "key");



ALTER TABLE ONLY "public"."simulation_runs"
    ADD CONSTRAINT "simulation_runs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."simulation_steps"
    ADD CONSTRAINT "simulation_steps_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."simulation_timelines"
    ADD CONSTRAINT "simulation_timelines_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."sms_messages"
    ADD CONSTRAINT "sms_messages_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."social_edges"
    ADD CONSTRAINT "social_edges_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."social_entities"
    ADD CONSTRAINT "social_entities_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."social_insights"
    ADD CONSTRAINT "social_insights_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."social_nodes"
    ADD CONSTRAINT "social_nodes_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."social_nodes"
    ADD CONSTRAINT "social_nodes_user_id_node_type_node_id_key" UNIQUE ("user_id", "node_type", "node_id");



ALTER TABLE ONLY "public"."social_recommendations"
    ADD CONSTRAINT "social_recommendations_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."social_risk_events"
    ADD CONSTRAINT "social_risk_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."social_state_snapshots"
    ADD CONSTRAINT "social_state_snapshots_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."somatic_alerts"
    ADD CONSTRAINT "somatic_alerts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."somatic_daily_metrics"
    ADD CONSTRAINT "somatic_daily_metrics_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."somatic_daily_metrics"
    ADD CONSTRAINT "somatic_daily_metrics_user_id_metrics_date_key" UNIQUE ("user_id", "metrics_date");



ALTER TABLE ONLY "public"."somatic_device_settings"
    ADD CONSTRAINT "somatic_device_settings_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."somatic_patterns"
    ADD CONSTRAINT "somatic_patterns_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."somatic_raw_device_events"
    ADD CONSTRAINT "somatic_raw_device_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."somatic_samples"
    ADD CONSTRAINT "somatic_samples_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."somatic_state_daily"
    ADD CONSTRAINT "somatic_state_daily_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."somatic_state_daily"
    ADD CONSTRAINT "somatic_state_daily_user_id_state_date_key" UNIQUE ("user_id", "state_date");



ALTER TABLE ONLY "public"."strategic_conflicts"
    ADD CONSTRAINT "strategic_conflicts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."strategic_domains"
    ADD CONSTRAINT "strategic_domains_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."strategic_equilibria"
    ADD CONSTRAINT "strategic_equilibria_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."strategic_objectives"
    ADD CONSTRAINT "strategic_objectives_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."strategic_plans"
    ADD CONSTRAINT "strategic_plans_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."strategic_playbooks"
    ADD CONSTRAINT "strategic_playbooks_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."strategic_playbooks"
    ADD CONSTRAINT "strategic_playbooks_slug_key" UNIQUE ("slug");



ALTER TABLE ONLY "public"."strategic_review_events"
    ADD CONSTRAINT "strategic_review_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."strategic_state_snapshots"
    ADD CONSTRAINT "strategic_state_snapshots_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."strategist_sessions"
    ADD CONSTRAINT "strategist_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."strategy_actions"
    ADD CONSTRAINT "strategy_actions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."strategy_feedback"
    ADD CONSTRAINT "strategy_feedback_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."strategy_paths"
    ADD CONSTRAINT "strategy_paths_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."strategy_pillars"
    ADD CONSTRAINT "strategy_pillars_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."strategy_recommendations"
    ADD CONSTRAINT "strategy_recommendations_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."strategy_snapshots"
    ADD CONSTRAINT "strategy_snapshots_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."streaks"
    ADD CONSTRAINT "streaks_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."streaks"
    ADD CONSTRAINT "streaks_user_id_streak_type_key" UNIQUE ("user_id", "streak_type");



ALTER TABLE ONLY "public"."system_capabilities"
    ADD CONSTRAINT "system_capabilities_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."system_capability_health"
    ADD CONSTRAINT "system_capability_health_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."system_changelog"
    ADD CONSTRAINT "system_changelog_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."system_diagnostics_findings"
    ADD CONSTRAINT "system_diagnostics_findings_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."system_diagnostics_runs"
    ADD CONSTRAINT "system_diagnostics_runs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."system_experiment_runs"
    ADD CONSTRAINT "system_experiment_runs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."system_experiments"
    ADD CONSTRAINT "system_experiments_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."system_improvement_ideas"
    ADD CONSTRAINT "system_improvement_ideas_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."system_module_health"
    ADD CONSTRAINT "system_module_health_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."system_module_metrics"
    ADD CONSTRAINT "system_module_metrics_module_id_date_key" UNIQUE ("module_id", "date");



ALTER TABLE ONLY "public"."system_module_metrics"
    ADD CONSTRAINT "system_module_metrics_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."system_modules"
    ADD CONSTRAINT "system_modules_key_key" UNIQUE ("key");



ALTER TABLE ONLY "public"."system_modules"
    ADD CONSTRAINT "system_modules_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."system_user_feedback"
    ADD CONSTRAINT "system_user_feedback_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."task_events"
    ADD CONSTRAINT "task_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."tasks"
    ADD CONSTRAINT "tasks_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."tb_chapters"
    ADD CONSTRAINT "tb_chapters_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."tb_context_snapshots"
    ADD CONSTRAINT "tb_context_snapshots_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."tb_edges"
    ADD CONSTRAINT "tb_edges_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."tb_embeddings"
    ADD CONSTRAINT "tb_embeddings_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."tb_entities"
    ADD CONSTRAINT "tb_entities_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."tb_entity_edges"
    ADD CONSTRAINT "tb_entity_edges_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."tb_entity_fragment_links"
    ADD CONSTRAINT "tb_entity_fragment_links_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."tb_insights"
    ADD CONSTRAINT "tb_insights_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."tb_memory_fragments"
    ADD CONSTRAINT "tb_memory_fragments_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."tb_node_types"
    ADD CONSTRAINT "tb_node_types_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."tb_nodes"
    ADD CONSTRAINT "tb_nodes_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."tb_raw_events"
    ADD CONSTRAINT "tb_raw_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."tb_user_patterns"
    ADD CONSTRAINT "tb_user_patterns_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."teachings"
    ADD CONSTRAINT "teachings_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."theory_of_mind_profiles"
    ADD CONSTRAINT "theory_of_mind_profiles_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."third_brain_events"
    ADD CONSTRAINT "third_brain_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."third_brain_insights"
    ADD CONSTRAINT "third_brain_insights_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."third_brain_memories"
    ADD CONSTRAINT "third_brain_memories_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."third_brain_memories"
    ADD CONSTRAINT "third_brain_memories_user_id_key_key" UNIQUE ("user_id", "key");



ALTER TABLE ONLY "public"."timeline_coach_sessions"
    ADD CONSTRAINT "timeline_coach_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."timeline_commitments"
    ADD CONSTRAINT "timeline_commitments_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."timeline_decisions"
    ADD CONSTRAINT "timeline_decisions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."timeline_preference_profile"
    ADD CONSTRAINT "timeline_preference_profile_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."timeline_reflections"
    ADD CONSTRAINT "timeline_reflections_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."usage_logs"
    ADD CONSTRAINT "usage_logs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."user_agi_settings"
    ADD CONSTRAINT "user_agi_settings_pkey" PRIMARY KEY ("user_id");



ALTER TABLE ONLY "public"."user_archetype_profiles"
    ADD CONSTRAINT "user_archetype_profiles_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."user_dashboard_layouts"
    ADD CONSTRAINT "user_dashboard_layouts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."user_experiment_arms"
    ADD CONSTRAINT "user_experiment_arms_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."user_experiment_data_points"
    ADD CONSTRAINT "user_experiment_data_points_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."user_experiment_results"
    ADD CONSTRAINT "user_experiment_results_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."user_experiments"
    ADD CONSTRAINT "user_experiments_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."user_focus_profile"
    ADD CONSTRAINT "user_focus_profile_pkey" PRIMARY KEY ("user_id");



ALTER TABLE ONLY "public"."user_interview_sessions"
    ADD CONSTRAINT "user_interview_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."user_job_profiles"
    ADD CONSTRAINT "user_job_profiles_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."user_job_profiles"
    ADD CONSTRAINT "user_job_profiles_user_id_key" UNIQUE ("user_id");



ALTER TABLE ONLY "public"."user_mythic_coach_settings"
    ADD CONSTRAINT "user_mythic_coach_settings_pkey" PRIMARY KEY ("user_id");



ALTER TABLE ONLY "public"."user_mythic_profile"
    ADD CONSTRAINT "user_mythic_profile_pkey" PRIMARY KEY ("user_id");



ALTER TABLE ONLY "public"."user_onboarding_state"
    ADD CONSTRAINT "user_onboarding_state_pkey" PRIMARY KEY ("user_id");



ALTER TABLE ONLY "public"."user_packs"
    ADD CONSTRAINT "user_packs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."user_packs"
    ADD CONSTRAINT "user_packs_user_id_pack_id_key" UNIQUE ("user_id", "pack_id");



ALTER TABLE ONLY "public"."user_persona_tuning"
    ADD CONSTRAINT "user_persona_tuning_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."user_persona_tuning"
    ADD CONSTRAINT "user_persona_tuning_user_id_persona_key_key" UNIQUE ("user_id", "persona_key");



ALTER TABLE ONLY "public"."user_philosophy_progress"
    ADD CONSTRAINT "user_philosophy_progress_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."user_plugins"
    ADD CONSTRAINT "user_plugins_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."user_prefs"
    ADD CONSTRAINT "user_prefs_pkey" PRIMARY KEY ("user_id");



ALTER TABLE ONLY "public"."user_profiles"
    ADD CONSTRAINT "user_profiles_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."user_profiles"
    ADD CONSTRAINT "user_profiles_referral_code_key" UNIQUE ("referral_code");



ALTER TABLE ONLY "public"."user_profiles"
    ADD CONSTRAINT "user_profiles_user_id_key" UNIQUE ("user_id");



ALTER TABLE ONLY "public"."user_safety_settings"
    ADD CONSTRAINT "user_safety_settings_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."user_safety_settings"
    ADD CONSTRAINT "user_safety_settings_user_id_key" UNIQUE ("user_id");



ALTER TABLE ONLY "public"."user_settings"
    ADD CONSTRAINT "user_settings_pkey" PRIMARY KEY ("user_id");



ALTER TABLE ONLY "public"."users"
    ADD CONSTRAINT "users_clerk_id_key" UNIQUE ("clerk_user_id");



ALTER TABLE ONLY "public"."users"
    ADD CONSTRAINT "users_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."value_profile"
    ADD CONSTRAINT "value_profile_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."vault_access_log"
    ADD CONSTRAINT "vault_access_log_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."vault_emergency_access"
    ADD CONSTRAINT "vault_emergency_access_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."vault_items"
    ADD CONSTRAINT "vault_items_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."vault_keys"
    ADD CONSTRAINT "vault_keys_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."vault_secure_notes"
    ADD CONSTRAINT "vault_secure_notes_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."vault_shares"
    ADD CONSTRAINT "vault_shares_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."vertical_metrics"
    ADD CONSTRAINT "vertical_metrics_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."voice_profiles"
    ADD CONSTRAINT "voice_profiles_key_key" UNIQUE ("key");



ALTER TABLE ONLY "public"."voice_profiles"
    ADD CONSTRAINT "voice_profiles_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."voice_sessions"
    ADD CONSTRAINT "voice_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."voice_turns"
    ADD CONSTRAINT "voice_turns_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."voicemails"
    ADD CONSTRAINT "voicemails_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."weekly_plans"
    ADD CONSTRAINT "weekly_plans_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."weekly_plans"
    ADD CONSTRAINT "weekly_plans_user_id_week_start_key" UNIQUE ("user_id", "week_start");



ALTER TABLE ONLY "public"."what_if_outcomes"
    ADD CONSTRAINT "what_if_outcomes_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."what_if_runs"
    ADD CONSTRAINT "what_if_runs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."what_if_scenarios"
    ADD CONSTRAINT "what_if_scenarios_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."wisdom_lessons"
    ADD CONSTRAINT "wisdom_lessons_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."wisdom_playbooks"
    ADD CONSTRAINT "wisdom_playbooks_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."wisdom_playbooks"
    ADD CONSTRAINT "wisdom_playbooks_user_id_key_key" UNIQUE ("user_id", "key");



ALTER TABLE ONLY "public"."wisdom_refresh_runs"
    ADD CONSTRAINT "wisdom_refresh_runs_pkey" PRIMARY KEY ("user_id");



ALTER TABLE ONLY "public"."work_scoreboard_days"
    ADD CONSTRAINT "work_scoreboard_days_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."work_scoreboard_days"
    ADD CONSTRAINT "work_scoreboard_days_user_id_uuid_day_key" UNIQUE ("user_id_uuid", "day");



ALTER TABLE ONLY "public"."workspace_day_log"
    ADD CONSTRAINT "workspace_day_log_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."workspace_day_log"
    ADD CONSTRAINT "workspace_day_log_user_id_date_key" UNIQUE ("user_id", "date");



ALTER TABLE ONLY "public"."workspace_focus_sessions"
    ADD CONSTRAINT "workspace_focus_sessions_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."workspace_focus_states"
    ADD CONSTRAINT "workspace_focus_states_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."workspace_interrupts"
    ADD CONSTRAINT "workspace_interrupts_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."workspace_state"
    ADD CONSTRAINT "workspace_state_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."workspace_state"
    ADD CONSTRAINT "workspace_state_user_id_state_date_key" UNIQUE ("user_id", "state_date");



ALTER TABLE ONLY "public"."workspace_threads"
    ADD CONSTRAINT "workspace_threads_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."workspace_timeline_links"
    ADD CONSTRAINT "workspace_timeline_links_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."workspaces"
    ADD CONSTRAINT "workspaces_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."xp_evaluation_runs"
    ADD CONSTRAINT "xp_evaluation_runs_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."xp_evaluation_runs"
    ADD CONSTRAINT "xp_evaluation_runs_user_id_evidence_id_evaluator_key_evalua_key" UNIQUE ("user_id", "evidence_id", "evaluator_key", "evaluator_version");



ALTER TABLE ONLY "public"."xp_evaluators"
    ADD CONSTRAINT "xp_evaluators_key_version_key" UNIQUE ("key", "version");



ALTER TABLE ONLY "public"."xp_evaluators"
    ADD CONSTRAINT "xp_evaluators_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."xp_events"
    ADD CONSTRAINT "xp_events_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."xp_ledger"
    ADD CONSTRAINT "xp_ledger_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."xp_ledger"
    ADD CONSTRAINT "xp_ledger_user_id_xp_type_source_kind_source_id_key" UNIQUE ("user_id", "xp_type", "source_kind", "source_id");



ALTER TABLE ONLY "public"."xp_transactions"
    ADD CONSTRAINT "xp_transactions_pkey" PRIMARY KEY ("id");



CREATE INDEX "achievements_user_id_idx" ON "public"."achievements" USING "btree" ("user_id");



CREATE INDEX "achievements_user_id_uuid_idx" ON "public"."achievements" USING "btree" ("user_id_uuid");



CREATE INDEX "activity_events_created_at_idx" ON "public"."activity_events" USING "btree" ("created_at" DESC);



CREATE INDEX "activity_events_event_name_idx" ON "public"."activity_events" USING "btree" ("event_name");



CREATE INDEX "activity_events_event_type_idx" ON "public"."activity_events" USING "btree" ("event_type");



CREATE INDEX "activity_events_user_created_at_idx" ON "public"."activity_events" USING "btree" ("user_id", "created_at");



CREATE INDEX "activity_events_user_event_ts_idx" ON "public"."activity_events" USING "btree" ("user_id", "event_ts");



CREATE INDEX "activity_events_user_id_created_at_idx" ON "public"."activity_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "activity_events_user_id_idx" ON "public"."activity_events" USING "btree" ("user_id");



CREATE INDEX "activity_events_user_id_text_idx" ON "public"."activity_events" USING "btree" ("user_id_text");



CREATE INDEX "activity_events_user_id_uuid_idx" ON "public"."activity_events" USING "btree" ("user_id_uuid");



CREATE INDEX "ag_messages_user_id_idx" ON "public"."ag_messages" USING "btree" ("user_id");



CREATE INDEX "ag_messages_user_id_uuid_idx" ON "public"."ag_messages" USING "btree" ("user_id_uuid");



CREATE INDEX "ag_runs_user_id_idx" ON "public"."ag_runs" USING "btree" ("user_id");



CREATE INDEX "ag_runs_user_id_uuid_idx" ON "public"."ag_runs" USING "btree" ("user_id_uuid");



CREATE INDEX "agi_actions_run_id_idx" ON "public"."agi_actions" USING "btree" ("run_id");



CREATE INDEX "agi_actions_status_idx" ON "public"."agi_actions" USING "btree" ("status");



CREATE INDEX "agi_actions_user_id_idx" ON "public"."agi_actions" USING "btree" ("user_id");



CREATE INDEX "agi_actions_user_id_text_idx" ON "public"."agi_actions" USING "btree" ("user_id_text");



CREATE INDEX "agi_actions_user_id_uuid_idx" ON "public"."agi_actions" USING "btree" ("user_id_uuid");



CREATE INDEX "agi_agent_profiles_agent_name_idx" ON "public"."agi_agent_profiles" USING "btree" ("agent_name");



CREATE INDEX "agi_agent_profiles_user_id_idx" ON "public"."agi_agent_profiles" USING "btree" ("user_id");



CREATE INDEX "agi_agent_profiles_user_id_text_idx" ON "public"."agi_agent_profiles" USING "btree" ("user_id_text");



CREATE INDEX "agi_agent_profiles_user_id_uuid_idx" ON "public"."agi_agent_profiles" USING "btree" ("user_id_uuid");



CREATE INDEX "agi_feedback_action_id_idx" ON "public"."agi_feedback" USING "btree" ("action_id");



CREATE INDEX "agi_feedback_user_id_idx" ON "public"."agi_feedback" USING "btree" ("user_id");



CREATE INDEX "agi_feedback_user_id_text_idx" ON "public"."agi_feedback" USING "btree" ("user_id_text");



CREATE INDEX "agi_feedback_user_id_uuid_idx" ON "public"."agi_feedback" USING "btree" ("user_id_uuid");



CREATE INDEX "agi_policies_enabled_idx" ON "public"."agi_policies" USING "btree" ("enabled");



CREATE INDEX "agi_policies_user_id_idx" ON "public"."agi_policies" USING "btree" ("user_id");



CREATE INDEX "agi_policies_user_id_text_idx" ON "public"."agi_policies" USING "btree" ("user_id_text");



CREATE INDEX "agi_policies_user_id_uuid_idx" ON "public"."agi_policies" USING "btree" ("user_id_uuid");



CREATE INDEX "agi_runs_started_at_idx" ON "public"."agi_runs" USING "btree" ("started_at");



CREATE INDEX "agi_runs_user_id_idx" ON "public"."agi_runs" USING "btree" ("user_id");



CREATE INDEX "agi_runs_user_id_text_idx" ON "public"."agi_runs" USING "btree" ("user_id_text");



CREATE INDEX "agi_runs_user_id_uuid_idx" ON "public"."agi_runs" USING "btree" ("user_id_uuid");



CREATE INDEX "agi_scenario_runs_user_id_idx" ON "public"."agi_scenario_runs" USING "btree" ("user_id");



CREATE INDEX "agi_scenario_runs_user_id_text_idx" ON "public"."agi_scenario_runs" USING "btree" ("user_id_text");



CREATE INDEX "agi_scenario_runs_user_id_uuid_idx" ON "public"."agi_scenario_runs" USING "btree" ("user_id_uuid");



CREATE INDEX "agi_telemetry_user_id_idx" ON "public"."agi_telemetry" USING "btree" ("user_id");



CREATE INDEX "agi_telemetry_user_id_text_idx" ON "public"."agi_telemetry" USING "btree" ("user_id_text");



CREATE INDEX "agi_telemetry_user_id_uuid_idx" ON "public"."agi_telemetry" USING "btree" ("user_id_uuid");



CREATE INDEX "agi_user_profile_tone_idx" ON "public"."agi_user_profile" USING "btree" ("tone");



CREATE INDEX "agi_user_profile_user_id_idx" ON "public"."agi_user_profile" USING "btree" ("user_id");



CREATE INDEX "agi_user_profile_user_id_text_idx" ON "public"."agi_user_profile" USING "btree" ("user_id_text");



CREATE INDEX "agi_user_profile_user_id_uuid_idx" ON "public"."agi_user_profile" USING "btree" ("user_id_uuid");



CREATE INDEX "align_feedback_user_id_idx" ON "public"."align_feedback" USING "btree" ("user_id");



CREATE INDEX "align_feedback_user_id_uuid_idx" ON "public"."align_feedback" USING "btree" ("user_id_uuid");



CREATE INDEX "align_user_profiles_user_id_idx" ON "public"."align_user_profiles" USING "btree" ("user_id");



CREATE INDEX "align_user_profiles_user_id_uuid_idx" ON "public"."align_user_profiles" USING "btree" ("user_id_uuid");



CREATE INDEX "align_violations_user_id_idx" ON "public"."align_violations" USING "btree" ("user_id");



CREATE INDEX "align_violations_user_id_uuid_idx" ON "public"."align_violations" USING "btree" ("user_id_uuid");



CREATE INDEX "alignment_evaluations_user_id_idx" ON "public"."alignment_evaluations" USING "btree" ("user_id");



CREATE INDEX "alignment_evaluations_user_id_text_idx" ON "public"."alignment_evaluations" USING "btree" ("user_id_text");



CREATE INDEX "alignment_evaluations_user_id_uuid_idx" ON "public"."alignment_evaluations" USING "btree" ("user_id_uuid");



CREATE INDEX "archetype_events_user_id_idx" ON "public"."archetype_events" USING "btree" ("user_id");



CREATE INDEX "archetype_events_user_id_text_idx" ON "public"."archetype_events" USING "btree" ("user_id_text");



CREATE INDEX "archetype_events_user_id_uuid_idx" ON "public"."archetype_events" USING "btree" ("user_id_uuid");



CREATE INDEX "archetype_snapshots_user_id_idx" ON "public"."archetype_snapshots" USING "btree" ("user_id");



CREATE INDEX "archetype_snapshots_user_id_text_idx" ON "public"."archetype_snapshots" USING "btree" ("user_id_text");



CREATE INDEX "archetype_snapshots_user_id_uuid_idx" ON "public"."archetype_snapshots" USING "btree" ("user_id_uuid");



CREATE INDEX "artifact_links_user_id_idx" ON "public"."artifact_links" USING "btree" ("user_id");



CREATE INDEX "artifact_links_user_id_text_idx" ON "public"."artifact_links" USING "btree" ("user_id_text");



CREATE INDEX "artifact_links_user_id_uuid_idx" ON "public"."artifact_links" USING "btree" ("user_id_uuid");



CREATE INDEX "attention_events_user_id_idx" ON "public"."attention_events" USING "btree" ("user_id");



CREATE INDEX "attention_events_user_id_text_idx" ON "public"."attention_events" USING "btree" ("user_id_text");



CREATE INDEX "attention_events_user_id_uuid_idx" ON "public"."attention_events" USING "btree" ("user_id_uuid");



CREATE INDEX "autonomy_actions_user_id_idx" ON "public"."autonomy_actions" USING "btree" ("user_id");



CREATE INDEX "autonomy_actions_user_id_uuid_idx" ON "public"."autonomy_actions" USING "btree" ("user_id_uuid");



CREATE INDEX "autopilot_jobs_requested_at_idx" ON "public"."autopilot_jobs" USING "btree" ("requested_at" DESC);



CREATE INDEX "autopilot_jobs_status_idx" ON "public"."autopilot_jobs" USING "btree" ("status");



CREATE INDEX "autopilot_jobs_user_id_idx" ON "public"."autopilot_jobs" USING "btree" ("user_id");



CREATE INDEX "autopilot_jobs_user_id_text_idx" ON "public"."autopilot_jobs" USING "btree" ("user_id_text");



CREATE INDEX "autopilot_jobs_user_id_uuid_idx" ON "public"."autopilot_jobs" USING "btree" ("user_id_uuid");



CREATE INDEX "autopilot_suggestions_created_at_idx" ON "public"."autopilot_suggestions" USING "btree" ("created_at" DESC);



CREATE INDEX "autopilot_suggestions_job_id_idx" ON "public"."autopilot_suggestions" USING "btree" ("job_id");



CREATE INDEX "autopilot_suggestions_status_idx" ON "public"."autopilot_suggestions" USING "btree" ("status");



CREATE INDEX "autopilot_suggestions_user_id_idx" ON "public"."autopilot_suggestions" USING "btree" ("user_id");



CREATE INDEX "autopilot_suggestions_user_id_text_idx" ON "public"."autopilot_suggestions" USING "btree" ("user_id_text");



CREATE INDEX "autopilot_suggestions_user_id_uuid_idx" ON "public"."autopilot_suggestions" USING "btree" ("user_id_uuid");



CREATE INDEX "behavior_predictions_user_id_idx" ON "public"."behavior_predictions" USING "btree" ("user_id");



CREATE INDEX "behavior_predictions_user_id_text_idx" ON "public"."behavior_predictions" USING "btree" ("user_id_text");



CREATE INDEX "behavior_predictions_user_id_uuid_idx" ON "public"."behavior_predictions" USING "btree" ("user_id_uuid");



CREATE INDEX "brain_capabilities_user_id_idx" ON "public"."brain_capabilities" USING "btree" ("user_id");



CREATE INDEX "brain_capabilities_user_id_text_idx" ON "public"."brain_capabilities" USING "btree" ("user_id_text");



CREATE INDEX "brain_capabilities_user_id_uuid_idx" ON "public"."brain_capabilities" USING "btree" ("user_id_uuid");



CREATE INDEX "brain_changelog_user_id_idx" ON "public"."brain_changelog" USING "btree" ("user_id");



CREATE INDEX "brain_changelog_user_id_text_idx" ON "public"."brain_changelog" USING "btree" ("user_id_text");



CREATE INDEX "brain_changelog_user_id_uuid_idx" ON "public"."brain_changelog" USING "btree" ("user_id_uuid");



CREATE INDEX "brain_entries_user_id_idx" ON "public"."brain_entries" USING "btree" ("user_id");



CREATE INDEX "brain_entries_user_id_uuid_idx" ON "public"."brain_entries" USING "btree" ("user_id_uuid");



CREATE INDEX "brain_error_events_user_id_idx" ON "public"."brain_error_events" USING "btree" ("user_id");



CREATE INDEX "brain_error_events_user_id_text_idx" ON "public"."brain_error_events" USING "btree" ("user_id_text");



CREATE INDEX "brain_error_events_user_id_uuid_idx" ON "public"."brain_error_events" USING "btree" ("user_id_uuid");



CREATE INDEX "brain_events_user_id_idx" ON "public"."brain_events" USING "btree" ("user_id");



CREATE INDEX "brain_events_user_id_text_idx" ON "public"."brain_events" USING "btree" ("user_id_text");



CREATE INDEX "brain_events_user_id_uuid_idx" ON "public"."brain_events" USING "btree" ("user_id_uuid");



CREATE INDEX "brain_health_snapshots_user_id_idx" ON "public"."brain_health_snapshots" USING "btree" ("user_id");



CREATE INDEX "brain_health_snapshots_user_id_text_idx" ON "public"."brain_health_snapshots" USING "btree" ("user_id_text");



CREATE INDEX "brain_health_snapshots_user_id_uuid_idx" ON "public"."brain_health_snapshots" USING "btree" ("user_id_uuid");



CREATE INDEX "brain_subsystems_user_id_idx" ON "public"."brain_subsystems" USING "btree" ("user_id");



CREATE INDEX "brain_subsystems_user_id_text_idx" ON "public"."brain_subsystems" USING "btree" ("user_id_text");



CREATE INDEX "brain_subsystems_user_id_uuid_idx" ON "public"."brain_subsystems" USING "btree" ("user_id_uuid");



CREATE INDEX "brainstem_status_user_id_idx" ON "public"."brainstem_status" USING "btree" ("user_id");



CREATE INDEX "brainstem_status_user_id_text_idx" ON "public"."brainstem_status" USING "btree" ("user_id_text");



CREATE INDEX "brainstem_status_user_id_uuid_idx" ON "public"."brainstem_status" USING "btree" ("user_id_uuid");



CREATE INDEX "butler_notifications_user_id_idx" ON "public"."butler_notifications" USING "btree" ("user_id");



CREATE INDEX "butler_notifications_user_id_uuid_idx" ON "public"."butler_notifications" USING "btree" ("user_id_uuid");



CREATE INDEX "butler_snoozes_user_id_idx" ON "public"."butler_snoozes" USING "btree" ("user_id");



CREATE INDEX "butler_snoozes_user_id_uuid_idx" ON "public"."butler_snoozes" USING "btree" ("user_id_uuid");



CREATE INDEX "calendar_accounts_user_id_idx" ON "public"."calendar_accounts" USING "btree" ("user_id");



CREATE INDEX "calendar_accounts_user_id_uuid_idx" ON "public"."calendar_accounts" USING "btree" ("user_id_uuid");



CREATE INDEX "calendar_events_cache_user_id_idx" ON "public"."calendar_events_cache" USING "btree" ("user_id");



CREATE INDEX "calendar_events_cache_user_id_uuid_idx" ON "public"."calendar_events_cache" USING "btree" ("user_id_uuid");



CREATE INDEX "call_intelligence_settings_user_id_idx" ON "public"."call_intelligence_settings" USING "btree" ("user_id");



CREATE INDEX "call_intelligence_settings_user_id_text_idx" ON "public"."call_intelligence_settings" USING "btree" ("user_id_text");



CREATE INDEX "call_intelligence_settings_user_id_uuid_idx" ON "public"."call_intelligence_settings" USING "btree" ("user_id_uuid");



CREATE INDEX "call_links_call_id_idx" ON "public"."call_links" USING "btree" ("call_id");



CREATE INDEX "call_links_entity_idx" ON "public"."call_links" USING "btree" ("entity_type", "entity_id");



CREATE INDEX "call_segments_call_id_idx" ON "public"."call_segments" USING "btree" ("call_id");



CREATE INDEX "call_sessions_provider_call_id_idx" ON "public"."call_sessions" USING "btree" ("provider_call_id");



CREATE INDEX "call_sessions_user_id_idx" ON "public"."call_sessions" USING "btree" ("user_id");



CREATE INDEX "call_sessions_user_id_text_idx" ON "public"."call_sessions" USING "btree" ("user_id_text");



CREATE INDEX "call_sessions_user_id_uuid_idx" ON "public"."call_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "call_summaries_call_id_idx" ON "public"."call_summaries" USING "btree" ("call_id");



CREATE INDEX "call_summaries_user_id_idx" ON "public"."call_summaries" USING "btree" ("user_id");



CREATE INDEX "call_summaries_user_id_text_idx" ON "public"."call_summaries" USING "btree" ("user_id_text");



CREATE INDEX "call_summaries_user_id_uuid_idx" ON "public"."call_summaries" USING "btree" ("user_id_uuid");



CREATE INDEX "calls_user_id_idx" ON "public"."calls" USING "btree" ("user_id");



CREATE INDEX "calls_user_id_text_idx" ON "public"."calls" USING "btree" ("user_id_text");



CREATE INDEX "calls_user_id_uuid_idx" ON "public"."calls" USING "btree" ("user_id_uuid");



CREATE INDEX "campaign_enrollments_user_id_idx" ON "public"."campaign_enrollments" USING "btree" ("user_id");



CREATE INDEX "campaign_enrollments_user_id_uuid_idx" ON "public"."campaign_enrollments" USING "btree" ("user_id_uuid");



CREATE INDEX "campaigns_user_id_idx" ON "public"."campaigns" USING "btree" ("user_id");



CREATE INDEX "campaigns_user_id_uuid_idx" ON "public"."campaigns" USING "btree" ("user_id_uuid");



CREATE INDEX "canon_events_user_id_idx" ON "public"."canon_events" USING "btree" ("user_id");



CREATE INDEX "canon_events_user_id_text_idx" ON "public"."canon_events" USING "btree" ("user_id_text");



CREATE INDEX "canon_events_user_id_uuid_idx" ON "public"."canon_events" USING "btree" ("user_id_uuid");



CREATE INDEX "canon_timeline_index_user_id_idx" ON "public"."canon_timeline_index" USING "btree" ("user_id");



CREATE INDEX "canon_timeline_index_user_id_text_idx" ON "public"."canon_timeline_index" USING "btree" ("user_id_text");



CREATE INDEX "canon_timeline_index_user_id_uuid_idx" ON "public"."canon_timeline_index" USING "btree" ("user_id_uuid");



CREATE INDEX "chapter_archetypes_user_id_idx" ON "public"."chapter_archetypes" USING "btree" ("user_id");



CREATE INDEX "chapter_archetypes_user_id_text_idx" ON "public"."chapter_archetypes" USING "btree" ("user_id_text");



CREATE INDEX "chapter_archetypes_user_id_uuid_idx" ON "public"."chapter_archetypes" USING "btree" ("user_id_uuid");



CREATE INDEX "civilization_domain_mappings_user_id_idx" ON "public"."civilization_domain_mappings" USING "btree" ("user_id");



CREATE INDEX "civilization_domain_mappings_user_id_text_idx" ON "public"."civilization_domain_mappings" USING "btree" ("user_id_text");



CREATE INDEX "civilization_domain_mappings_user_id_uuid_idx" ON "public"."civilization_domain_mappings" USING "btree" ("user_id_uuid");



CREATE INDEX "civilization_domains_user_id_idx" ON "public"."civilization_domains" USING "btree" ("user_id");



CREATE INDEX "civilization_domains_user_id_text_idx" ON "public"."civilization_domains" USING "btree" ("user_id_text");



CREATE INDEX "civilization_domains_user_id_uuid_idx" ON "public"."civilization_domains" USING "btree" ("user_id_uuid");



CREATE UNIQUE INDEX "civilization_patterns_key_unique" ON "public"."civilization_patterns" USING "btree" ("domain", "key");



CREATE INDEX "civilization_settings_user_id_idx" ON "public"."civilization_settings" USING "btree" ("user_id");



CREATE INDEX "civilization_settings_user_id_text_idx" ON "public"."civilization_settings" USING "btree" ("user_id_text");



CREATE INDEX "civilization_settings_user_id_uuid_idx" ON "public"."civilization_settings" USING "btree" ("user_id_uuid");



CREATE INDEX "coach_council_deliberations_session_idx" ON "public"."coach_council_deliberations" USING "btree" ("session_id");



CREATE INDEX "coach_council_members_session_idx" ON "public"."coach_council_members" USING "btree" ("session_id");



CREATE INDEX "coach_council_sessions_user_id_idx" ON "public"."coach_council_sessions" USING "btree" ("user_id");



CREATE INDEX "coach_council_sessions_user_id_text_idx" ON "public"."coach_council_sessions" USING "btree" ("user_id_text");



CREATE INDEX "coach_council_sessions_user_id_uuid_idx" ON "public"."coach_council_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "coach_council_sessions_user_idx" ON "public"."coach_council_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "coach_generated_scenarios_user_id_idx" ON "public"."coach_generated_scenarios" USING "btree" ("user_id");



CREATE INDEX "coach_generated_scenarios_user_id_text_idx" ON "public"."coach_generated_scenarios" USING "btree" ("user_id_text");



CREATE INDEX "coach_generated_scenarios_user_id_uuid_idx" ON "public"."coach_generated_scenarios" USING "btree" ("user_id_uuid");



CREATE INDEX "coach_generated_scenarios_user_idx" ON "public"."coach_generated_scenarios" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "coach_multi_agent_sessions_user_id_idx" ON "public"."coach_multi_agent_sessions" USING "btree" ("user_id");



CREATE INDEX "coach_multi_agent_sessions_user_id_text_idx" ON "public"."coach_multi_agent_sessions" USING "btree" ("user_id_text");



CREATE INDEX "coach_multi_agent_sessions_user_id_uuid_idx" ON "public"."coach_multi_agent_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "coach_multi_agent_sessions_user_idx" ON "public"."coach_multi_agent_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE UNIQUE INDEX "coach_roleplay_scenarios_unique_default" ON "public"."coach_roleplay_scenarios" USING "btree" ("coach_id", "scenario_type") WHERE ("is_default" = true);



CREATE INDEX "coach_scenarios_coach_type_idx" ON "public"."coach_scenarios" USING "btree" ("coach_type", "difficulty");



CREATE INDEX "coach_scenarios_tags_idx" ON "public"."coach_scenarios" USING "gin" ("topic_tags");



CREATE INDEX "coach_sessions_user_id_idx" ON "public"."coach_sessions" USING "btree" ("user_id");



CREATE INDEX "coach_sessions_user_id_text_idx" ON "public"."coach_sessions" USING "btree" ("user_id_text");



CREATE INDEX "coach_sessions_user_id_uuid_idx" ON "public"."coach_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "coach_training_sessions_user_id_idx" ON "public"."coach_training_sessions" USING "btree" ("user_id");



CREATE INDEX "coach_training_sessions_user_id_text_idx" ON "public"."coach_training_sessions" USING "btree" ("user_id_text");



CREATE INDEX "coach_training_sessions_user_id_uuid_idx" ON "public"."coach_training_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "coach_training_sessions_user_idx" ON "public"."coach_training_sessions" USING "btree" ("user_id", "coach_id", "created_at" DESC);



CREATE INDEX "coach_user_preferences_user_id_idx" ON "public"."coach_user_preferences" USING "btree" ("user_id");



CREATE INDEX "coach_user_preferences_user_id_text_idx" ON "public"."coach_user_preferences" USING "btree" ("user_id_text");



CREATE INDEX "coach_user_preferences_user_id_uuid_idx" ON "public"."coach_user_preferences" USING "btree" ("user_id_uuid");



CREATE INDEX "coach_user_preferences_user_idx" ON "public"."coach_user_preferences" USING "btree" ("user_id", "coach_type");



CREATE INDEX "coach_voice_sessions_user_id_idx" ON "public"."coach_voice_sessions" USING "btree" ("user_id");



CREATE INDEX "coach_voice_sessions_user_id_text_idx" ON "public"."coach_voice_sessions" USING "btree" ("user_id_text");



CREATE INDEX "coach_voice_sessions_user_id_uuid_idx" ON "public"."coach_voice_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "coach_voice_sessions_user_idx" ON "public"."coach_voice_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "cognitive_hypotheses_user_id_idx" ON "public"."cognitive_hypotheses" USING "btree" ("user_id");



CREATE INDEX "cognitive_hypotheses_user_id_text_idx" ON "public"."cognitive_hypotheses" USING "btree" ("user_id_text");



CREATE INDEX "cognitive_hypotheses_user_id_uuid_idx" ON "public"."cognitive_hypotheses" USING "btree" ("user_id_uuid");



CREATE INDEX "cognitive_insights_user_id_idx" ON "public"."cognitive_insights" USING "btree" ("user_id");



CREATE INDEX "cognitive_insights_user_id_text_idx" ON "public"."cognitive_insights" USING "btree" ("user_id_text");



CREATE INDEX "cognitive_insights_user_id_uuid_idx" ON "public"."cognitive_insights" USING "btree" ("user_id_uuid");



CREATE INDEX "cognitive_phases_user_id_idx" ON "public"."cognitive_phases" USING "btree" ("user_id");



CREATE INDEX "cognitive_phases_user_id_text_idx" ON "public"."cognitive_phases" USING "btree" ("user_id_text");



CREATE INDEX "cognitive_phases_user_id_uuid_idx" ON "public"."cognitive_phases" USING "btree" ("user_id_uuid");



CREATE INDEX "cognitive_runs_user_id_idx" ON "public"."cognitive_runs" USING "btree" ("user_id");



CREATE INDEX "cognitive_runs_user_id_text_idx" ON "public"."cognitive_runs" USING "btree" ("user_id_text");



CREATE INDEX "cognitive_runs_user_id_uuid_idx" ON "public"."cognitive_runs" USING "btree" ("user_id_uuid");



CREATE INDEX "cognitive_self_reflections_user_id_idx" ON "public"."cognitive_self_reflections" USING "btree" ("user_id");



CREATE INDEX "cognitive_self_reflections_user_id_text_idx" ON "public"."cognitive_self_reflections" USING "btree" ("user_id_text");



CREATE INDEX "cognitive_self_reflections_user_id_uuid_idx" ON "public"."cognitive_self_reflections" USING "btree" ("user_id_uuid");



CREATE INDEX "cognitive_update_actions_user_id_idx" ON "public"."cognitive_update_actions" USING "btree" ("user_id");



CREATE INDEX "cognitive_update_actions_user_id_text_idx" ON "public"."cognitive_update_actions" USING "btree" ("user_id_text");



CREATE INDEX "cognitive_update_actions_user_id_uuid_idx" ON "public"."cognitive_update_actions" USING "btree" ("user_id_uuid");



CREATE UNIQUE INDEX "communication_programs_key_unique" ON "public"."communication_programs" USING "btree" ("key");



CREATE INDEX "communication_sessions_user_id_idx" ON "public"."communication_sessions" USING "btree" ("user_id");



CREATE INDEX "communication_sessions_user_id_text_idx" ON "public"."communication_sessions" USING "btree" ("user_id_text");



CREATE INDEX "communication_sessions_user_id_uuid_idx" ON "public"."communication_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "communication_turns_session_id_idx" ON "public"."communication_turns" USING "btree" ("session_id");



CREATE INDEX "conscious_conflicts_user_id_idx" ON "public"."conscious_conflicts" USING "btree" ("user_id");



CREATE INDEX "conscious_conflicts_user_id_text_idx" ON "public"."conscious_conflicts" USING "btree" ("user_id_text");



CREATE INDEX "conscious_conflicts_user_id_uuid_idx" ON "public"."conscious_conflicts" USING "btree" ("user_id_uuid");



CREATE INDEX "conscious_frames_user_id_idx" ON "public"."conscious_frames" USING "btree" ("user_id");



CREATE INDEX "conscious_frames_user_id_text_idx" ON "public"."conscious_frames" USING "btree" ("user_id_text");



CREATE INDEX "conscious_frames_user_id_uuid_idx" ON "public"."conscious_frames" USING "btree" ("user_id_uuid");



CREATE INDEX "conscious_insights_user_id_idx" ON "public"."conscious_insights" USING "btree" ("user_id");



CREATE INDEX "conscious_insights_user_id_text_idx" ON "public"."conscious_insights" USING "btree" ("user_id_text");



CREATE INDEX "conscious_insights_user_id_uuid_idx" ON "public"."conscious_insights" USING "btree" ("user_id_uuid");



CREATE INDEX "conscious_items_user_id_idx" ON "public"."conscious_items" USING "btree" ("user_id");



CREATE INDEX "conscious_items_user_id_text_idx" ON "public"."conscious_items" USING "btree" ("user_id_text");



CREATE INDEX "conscious_items_user_id_uuid_idx" ON "public"."conscious_items" USING "btree" ("user_id_uuid");



CREATE INDEX "conscious_links_user_id_idx" ON "public"."conscious_links" USING "btree" ("user_id");



CREATE INDEX "conscious_links_user_id_text_idx" ON "public"."conscious_links" USING "btree" ("user_id_text");



CREATE INDEX "conscious_links_user_id_uuid_idx" ON "public"."conscious_links" USING "btree" ("user_id_uuid");



CREATE INDEX "contact_dates_user_id_idx" ON "public"."contact_dates" USING "btree" ("user_id");



CREATE INDEX "contact_dates_user_id_text_idx" ON "public"."contact_dates" USING "btree" ("user_id_text");



CREATE INDEX "contact_dates_user_id_uuid_idx" ON "public"."contact_dates" USING "btree" ("user_id_uuid");



CREATE INDEX "contact_emails_user_id_idx" ON "public"."contact_emails" USING "btree" ("user_id");



CREATE INDEX "contact_emails_user_id_text_idx" ON "public"."contact_emails" USING "btree" ("user_id_text");



CREATE INDEX "contact_emails_user_id_uuid_idx" ON "public"."contact_emails" USING "btree" ("user_id_uuid");



CREATE INDEX "contact_facts_user_id_idx" ON "public"."contact_facts" USING "btree" ("user_id");



CREATE INDEX "contact_facts_user_id_text_idx" ON "public"."contact_facts" USING "btree" ("user_id_text");



CREATE INDEX "contact_facts_user_id_uuid_idx" ON "public"."contact_facts" USING "btree" ("user_id_uuid");



CREATE INDEX "contact_identity_intel_user_contact_idx" ON "public"."contact_identity_intel" USING "btree" ("user_id", "contact_id");



CREATE INDEX "contact_identity_intel_user_id_idx" ON "public"."contact_identity_intel" USING "btree" ("user_id");



CREATE INDEX "contact_identity_intel_user_id_text_idx" ON "public"."contact_identity_intel" USING "btree" ("user_id_text");



CREATE INDEX "contact_identity_intel_user_id_uuid_idx" ON "public"."contact_identity_intel" USING "btree" ("user_id_uuid");



CREATE INDEX "contact_influence_events_user_contact_idx" ON "public"."contact_influence_events" USING "btree" ("user_id", "contact_id", "created_at" DESC);



CREATE INDEX "contact_influence_events_user_id_idx" ON "public"."contact_influence_events" USING "btree" ("user_id");



CREATE INDEX "contact_influence_events_user_id_text_idx" ON "public"."contact_influence_events" USING "btree" ("user_id_text");



CREATE INDEX "contact_influence_events_user_id_uuid_idx" ON "public"."contact_influence_events" USING "btree" ("user_id_uuid");



CREATE INDEX "contact_intel_sources_contact_idx" ON "public"."contact_intelligence_sources" USING "btree" ("contact_id", "fetched_at" DESC);



CREATE INDEX "contact_intelligence_sources_user_id_idx" ON "public"."contact_intelligence_sources" USING "btree" ("user_id");



CREATE INDEX "contact_intelligence_sources_user_id_text_idx" ON "public"."contact_intelligence_sources" USING "btree" ("user_id_text");



CREATE INDEX "contact_intelligence_sources_user_id_uuid_idx" ON "public"."contact_intelligence_sources" USING "btree" ("user_id_uuid");



CREATE INDEX "contact_phones_user_id_idx" ON "public"."contact_phones" USING "btree" ("user_id");



CREATE INDEX "contact_phones_user_id_text_idx" ON "public"."contact_phones" USING "btree" ("user_id_text");



CREATE INDEX "contact_phones_user_id_uuid_idx" ON "public"."contact_phones" USING "btree" ("user_id_uuid");



CREATE INDEX "contact_playbooks_user_contact_idx" ON "public"."contact_playbooks" USING "btree" ("user_id", "contact_id");



CREATE INDEX "contact_playbooks_user_id_idx" ON "public"."contact_playbooks" USING "btree" ("user_id");



CREATE INDEX "contact_playbooks_user_id_text_idx" ON "public"."contact_playbooks" USING "btree" ("user_id_text");



CREATE INDEX "contact_playbooks_user_id_uuid_idx" ON "public"."contact_playbooks" USING "btree" ("user_id_uuid");



CREATE INDEX "contact_relationship_scores_user_contact_idx" ON "public"."contact_relationship_scores" USING "btree" ("user_id", "contact_id");



CREATE INDEX "contact_relationship_scores_user_id_idx" ON "public"."contact_relationship_scores" USING "btree" ("user_id");



CREATE INDEX "contact_relationship_scores_user_id_text_idx" ON "public"."contact_relationship_scores" USING "btree" ("user_id_text");



CREATE INDEX "contact_relationship_scores_user_id_uuid_idx" ON "public"."contact_relationship_scores" USING "btree" ("user_id_uuid");



CREATE INDEX "contact_relationships_user_id_idx" ON "public"."contact_relationships" USING "btree" ("user_id");



CREATE INDEX "contact_relationships_user_id_text_idx" ON "public"."contact_relationships" USING "btree" ("user_id_text");



CREATE INDEX "contact_relationships_user_id_uuid_idx" ON "public"."contact_relationships" USING "btree" ("user_id_uuid");



CREATE INDEX "contact_tag_links_user_id_idx" ON "public"."contact_tag_links" USING "btree" ("user_id");



CREATE INDEX "contact_tag_links_user_id_text_idx" ON "public"."contact_tag_links" USING "btree" ("user_id_text");



CREATE INDEX "contact_tag_links_user_id_uuid_idx" ON "public"."contact_tag_links" USING "btree" ("user_id_uuid");



CREATE INDEX "contact_tags_user_id_idx" ON "public"."contact_tags" USING "btree" ("user_id");



CREATE INDEX "contact_tags_user_id_text_idx" ON "public"."contact_tags" USING "btree" ("user_id_text");



CREATE INDEX "contact_tags_user_id_uuid_idx" ON "public"."contact_tags" USING "btree" ("user_id_uuid");



CREATE INDEX "contacts_user_id_idx" ON "public"."contacts" USING "btree" ("user_id");



CREATE INDEX "contacts_user_id_text_idx" ON "public"."contacts" USING "btree" ("user_id_text");



CREATE INDEX "contacts_user_id_uuid_idx" ON "public"."contacts" USING "btree" ("user_id_uuid");



CREATE INDEX "cortex_anomalies_user_id_idx" ON "public"."cortex_anomalies" USING "btree" ("user_id");



CREATE INDEX "cortex_anomalies_user_id_text_idx" ON "public"."cortex_anomalies" USING "btree" ("user_id_text");



CREATE INDEX "cortex_anomalies_user_id_uuid_idx" ON "public"."cortex_anomalies" USING "btree" ("user_id_uuid");



CREATE INDEX "cortex_areas_user_id_idx" ON "public"."cortex_areas" USING "btree" ("user_id");



CREATE INDEX "cortex_areas_user_id_text_idx" ON "public"."cortex_areas" USING "btree" ("user_id_text");



CREATE INDEX "cortex_areas_user_id_uuid_idx" ON "public"."cortex_areas" USING "btree" ("user_id_uuid");



CREATE INDEX "cortex_events_user_id_idx" ON "public"."cortex_events" USING "btree" ("user_id");



CREATE INDEX "cortex_events_user_id_text_idx" ON "public"."cortex_events" USING "btree" ("user_id_text");



CREATE INDEX "cortex_events_user_id_uuid_idx" ON "public"."cortex_events" USING "btree" ("user_id_uuid");



CREATE INDEX "cortex_patterns_user_id_idx" ON "public"."cortex_patterns" USING "btree" ("user_id");



CREATE INDEX "cortex_patterns_user_id_text_idx" ON "public"."cortex_patterns" USING "btree" ("user_id_text");



CREATE INDEX "cortex_patterns_user_id_uuid_idx" ON "public"."cortex_patterns" USING "btree" ("user_id_uuid");



CREATE INDEX "cortex_predictions_user_id_idx" ON "public"."cortex_predictions" USING "btree" ("user_id");



CREATE INDEX "cortex_predictions_user_id_text_idx" ON "public"."cortex_predictions" USING "btree" ("user_id_text");



CREATE INDEX "cortex_predictions_user_id_uuid_idx" ON "public"."cortex_predictions" USING "btree" ("user_id_uuid");



CREATE INDEX "cortex_signals_user_id_idx" ON "public"."cortex_signals" USING "btree" ("user_id");



CREATE INDEX "cortex_signals_user_id_text_idx" ON "public"."cortex_signals" USING "btree" ("user_id_text");



CREATE INDEX "cortex_signals_user_id_uuid_idx" ON "public"."cortex_signals" USING "btree" ("user_id_uuid");



CREATE INDEX "council_consensus_user_id_idx" ON "public"."council_consensus" USING "btree" ("user_id");



CREATE INDEX "council_consensus_user_id_text_idx" ON "public"."council_consensus" USING "btree" ("user_id_text");



CREATE INDEX "council_consensus_user_id_uuid_idx" ON "public"."council_consensus" USING "btree" ("user_id_uuid");



CREATE INDEX "council_decision_dossiers_user_id_idx" ON "public"."council_decision_dossiers" USING "btree" ("user_id");



CREATE INDEX "council_decision_dossiers_user_id_text_idx" ON "public"."council_decision_dossiers" USING "btree" ("user_id_text");



CREATE INDEX "council_decision_dossiers_user_id_uuid_idx" ON "public"."council_decision_dossiers" USING "btree" ("user_id_uuid");



CREATE INDEX "council_members_user_id_idx" ON "public"."council_members" USING "btree" ("user_id");



CREATE INDEX "council_members_user_id_text_idx" ON "public"."council_members" USING "btree" ("user_id_text");



CREATE INDEX "council_members_user_id_uuid_idx" ON "public"."council_members" USING "btree" ("user_id_uuid");



CREATE INDEX "council_opinions_user_id_idx" ON "public"."council_opinions" USING "btree" ("user_id");



CREATE INDEX "council_opinions_user_id_text_idx" ON "public"."council_opinions" USING "btree" ("user_id_text");



CREATE INDEX "council_opinions_user_id_uuid_idx" ON "public"."council_opinions" USING "btree" ("user_id_uuid");



CREATE INDEX "council_sessions_user_id_idx" ON "public"."council_sessions" USING "btree" ("user_id");



CREATE INDEX "council_sessions_user_id_text_idx" ON "public"."council_sessions" USING "btree" ("user_id_text");



CREATE INDEX "council_sessions_user_id_uuid_idx" ON "public"."council_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "creative_artifacts_user_id_idx" ON "public"."creative_artifacts" USING "btree" ("user_id");



CREATE INDEX "creative_artifacts_user_id_text_idx" ON "public"."creative_artifacts" USING "btree" ("user_id_text");



CREATE INDEX "creative_artifacts_user_id_uuid_idx" ON "public"."creative_artifacts" USING "btree" ("user_id_uuid");



CREATE INDEX "creative_assets_user_id_idx" ON "public"."creative_assets" USING "btree" ("user_id");



CREATE INDEX "creative_assets_user_id_text_idx" ON "public"."creative_assets" USING "btree" ("user_id_text");



CREATE INDEX "creative_assets_user_id_uuid_idx" ON "public"."creative_assets" USING "btree" ("user_id_uuid");



CREATE INDEX "creative_evaluations_user_id_idx" ON "public"."creative_evaluations" USING "btree" ("user_id");



CREATE INDEX "creative_evaluations_user_id_text_idx" ON "public"."creative_evaluations" USING "btree" ("user_id_text");



CREATE INDEX "creative_evaluations_user_id_uuid_idx" ON "public"."creative_evaluations" USING "btree" ("user_id_uuid");



CREATE INDEX "creative_ideas_user_id_idx" ON "public"."creative_ideas" USING "btree" ("user_id");



CREATE INDEX "creative_ideas_user_id_text_idx" ON "public"."creative_ideas" USING "btree" ("user_id_text");



CREATE INDEX "creative_ideas_user_id_uuid_idx" ON "public"."creative_ideas" USING "btree" ("user_id_uuid");



CREATE INDEX "creative_patterns_user_id_idx" ON "public"."creative_patterns" USING "btree" ("user_id");



CREATE INDEX "creative_patterns_user_id_text_idx" ON "public"."creative_patterns" USING "btree" ("user_id_text");



CREATE INDEX "creative_patterns_user_id_uuid_idx" ON "public"."creative_patterns" USING "btree" ("user_id_uuid");



CREATE INDEX "creative_projects_user_id_idx" ON "public"."creative_projects" USING "btree" ("user_id");



CREATE INDEX "creative_projects_user_id_text_idx" ON "public"."creative_projects" USING "btree" ("user_id_text");



CREATE INDEX "creative_projects_user_id_uuid_idx" ON "public"."creative_projects" USING "btree" ("user_id_uuid");



CREATE INDEX "creative_sessions_user_id_idx" ON "public"."creative_sessions" USING "btree" ("user_id");



CREATE INDEX "creative_sessions_user_id_text_idx" ON "public"."creative_sessions" USING "btree" ("user_id_text");



CREATE INDEX "creative_sessions_user_id_uuid_idx" ON "public"."creative_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "creative_style_profiles_user_id_idx" ON "public"."creative_style_profiles" USING "btree" ("user_id");



CREATE INDEX "creative_style_profiles_user_id_text_idx" ON "public"."creative_style_profiles" USING "btree" ("user_id_text");



CREATE INDEX "creative_style_profiles_user_id_uuid_idx" ON "public"."creative_style_profiles" USING "btree" ("user_id_uuid");



CREATE INDEX "crm_alerts_user_id_idx" ON "public"."crm_alerts" USING "btree" ("user_id");



CREATE INDEX "crm_alerts_user_id_text_idx" ON "public"."crm_alerts" USING "btree" ("user_id_text");



CREATE INDEX "crm_alerts_user_id_uuid_idx" ON "public"."crm_alerts" USING "btree" ("user_id_uuid");



CREATE INDEX "crm_alerts_user_idx" ON "public"."crm_alerts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "crm_contact_intel_contact_owner_idx" ON "public"."crm_contact_intel" USING "btree" ("contact_id", "owner_user_id");



CREATE UNIQUE INDEX "crm_contact_intel_contact_owner_uniq" ON "public"."crm_contact_intel" USING "btree" ("contact_id", "owner_user_id");



CREATE INDEX "crm_contact_intel_sources_contact_owner_captured_idx" ON "public"."crm_contact_intel_sources" USING "btree" ("contact_id", "owner_user_id", "captured_at" DESC);



CREATE INDEX "crm_contact_intel_sources_owner_captured_idx" ON "public"."crm_contact_intel_sources" USING "btree" ("owner_user_id", "contact_id", "captured_at" DESC);



CREATE INDEX "crm_contact_intel_sources_owner_contact_idx" ON "public"."crm_contact_intel_sources" USING "btree" ("owner_user_id", "contact_id");



CREATE INDEX "crm_contact_org_links_user_id_idx" ON "public"."crm_contact_org_links" USING "btree" ("user_id");



CREATE INDEX "crm_contact_org_links_user_id_text_idx" ON "public"."crm_contact_org_links" USING "btree" ("user_id_text");



CREATE INDEX "crm_contact_org_links_user_id_uuid_idx" ON "public"."crm_contact_org_links" USING "btree" ("user_id_uuid");



CREATE INDEX "crm_contacts_name_idx" ON "public"."crm_contacts" USING "btree" ("user_id", "full_name");



CREATE INDEX "crm_contacts_user_id_idx" ON "public"."crm_contacts" USING "btree" ("user_id");



CREATE INDEX "crm_contacts_user_id_text_idx" ON "public"."crm_contacts" USING "btree" ("user_id_text");



CREATE INDEX "crm_contacts_user_id_uuid_idx" ON "public"."crm_contacts" USING "btree" ("user_id_uuid");



CREATE INDEX "crm_contacts_user_idx" ON "public"."crm_contacts" USING "btree" ("user_id", "type");



CREATE INDEX "crm_deal_contacts_user_id_idx" ON "public"."crm_deal_contacts" USING "btree" ("user_id");



CREATE INDEX "crm_deal_contacts_user_id_text_idx" ON "public"."crm_deal_contacts" USING "btree" ("user_id_text");



CREATE INDEX "crm_deal_contacts_user_id_uuid_idx" ON "public"."crm_deal_contacts" USING "btree" ("user_id_uuid");



CREATE INDEX "crm_deal_health_user_id_idx" ON "public"."crm_deal_health" USING "btree" ("user_id");



CREATE INDEX "crm_deal_health_user_id_text_idx" ON "public"."crm_deal_health" USING "btree" ("user_id_text");



CREATE INDEX "crm_deal_health_user_id_uuid_idx" ON "public"."crm_deal_health" USING "btree" ("user_id_uuid");



CREATE INDEX "crm_deal_health_user_idx" ON "public"."crm_deal_health" USING "btree" ("user_id", "score" DESC);



CREATE INDEX "crm_deals_close_idx" ON "public"."crm_deals" USING "btree" ("user_id", "close_date");



CREATE INDEX "crm_deals_user_id_idx" ON "public"."crm_deals" USING "btree" ("user_id");



CREATE INDEX "crm_deals_user_id_text_idx" ON "public"."crm_deals" USING "btree" ("user_id_text");



CREATE INDEX "crm_deals_user_id_uuid_idx" ON "public"."crm_deals" USING "btree" ("user_id_uuid");



CREATE INDEX "crm_deals_user_idx" ON "public"."crm_deals" USING "btree" ("user_id", "stage");



CREATE INDEX "crm_interactions_contact_idx" ON "public"."crm_interactions" USING "btree" ("user_id", "contact_id", "occurred_at" DESC);



CREATE INDEX "crm_interactions_user_id_idx" ON "public"."crm_interactions" USING "btree" ("user_id");



CREATE INDEX "crm_interactions_user_id_text_idx" ON "public"."crm_interactions" USING "btree" ("user_id_text");



CREATE INDEX "crm_interactions_user_id_uuid_idx" ON "public"."crm_interactions" USING "btree" ("user_id_uuid");



CREATE INDEX "crm_interactions_user_idx" ON "public"."crm_interactions" USING "btree" ("user_id", "occurred_at" DESC);



CREATE INDEX "crm_organizations_user_id_idx" ON "public"."crm_organizations" USING "btree" ("user_id");



CREATE INDEX "crm_organizations_user_id_text_idx" ON "public"."crm_organizations" USING "btree" ("user_id_text");



CREATE INDEX "crm_organizations_user_id_uuid_idx" ON "public"."crm_organizations" USING "btree" ("user_id_uuid");



CREATE INDEX "crm_orgs_user_idx" ON "public"."crm_organizations" USING "btree" ("user_id", "name");



CREATE INDEX "crm_rel_health_user_idx" ON "public"."crm_relationship_health" USING "btree" ("user_id", "score" DESC);



CREATE INDEX "crm_relationship_health_user_id_idx" ON "public"."crm_relationship_health" USING "btree" ("user_id");



CREATE INDEX "crm_relationship_health_user_id_text_idx" ON "public"."crm_relationship_health" USING "btree" ("user_id_text");



CREATE INDEX "crm_relationship_health_user_id_uuid_idx" ON "public"."crm_relationship_health" USING "btree" ("user_id_uuid");



CREATE UNIQUE INDEX "crm_tasks_source_dedupe" ON "public"."crm_tasks" USING "btree" ("owner_user_id", "source_table", "source_id") WHERE (("source_table" IS NOT NULL) AND ("source_id" IS NOT NULL));



CREATE INDEX "cultural_highlights_user_id_idx" ON "public"."cultural_highlights" USING "btree" ("user_id");



CREATE INDEX "cultural_highlights_user_id_text_idx" ON "public"."cultural_highlights" USING "btree" ("user_id_text");



CREATE INDEX "cultural_highlights_user_id_uuid_idx" ON "public"."cultural_highlights" USING "btree" ("user_id_uuid");



CREATE INDEX "cultural_inference_snapshots_user_id_idx" ON "public"."cultural_inference_snapshots" USING "btree" ("user_id");



CREATE INDEX "cultural_inference_snapshots_user_id_text_idx" ON "public"."cultural_inference_snapshots" USING "btree" ("user_id_text");



CREATE INDEX "cultural_inference_snapshots_user_id_uuid_idx" ON "public"."cultural_inference_snapshots" USING "btree" ("user_id_uuid");



CREATE INDEX "cultural_predictions_user_id_idx" ON "public"."cultural_predictions" USING "btree" ("user_id");



CREATE INDEX "cultural_predictions_user_id_text_idx" ON "public"."cultural_predictions" USING "btree" ("user_id_text");



CREATE INDEX "cultural_predictions_user_id_uuid_idx" ON "public"."cultural_predictions" USING "btree" ("user_id_uuid");



CREATE INDEX "cultural_profiles_user_id_idx" ON "public"."cultural_profiles" USING "btree" ("user_id");



CREATE INDEX "cultural_profiles_user_id_text_idx" ON "public"."cultural_profiles" USING "btree" ("user_id_text");



CREATE INDEX "cultural_profiles_user_id_uuid_idx" ON "public"."cultural_profiles" USING "btree" ("user_id_uuid");



CREATE INDEX "cultural_signals_user_id_idx" ON "public"."cultural_signals" USING "btree" ("user_id");



CREATE INDEX "cultural_signals_user_id_text_idx" ON "public"."cultural_signals" USING "btree" ("user_id_text");



CREATE INDEX "cultural_signals_user_id_uuid_idx" ON "public"."cultural_signals" USING "btree" ("user_id_uuid");



CREATE INDEX "culture_alignment_log_user_id_idx" ON "public"."culture_alignment_log" USING "btree" ("user_id");



CREATE INDEX "culture_alignment_log_user_id_text_idx" ON "public"."culture_alignment_log" USING "btree" ("user_id_text");



CREATE INDEX "culture_alignment_log_user_id_uuid_idx" ON "public"."culture_alignment_log" USING "btree" ("user_id_uuid");



CREATE INDEX "culture_contexts_user_id_idx" ON "public"."culture_contexts" USING "btree" ("user_id");



CREATE INDEX "culture_contexts_user_id_text_idx" ON "public"."culture_contexts" USING "btree" ("user_id_text");



CREATE INDEX "culture_contexts_user_id_uuid_idx" ON "public"."culture_contexts" USING "btree" ("user_id_uuid");



CREATE INDEX "culture_norm_logs_user_id_idx" ON "public"."culture_norm_logs" USING "btree" ("user_id");



CREATE INDEX "culture_norm_logs_user_id_text_idx" ON "public"."culture_norm_logs" USING "btree" ("user_id_text");



CREATE INDEX "culture_norm_logs_user_id_uuid_idx" ON "public"."culture_norm_logs" USING "btree" ("user_id_uuid");



CREATE INDEX "culture_profiles_user_id_idx" ON "public"."culture_profiles" USING "btree" ("user_id");



CREATE INDEX "culture_profiles_user_id_text_idx" ON "public"."culture_profiles" USING "btree" ("user_id_text");



CREATE INDEX "culture_profiles_user_id_uuid_idx" ON "public"."culture_profiles" USING "btree" ("user_id_uuid");



CREATE INDEX "daily_quest_generation_runs_user_id_idx" ON "public"."daily_quest_generation_runs" USING "btree" ("user_id");



CREATE INDEX "daily_quest_generation_runs_user_id_uuid_idx" ON "public"."daily_quest_generation_runs" USING "btree" ("user_id_uuid");



CREATE UNIQUE INDEX "daily_quests_unique_day_key" ON "public"."daily_quests" USING "btree" ("user_id", "quest_date", "quest_key");



CREATE INDEX "daily_quests_user_day_idx" ON "public"."daily_quests" USING "btree" ("user_id", "quest_date" DESC);



CREATE INDEX "daily_quests_user_id_idx" ON "public"."daily_quests" USING "btree" ("user_id");



CREATE INDEX "daily_quests_user_id_uuid_idx" ON "public"."daily_quests" USING "btree" ("user_id_uuid");



CREATE INDEX "daily_timeline_views_user_id_idx" ON "public"."daily_timeline_views" USING "btree" ("user_id");



CREATE INDEX "daily_timeline_views_user_id_text_idx" ON "public"."daily_timeline_views" USING "btree" ("user_id_text");



CREATE INDEX "daily_timeline_views_user_id_uuid_idx" ON "public"."daily_timeline_views" USING "btree" ("user_id_uuid");



CREATE INDEX "dash_layouts_user_id_idx" ON "public"."dash_layouts" USING "btree" ("user_id");



CREATE INDEX "dash_layouts_user_id_uuid_idx" ON "public"."dash_layouts" USING "btree" ("user_id_uuid");



CREATE INDEX "dashboard_telemetry_events_user_id_idx" ON "public"."dashboard_telemetry_events" USING "btree" ("user_id");



CREATE INDEX "dashboard_telemetry_events_user_id_uuid_idx" ON "public"."dashboard_telemetry_events" USING "btree" ("user_id_uuid");



CREATE INDEX "dashboard_telemetry_user_id_idx" ON "public"."dashboard_telemetry" USING "btree" ("user_id");



CREATE INDEX "dashboard_telemetry_user_id_uuid_idx" ON "public"."dashboard_telemetry" USING "btree" ("user_id_uuid");



CREATE INDEX "day_plans_user_id_idx" ON "public"."day_plans" USING "btree" ("user_id");



CREATE INDEX "day_plans_user_id_uuid_idx" ON "public"."day_plans" USING "btree" ("user_id_uuid");



CREATE INDEX "deal_archetype_runs_user_id_idx" ON "public"."deal_archetype_runs" USING "btree" ("user_id");



CREATE INDEX "deal_archetype_runs_user_id_text_idx" ON "public"."deal_archetype_runs" USING "btree" ("user_id_text");



CREATE INDEX "deal_archetype_runs_user_id_uuid_idx" ON "public"."deal_archetype_runs" USING "btree" ("user_id_uuid");



CREATE INDEX "deals_user_id_idx" ON "public"."deals" USING "btree" ("user_id");



CREATE INDEX "deals_user_id_text_idx" ON "public"."deals" USING "btree" ("user_id_text");



CREATE INDEX "deals_user_id_uuid_idx" ON "public"."deals" USING "btree" ("user_id_uuid");



CREATE INDEX "decision_tree_edges_user_id_idx" ON "public"."decision_tree_edges" USING "btree" ("user_id");



CREATE INDEX "decision_tree_edges_user_id_text_idx" ON "public"."decision_tree_edges" USING "btree" ("user_id_text");



CREATE INDEX "decision_tree_edges_user_id_uuid_idx" ON "public"."decision_tree_edges" USING "btree" ("user_id_uuid");



CREATE INDEX "decision_tree_nodes_user_id_idx" ON "public"."decision_tree_nodes" USING "btree" ("user_id");



CREATE INDEX "decision_tree_nodes_user_id_text_idx" ON "public"."decision_tree_nodes" USING "btree" ("user_id_text");



CREATE INDEX "decision_tree_nodes_user_id_uuid_idx" ON "public"."decision_tree_nodes" USING "btree" ("user_id_uuid");



CREATE INDEX "decision_trees_user_id_idx" ON "public"."decision_trees" USING "btree" ("user_id");



CREATE INDEX "decision_trees_user_id_text_idx" ON "public"."decision_trees" USING "btree" ("user_id_text");



CREATE INDEX "decision_trees_user_id_uuid_idx" ON "public"."decision_trees" USING "btree" ("user_id_uuid");



CREATE INDEX "decisions_user_id_idx" ON "public"."decisions" USING "btree" ("user_id");



CREATE INDEX "decisions_user_id_text_idx" ON "public"."decisions" USING "btree" ("user_id_text");



CREATE INDEX "decisions_user_id_uuid_idx" ON "public"."decisions" USING "btree" ("user_id_uuid");



CREATE INDEX "delegated_drafts_user_id_idx" ON "public"."delegated_drafts" USING "btree" ("user_id");



CREATE INDEX "delegated_drafts_user_id_uuid_idx" ON "public"."delegated_drafts" USING "btree" ("user_id_uuid");



CREATE INDEX "desire_profiles_user_id_idx" ON "public"."desire_profiles" USING "btree" ("user_id");



CREATE INDEX "desire_profiles_user_id_text_idx" ON "public"."desire_profiles" USING "btree" ("user_id_text");



CREATE INDEX "desire_profiles_user_id_uuid_idx" ON "public"."desire_profiles" USING "btree" ("user_id_uuid");



CREATE INDEX "desire_signals_user_id_idx" ON "public"."desire_signals" USING "btree" ("user_id");



CREATE INDEX "desire_signals_user_id_text_idx" ON "public"."desire_signals" USING "btree" ("user_id_text");



CREATE INDEX "desire_signals_user_id_uuid_idx" ON "public"."desire_signals" USING "btree" ("user_id_uuid");



CREATE INDEX "destiny_alignment_log_user_id_idx" ON "public"."destiny_alignment_log" USING "btree" ("user_id");



CREATE INDEX "destiny_alignment_log_user_id_text_idx" ON "public"."destiny_alignment_log" USING "btree" ("user_id_text");



CREATE INDEX "destiny_alignment_log_user_id_uuid_idx" ON "public"."destiny_alignment_log" USING "btree" ("user_id_uuid");



CREATE INDEX "destiny_anchor_choices_user_id_idx" ON "public"."destiny_anchor_choices" USING "btree" ("user_id");



CREATE INDEX "destiny_anchor_choices_user_id_text_idx" ON "public"."destiny_anchor_choices" USING "btree" ("user_id_text");



CREATE INDEX "destiny_anchor_choices_user_id_uuid_idx" ON "public"."destiny_anchor_choices" USING "btree" ("user_id_uuid");



CREATE INDEX "destiny_arcs_user_id_idx" ON "public"."destiny_arcs" USING "btree" ("user_id");



CREATE INDEX "destiny_arcs_user_id_text_idx" ON "public"."destiny_arcs" USING "btree" ("user_id_text");



CREATE INDEX "destiny_arcs_user_id_uuid_idx" ON "public"."destiny_arcs" USING "btree" ("user_id_uuid");



CREATE INDEX "destiny_blueprints_user_id_idx" ON "public"."destiny_blueprints" USING "btree" ("user_id");



CREATE INDEX "destiny_blueprints_user_id_text_idx" ON "public"."destiny_blueprints" USING "btree" ("user_id_text");



CREATE INDEX "destiny_blueprints_user_id_uuid_idx" ON "public"."destiny_blueprints" USING "btree" ("user_id_uuid");



CREATE INDEX "destiny_checkpoints_user_id_idx" ON "public"."destiny_checkpoints" USING "btree" ("user_id");



CREATE INDEX "destiny_checkpoints_user_id_text_idx" ON "public"."destiny_checkpoints" USING "btree" ("user_id_text");



CREATE INDEX "destiny_checkpoints_user_id_uuid_idx" ON "public"."destiny_checkpoints" USING "btree" ("user_id_uuid");



CREATE INDEX "destiny_timelines_user_id_idx" ON "public"."destiny_timelines" USING "btree" ("user_id");



CREATE INDEX "destiny_timelines_user_id_text_idx" ON "public"."destiny_timelines" USING "btree" ("user_id_text");



CREATE INDEX "destiny_timelines_user_id_uuid_idx" ON "public"."destiny_timelines" USING "btree" ("user_id_uuid");



CREATE INDEX "domain_kpis_user_id_idx" ON "public"."domain_kpis" USING "btree" ("user_id");



CREATE INDEX "domain_kpis_user_id_uuid_idx" ON "public"."domain_kpis" USING "btree" ("user_id_uuid");



CREATE INDEX "dqgr_user_day_idx" ON "public"."daily_quest_generation_runs" USING "btree" ("user_id", "quest_date" DESC);



CREATE INDEX "efc_action_sequences_user_id_idx" ON "public"."efc_action_sequences" USING "btree" ("user_id");



CREATE INDEX "efc_action_sequences_user_id_uuid_idx" ON "public"."efc_action_sequences" USING "btree" ("user_id_uuid");



CREATE INDEX "efc_actions_priority_idx" ON "public"."efc_generated_actions" USING "btree" ("user_id", "priority_score" DESC) WHERE ("status" = 'suggested'::"text");



CREATE INDEX "efc_actions_urgency_idx" ON "public"."efc_generated_actions" USING "btree" ("user_id", "urgency") WHERE ("status" = ANY (ARRAY['suggested'::"text", 'accepted'::"text"]));



CREATE INDEX "efc_actions_user_status_idx" ON "public"."efc_generated_actions" USING "btree" ("user_id", "status", "created_at" DESC);



CREATE INDEX "efc_commitments_due_idx" ON "public"."efc_commitments" USING "btree" ("user_id", "due_at") WHERE ("status" = 'active'::"text");



CREATE INDEX "efc_commitments_made_to_idx" ON "public"."efc_commitments" USING "btree" ("user_id", "made_to_entity_id") WHERE ("made_to_entity_id" IS NOT NULL);



CREATE INDEX "efc_commitments_user_id_idx" ON "public"."efc_commitments" USING "btree" ("user_id");



CREATE INDEX "efc_commitments_user_id_uuid_idx" ON "public"."efc_commitments" USING "btree" ("user_id_uuid");



CREATE INDEX "efc_commitments_user_status_idx" ON "public"."efc_commitments" USING "btree" ("user_id", "status");



CREATE INDEX "efc_energy_states_user_id_idx" ON "public"."efc_energy_states" USING "btree" ("user_id");



CREATE INDEX "efc_energy_states_user_id_uuid_idx" ON "public"."efc_energy_states" USING "btree" ("user_id_uuid");



CREATE INDEX "efc_energy_user_idx" ON "public"."efc_energy_states" USING "btree" ("user_id", "recorded_at" DESC);



CREATE INDEX "efc_execution_action_idx" ON "public"."efc_execution_log" USING "btree" ("action_id");



CREATE INDEX "efc_execution_log_user_id_idx" ON "public"."efc_execution_log" USING "btree" ("user_id");



CREATE INDEX "efc_execution_log_user_id_uuid_idx" ON "public"."efc_execution_log" USING "btree" ("user_id_uuid");



CREATE INDEX "efc_execution_user_idx" ON "public"."efc_execution_log" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "efc_generated_actions_user_id_idx" ON "public"."efc_generated_actions" USING "btree" ("user_id");



CREATE INDEX "efc_generated_actions_user_id_uuid_idx" ON "public"."efc_generated_actions" USING "btree" ("user_id_uuid");



CREATE INDEX "efc_nudges_commitment_idx" ON "public"."efc_nudges" USING "btree" ("commitment_id");



CREATE INDEX "efc_nudges_user_id_idx" ON "public"."efc_nudges" USING "btree" ("user_id");



CREATE INDEX "efc_nudges_user_id_uuid_idx" ON "public"."efc_nudges" USING "btree" ("user_id_uuid");



CREATE INDEX "efc_nudges_user_idx" ON "public"."efc_nudges" USING "btree" ("user_id", "acknowledged", "created_at" DESC);



CREATE INDEX "efc_sequences_active_idx" ON "public"."efc_action_sequences" USING "btree" ("user_id", "valid_until") WHERE ("completed" = false);



CREATE INDEX "efc_sequences_user_idx" ON "public"."efc_action_sequences" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "email_accounts_user_id_idx" ON "public"."email_accounts" USING "btree" ("user_id");



CREATE INDEX "email_accounts_user_id_text_idx" ON "public"."email_accounts" USING "btree" ("user_id_text");



CREATE INDEX "email_accounts_user_id_uuid_idx" ON "public"."email_accounts" USING "btree" ("user_id_uuid");



CREATE INDEX "email_accounts_user_idx" ON "public"."email_accounts" USING "btree" ("user_id", "provider");



CREATE UNIQUE INDEX "email_accounts_user_provider_email_uidx" ON "public"."email_accounts" USING "btree" ("user_id", "provider", "email_address");



CREATE INDEX "email_actions_user_id_idx" ON "public"."email_actions" USING "btree" ("user_id");



CREATE INDEX "email_actions_user_id_uuid_idx" ON "public"."email_actions" USING "btree" ("user_id_uuid");



CREATE INDEX "email_daily_briefs_user_id_idx" ON "public"."email_daily_briefs" USING "btree" ("user_id");



CREATE INDEX "email_daily_briefs_user_id_uuid_idx" ON "public"."email_daily_briefs" USING "btree" ("user_id_uuid");



CREATE INDEX "email_drafts_thread_idx" ON "public"."email_drafts" USING "btree" ("email_thread_id", "created_at" DESC);



CREATE INDEX "email_drafts_user_id_idx" ON "public"."email_drafts" USING "btree" ("user_id");



CREATE INDEX "email_drafts_user_id_uuid_idx" ON "public"."email_drafts" USING "btree" ("user_id_uuid");



CREATE INDEX "email_events_in_reply_to_idx" ON "public"."email_events" USING "btree" ("in_reply_to");



CREATE INDEX "email_events_message_id_idx" ON "public"."email_events" USING "btree" ("message_id");



CREATE INDEX "email_events_thread_id_idx" ON "public"."email_events" USING "btree" ("thread_id");



CREATE INDEX "email_events_user_id_idx" ON "public"."email_events" USING "btree" ("user_id");



CREATE INDEX "email_events_user_id_uuid_idx" ON "public"."email_events" USING "btree" ("user_id_uuid");



CREATE INDEX "email_events_user_received_idx" ON "public"."email_events" USING "btree" ("user_id", "received_at" DESC);



CREATE INDEX "email_followups_due_idx" ON "public"."email_followups" USING "btree" ("user_id", "state", "due_at");



CREATE INDEX "email_followups_user_id_idx" ON "public"."email_followups" USING "btree" ("user_id");



CREATE INDEX "email_followups_user_id_text_idx" ON "public"."email_followups" USING "btree" ("user_id_text");



CREATE INDEX "email_followups_user_id_uuid_idx" ON "public"."email_followups" USING "btree" ("user_id_uuid");



CREATE INDEX "email_items_user_id_idx" ON "public"."email_items" USING "btree" ("user_id");



CREATE INDEX "email_items_user_id_uuid_idx" ON "public"."email_items" USING "btree" ("user_id_uuid");



CREATE INDEX "email_outbox_approval_status_idx" ON "public"."email_outbox" USING "btree" ("approval_status");



CREATE INDEX "email_outbox_autofix_idx" ON "public"."email_outbox" USING "btree" ("auto_fix_suggested", "failure_code");



CREATE INDEX "email_outbox_claim_idx" ON "public"."email_outbox" USING "btree" ("status", "next_attempt_at", "created_at");



CREATE INDEX "email_outbox_defer_until_idx" ON "public"."email_outbox" USING "btree" ("defer_until");



CREATE INDEX "email_outbox_lease_exp_idx" ON "public"."email_outbox" USING "btree" ("status", "lease_expires_at");



CREATE INDEX "email_outbox_pending_send_idx" ON "public"."email_outbox" USING "btree" ("status", "scheduled_send_at") WHERE ("status" = 'pending_send'::"text");



CREATE INDEX "email_outbox_status_idx" ON "public"."email_outbox" USING "btree" ("status");



CREATE INDEX "email_outbox_thread_idx" ON "public"."email_outbox" USING "btree" ("email_thread_id");



CREATE INDEX "email_outbox_user_id_idx" ON "public"."email_outbox" USING "btree" ("user_id");



CREATE INDEX "email_outbox_user_id_text_idx" ON "public"."email_outbox" USING "btree" ("user_id_text");



CREATE INDEX "email_outbox_user_id_uuid_idx" ON "public"."email_outbox" USING "btree" ("user_id_uuid");



CREATE INDEX "email_outbox_user_idx" ON "public"."email_outbox" USING "btree" ("user_id");



CREATE INDEX "email_outbox_user_status_idx" ON "public"."email_outbox" USING "btree" ("user_id", "status", "created_at");



CREATE INDEX "email_resolution_next_action_idx" ON "public"."email_resolution" USING "btree" ("user_id", "next_action_at") WHERE ("next_action_at" IS NOT NULL);



CREATE INDEX "email_resolution_user_id_idx" ON "public"."email_resolution" USING "btree" ("user_id");



CREATE INDEX "email_resolution_user_id_text_idx" ON "public"."email_resolution" USING "btree" ("user_id_text");



CREATE INDEX "email_resolution_user_id_uuid_idx" ON "public"."email_resolution" USING "btree" ("user_id_uuid");



CREATE INDEX "email_resolution_user_idx" ON "public"."email_resolution" USING "btree" ("user_id", "state");



CREATE INDEX "email_send_audit_outbox_idx" ON "public"."email_send_audit" USING "btree" ("outbox_id", "created_at" DESC);



CREATE INDEX "email_send_audit_user_id_idx" ON "public"."email_send_audit" USING "btree" ("user_id");



CREATE INDEX "email_send_audit_user_id_uuid_idx" ON "public"."email_send_audit" USING "btree" ("user_id_uuid");



CREATE INDEX "email_send_audit_user_idx" ON "public"."email_send_audit" USING "btree" ("user_id", "created_at" DESC);



CREATE UNIQUE INDEX "email_suggested_drafts_active_dedupe" ON "public"."email_suggested_drafts" USING "btree" ("user_id", "thread_id", "prompt_hash") WHERE (("active" = true) AND ("thread_id" IS NOT NULL) AND ("prompt_hash" IS NOT NULL) AND ("prompt_hash" <> ''::"text"));



CREATE INDEX "email_suggested_drafts_user_active_idx" ON "public"."email_suggested_drafts" USING "btree" ("user_id", "active", "created_at" DESC);



CREATE INDEX "email_suggested_drafts_user_id_idx" ON "public"."email_suggested_drafts" USING "btree" ("user_id");



CREATE INDEX "email_suggested_drafts_user_id_uuid_idx" ON "public"."email_suggested_drafts" USING "btree" ("user_id_uuid");



CREATE INDEX "email_threads_owner_activity_idx" ON "public"."email_threads" USING "btree" ("owner_user_id", "last_activity_at" DESC);



CREATE INDEX "email_threads_owner_contact_last_idx" ON "public"."email_threads" USING "btree" ("owner_user_id", "contact_email", COALESCE("last_message_at", "last_email_at") DESC);



CREATE INDEX "email_threads_user_contact_activity_idx" ON "public"."email_threads" USING "btree" ("user_id", "contact_email", "last_activity_at" DESC);



CREATE INDEX "email_threads_user_contact_last_idx" ON "public"."email_threads" USING "btree" ("user_id", "contact_email", COALESCE("last_message_at", "last_email_at") DESC);



CREATE INDEX "email_threads_user_deal_last_idx" ON "public"."email_threads" USING "btree" ("user_id", "deal_id", COALESCE("last_message_at", "last_email_at") DESC);



CREATE INDEX "email_threads_user_id_idx" ON "public"."email_threads" USING "btree" ("user_id");



CREATE INDEX "email_threads_user_id_uuid_idx" ON "public"."email_threads" USING "btree" ("user_id_uuid");



CREATE INDEX "email_triage_items_next_action_idx" ON "public"."email_triage_items" USING "btree" ("user_id", "next_action_at") WHERE ("next_action_at" IS NOT NULL);



CREATE INDEX "email_triage_items_open_idx" ON "public"."email_triage_items" USING "btree" ("user_id", "state", "urgency", "score" DESC);



CREATE INDEX "email_triage_items_user_id_idx" ON "public"."email_triage_items" USING "btree" ("user_id");



CREATE INDEX "email_triage_items_user_id_text_idx" ON "public"."email_triage_items" USING "btree" ("user_id_text");



CREATE INDEX "email_triage_items_user_id_uuid_idx" ON "public"."email_triage_items" USING "btree" ("user_id_uuid");



CREATE INDEX "email_triage_items_user_state_next_idx" ON "public"."email_triage_items" USING "btree" ("user_id", "state", "next_action_at" DESC NULLS LAST, "updated_at" DESC);



CREATE UNIQUE INDEX "email_triage_items_user_thread_unique" ON "public"."email_triage_items" USING "btree" ("user_id", "email_thread_id");



CREATE INDEX "email_triage_items_user_updated_idx" ON "public"."email_triage_items" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "emails_user_id_idx" ON "public"."emails" USING "btree" ("user_id");



CREATE INDEX "emails_user_id_uuid_idx" ON "public"."emails" USING "btree" ("user_id_uuid");



CREATE INDEX "emo_adaptive_responses_user_id_idx" ON "public"."emo_adaptive_responses" USING "btree" ("user_id");



CREATE INDEX "emo_adaptive_responses_user_id_uuid_idx" ON "public"."emo_adaptive_responses" USING "btree" ("user_id_uuid");



CREATE INDEX "emo_adaptive_user_idx" ON "public"."emo_adaptive_responses" USING "btree" ("user_id", "emotion_state");



CREATE INDEX "emo_checkins_user_id_idx" ON "public"."emo_checkins" USING "btree" ("user_id");



CREATE INDEX "emo_checkins_user_id_uuid_idx" ON "public"."emo_checkins" USING "btree" ("user_id_uuid");



CREATE INDEX "emo_checkins_user_idx" ON "public"."emo_checkins" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "emo_goals_user_id_idx" ON "public"."emo_goals" USING "btree" ("user_id");



CREATE INDEX "emo_goals_user_id_uuid_idx" ON "public"."emo_goals" USING "btree" ("user_id_uuid");



CREATE INDEX "emo_goals_user_idx" ON "public"."emo_goals" USING "btree" ("user_id", "status");



CREATE UNIQUE INDEX "emo_interventions_unique_idx" ON "public"."emo_interventions" USING "btree" ("user_id", "intervention_type", "intervention_name");



CREATE INDEX "emo_interventions_user_id_idx" ON "public"."emo_interventions" USING "btree" ("user_id");



CREATE INDEX "emo_interventions_user_id_uuid_idx" ON "public"."emo_interventions" USING "btree" ("user_id_uuid");



CREATE INDEX "emo_interventions_user_idx" ON "public"."emo_interventions" USING "btree" ("user_id");



CREATE INDEX "emo_profiles_user_id_idx" ON "public"."emo_profiles" USING "btree" ("user_id");



CREATE INDEX "emo_profiles_user_id_uuid_idx" ON "public"."emo_profiles" USING "btree" ("user_id_uuid");



CREATE INDEX "emo_states_emotion_idx" ON "public"."emo_states" USING "btree" ("user_id", "detected_emotion");



CREATE INDEX "emo_states_source_idx" ON "public"."emo_states" USING "btree" ("user_id", "source");



CREATE INDEX "emo_states_user_id_idx" ON "public"."emo_states" USING "btree" ("user_id");



CREATE INDEX "emo_states_user_id_uuid_idx" ON "public"."emo_states" USING "btree" ("user_id_uuid");



CREATE INDEX "emo_states_user_time_idx" ON "public"."emo_states" USING "btree" ("user_id", "occurred_at" DESC);



CREATE INDEX "emo_transitions_user_id_idx" ON "public"."emo_transitions" USING "btree" ("user_id");



CREATE INDEX "emo_transitions_user_id_uuid_idx" ON "public"."emo_transitions" USING "btree" ("user_id_uuid");



CREATE INDEX "emo_transitions_user_idx" ON "public"."emo_transitions" USING "btree" ("user_id", "occurred_at" DESC);



CREATE INDEX "emotion_channel_settings_user_id_idx" ON "public"."emotion_channel_settings" USING "btree" ("user_id");



CREATE INDEX "emotion_channel_settings_user_id_text_idx" ON "public"."emotion_channel_settings" USING "btree" ("user_id_text");



CREATE INDEX "emotion_channel_settings_user_id_uuid_idx" ON "public"."emotion_channel_settings" USING "btree" ("user_id_uuid");



CREATE INDEX "emotion_interaction_log_user_id_idx" ON "public"."emotion_interaction_log" USING "btree" ("user_id");



CREATE INDEX "emotion_interaction_log_user_id_text_idx" ON "public"."emotion_interaction_log" USING "btree" ("user_id_text");



CREATE INDEX "emotion_interaction_log_user_id_uuid_idx" ON "public"."emotion_interaction_log" USING "btree" ("user_id_uuid");



CREATE INDEX "emotion_resonance_events_user_id_idx" ON "public"."emotion_resonance_events" USING "btree" ("user_id");



CREATE INDEX "emotion_resonance_events_user_id_text_idx" ON "public"."emotion_resonance_events" USING "btree" ("user_id_text");



CREATE INDEX "emotion_resonance_events_user_id_uuid_idx" ON "public"."emotion_resonance_events" USING "btree" ("user_id_uuid");



CREATE INDEX "emotion_samples_user_id_idx" ON "public"."emotion_samples" USING "btree" ("user_id");



CREATE INDEX "emotion_samples_user_id_text_idx" ON "public"."emotion_samples" USING "btree" ("user_id_text");



CREATE INDEX "emotion_samples_user_id_uuid_idx" ON "public"."emotion_samples" USING "btree" ("user_id_uuid");



CREATE INDEX "emotion_state_daily_user_id_idx" ON "public"."emotion_state_daily" USING "btree" ("user_id");



CREATE INDEX "emotion_state_daily_user_id_text_idx" ON "public"."emotion_state_daily" USING "btree" ("user_id_text");



CREATE INDEX "emotion_state_daily_user_id_uuid_idx" ON "public"."emotion_state_daily" USING "btree" ("user_id_uuid");



CREATE INDEX "emotion_style_profile_user_id_idx" ON "public"."emotion_style_profile" USING "btree" ("user_id");



CREATE INDEX "emotion_style_profile_user_id_text_idx" ON "public"."emotion_style_profile" USING "btree" ("user_id_text");



CREATE INDEX "emotion_style_profile_user_id_uuid_idx" ON "public"."emotion_style_profile" USING "btree" ("user_id_uuid");



CREATE INDEX "emotional_checkins_user_id_idx" ON "public"."emotional_checkins" USING "btree" ("user_id");



CREATE INDEX "emotional_checkins_user_id_uuid_idx" ON "public"."emotional_checkins" USING "btree" ("user_id_uuid");



CREATE INDEX "emotional_patterns_user_id_idx" ON "public"."emotional_patterns" USING "btree" ("user_id");



CREATE INDEX "emotional_patterns_user_id_uuid_idx" ON "public"."emotional_patterns" USING "btree" ("user_id_uuid");



CREATE INDEX "emotional_support_logs_user_id_idx" ON "public"."emotional_support_logs" USING "btree" ("user_id");



CREATE INDEX "emotional_support_logs_user_id_uuid_idx" ON "public"."emotional_support_logs" USING "btree" ("user_id_uuid");



CREATE INDEX "empathic_events_user_id_idx" ON "public"."empathic_events" USING "btree" ("user_id");



CREATE INDEX "empathic_events_user_id_text_idx" ON "public"."empathic_events" USING "btree" ("user_id_text");



CREATE INDEX "empathic_events_user_id_uuid_idx" ON "public"."empathic_events" USING "btree" ("user_id_uuid");



CREATE INDEX "ethical_policies_user_id_idx" ON "public"."ethical_policies" USING "btree" ("user_id");



CREATE INDEX "ethical_policies_user_id_text_idx" ON "public"."ethical_policies" USING "btree" ("user_id_text");



CREATE INDEX "ethical_policies_user_id_uuid_idx" ON "public"."ethical_policies" USING "btree" ("user_id_uuid");



CREATE INDEX "execution_logs_user_id_idx" ON "public"."execution_logs" USING "btree" ("user_id");



CREATE INDEX "execution_logs_user_id_text_idx" ON "public"."execution_logs" USING "btree" ("user_id_text");



CREATE INDEX "execution_logs_user_id_uuid_idx" ON "public"."execution_logs" USING "btree" ("user_id_uuid");



CREATE INDEX "execution_runs_user_id_idx" ON "public"."execution_runs" USING "btree" ("user_id");



CREATE INDEX "execution_runs_user_id_text_idx" ON "public"."execution_runs" USING "btree" ("user_id_text");



CREATE INDEX "execution_runs_user_id_uuid_idx" ON "public"."execution_runs" USING "btree" ("user_id_uuid");



CREATE INDEX "executive_council_members_user_id_idx" ON "public"."executive_council_members" USING "btree" ("user_id");



CREATE INDEX "executive_council_members_user_id_text_idx" ON "public"."executive_council_members" USING "btree" ("user_id_text");



CREATE INDEX "executive_council_members_user_id_uuid_idx" ON "public"."executive_council_members" USING "btree" ("user_id_uuid");



CREATE INDEX "executive_summaries_user_id_idx" ON "public"."executive_summaries" USING "btree" ("user_id");



CREATE INDEX "executive_summaries_user_id_uuid_idx" ON "public"."executive_summaries" USING "btree" ("user_id_uuid");



CREATE INDEX "experience_events_user_id_idx" ON "public"."experience_events" USING "btree" ("user_id");



CREATE INDEX "experience_events_user_id_text_idx" ON "public"."experience_events" USING "btree" ("user_id_text");



CREATE INDEX "experience_events_user_id_uuid_idx" ON "public"."experience_events" USING "btree" ("user_id_uuid");



CREATE UNIQUE INDEX "experiment_metrics_key_unique" ON "public"."experiment_metrics" USING "btree" ("key");



CREATE UNIQUE INDEX "experiment_templates_key_unique" ON "public"."experiment_templates" USING "btree" ("key");



CREATE INDEX "feedback_user_id_idx" ON "public"."feedback" USING "btree" ("user_id");



CREATE INDEX "feedback_user_id_uuid_idx" ON "public"."feedback" USING "btree" ("user_id_uuid");



CREATE INDEX "finance_accounts_user_id_idx" ON "public"."finance_accounts" USING "btree" ("user_id");



CREATE INDEX "finance_accounts_user_id_text_idx" ON "public"."finance_accounts" USING "btree" ("user_id_text");



CREATE INDEX "finance_accounts_user_id_uuid_idx" ON "public"."finance_accounts" USING "btree" ("user_id_uuid");



CREATE INDEX "finance_accounts_user_idx" ON "public"."finance_accounts" USING "btree" ("user_id", "is_active");



CREATE INDEX "finance_alerts_user_id_idx" ON "public"."finance_alerts" USING "btree" ("user_id");



CREATE INDEX "finance_alerts_user_id_text_idx" ON "public"."finance_alerts" USING "btree" ("user_id_text");



CREATE INDEX "finance_alerts_user_id_uuid_idx" ON "public"."finance_alerts" USING "btree" ("user_id_uuid");



CREATE INDEX "finance_alerts_user_idx" ON "public"."finance_alerts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "finance_budgets_user_id_idx" ON "public"."finance_budgets" USING "btree" ("user_id");



CREATE INDEX "finance_budgets_user_id_text_idx" ON "public"."finance_budgets" USING "btree" ("user_id_text");



CREATE INDEX "finance_budgets_user_id_uuid_idx" ON "public"."finance_budgets" USING "btree" ("user_id_uuid");



CREATE INDEX "finance_budgets_user_idx" ON "public"."finance_budgets" USING "btree" ("user_id", "month" DESC);



CREATE INDEX "finance_goals_user_id_idx" ON "public"."finance_goals" USING "btree" ("user_id");



CREATE INDEX "finance_goals_user_id_text_idx" ON "public"."finance_goals" USING "btree" ("user_id_text");



CREATE INDEX "finance_goals_user_id_uuid_idx" ON "public"."finance_goals" USING "btree" ("user_id_uuid");



CREATE INDEX "finance_goals_user_idx" ON "public"."finance_goals" USING "btree" ("user_id", "status");



CREATE INDEX "finance_snapshots_user_id_idx" ON "public"."finance_snapshots" USING "btree" ("user_id");



CREATE INDEX "finance_snapshots_user_id_text_idx" ON "public"."finance_snapshots" USING "btree" ("user_id_text");



CREATE INDEX "finance_snapshots_user_id_uuid_idx" ON "public"."finance_snapshots" USING "btree" ("user_id_uuid");



CREATE INDEX "finance_snapshots_user_idx" ON "public"."finance_snapshots" USING "btree" ("user_id", "period_start" DESC);



CREATE INDEX "finance_transactions_category_idx" ON "public"."finance_transactions" USING "btree" ("user_id", "category", "date" DESC);



CREATE INDEX "finance_transactions_user_id_idx" ON "public"."finance_transactions" USING "btree" ("user_id");



CREATE INDEX "finance_transactions_user_id_text_idx" ON "public"."finance_transactions" USING "btree" ("user_id_text");



CREATE INDEX "finance_transactions_user_id_uuid_idx" ON "public"."finance_transactions" USING "btree" ("user_id_uuid");



CREATE INDEX "finance_transactions_user_idx" ON "public"."finance_transactions" USING "btree" ("user_id", "date" DESC);



CREATE INDEX "financial_accounts_entity_idx" ON "public"."financial_accounts" USING "btree" ("entity_id");



CREATE INDEX "financial_connections_user_id_idx" ON "public"."financial_connections" USING "btree" ("user_id");



CREATE INDEX "financial_connections_user_id_text_idx" ON "public"."financial_connections" USING "btree" ("user_id_text");



CREATE INDEX "financial_connections_user_id_uuid_idx" ON "public"."financial_connections" USING "btree" ("user_id_uuid");



CREATE INDEX "financial_connections_user_idx" ON "public"."financial_connections" USING "btree" ("user_id");



CREATE INDEX "financial_entities_user_id_idx" ON "public"."financial_entities" USING "btree" ("user_id");



CREATE INDEX "financial_entities_user_id_text_idx" ON "public"."financial_entities" USING "btree" ("user_id_text");



CREATE INDEX "financial_entities_user_id_uuid_idx" ON "public"."financial_entities" USING "btree" ("user_id_uuid");



CREATE INDEX "financial_entities_user_idx" ON "public"."financial_entities" USING "btree" ("user_id");



CREATE UNIQUE INDEX "financial_imported_transactions_unique_raw" ON "public"."financial_imported_transactions" USING "btree" ("connection_id", "raw_id");



CREATE INDEX "financial_ledger_lines_account_idx" ON "public"."financial_ledger_lines" USING "btree" ("account_id");



CREATE INDEX "financial_ledger_lines_entry_idx" ON "public"."financial_ledger_lines" USING "btree" ("entry_id");



CREATE INDEX "financial_snapshots_entity_date_idx" ON "public"."financial_snapshots" USING "btree" ("entity_id", "as_of_date");



CREATE INDEX "focus_locks_user_ends_at_idx" ON "public"."focus_locks" USING "btree" ("user_id", "ends_at" DESC);



CREATE INDEX "focus_locks_user_id_idx" ON "public"."focus_locks" USING "btree" ("user_id");



CREATE INDEX "focus_locks_user_id_uuid_idx" ON "public"."focus_locks" USING "btree" ("user_id_uuid");



CREATE INDEX "focus_locks_user_status_idx" ON "public"."focus_locks" USING "btree" ("user_id", "status");



CREATE INDEX "focus_sessions_user_id_idx" ON "public"."focus_sessions" USING "btree" ("user_id");



CREATE INDEX "focus_sessions_user_id_uuid_idx" ON "public"."focus_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "follow_ups_user_id_idx" ON "public"."follow_ups" USING "btree" ("user_id");



CREATE INDEX "follow_ups_user_id_uuid_idx" ON "public"."follow_ups" USING "btree" ("user_id_uuid");



CREATE INDEX "gift_ideas_user_id_idx" ON "public"."gift_ideas" USING "btree" ("user_id");



CREATE INDEX "gift_ideas_user_id_text_idx" ON "public"."gift_ideas" USING "btree" ("user_id_text");



CREATE INDEX "gift_ideas_user_id_uuid_idx" ON "public"."gift_ideas" USING "btree" ("user_id_uuid");



CREATE INDEX "goal_hierarchy_user_id_idx" ON "public"."goal_hierarchy" USING "btree" ("user_id");



CREATE INDEX "goal_hierarchy_user_id_text_idx" ON "public"."goal_hierarchy" USING "btree" ("user_id_text");



CREATE INDEX "goal_hierarchy_user_id_uuid_idx" ON "public"."goal_hierarchy" USING "btree" ("user_id_uuid");



CREATE INDEX "goals_user_id_idx" ON "public"."goals" USING "btree" ("user_id");



CREATE INDEX "goals_user_id_uuid_idx" ON "public"."goals" USING "btree" ("user_id_uuid");



CREATE INDEX "guardrail_events_user_id_idx" ON "public"."guardrail_events" USING "btree" ("user_id");



CREATE INDEX "guardrail_events_user_id_text_idx" ON "public"."guardrail_events" USING "btree" ("user_id_text");



CREATE INDEX "guardrail_events_user_id_uuid_idx" ON "public"."guardrail_events" USING "btree" ("user_id_uuid");



CREATE INDEX "habit_completions_user_id_idx" ON "public"."habit_completions" USING "btree" ("user_id");



CREATE INDEX "habit_completions_user_id_uuid_idx" ON "public"."habit_completions" USING "btree" ("user_id_uuid");



CREATE INDEX "habit_logs_user_id_idx" ON "public"."habit_logs" USING "btree" ("user_id");



CREATE INDEX "habit_logs_user_id_text_idx" ON "public"."habit_logs" USING "btree" ("user_id_text");



CREATE INDEX "habit_logs_user_id_uuid_idx" ON "public"."habit_logs" USING "btree" ("user_id_uuid");



CREATE INDEX "habit_streaks_user_id_idx" ON "public"."habit_streaks" USING "btree" ("user_id");



CREATE INDEX "habit_streaks_user_id_uuid_idx" ON "public"."habit_streaks" USING "btree" ("user_id_uuid");



CREATE INDEX "habits_user_id_idx" ON "public"."habits" USING "btree" ("user_id");



CREATE INDEX "habits_user_id_text_idx" ON "public"."habits" USING "btree" ("user_id_text");



CREATE INDEX "habits_user_id_uuid_idx" ON "public"."habits" USING "btree" ("user_id_uuid");



CREATE INDEX "household_members_household_idx" ON "public"."household_members" USING "btree" ("household_id");



CREATE INDEX "household_members_user_id_idx" ON "public"."household_members" USING "btree" ("user_id");



CREATE INDEX "household_members_user_id_text_idx" ON "public"."household_members" USING "btree" ("user_id_text");



CREATE INDEX "household_members_user_id_uuid_idx" ON "public"."household_members" USING "btree" ("user_id_uuid");



CREATE INDEX "household_members_user_idx" ON "public"."household_members" USING "btree" ("user_id");



CREATE INDEX "id_aspirations_user_id_idx" ON "public"."id_aspirations" USING "btree" ("user_id");



CREATE INDEX "id_aspirations_user_id_uuid_idx" ON "public"."id_aspirations" USING "btree" ("user_id_uuid");



CREATE INDEX "id_aspirations_user_idx" ON "public"."id_aspirations" USING "btree" ("user_id", "status");



CREATE INDEX "id_beliefs_user_id_idx" ON "public"."id_beliefs" USING "btree" ("user_id");



CREATE INDEX "id_beliefs_user_id_uuid_idx" ON "public"."id_beliefs" USING "btree" ("user_id_uuid");



CREATE INDEX "id_beliefs_user_idx" ON "public"."id_beliefs" USING "btree" ("user_id", "category");



CREATE INDEX "id_growth_areas_user_id_idx" ON "public"."id_growth_areas" USING "btree" ("user_id");



CREATE INDEX "id_growth_areas_user_id_uuid_idx" ON "public"."id_growth_areas" USING "btree" ("user_id_uuid");



CREATE INDEX "id_growth_user_idx" ON "public"."id_growth_areas" USING "btree" ("user_id", "status");



CREATE INDEX "id_momentum_daily_user_id_idx" ON "public"."id_momentum_daily" USING "btree" ("user_id");



CREATE INDEX "id_momentum_daily_user_id_uuid_idx" ON "public"."id_momentum_daily" USING "btree" ("user_id_uuid");



CREATE INDEX "id_narrative_chapters_user_id_idx" ON "public"."id_narrative_chapters" USING "btree" ("user_id");



CREATE INDEX "id_narrative_chapters_user_id_uuid_idx" ON "public"."id_narrative_chapters" USING "btree" ("user_id_uuid");



CREATE INDEX "id_narrative_user_idx" ON "public"."id_narrative_chapters" USING "btree" ("user_id", "chapter_order");



CREATE INDEX "id_roles_user_id_idx" ON "public"."id_roles" USING "btree" ("user_id");



CREATE INDEX "id_roles_user_id_uuid_idx" ON "public"."id_roles" USING "btree" ("user_id_uuid");



CREATE INDEX "id_roles_user_idx" ON "public"."id_roles" USING "btree" ("user_id");



CREATE INDEX "id_snapshots_user_id_idx" ON "public"."id_snapshots" USING "btree" ("user_id");



CREATE INDEX "id_snapshots_user_id_uuid_idx" ON "public"."id_snapshots" USING "btree" ("user_id_uuid");



CREATE INDEX "id_snapshots_user_idx" ON "public"."id_snapshots" USING "btree" ("user_id", "snapshot_date" DESC);



CREATE INDEX "id_strengths_user_id_idx" ON "public"."id_strengths" USING "btree" ("user_id");



CREATE INDEX "id_strengths_user_id_uuid_idx" ON "public"."id_strengths" USING "btree" ("user_id_uuid");



CREATE INDEX "id_strengths_user_idx" ON "public"."id_strengths" USING "btree" ("user_id");



CREATE UNIQUE INDEX "id_values_unique_idx" ON "public"."id_values" USING "btree" ("user_id", "lower"("value_name")) WHERE ("active" = true);



CREATE INDEX "id_values_user_id_idx" ON "public"."id_values" USING "btree" ("user_id");



CREATE INDEX "id_values_user_id_uuid_idx" ON "public"."id_values" USING "btree" ("user_id_uuid");



CREATE INDEX "id_values_user_idx" ON "public"."id_values" USING "btree" ("user_id", "importance_rank");



CREATE INDEX "identity_arcs_user_id_idx" ON "public"."identity_arcs" USING "btree" ("user_id");



CREATE INDEX "identity_arcs_user_id_text_idx" ON "public"."identity_arcs" USING "btree" ("user_id_text");



CREATE INDEX "identity_arcs_user_id_uuid_idx" ON "public"."identity_arcs" USING "btree" ("user_id_uuid");



CREATE INDEX "identity_events_user_id_idx" ON "public"."identity_events" USING "btree" ("user_id");



CREATE INDEX "identity_events_user_id_uuid_idx" ON "public"."identity_events" USING "btree" ("user_id_uuid");



CREATE INDEX "identity_transforms_user_id_idx" ON "public"."identity_transforms" USING "btree" ("user_id");



CREATE INDEX "identity_transforms_user_id_text_idx" ON "public"."identity_transforms" USING "btree" ("user_id_text");



CREATE INDEX "identity_transforms_user_id_uuid_idx" ON "public"."identity_transforms" USING "btree" ("user_id_uuid");



CREATE INDEX "idx_aa_related_insight" ON "public"."autonomy_actions" USING "btree" ("related_insight_id") WHERE ("related_insight_id" IS NOT NULL);



CREATE INDEX "idx_aa_scheduled" ON "public"."autonomy_actions" USING "btree" ("user_id", "scheduled_for") WHERE ("scheduled_for" IS NOT NULL);



CREATE INDEX "idx_aa_user_id" ON "public"."autonomy_actions" USING "btree" ("user_id");



CREATE INDEX "idx_aa_user_status" ON "public"."autonomy_actions" USING "btree" ("user_id", "status");



CREATE INDEX "idx_aa_user_type" ON "public"."autonomy_actions" USING "btree" ("user_id", "type");



CREATE INDEX "idx_achievements__user_id" ON "public"."achievements" USING "btree" ("user_id");



CREATE INDEX "idx_achievements_owner_user_id" ON "public"."achievements" USING "btree" ("owner_user_id");



CREATE INDEX "idx_achievements_user" ON "public"."achievements" USING "btree" ("user_id");



CREATE INDEX "idx_activity_events__user_id" ON "public"."activity_events" USING "btree" ("user_id");



CREATE INDEX "idx_activity_events__user_id__created_at_desc" ON "public"."activity_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_ag_agents_owner_user_id" ON "public"."ag_agents" USING "btree" ("owner_user_id");



CREATE INDEX "idx_ag_messages__user_id" ON "public"."ag_messages" USING "btree" ("user_id");



CREATE INDEX "idx_ag_messages__user_id__created_at_desc" ON "public"."ag_messages" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_ag_messages_owner_user_id" ON "public"."ag_messages" USING "btree" ("owner_user_id");



CREATE INDEX "idx_ag_messages_run" ON "public"."ag_messages" USING "btree" ("run_id", "created_at");



CREATE INDEX "idx_ag_runs__user_id" ON "public"."ag_runs" USING "btree" ("user_id");



CREATE INDEX "idx_ag_runs__user_id__created_at_desc" ON "public"."ag_runs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_ag_runs__user_id__updated_at_desc" ON "public"."ag_runs" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_ag_runs_owner_user_id" ON "public"."ag_runs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_ag_runs_status" ON "public"."ag_runs" USING "btree" ("user_id", "status");



CREATE INDEX "idx_ag_runs_user" ON "public"."ag_runs" USING "btree" ("user_id");



CREATE INDEX "idx_agi_actions__user_id" ON "public"."agi_actions" USING "btree" ("user_id");



CREATE INDEX "idx_agi_actions_owner_user_id" ON "public"."agi_actions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_agi_agent_profiles__user_id" ON "public"."agi_agent_profiles" USING "btree" ("user_id");



CREATE INDEX "idx_agi_agent_profiles_owner_user_id" ON "public"."agi_agent_profiles" USING "btree" ("owner_user_id");



CREATE INDEX "idx_agi_feedback__user_id" ON "public"."agi_feedback" USING "btree" ("user_id");



CREATE INDEX "idx_agi_feedback__user_id__created_at_desc" ON "public"."agi_feedback" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_agi_feedback_owner_user_id" ON "public"."agi_feedback" USING "btree" ("owner_user_id");



CREATE INDEX "idx_agi_policies__user_id" ON "public"."agi_policies" USING "btree" ("user_id");



CREATE INDEX "idx_agi_policies__user_id__created_at_desc" ON "public"."agi_policies" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_agi_policies_owner_user_id" ON "public"."agi_policies" USING "btree" ("owner_user_id");



CREATE INDEX "idx_agi_runs__user_id" ON "public"."agi_runs" USING "btree" ("user_id");



CREATE INDEX "idx_agi_runs_owner_user_id" ON "public"."agi_runs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_agi_scenario_runs__user_id" ON "public"."agi_scenario_runs" USING "btree" ("user_id");



CREATE INDEX "idx_agi_scenario_runs__user_id__created_at_desc" ON "public"."agi_scenario_runs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_agi_scenario_runs_owner_user_id" ON "public"."agi_scenario_runs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_agi_scenarios_owner_user_id" ON "public"."agi_scenarios" USING "btree" ("owner_user_id");



CREATE INDEX "idx_agi_telemetry__user_id" ON "public"."agi_telemetry" USING "btree" ("user_id");



CREATE INDEX "idx_agi_telemetry__user_id__created_at_desc" ON "public"."agi_telemetry" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_agi_telemetry_owner_user_id" ON "public"."agi_telemetry" USING "btree" ("owner_user_id");



CREATE INDEX "idx_agi_user_profile__user_id" ON "public"."agi_user_profile" USING "btree" ("user_id");



CREATE INDEX "idx_agi_user_profile__user_id__created_at_desc" ON "public"."agi_user_profile" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_agi_user_profile__user_id__updated_at_desc" ON "public"."agi_user_profile" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_agi_user_profile_owner_user_id" ON "public"."agi_user_profile" USING "btree" ("owner_user_id");



CREATE INDEX "idx_align_feedback__user_id" ON "public"."align_feedback" USING "btree" ("user_id");



CREATE INDEX "idx_align_feedback__user_id__created_at_desc" ON "public"."align_feedback" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_align_feedback_owner_user_id" ON "public"."align_feedback" USING "btree" ("owner_user_id");



CREATE INDEX "idx_align_feedback_user" ON "public"."align_feedback" USING "btree" ("user_id");



CREATE INDEX "idx_align_global_policies_owner_user_id" ON "public"."align_global_policies" USING "btree" ("owner_user_id");



CREATE INDEX "idx_align_user_profiles__user_id" ON "public"."align_user_profiles" USING "btree" ("user_id");



CREATE INDEX "idx_align_user_profiles__user_id__created_at_desc" ON "public"."align_user_profiles" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_align_user_profiles__user_id__updated_at_desc" ON "public"."align_user_profiles" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_align_user_profiles_owner_user_id" ON "public"."align_user_profiles" USING "btree" ("owner_user_id");



CREATE INDEX "idx_align_violations__user_id" ON "public"."align_violations" USING "btree" ("user_id");



CREATE INDEX "idx_align_violations__user_id__created_at_desc" ON "public"."align_violations" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_align_violations_owner_user_id" ON "public"."align_violations" USING "btree" ("owner_user_id");



CREATE INDEX "idx_align_violations_severity" ON "public"."align_violations" USING "btree" ("severity");



CREATE INDEX "idx_align_violations_user" ON "public"."align_violations" USING "btree" ("user_id");



CREATE INDEX "idx_alignment_evaluations__user_id" ON "public"."alignment_evaluations" USING "btree" ("user_id");



CREATE INDEX "idx_alignment_evaluations__user_id__created_at_desc" ON "public"."alignment_evaluations" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_alignment_evaluations_owner_user_id" ON "public"."alignment_evaluations" USING "btree" ("owner_user_id");



CREATE INDEX "idx_alignment_evaluations_user_time" ON "public"."alignment_evaluations" USING "btree" ("user_id", "evaluated_at");



CREATE INDEX "idx_archetype_definitions_owner_user_id" ON "public"."archetype_definitions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_archetype_events__user_id" ON "public"."archetype_events" USING "btree" ("user_id");



CREATE INDEX "idx_archetype_events__user_id__created_at_desc" ON "public"."archetype_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_archetype_events_owner_user_id" ON "public"."archetype_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_archetype_snapshots__user_id" ON "public"."archetype_snapshots" USING "btree" ("user_id");



CREATE INDEX "idx_archetype_snapshots_owner_user_id" ON "public"."archetype_snapshots" USING "btree" ("owner_user_id");



CREATE INDEX "idx_artifact_links__user_id" ON "public"."artifact_links" USING "btree" ("user_id");



CREATE INDEX "idx_artifact_links__user_id__created_at_desc" ON "public"."artifact_links" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_artifact_links_exec" ON "public"."artifact_links" USING "btree" ("user_id", "execution_id", "created_at" DESC);



CREATE INDEX "idx_artifact_links_from" ON "public"."artifact_links" USING "btree" ("user_id", "from_type", "from_id", "created_at" DESC);



CREATE INDEX "idx_artifact_links_run" ON "public"."artifact_links" USING "btree" ("user_id", "execution_run_id", "created_at" DESC);



CREATE INDEX "idx_artifact_links_to" ON "public"."artifact_links" USING "btree" ("user_id", "to_type", "to_id", "created_at" DESC);



CREATE INDEX "idx_artifact_links_trace" ON "public"."artifact_links" USING "btree" ("user_id", "trace_id", "created_at" DESC);



CREATE INDEX "idx_artifact_links_user_id_text" ON "public"."artifact_links" USING "btree" ("user_id_text");



CREATE INDEX "idx_attention_events__user_id" ON "public"."attention_events" USING "btree" ("user_id");



CREATE INDEX "idx_attention_events_owner_user_id" ON "public"."attention_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_attention_events_user" ON "public"."attention_events" USING "btree" ("user_id", "occurred_at");



CREATE INDEX "idx_autonomy_actions__user_id" ON "public"."autonomy_actions" USING "btree" ("user_id");



CREATE INDEX "idx_autonomy_actions__user_id__created_at_desc" ON "public"."autonomy_actions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_autonomy_actions__user_id__updated_at_desc" ON "public"."autonomy_actions" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_autonomy_actions_owner_user_id" ON "public"."autonomy_actions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_autopilot_jobs__user_id" ON "public"."autopilot_jobs" USING "btree" ("user_id");



CREATE INDEX "idx_autopilot_suggestions__user_id" ON "public"."autopilot_suggestions" USING "btree" ("user_id");



CREATE INDEX "idx_autopilot_suggestions__user_id__created_at_desc" ON "public"."autopilot_suggestions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_autopilot_suggestions__user_id__updated_at_desc" ON "public"."autopilot_suggestions" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_behavior_predictions__user_id" ON "public"."behavior_predictions" USING "btree" ("user_id");



CREATE INDEX "idx_behavior_predictions__user_id__created_at_desc" ON "public"."behavior_predictions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_behavior_predictions_owner_user_id" ON "public"."behavior_predictions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_behavior_predictions_user_entity" ON "public"."behavior_predictions" USING "btree" ("user_id", "entity_type", "entity_id", "prediction_time");



CREATE INDEX "idx_brain_capabilities__user_id" ON "public"."brain_capabilities" USING "btree" ("user_id");



CREATE INDEX "idx_brain_capabilities__user_id__created_at_desc" ON "public"."brain_capabilities" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_brain_capabilities__user_id__updated_at_desc" ON "public"."brain_capabilities" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_brain_capabilities_owner_user_id" ON "public"."brain_capabilities" USING "btree" ("owner_user_id");



CREATE UNIQUE INDEX "idx_brain_capabilities_user_cap" ON "public"."brain_capabilities" USING "btree" ("user_id", "capability_key");



CREATE INDEX "idx_brain_changelog__user_id" ON "public"."brain_changelog" USING "btree" ("user_id");



CREATE INDEX "idx_brain_changelog__user_id__created_at_desc" ON "public"."brain_changelog" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_brain_changelog_owner_user_id" ON "public"."brain_changelog" USING "btree" ("owner_user_id");



CREATE INDEX "idx_brain_changelog_user" ON "public"."brain_changelog" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_brain_entries__user_id" ON "public"."brain_entries" USING "btree" ("user_id");



CREATE INDEX "idx_brain_entries__user_id__created_at_desc" ON "public"."brain_entries" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_brain_entries__user_id__updated_at_desc" ON "public"."brain_entries" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_brain_entries_tags" ON "public"."brain_entries" USING "gin" ("tags");



CREATE INDEX "idx_brain_entries_user_created" ON "public"."brain_entries" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_brain_error_events__user_id" ON "public"."brain_error_events" USING "btree" ("user_id");



CREATE INDEX "idx_brain_error_events_owner_user_id" ON "public"."brain_error_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_brain_error_events_subsystem" ON "public"."brain_error_events" USING "btree" ("subsystem_id", "occurred_at" DESC);



CREATE INDEX "idx_brain_error_events_user_time" ON "public"."brain_error_events" USING "btree" ("user_id", "occurred_at" DESC);



CREATE INDEX "idx_brain_events__user_id" ON "public"."brain_events" USING "btree" ("user_id");



CREATE INDEX "idx_brain_events__user_id__created_at_desc" ON "public"."brain_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_brain_events_owner_user_id" ON "public"."brain_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_brain_events_user_time" ON "public"."brain_events" USING "btree" ("user_id", "event_time");



CREATE INDEX "idx_brain_health_snapshots__user_id" ON "public"."brain_health_snapshots" USING "btree" ("user_id");



CREATE INDEX "idx_brain_health_snapshots_owner_user_id" ON "public"."brain_health_snapshots" USING "btree" ("owner_user_id");



CREATE INDEX "idx_brain_health_snapshots_user_time" ON "public"."brain_health_snapshots" USING "btree" ("user_id", "snapshot_time" DESC);



CREATE INDEX "idx_brain_subsystems__user_id" ON "public"."brain_subsystems" USING "btree" ("user_id");



CREATE INDEX "idx_brain_subsystems__user_id__created_at_desc" ON "public"."brain_subsystems" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_brain_subsystems__user_id__updated_at_desc" ON "public"."brain_subsystems" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_brain_subsystems_owner_user_id" ON "public"."brain_subsystems" USING "btree" ("owner_user_id");



CREATE INDEX "idx_brain_subsystems_user" ON "public"."brain_subsystems" USING "btree" ("user_id");



CREATE INDEX "idx_brainstem_status__user_id" ON "public"."brainstem_status" USING "btree" ("user_id");



CREATE INDEX "idx_brainstem_status__user_id__created_at_desc" ON "public"."brainstem_status" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_brainstem_status__user_id__updated_at_desc" ON "public"."brainstem_status" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_brainstem_status_owner_user_id" ON "public"."brainstem_status" USING "btree" ("owner_user_id");



CREATE INDEX "idx_branch_comparisons_owner_user_id" ON "public"."branch_comparisons" USING "btree" ("owner_user_id");



CREATE INDEX "idx_branch_simulation_runs_owner_user_id" ON "public"."branch_simulation_runs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_butler_notifications__user_id" ON "public"."butler_notifications" USING "btree" ("user_id");



CREATE INDEX "idx_butler_notifications__user_id__created_at_desc" ON "public"."butler_notifications" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_butler_notifications__user_id__updated_at_desc" ON "public"."butler_notifications" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_butler_notifications_owner_user_id" ON "public"."butler_notifications" USING "btree" ("owner_user_id");



CREATE INDEX "idx_butler_notifications_pending" ON "public"."butler_notifications" USING "btree" ("user_id", "status") WHERE ("status" = 'pending'::"text");



CREATE INDEX "idx_butler_notifications_status" ON "public"."butler_notifications" USING "btree" ("user_id", "status");



CREATE INDEX "idx_butler_notifications_user" ON "public"."butler_notifications" USING "btree" ("user_id");



CREATE INDEX "idx_butler_snoozes__user_id" ON "public"."butler_snoozes" USING "btree" ("user_id");



CREATE INDEX "idx_butler_snoozes__user_id__created_at_desc" ON "public"."butler_snoozes" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_butler_snoozes_owner_user_id" ON "public"."butler_snoozes" USING "btree" ("owner_user_id");



CREATE INDEX "idx_butler_snoozes_until" ON "public"."butler_snoozes" USING "btree" ("user_id", "snooze_until");



CREATE INDEX "idx_butler_snoozes_user" ON "public"."butler_snoozes" USING "btree" ("user_id");



CREATE INDEX "idx_ca_user_id" ON "public"."calendar_accounts" USING "btree" ("user_id");



CREATE INDEX "idx_ca_user_provider" ON "public"."calendar_accounts" USING "btree" ("user_id", "provider");



CREATE INDEX "idx_calendar_accounts__user_id" ON "public"."calendar_accounts" USING "btree" ("user_id");



CREATE INDEX "idx_calendar_accounts__user_id__created_at_desc" ON "public"."calendar_accounts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_calendar_accounts__user_id__updated_at_desc" ON "public"."calendar_accounts" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_calendar_accounts_owner_user_id" ON "public"."calendar_accounts" USING "btree" ("owner_user_id");



CREATE INDEX "idx_calendar_events_cache__user_id" ON "public"."calendar_events_cache" USING "btree" ("user_id");



CREATE INDEX "idx_calendar_events_cache__user_id__created_at_desc" ON "public"."calendar_events_cache" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_calendar_events_cache__user_id__updated_at_desc" ON "public"."calendar_events_cache" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_calendar_events_cache_owner_user_id" ON "public"."calendar_events_cache" USING "btree" ("owner_user_id");



CREATE INDEX "idx_call_intelligence_settings__user_id" ON "public"."call_intelligence_settings" USING "btree" ("user_id");



CREATE INDEX "idx_call_intelligence_settings__user_id__created_at_desc" ON "public"."call_intelligence_settings" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_call_intelligence_settings__user_id__updated_at_desc" ON "public"."call_intelligence_settings" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_call_intelligence_settings_owner_user_id" ON "public"."call_intelligence_settings" USING "btree" ("owner_user_id");



CREATE INDEX "idx_call_links_owner_user_id" ON "public"."call_links" USING "btree" ("owner_user_id");



CREATE INDEX "idx_call_segments_owner_user_id" ON "public"."call_segments" USING "btree" ("owner_user_id");



CREATE INDEX "idx_call_sessions__user_id" ON "public"."call_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_call_sessions__user_id__created_at_desc" ON "public"."call_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_call_sessions_owner_user_id" ON "public"."call_sessions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_call_summaries__user_id" ON "public"."call_summaries" USING "btree" ("user_id");



CREATE INDEX "idx_call_summaries__user_id__created_at_desc" ON "public"."call_summaries" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_call_summaries_owner_user_id" ON "public"."call_summaries" USING "btree" ("owner_user_id");



CREATE INDEX "idx_calls__user_id" ON "public"."calls" USING "btree" ("user_id");



CREATE INDEX "idx_calls__user_id__created_at_desc" ON "public"."calls" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_calls_contact_id" ON "public"."calls" USING "btree" ("contact_id");



CREATE INDEX "idx_calls_owner_user_id" ON "public"."calls" USING "btree" ("owner_user_id");



CREATE INDEX "idx_calls_user_id" ON "public"."calls" USING "btree" ("user_id");



CREATE INDEX "idx_camp_status" ON "public"."campaigns" USING "btree" ("user_id", "status");



CREATE INDEX "idx_camp_user" ON "public"."campaigns" USING "btree" ("user_id");



CREATE INDEX "idx_campaign_enrollments__user_id" ON "public"."campaign_enrollments" USING "btree" ("user_id");



CREATE INDEX "idx_campaign_enrollments_owner_user_id" ON "public"."campaign_enrollments" USING "btree" ("owner_user_id");



CREATE INDEX "idx_campaigns__user_id" ON "public"."campaigns" USING "btree" ("user_id");



CREATE INDEX "idx_campaigns__user_id__created_at_desc" ON "public"."campaigns" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_campaigns__user_id__updated_at_desc" ON "public"."campaigns" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_campaigns_owner_user_id" ON "public"."campaigns" USING "btree" ("owner_user_id");



CREATE INDEX "idx_canon_events__user_id" ON "public"."canon_events" USING "btree" ("user_id");



CREATE INDEX "idx_canon_events__user_id__created_at_desc" ON "public"."canon_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_canon_events_owner_user_id" ON "public"."canon_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_canon_timeline_index__user_id" ON "public"."canon_timeline_index" USING "btree" ("user_id");



CREATE INDEX "idx_canon_timeline_index__user_id__created_at_desc" ON "public"."canon_timeline_index" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_canon_timeline_index_owner_user_id" ON "public"."canon_timeline_index" USING "btree" ("owner_user_id");



CREATE INDEX "idx_cce_contact_time" ON "public"."crm_contact_events" USING "btree" ("owner_user_id", "contact_id", "occurred_at" DESC);



CREATE INDEX "idx_cce_type" ON "public"."crm_contact_events" USING "btree" ("owner_user_id", "contact_id", "type");



CREATE INDEX "idx_ccf_contact" ON "public"."crm_contact_facts" USING "btree" ("owner_user_id", "contact_id");



CREATE INDEX "idx_ccf_pinned" ON "public"."crm_contact_facts" USING "btree" ("owner_user_id", "contact_id", "pinned");



CREATE INDEX "idx_cci_contact" ON "public"."crm_contact_intel" USING "btree" ("owner_user_id", "contact_id");



CREATE INDEX "idx_ce_campaign" ON "public"."campaign_enrollments" USING "btree" ("campaign_id");



CREATE INDEX "idx_ce_next" ON "public"."campaign_enrollments" USING "btree" ("next_step_at") WHERE ("status" = 'active'::"text");



CREATE INDEX "idx_ce_status" ON "public"."campaign_enrollments" USING "btree" ("status");



CREATE INDEX "idx_ce_user" ON "public"."campaign_enrollments" USING "btree" ("user_id");



CREATE INDEX "idx_cec_start_time" ON "public"."calendar_events_cache" USING "btree" ("start_time");



CREATE INDEX "idx_cec_user_id" ON "public"."calendar_events_cache" USING "btree" ("user_id");



CREATE INDEX "idx_cec_user_time" ON "public"."calendar_events_cache" USING "btree" ("user_id", "start_time", "end_time");



CREATE INDEX "idx_chapter_archetypes__user_id" ON "public"."chapter_archetypes" USING "btree" ("user_id");



CREATE INDEX "idx_chapter_archetypes__user_id__created_at_desc" ON "public"."chapter_archetypes" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_chapter_archetypes_owner_user_id" ON "public"."chapter_archetypes" USING "btree" ("owner_user_id");



CREATE INDEX "idx_civilization_domain_mappings__user_id" ON "public"."civilization_domain_mappings" USING "btree" ("user_id");



CREATE INDEX "idx_civilization_domain_mappings__user_id__created_at_desc" ON "public"."civilization_domain_mappings" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_civilization_domain_mappings_owner_user_id" ON "public"."civilization_domain_mappings" USING "btree" ("owner_user_id");



CREATE INDEX "idx_civilization_domain_state_owner_user_id" ON "public"."civilization_domain_state" USING "btree" ("owner_user_id");



CREATE INDEX "idx_civilization_domains__user_id" ON "public"."civilization_domains" USING "btree" ("user_id");



CREATE INDEX "idx_civilization_domains__user_id__created_at_desc" ON "public"."civilization_domains" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_civilization_domains_owner_user_id" ON "public"."civilization_domains" USING "btree" ("owner_user_id");



CREATE INDEX "idx_civilization_patterns_owner_user_id" ON "public"."civilization_patterns" USING "btree" ("owner_user_id");



CREATE INDEX "idx_civilization_settings__user_id" ON "public"."civilization_settings" USING "btree" ("user_id");



CREATE INDEX "idx_civilization_settings__user_id__created_at_desc" ON "public"."civilization_settings" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_civilization_settings__user_id__updated_at_desc" ON "public"."civilization_settings" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_civilization_settings_owner_user_id" ON "public"."civilization_settings" USING "btree" ("owner_user_id");



CREATE INDEX "idx_coach_council_deliberations_owner_user_id" ON "public"."coach_council_deliberations" USING "btree" ("owner_user_id");



CREATE INDEX "idx_coach_council_members_owner_user_id" ON "public"."coach_council_members" USING "btree" ("owner_user_id");



CREATE INDEX "idx_coach_council_sessions__user_id" ON "public"."coach_council_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_coach_council_sessions__user_id__created_at_desc" ON "public"."coach_council_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_coach_council_sessions_owner_user_id" ON "public"."coach_council_sessions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_coach_council_summary_owner_user_id" ON "public"."coach_council_summary" USING "btree" ("owner_user_id");



CREATE INDEX "idx_coach_generated_scenarios__user_id" ON "public"."coach_generated_scenarios" USING "btree" ("user_id");



CREATE INDEX "idx_coach_generated_scenarios__user_id__created_at_desc" ON "public"."coach_generated_scenarios" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_coach_generated_scenarios_owner_user_id" ON "public"."coach_generated_scenarios" USING "btree" ("owner_user_id");



CREATE INDEX "idx_coach_multi_agent_sessions__user_id" ON "public"."coach_multi_agent_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_coach_multi_agent_sessions__user_id__created_at_desc" ON "public"."coach_multi_agent_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_coach_multi_agent_sessions__user_id__updated_at_desc" ON "public"."coach_multi_agent_sessions" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_coach_multi_agent_sessions_owner_user_id" ON "public"."coach_multi_agent_sessions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_coach_roleplay_scenarios_owner_user_id" ON "public"."coach_roleplay_scenarios" USING "btree" ("owner_user_id");



CREATE INDEX "idx_coach_scenarios_owner_user_id" ON "public"."coach_scenarios" USING "btree" ("owner_user_id");



CREATE INDEX "idx_coach_sessions__user_id" ON "public"."coach_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_coach_sessions__user_id__created_at_desc" ON "public"."coach_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_coach_sessions_coach" ON "public"."coach_sessions" USING "btree" ("coach");



CREATE INDEX "idx_coach_sessions_owner_user_id" ON "public"."coach_sessions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_coach_sessions_user_id" ON "public"."coach_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_coach_training_sessions__user_id" ON "public"."coach_training_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_coach_training_sessions__user_id__created_at_desc" ON "public"."coach_training_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_coach_training_sessions_owner_user_id" ON "public"."coach_training_sessions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_coach_user_preferences__user_id" ON "public"."coach_user_preferences" USING "btree" ("user_id");



CREATE INDEX "idx_coach_user_preferences__user_id__created_at_desc" ON "public"."coach_user_preferences" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_coach_user_preferences__user_id__updated_at_desc" ON "public"."coach_user_preferences" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_coach_user_preferences_owner_user_id" ON "public"."coach_user_preferences" USING "btree" ("owner_user_id");



CREATE INDEX "idx_coach_voice_overrides_owner_user_id" ON "public"."coach_voice_overrides" USING "btree" ("owner_user_id");



CREATE INDEX "idx_coach_voice_sessions__user_id" ON "public"."coach_voice_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_coach_voice_sessions__user_id__created_at_desc" ON "public"."coach_voice_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_coach_voice_sessions_owner_user_id" ON "public"."coach_voice_sessions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_cognitive_hypotheses__user_id" ON "public"."cognitive_hypotheses" USING "btree" ("user_id");



CREATE INDEX "idx_cognitive_hypotheses__user_id__created_at_desc" ON "public"."cognitive_hypotheses" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_cognitive_hypotheses__user_id__updated_at_desc" ON "public"."cognitive_hypotheses" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_cognitive_hypotheses_owner_user_id" ON "public"."cognitive_hypotheses" USING "btree" ("owner_user_id");



CREATE INDEX "idx_cognitive_hypotheses_user" ON "public"."cognitive_hypotheses" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_cognitive_insights__user_id" ON "public"."cognitive_insights" USING "btree" ("user_id");



CREATE INDEX "idx_cognitive_insights__user_id__created_at_desc" ON "public"."cognitive_insights" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_cognitive_insights_category" ON "public"."cognitive_insights" USING "btree" ("user_id", "category", "created_at" DESC);



CREATE INDEX "idx_cognitive_insights_owner_user_id" ON "public"."cognitive_insights" USING "btree" ("owner_user_id");



CREATE INDEX "idx_cognitive_insights_user_time" ON "public"."cognitive_insights" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_cognitive_phases__user_id" ON "public"."cognitive_phases" USING "btree" ("user_id");



CREATE INDEX "idx_cognitive_phases__user_id__created_at_desc" ON "public"."cognitive_phases" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_cognitive_phases_owner_user_id" ON "public"."cognitive_phases" USING "btree" ("owner_user_id");



CREATE INDEX "idx_cognitive_phases_run" ON "public"."cognitive_phases" USING "btree" ("run_id", "phase_name");



CREATE INDEX "idx_cognitive_runs__user_id" ON "public"."cognitive_runs" USING "btree" ("user_id");



CREATE INDEX "idx_cognitive_runs__user_id__created_at_desc" ON "public"."cognitive_runs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_cognitive_runs_owner_user_id" ON "public"."cognitive_runs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_cognitive_runs_user_time" ON "public"."cognitive_runs" USING "btree" ("user_id", "started_at" DESC);



CREATE INDEX "idx_cognitive_self_reflections__user_id" ON "public"."cognitive_self_reflections" USING "btree" ("user_id");



CREATE INDEX "idx_cognitive_self_reflections__user_id__created_at_desc" ON "public"."cognitive_self_reflections" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_cognitive_self_reflections_owner_user_id" ON "public"."cognitive_self_reflections" USING "btree" ("owner_user_id");



CREATE INDEX "idx_cognitive_self_reflections_user_time" ON "public"."cognitive_self_reflections" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_cognitive_update_actions__user_id" ON "public"."cognitive_update_actions" USING "btree" ("user_id");



CREATE INDEX "idx_cognitive_update_actions__user_id__created_at_desc" ON "public"."cognitive_update_actions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_cognitive_update_actions_owner_user_id" ON "public"."cognitive_update_actions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_cognitive_update_actions_user_status" ON "public"."cognitive_update_actions" USING "btree" ("user_id", "status", "created_at" DESC);



CREATE INDEX "idx_communication_programs_owner_user_id" ON "public"."communication_programs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_communication_sessions__user_id" ON "public"."communication_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_communication_sessions__user_id__created_at_desc" ON "public"."communication_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_communication_sessions_owner_user_id" ON "public"."communication_sessions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_communication_turns_owner_user_id" ON "public"."communication_turns" USING "btree" ("owner_user_id");



CREATE INDEX "idx_conscious_conflicts__user_id" ON "public"."conscious_conflicts" USING "btree" ("user_id");



CREATE INDEX "idx_conscious_conflicts__user_id__created_at_desc" ON "public"."conscious_conflicts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_conscious_conflicts_owner_user_id" ON "public"."conscious_conflicts" USING "btree" ("owner_user_id");



CREATE INDEX "idx_conscious_conflicts_user" ON "public"."conscious_conflicts" USING "btree" ("user_id", "created_at");



CREATE INDEX "idx_conscious_frames__user_id" ON "public"."conscious_frames" USING "btree" ("user_id");



CREATE INDEX "idx_conscious_frames__user_id__created_at_desc" ON "public"."conscious_frames" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_conscious_frames_owner_user_id" ON "public"."conscious_frames" USING "btree" ("owner_user_id");



CREATE INDEX "idx_conscious_frames_user_time" ON "public"."conscious_frames" USING "btree" ("user_id", "frame_time");



CREATE INDEX "idx_conscious_insights__user_id" ON "public"."conscious_insights" USING "btree" ("user_id");



CREATE INDEX "idx_conscious_insights__user_id__created_at_desc" ON "public"."conscious_insights" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_conscious_insights_owner_user_id" ON "public"."conscious_insights" USING "btree" ("owner_user_id");



CREATE INDEX "idx_conscious_insights_user_time" ON "public"."conscious_insights" USING "btree" ("user_id", "generated_at");



CREATE INDEX "idx_conscious_items__user_id" ON "public"."conscious_items" USING "btree" ("user_id");



CREATE INDEX "idx_conscious_items__user_id__created_at_desc" ON "public"."conscious_items" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_conscious_items_owner_user_id" ON "public"."conscious_items" USING "btree" ("owner_user_id");



CREATE INDEX "idx_conscious_items_user_attention" ON "public"."conscious_items" USING "btree" ("user_id", "attention_score" DESC);



CREATE INDEX "idx_conscious_items_user_frame" ON "public"."conscious_items" USING "btree" ("user_id", "frame_id");



CREATE INDEX "idx_conscious_links__user_id" ON "public"."conscious_links" USING "btree" ("user_id");



CREATE INDEX "idx_conscious_links__user_id__created_at_desc" ON "public"."conscious_links" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_conscious_links_owner_user_id" ON "public"."conscious_links" USING "btree" ("owner_user_id");



CREATE INDEX "idx_conscious_links_user" ON "public"."conscious_links" USING "btree" ("user_id");



CREATE INDEX "idx_contact_dates__user_id" ON "public"."contact_dates" USING "btree" ("user_id");



CREATE INDEX "idx_contact_dates__user_id__created_at_desc" ON "public"."contact_dates" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_contact_dates_contact" ON "public"."contact_dates" USING "btree" ("contact_id");



CREATE INDEX "idx_contact_dates_date" ON "public"."contact_dates" USING "btree" ("date");



CREATE INDEX "idx_contact_dates_user" ON "public"."contact_dates" USING "btree" ("user_id");



CREATE INDEX "idx_contact_emails__user_id" ON "public"."contact_emails" USING "btree" ("user_id");



CREATE INDEX "idx_contact_emails__user_id__created_at_desc" ON "public"."contact_emails" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_contact_emails_contact" ON "public"."contact_emails" USING "btree" ("contact_id");



CREATE INDEX "idx_contact_emails_email" ON "public"."contact_emails" USING "btree" ("email");



CREATE INDEX "idx_contact_emails_user" ON "public"."contact_emails" USING "btree" ("user_id");



CREATE INDEX "idx_contact_facts__user_id" ON "public"."contact_facts" USING "btree" ("user_id");



CREATE INDEX "idx_contact_facts__user_id__created_at_desc" ON "public"."contact_facts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_contact_facts__user_id__updated_at_desc" ON "public"."contact_facts" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_contact_facts_contact" ON "public"."contact_facts" USING "btree" ("contact_id");



CREATE INDEX "idx_contact_facts_key" ON "public"."contact_facts" USING "btree" ("key");



CREATE INDEX "idx_contact_facts_user" ON "public"."contact_facts" USING "btree" ("user_id");



CREATE INDEX "idx_contact_identity_intel__user_id" ON "public"."contact_identity_intel" USING "btree" ("user_id");



CREATE INDEX "idx_contact_identity_intel_owner_user_id" ON "public"."contact_identity_intel" USING "btree" ("owner_user_id");



CREATE INDEX "idx_contact_influence_events__user_id" ON "public"."contact_influence_events" USING "btree" ("user_id");



CREATE INDEX "idx_contact_influence_events__user_id__created_at_desc" ON "public"."contact_influence_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_contact_influence_events_owner_user_id" ON "public"."contact_influence_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_contact_intelligence_sources__user_id" ON "public"."contact_intelligence_sources" USING "btree" ("user_id");



CREATE INDEX "idx_contact_intelligence_sources_owner_user_id" ON "public"."contact_intelligence_sources" USING "btree" ("owner_user_id");



CREATE INDEX "idx_contact_phones__user_id" ON "public"."contact_phones" USING "btree" ("user_id");



CREATE INDEX "idx_contact_phones__user_id__created_at_desc" ON "public"."contact_phones" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_contact_phones_contact" ON "public"."contact_phones" USING "btree" ("contact_id");



CREATE INDEX "idx_contact_phones_user" ON "public"."contact_phones" USING "btree" ("user_id");



CREATE INDEX "idx_contact_playbooks__user_id" ON "public"."contact_playbooks" USING "btree" ("user_id");



CREATE INDEX "idx_contact_playbooks_owner_user_id" ON "public"."contact_playbooks" USING "btree" ("owner_user_id");



CREATE INDEX "idx_contact_relationship_scores__user_id" ON "public"."contact_relationship_scores" USING "btree" ("user_id");



CREATE INDEX "idx_contact_relationship_scores_owner_user_id" ON "public"."contact_relationship_scores" USING "btree" ("owner_user_id");



CREATE INDEX "idx_contact_relationships__user_id" ON "public"."contact_relationships" USING "btree" ("user_id");



CREATE INDEX "idx_contact_relationships__user_id__created_at_desc" ON "public"."contact_relationships" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_contact_relationships_from" ON "public"."contact_relationships" USING "btree" ("from_contact_id");



CREATE INDEX "idx_contact_relationships_to" ON "public"."contact_relationships" USING "btree" ("to_contact_id");



CREATE INDEX "idx_contact_relationships_user" ON "public"."contact_relationships" USING "btree" ("user_id");



CREATE INDEX "idx_contact_tag_links__user_id" ON "public"."contact_tag_links" USING "btree" ("user_id");



CREATE INDEX "idx_contact_tag_links__user_id__created_at_desc" ON "public"."contact_tag_links" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_contact_tag_links_contact" ON "public"."contact_tag_links" USING "btree" ("contact_id");



CREATE INDEX "idx_contact_tag_links_tag" ON "public"."contact_tag_links" USING "btree" ("tag_id");



CREATE INDEX "idx_contact_tag_links_user" ON "public"."contact_tag_links" USING "btree" ("user_id");



CREATE INDEX "idx_contact_tags__user_id" ON "public"."contact_tags" USING "btree" ("user_id");



CREATE INDEX "idx_contact_tags__user_id__created_at_desc" ON "public"."contact_tags" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_contact_tags_category" ON "public"."contact_tags" USING "btree" ("user_id", "category");



CREATE INDEX "idx_contact_tags_user" ON "public"."contact_tags" USING "btree" ("user_id");



CREATE INDEX "idx_contacts__user_id" ON "public"."contacts" USING "btree" ("user_id");



CREATE INDEX "idx_contacts__user_id__created_at_desc" ON "public"."contacts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_contacts__user_id__updated_at_desc" ON "public"."contacts" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_contacts_owner" ON "public"."crm_contacts" USING "btree" ("owner_user_id");



CREATE INDEX "idx_contacts_owner_user_id" ON "public"."contacts" USING "btree" ("owner_user_id");



CREATE INDEX "idx_contacts_user_email" ON "public"."contacts" USING "btree" ("user_id", "email");



CREATE INDEX "idx_contacts_user_email_lower" ON "public"."contacts" USING "btree" ("user_id", "lower"("email")) WHERE (("email" IS NOT NULL) AND ("length"("email") > 0));



CREATE INDEX "idx_contacts_user_full_name_lower" ON "public"."contacts" USING "btree" ("user_id", "lower"("full_name")) WHERE (("full_name" IS NOT NULL) AND ("length"("full_name") > 0));



CREATE INDEX "idx_contacts_user_id" ON "public"."contacts" USING "btree" ("user_id");



CREATE INDEX "idx_contacts_user_name" ON "public"."contacts" USING "btree" ("user_id", "name");



CREATE INDEX "idx_cortex_anomalies__user_id" ON "public"."cortex_anomalies" USING "btree" ("user_id");



CREATE INDEX "idx_cortex_anomalies__user_id__created_at_desc" ON "public"."cortex_anomalies" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_cortex_anomalies_owner_user_id" ON "public"."cortex_anomalies" USING "btree" ("owner_user_id");



CREATE INDEX "idx_cortex_anomalies_user" ON "public"."cortex_anomalies" USING "btree" ("user_id", "window_date");



CREATE INDEX "idx_cortex_areas__user_id" ON "public"."cortex_areas" USING "btree" ("user_id");



CREATE INDEX "idx_cortex_areas__user_id__created_at_desc" ON "public"."cortex_areas" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_cortex_areas__user_id__updated_at_desc" ON "public"."cortex_areas" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_cortex_areas_owner_user_id" ON "public"."cortex_areas" USING "btree" ("owner_user_id");



CREATE INDEX "idx_cortex_areas_user" ON "public"."cortex_areas" USING "btree" ("user_id");



CREATE INDEX "idx_cortex_events__user_id" ON "public"."cortex_events" USING "btree" ("user_id");



CREATE INDEX "idx_cortex_events__user_id__created_at_desc" ON "public"."cortex_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_cortex_events_owner_user_id" ON "public"."cortex_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_cortex_events_user_time" ON "public"."cortex_events" USING "btree" ("user_id", "event_time");



CREATE INDEX "idx_cortex_events_user_type" ON "public"."cortex_events" USING "btree" ("user_id", "event_type");



CREATE INDEX "idx_cortex_patterns__user_id" ON "public"."cortex_patterns" USING "btree" ("user_id");



CREATE INDEX "idx_cortex_patterns__user_id__created_at_desc" ON "public"."cortex_patterns" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_cortex_patterns__user_id__updated_at_desc" ON "public"."cortex_patterns" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_cortex_patterns_owner_user_id" ON "public"."cortex_patterns" USING "btree" ("owner_user_id");



CREATE INDEX "idx_cortex_patterns_user" ON "public"."cortex_patterns" USING "btree" ("user_id");



CREATE INDEX "idx_cortex_predictions__user_id" ON "public"."cortex_predictions" USING "btree" ("user_id");



CREATE INDEX "idx_cortex_predictions__user_id__created_at_desc" ON "public"."cortex_predictions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_cortex_predictions_owner_user_id" ON "public"."cortex_predictions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_cortex_predictions_user" ON "public"."cortex_predictions" USING "btree" ("user_id", "created_at");



CREATE INDEX "idx_cortex_signals__user_id" ON "public"."cortex_signals" USING "btree" ("user_id");



CREATE INDEX "idx_cortex_signals__user_id__created_at_desc" ON "public"."cortex_signals" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_cortex_signals__user_id__updated_at_desc" ON "public"."cortex_signals" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_cortex_signals_owner_user_id" ON "public"."cortex_signals" USING "btree" ("owner_user_id");



CREATE INDEX "idx_cortex_signals_user_date" ON "public"."cortex_signals" USING "btree" ("user_id", "window_date");



CREATE INDEX "idx_council_consensus__user_id" ON "public"."council_consensus" USING "btree" ("user_id");



CREATE INDEX "idx_council_consensus__user_id__created_at_desc" ON "public"."council_consensus" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_council_consensus_owner_user_id" ON "public"."council_consensus" USING "btree" ("owner_user_id");



CREATE INDEX "idx_council_decision_dossiers__user_id" ON "public"."council_decision_dossiers" USING "btree" ("user_id");



CREATE INDEX "idx_council_decision_dossiers__user_id__created_at_desc" ON "public"."council_decision_dossiers" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_council_decision_dossiers_owner_user_id" ON "public"."council_decision_dossiers" USING "btree" ("owner_user_id");



CREATE INDEX "idx_council_members__user_id" ON "public"."council_members" USING "btree" ("user_id");



CREATE INDEX "idx_council_members__user_id__created_at_desc" ON "public"."council_members" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_council_members_owner_user_id" ON "public"."council_members" USING "btree" ("owner_user_id");



CREATE INDEX "idx_council_members_user" ON "public"."council_members" USING "btree" ("user_id");



CREATE INDEX "idx_council_opinions__user_id" ON "public"."council_opinions" USING "btree" ("user_id");



CREATE INDEX "idx_council_opinions__user_id__created_at_desc" ON "public"."council_opinions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_council_opinions_owner_user_id" ON "public"."council_opinions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_council_opinions_session" ON "public"."council_opinions" USING "btree" ("session_id");



CREATE INDEX "idx_council_sessions__user_id" ON "public"."council_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_council_sessions__user_id__created_at_desc" ON "public"."council_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_council_sessions_owner_user_id" ON "public"."council_sessions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_creative_artifacts__user_id" ON "public"."creative_artifacts" USING "btree" ("user_id");



CREATE INDEX "idx_creative_artifacts__user_id__created_at_desc" ON "public"."creative_artifacts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_creative_artifacts__user_id__updated_at_desc" ON "public"."creative_artifacts" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_creative_artifacts_owner_user_id" ON "public"."creative_artifacts" USING "btree" ("owner_user_id");



CREATE INDEX "idx_creative_artifacts_user" ON "public"."creative_artifacts" USING "btree" ("user_id", "created_at");



CREATE INDEX "idx_creative_assets__user_id" ON "public"."creative_assets" USING "btree" ("user_id");



CREATE INDEX "idx_creative_assets__user_id__created_at_desc" ON "public"."creative_assets" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_creative_assets_owner_user_id" ON "public"."creative_assets" USING "btree" ("owner_user_id");



CREATE INDEX "idx_creative_evaluations__user_id" ON "public"."creative_evaluations" USING "btree" ("user_id");



CREATE INDEX "idx_creative_evaluations__user_id__created_at_desc" ON "public"."creative_evaluations" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_creative_evaluations_owner_user_id" ON "public"."creative_evaluations" USING "btree" ("owner_user_id");



CREATE INDEX "idx_creative_evaluations_user" ON "public"."creative_evaluations" USING "btree" ("user_id", "created_at");



CREATE INDEX "idx_creative_ideas__user_id" ON "public"."creative_ideas" USING "btree" ("user_id");



CREATE INDEX "idx_creative_ideas__user_id__created_at_desc" ON "public"."creative_ideas" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_creative_ideas__user_id__updated_at_desc" ON "public"."creative_ideas" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_creative_ideas_owner_user_id" ON "public"."creative_ideas" USING "btree" ("owner_user_id");



CREATE INDEX "idx_creative_ideas_session" ON "public"."creative_ideas" USING "btree" ("session_id");



CREATE INDEX "idx_creative_ideas_user_status" ON "public"."creative_ideas" USING "btree" ("user_id", "status");



CREATE INDEX "idx_creative_patterns__user_id" ON "public"."creative_patterns" USING "btree" ("user_id");



CREATE INDEX "idx_creative_patterns__user_id__created_at_desc" ON "public"."creative_patterns" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_creative_patterns__user_id__updated_at_desc" ON "public"."creative_patterns" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_creative_patterns_owner_user_id" ON "public"."creative_patterns" USING "btree" ("owner_user_id");



CREATE UNIQUE INDEX "idx_creative_patterns_user_key" ON "public"."creative_patterns" USING "btree" ("user_id", "pattern_key");



CREATE INDEX "idx_creative_projects__user_id" ON "public"."creative_projects" USING "btree" ("user_id");



CREATE INDEX "idx_creative_projects__user_id__created_at_desc" ON "public"."creative_projects" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_creative_projects__user_id__updated_at_desc" ON "public"."creative_projects" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_creative_projects_owner_user_id" ON "public"."creative_projects" USING "btree" ("owner_user_id");



CREATE INDEX "idx_creative_sessions__user_id" ON "public"."creative_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_creative_sessions__user_id__created_at_desc" ON "public"."creative_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_creative_sessions__user_id__updated_at_desc" ON "public"."creative_sessions" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_creative_sessions_owner_user_id" ON "public"."creative_sessions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_creative_sessions_user" ON "public"."creative_sessions" USING "btree" ("user_id", "created_at");



CREATE INDEX "idx_creative_style_profiles__user_id" ON "public"."creative_style_profiles" USING "btree" ("user_id");



CREATE INDEX "idx_creative_style_profiles__user_id__created_at_desc" ON "public"."creative_style_profiles" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_creative_style_profiles_owner_user_id" ON "public"."creative_style_profiles" USING "btree" ("owner_user_id");



CREATE INDEX "idx_crm_alerts__user_id" ON "public"."crm_alerts" USING "btree" ("user_id");



CREATE INDEX "idx_crm_alerts__user_id__created_at_desc" ON "public"."crm_alerts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_crm_alerts_owner_user_id" ON "public"."crm_alerts" USING "btree" ("owner_user_id");



CREATE INDEX "idx_crm_contact_org_links__user_id" ON "public"."crm_contact_org_links" USING "btree" ("user_id");



CREATE INDEX "idx_crm_contact_org_links__user_id__created_at_desc" ON "public"."crm_contact_org_links" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_crm_contact_org_links_owner_user_id" ON "public"."crm_contact_org_links" USING "btree" ("owner_user_id");



CREATE INDEX "idx_crm_contacts__user_id" ON "public"."crm_contacts" USING "btree" ("user_id");



CREATE INDEX "idx_crm_contacts__user_id__created_at_desc" ON "public"."crm_contacts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_crm_contacts__user_id__updated_at_desc" ON "public"."crm_contacts" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_crm_contacts_merged_into" ON "public"."crm_contacts" USING "btree" ("merged_into_contact_id");



CREATE INDEX "idx_crm_contacts_normalized_email" ON "public"."crm_contacts" USING "btree" ("normalized_email");



CREATE INDEX "idx_crm_contacts_normalized_full_name" ON "public"."crm_contacts" USING "btree" ("normalized_full_name");



CREATE INDEX "idx_crm_contacts_normalized_phone" ON "public"."crm_contacts" USING "btree" ("normalized_phone");



CREATE INDEX "idx_crm_contacts_owner_user_id" ON "public"."crm_contacts" USING "btree" ("owner_user_id");



CREATE INDEX "idx_crm_contacts_tb_node_id" ON "public"."crm_contacts" USING "btree" ("tb_node_id");



CREATE INDEX "idx_crm_contacts_user_id" ON "public"."crm_contacts" USING "btree" ("user_id");



CREATE INDEX "idx_crm_contacts_user_status" ON "public"."crm_contacts" USING "btree" ("user_id", "status");



CREATE INDEX "idx_crm_deal_contacts__user_id" ON "public"."crm_deal_contacts" USING "btree" ("user_id");



CREATE INDEX "idx_crm_deal_contacts__user_id__created_at_desc" ON "public"."crm_deal_contacts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_crm_deal_contacts_owner_user_id" ON "public"."crm_deal_contacts" USING "btree" ("owner_user_id");



CREATE INDEX "idx_crm_deal_health__user_id" ON "public"."crm_deal_health" USING "btree" ("user_id");



CREATE INDEX "idx_crm_deal_health__user_id__created_at_desc" ON "public"."crm_deal_health" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_crm_deal_health__user_id__updated_at_desc" ON "public"."crm_deal_health" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_crm_deal_health_owner_user_id" ON "public"."crm_deal_health" USING "btree" ("owner_user_id");



CREATE INDEX "idx_crm_deals__user_id" ON "public"."crm_deals" USING "btree" ("user_id");



CREATE INDEX "idx_crm_deals__user_id__created_at_desc" ON "public"."crm_deals" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_crm_deals__user_id__updated_at_desc" ON "public"."crm_deals" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_crm_deals_owner_user_id" ON "public"."crm_deals" USING "btree" ("owner_user_id");



CREATE INDEX "idx_crm_deals_tb_node_id" ON "public"."crm_deals" USING "btree" ("tb_node_id");



CREATE INDEX "idx_crm_interactions__user_id" ON "public"."crm_interactions" USING "btree" ("user_id");



CREATE INDEX "idx_crm_interactions__user_id__created_at_desc" ON "public"."crm_interactions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_crm_interactions_owner_user_id" ON "public"."crm_interactions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_crm_organizations__user_id" ON "public"."crm_organizations" USING "btree" ("user_id");



CREATE INDEX "idx_crm_organizations__user_id__created_at_desc" ON "public"."crm_organizations" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_crm_organizations__user_id__updated_at_desc" ON "public"."crm_organizations" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_crm_organizations_owner_user_id" ON "public"."crm_organizations" USING "btree" ("owner_user_id");



CREATE INDEX "idx_crm_orgs_owner_user_id" ON "public"."crm_organizations" USING "btree" ("owner_user_id");



CREATE INDEX "idx_crm_orgs_tb_node_id" ON "public"."crm_organizations" USING "btree" ("tb_node_id");



CREATE INDEX "idx_crm_relationship_health__user_id" ON "public"."crm_relationship_health" USING "btree" ("user_id");



CREATE INDEX "idx_crm_relationship_health__user_id__created_at_desc" ON "public"."crm_relationship_health" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_crm_relationship_health__user_id__updated_at_desc" ON "public"."crm_relationship_health" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_crm_relationship_health_owner_user_id" ON "public"."crm_relationship_health" USING "btree" ("owner_user_id");



CREATE INDEX "idx_crm_tasks_contact" ON "public"."crm_tasks" USING "btree" ("contact_id");



CREATE INDEX "idx_crm_tasks_deal" ON "public"."crm_tasks" USING "btree" ("deal_id");



CREATE INDEX "idx_crm_tasks_due_at" ON "public"."crm_tasks" USING "btree" ("due_at");



CREATE INDEX "idx_crm_tasks_org" ON "public"."crm_tasks" USING "btree" ("org_id");



CREATE INDEX "idx_crm_tasks_owner_user_id" ON "public"."crm_tasks" USING "btree" ("owner_user_id");



CREATE INDEX "idx_crm_tasks_status" ON "public"."crm_tasks" USING "btree" ("status");



CREATE INDEX "idx_cultural_domains_owner_user_id" ON "public"."cultural_domains" USING "btree" ("owner_user_id");



CREATE INDEX "idx_cultural_highlights__user_id" ON "public"."cultural_highlights" USING "btree" ("user_id");



CREATE INDEX "idx_cultural_highlights__user_id__created_at_desc" ON "public"."cultural_highlights" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_cultural_highlights_owner_user_id" ON "public"."cultural_highlights" USING "btree" ("owner_user_id");



CREATE INDEX "idx_cultural_inference_snapshots__user_id" ON "public"."cultural_inference_snapshots" USING "btree" ("user_id");



CREATE INDEX "idx_cultural_inference_snapshots_owner_user_id" ON "public"."cultural_inference_snapshots" USING "btree" ("owner_user_id");



CREATE INDEX "idx_cultural_predictions__user_id" ON "public"."cultural_predictions" USING "btree" ("user_id");



CREATE INDEX "idx_cultural_predictions__user_id__created_at_desc" ON "public"."cultural_predictions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_cultural_predictions_owner_user_id" ON "public"."cultural_predictions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_cultural_profiles__user_id" ON "public"."cultural_profiles" USING "btree" ("user_id");



CREATE INDEX "idx_cultural_profiles__user_id__created_at_desc" ON "public"."cultural_profiles" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_cultural_profiles__user_id__updated_at_desc" ON "public"."cultural_profiles" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_cultural_profiles_owner_user_id" ON "public"."cultural_profiles" USING "btree" ("owner_user_id");



CREATE INDEX "idx_cultural_signals__user_id" ON "public"."cultural_signals" USING "btree" ("user_id");



CREATE INDEX "idx_cultural_signals__user_id__created_at_desc" ON "public"."cultural_signals" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_cultural_signals_owner_user_id" ON "public"."cultural_signals" USING "btree" ("owner_user_id");



CREATE INDEX "idx_culture_alignment_log__user_id" ON "public"."culture_alignment_log" USING "btree" ("user_id");



CREATE INDEX "idx_culture_alignment_log_owner_user_id" ON "public"."culture_alignment_log" USING "btree" ("owner_user_id");



CREATE INDEX "idx_culture_alignment_log_user" ON "public"."culture_alignment_log" USING "btree" ("user_id", "evaluated_at");



CREATE INDEX "idx_culture_contexts__user_id" ON "public"."culture_contexts" USING "btree" ("user_id");



CREATE INDEX "idx_culture_contexts__user_id__created_at_desc" ON "public"."culture_contexts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_culture_contexts__user_id__updated_at_desc" ON "public"."culture_contexts" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_culture_contexts_owner_user_id" ON "public"."culture_contexts" USING "btree" ("owner_user_id");



CREATE UNIQUE INDEX "idx_culture_contexts_user_key" ON "public"."culture_contexts" USING "btree" ("user_id", "key");



CREATE INDEX "idx_culture_norm_logs__user_id" ON "public"."culture_norm_logs" USING "btree" ("user_id");



CREATE INDEX "idx_culture_norm_logs__user_id__created_at_desc" ON "public"."culture_norm_logs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_culture_norm_logs_owner_user_id" ON "public"."culture_norm_logs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_culture_norm_logs_user_context" ON "public"."culture_norm_logs" USING "btree" ("user_id", "context_id", "created_at");



CREATE INDEX "idx_culture_profiles__user_id" ON "public"."culture_profiles" USING "btree" ("user_id");



CREATE INDEX "idx_culture_profiles__user_id__created_at_desc" ON "public"."culture_profiles" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_culture_profiles__user_id__updated_at_desc" ON "public"."culture_profiles" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_culture_profiles_owner_user_id" ON "public"."culture_profiles" USING "btree" ("owner_user_id");



CREATE UNIQUE INDEX "idx_culture_profiles_user_context" ON "public"."culture_profiles" USING "btree" ("user_id", "context_id");



CREATE INDEX "idx_daily_briefs_user_day" ON "public"."daily_briefs" USING "btree" ("user_id_uuid", "day" DESC);



CREATE INDEX "idx_daily_quest_generation_runs__user_id" ON "public"."daily_quest_generation_runs" USING "btree" ("user_id");



CREATE INDEX "idx_daily_quest_generation_runs__user_id__created_at_desc" ON "public"."daily_quest_generation_runs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_daily_quests__user_id" ON "public"."daily_quests" USING "btree" ("user_id");



CREATE INDEX "idx_daily_quests__user_id__created_at_desc" ON "public"."daily_quests" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_daily_quests__user_id__updated_at_desc" ON "public"."daily_quests" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_daily_timeline_views__user_id" ON "public"."daily_timeline_views" USING "btree" ("user_id");



CREATE INDEX "idx_daily_timeline_views__user_id__created_at_desc" ON "public"."daily_timeline_views" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_daily_timeline_views_owner_user_id" ON "public"."daily_timeline_views" USING "btree" ("owner_user_id");



CREATE INDEX "idx_dash_layouts__user_id" ON "public"."dash_layouts" USING "btree" ("user_id");



CREATE INDEX "idx_dash_layouts__user_id__created_at_desc" ON "public"."dash_layouts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_dash_layouts__user_id__updated_at_desc" ON "public"."dash_layouts" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_dash_layouts_owner_user_id" ON "public"."dash_layouts" USING "btree" ("owner_user_id");



CREATE INDEX "idx_dash_layouts_user" ON "public"."dash_layouts" USING "btree" ("user_id");



CREATE INDEX "idx_dash_panels_owner_user_id" ON "public"."dash_panels" USING "btree" ("owner_user_id");



CREATE INDEX "idx_dashboard_telemetry__user_id" ON "public"."dashboard_telemetry" USING "btree" ("user_id");



CREATE INDEX "idx_dashboard_telemetry__user_id__created_at_desc" ON "public"."dashboard_telemetry" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_dashboard_telemetry_events__user_id" ON "public"."dashboard_telemetry_events" USING "btree" ("user_id");



CREATE INDEX "idx_dashboard_telemetry_owner_user_id" ON "public"."dashboard_telemetry" USING "btree" ("owner_user_id");



CREATE INDEX "idx_dashboard_telemetry_user_date" ON "public"."dashboard_telemetry_events" USING "btree" ("user_id", "occurred_at" DESC);



CREATE INDEX "idx_day_plans__user_id" ON "public"."day_plans" USING "btree" ("user_id");



CREATE INDEX "idx_day_plans__user_id__created_at_desc" ON "public"."day_plans" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_day_plans__user_id__updated_at_desc" ON "public"."day_plans" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_day_plans_owner_user_id" ON "public"."day_plans" USING "btree" ("owner_user_id");



CREATE INDEX "idx_dd_auto_generated" ON "public"."delegated_drafts" USING "btree" ("user_id", "auto_generated") WHERE ("auto_generated" = true);



CREATE INDEX "idx_dd_related_event" ON "public"."delegated_drafts" USING "btree" ("related_event_id") WHERE ("related_event_id" IS NOT NULL);



CREATE INDEX "idx_dd_related_insight" ON "public"."delegated_drafts" USING "btree" ("related_insight_id") WHERE ("related_insight_id" IS NOT NULL);



CREATE INDEX "idx_dd_user_id" ON "public"."delegated_drafts" USING "btree" ("user_id");



CREATE INDEX "idx_dd_user_status" ON "public"."delegated_drafts" USING "btree" ("user_id", "status");



CREATE INDEX "idx_dd_user_type" ON "public"."delegated_drafts" USING "btree" ("user_id", "type");



CREATE INDEX "idx_deal_archetype_runs__user_id" ON "public"."deal_archetype_runs" USING "btree" ("user_id");



CREATE INDEX "idx_deal_archetype_runs__user_id__created_at_desc" ON "public"."deal_archetype_runs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_deal_archetype_runs_owner_user_id" ON "public"."deal_archetype_runs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_deal_archetypes_owner_user_id" ON "public"."deal_archetypes" USING "btree" ("owner_user_id");



CREATE INDEX "idx_deal_intelligence_owner_user_id" ON "public"."deal_intelligence" USING "btree" ("owner_user_id");



CREATE INDEX "idx_deal_participants_owner_user_id" ON "public"."deal_participants" USING "btree" ("owner_user_id");



CREATE INDEX "idx_deal_stages_user_id_uuid" ON "public"."deal_stages" USING "btree" ("user_id_uuid");



CREATE INDEX "idx_deals__user_id" ON "public"."deals" USING "btree" ("user_id");



CREATE INDEX "idx_deals__user_id__created_at_desc" ON "public"."deals" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_deals__user_id__updated_at_desc" ON "public"."deals" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_deals_owner_user_id" ON "public"."deals" USING "btree" ("owner_user_id");



CREATE INDEX "idx_deals_user_id_updated" ON "public"."deals" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_deals_user_stage" ON "public"."deals" USING "btree" ("user_id_uuid", "stage");



CREATE INDEX "idx_deals_user_updated" ON "public"."deals" USING "btree" ("user_id_uuid", "updated_at" DESC NULLS LAST);



CREATE INDEX "idx_decision_options_owner_user_id" ON "public"."decision_options" USING "btree" ("owner_user_id");



CREATE INDEX "idx_decision_scenarios_owner_user_id" ON "public"."decision_scenarios" USING "btree" ("owner_user_id");



CREATE INDEX "idx_decision_tree_edges__user_id" ON "public"."decision_tree_edges" USING "btree" ("user_id");



CREATE INDEX "idx_decision_tree_edges__user_id__created_at_desc" ON "public"."decision_tree_edges" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_decision_tree_edges_owner_user_id" ON "public"."decision_tree_edges" USING "btree" ("owner_user_id");



CREATE INDEX "idx_decision_tree_nodes__user_id" ON "public"."decision_tree_nodes" USING "btree" ("user_id");



CREATE INDEX "idx_decision_tree_nodes__user_id__created_at_desc" ON "public"."decision_tree_nodes" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_decision_tree_nodes_owner_user_id" ON "public"."decision_tree_nodes" USING "btree" ("owner_user_id");



CREATE INDEX "idx_decision_trees__user_id" ON "public"."decision_trees" USING "btree" ("user_id");



CREATE INDEX "idx_decision_trees__user_id__created_at_desc" ON "public"."decision_trees" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_decision_trees__user_id__updated_at_desc" ON "public"."decision_trees" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_decision_trees_owner_user_id" ON "public"."decision_trees" USING "btree" ("owner_user_id");



CREATE INDEX "idx_decisions__user_id" ON "public"."decisions" USING "btree" ("user_id");



CREATE INDEX "idx_decisions__user_id__created_at_desc" ON "public"."decisions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_decisions_owner_user_id" ON "public"."decisions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_delegated_drafts__user_id" ON "public"."delegated_drafts" USING "btree" ("user_id");



CREATE INDEX "idx_delegated_drafts__user_id__created_at_desc" ON "public"."delegated_drafts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_delegated_drafts__user_id__updated_at_desc" ON "public"."delegated_drafts" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_delegated_drafts_owner_user_id" ON "public"."delegated_drafts" USING "btree" ("owner_user_id");



CREATE INDEX "idx_desire_profiles__user_id" ON "public"."desire_profiles" USING "btree" ("user_id");



CREATE INDEX "idx_desire_profiles__user_id__created_at_desc" ON "public"."desire_profiles" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_desire_profiles__user_id__updated_at_desc" ON "public"."desire_profiles" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_desire_profiles_owner_user_id" ON "public"."desire_profiles" USING "btree" ("owner_user_id");



CREATE INDEX "idx_desire_profiles_user_entity" ON "public"."desire_profiles" USING "btree" ("user_id", "entity_type", "entity_id");



CREATE INDEX "idx_desire_signals__user_id" ON "public"."desire_signals" USING "btree" ("user_id");



CREATE INDEX "idx_desire_signals__user_id__created_at_desc" ON "public"."desire_signals" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_desire_signals_owner_user_id" ON "public"."desire_signals" USING "btree" ("owner_user_id");



CREATE INDEX "idx_desire_signals_user_entity" ON "public"."desire_signals" USING "btree" ("user_id", "entity_type", "entity_id", "signal_time");



CREATE INDEX "idx_destiny_alignment_log__user_id" ON "public"."destiny_alignment_log" USING "btree" ("user_id");



CREATE INDEX "idx_destiny_alignment_log_owner_user_id" ON "public"."destiny_alignment_log" USING "btree" ("owner_user_id");



CREATE INDEX "idx_destiny_alignment_user" ON "public"."destiny_alignment_log" USING "btree" ("user_id", "evaluated_at");



CREATE INDEX "idx_destiny_anchor_choices__user_id" ON "public"."destiny_anchor_choices" USING "btree" ("user_id");



CREATE INDEX "idx_destiny_anchor_choices__user_id__created_at_desc" ON "public"."destiny_anchor_choices" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_destiny_anchor_choices_owner_user_id" ON "public"."destiny_anchor_choices" USING "btree" ("owner_user_id");



CREATE INDEX "idx_destiny_arcs__user_id" ON "public"."destiny_arcs" USING "btree" ("user_id");



CREATE INDEX "idx_destiny_arcs__user_id__created_at_desc" ON "public"."destiny_arcs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_destiny_arcs__user_id__updated_at_desc" ON "public"."destiny_arcs" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_destiny_arcs_owner_user_id" ON "public"."destiny_arcs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_destiny_arcs_user" ON "public"."destiny_arcs" USING "btree" ("user_id", "created_at");



CREATE INDEX "idx_destiny_blueprints__user_id" ON "public"."destiny_blueprints" USING "btree" ("user_id");



CREATE INDEX "idx_destiny_blueprints__user_id__created_at_desc" ON "public"."destiny_blueprints" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_destiny_blueprints__user_id__updated_at_desc" ON "public"."destiny_blueprints" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_destiny_blueprints_owner_user_id" ON "public"."destiny_blueprints" USING "btree" ("owner_user_id");



CREATE INDEX "idx_destiny_blueprints_user" ON "public"."destiny_blueprints" USING "btree" ("user_id");



CREATE INDEX "idx_destiny_checkpoints__user_id" ON "public"."destiny_checkpoints" USING "btree" ("user_id");



CREATE INDEX "idx_destiny_checkpoints__user_id__created_at_desc" ON "public"."destiny_checkpoints" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_destiny_checkpoints__user_id__updated_at_desc" ON "public"."destiny_checkpoints" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_destiny_checkpoints_owner_user_id" ON "public"."destiny_checkpoints" USING "btree" ("owner_user_id");



CREATE INDEX "idx_destiny_checkpoints_user" ON "public"."destiny_checkpoints" USING "btree" ("user_id", "target_date");



CREATE INDEX "idx_destiny_milestones_owner_user_id" ON "public"."destiny_milestones" USING "btree" ("owner_user_id");



CREATE INDEX "idx_destiny_simulation_runs_owner_user_id" ON "public"."destiny_simulation_runs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_destiny_timeline_scores_owner_user_id" ON "public"."destiny_timeline_scores" USING "btree" ("owner_user_id");



CREATE INDEX "idx_destiny_timelines__user_id" ON "public"."destiny_timelines" USING "btree" ("user_id");



CREATE INDEX "idx_destiny_timelines__user_id__created_at_desc" ON "public"."destiny_timelines" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_destiny_timelines__user_id__updated_at_desc" ON "public"."destiny_timelines" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_destiny_timelines_owner_user_id" ON "public"."destiny_timelines" USING "btree" ("owner_user_id");



CREATE INDEX "idx_destiny_waypoints_owner_user_id" ON "public"."destiny_waypoints" USING "btree" ("owner_user_id");



CREATE INDEX "idx_dk_user_domain" ON "public"."domain_kpis" USING "btree" ("user_id", "domain_key");



CREATE INDEX "idx_dk_user_id" ON "public"."domain_kpis" USING "btree" ("user_id");



CREATE INDEX "idx_dk_user_period" ON "public"."domain_kpis" USING "btree" ("user_id", "period_start", "period_end");



CREATE INDEX "idx_domain_kpis__user_id" ON "public"."domain_kpis" USING "btree" ("user_id");



CREATE INDEX "idx_domain_kpis__user_id__created_at_desc" ON "public"."domain_kpis" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_domain_kpis_owner_user_id" ON "public"."domain_kpis" USING "btree" ("owner_user_id");



CREATE INDEX "idx_dp_user_date" ON "public"."day_plans" USING "btree" ("user_id", "date");



CREATE INDEX "idx_dp_user_id" ON "public"."day_plans" USING "btree" ("user_id");



CREATE INDEX "idx_ec_user_date" ON "public"."emotional_checkins" USING "btree" ("user_id", "checked_in_at");



CREATE INDEX "idx_ec_user_id" ON "public"."emotional_checkins" USING "btree" ("user_id");



CREATE INDEX "idx_efc_action_sequences__user_id" ON "public"."efc_action_sequences" USING "btree" ("user_id");



CREATE INDEX "idx_efc_action_sequences__user_id__created_at_desc" ON "public"."efc_action_sequences" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_efc_action_sequences_owner_user_id" ON "public"."efc_action_sequences" USING "btree" ("owner_user_id");



CREATE INDEX "idx_efc_commitments__user_id" ON "public"."efc_commitments" USING "btree" ("user_id");



CREATE INDEX "idx_efc_commitments__user_id__created_at_desc" ON "public"."efc_commitments" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_efc_commitments__user_id__updated_at_desc" ON "public"."efc_commitments" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_efc_commitments_owner_user_id" ON "public"."efc_commitments" USING "btree" ("owner_user_id");



CREATE INDEX "idx_efc_energy_states__user_id" ON "public"."efc_energy_states" USING "btree" ("user_id");



CREATE INDEX "idx_efc_energy_states_owner_user_id" ON "public"."efc_energy_states" USING "btree" ("owner_user_id");



CREATE INDEX "idx_efc_execution_log__user_id" ON "public"."efc_execution_log" USING "btree" ("user_id");



CREATE INDEX "idx_efc_execution_log__user_id__created_at_desc" ON "public"."efc_execution_log" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_efc_execution_log_owner_user_id" ON "public"."efc_execution_log" USING "btree" ("owner_user_id");



CREATE INDEX "idx_efc_generated_actions__user_id" ON "public"."efc_generated_actions" USING "btree" ("user_id");



CREATE INDEX "idx_efc_generated_actions__user_id__created_at_desc" ON "public"."efc_generated_actions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_efc_generated_actions_owner_user_id" ON "public"."efc_generated_actions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_efc_nudges__user_id" ON "public"."efc_nudges" USING "btree" ("user_id");



CREATE INDEX "idx_efc_nudges__user_id__created_at_desc" ON "public"."efc_nudges" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_efc_nudges_owner_user_id" ON "public"."efc_nudges" USING "btree" ("owner_user_id");



CREATE INDEX "idx_email_accounts__user_id" ON "public"."email_accounts" USING "btree" ("user_id");



CREATE INDEX "idx_email_accounts__user_id__created_at_desc" ON "public"."email_accounts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_email_accounts_owner_user_id" ON "public"."email_accounts" USING "btree" ("owner_user_id");



CREATE INDEX "idx_email_actions__user_id" ON "public"."email_actions" USING "btree" ("user_id");



CREATE INDEX "idx_email_actions__user_id__created_at_desc" ON "public"."email_actions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_email_actions_owner_user_id" ON "public"."email_actions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_email_actions_status" ON "public"."email_actions" USING "btree" ("status");



CREATE INDEX "idx_email_actions_type" ON "public"."email_actions" USING "btree" ("action_type");



CREATE INDEX "idx_email_actions_user_id" ON "public"."email_actions" USING "btree" ("user_id");



CREATE INDEX "idx_email_briefs_user_date" ON "public"."email_daily_briefs" USING "btree" ("user_id", "brief_date");



CREATE INDEX "idx_email_daily_briefs__user_id" ON "public"."email_daily_briefs" USING "btree" ("user_id");



CREATE INDEX "idx_email_daily_briefs_owner_user_id" ON "public"."email_daily_briefs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_email_drafts__user_id" ON "public"."email_drafts" USING "btree" ("user_id");



CREATE INDEX "idx_email_drafts__user_id__created_at_desc" ON "public"."email_drafts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_email_drafts__user_id__updated_at_desc" ON "public"."email_drafts" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_email_events__user_id" ON "public"."email_events" USING "btree" ("user_id");



CREATE INDEX "idx_email_events__user_id__created_at_desc" ON "public"."email_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_email_followups__user_id" ON "public"."email_followups" USING "btree" ("user_id");



CREATE INDEX "idx_email_followups__user_id__created_at_desc" ON "public"."email_followups" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_email_items__user_id" ON "public"."email_items" USING "btree" ("user_id");



CREATE INDEX "idx_email_items__user_id__created_at_desc" ON "public"."email_items" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_email_items__user_id__updated_at_desc" ON "public"."email_items" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_email_items_from_email" ON "public"."email_items" USING "btree" ("from_email");



CREATE INDEX "idx_email_items_owner_user_id" ON "public"."email_items" USING "btree" ("owner_user_id");



CREATE INDEX "idx_email_items_received_at" ON "public"."email_items" USING "btree" ("received_at" DESC);



CREATE INDEX "idx_email_items_user_id" ON "public"."email_items" USING "btree" ("user_id");



CREATE INDEX "idx_email_messages_owner_user_id" ON "public"."email_messages" USING "btree" ("owner_user_id");



CREATE INDEX "idx_email_outbox__user_id" ON "public"."email_outbox" USING "btree" ("user_id");



CREATE INDEX "idx_email_outbox__user_id__created_at_desc" ON "public"."email_outbox" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_email_outbox_trace" ON "public"."email_outbox" USING "btree" ("user_id", "trace_id", "created_at" DESC);



CREATE INDEX "idx_email_outbox_user_id_text" ON "public"."email_outbox" USING "btree" ("user_id_text");



CREATE INDEX "idx_email_resolution__user_id" ON "public"."email_resolution" USING "btree" ("user_id");



CREATE INDEX "idx_email_resolution__user_id__created_at_desc" ON "public"."email_resolution" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_email_resolution__user_id__updated_at_desc" ON "public"."email_resolution" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_email_send_audit__user_id" ON "public"."email_send_audit" USING "btree" ("user_id");



CREATE INDEX "idx_email_send_audit__user_id__created_at_desc" ON "public"."email_send_audit" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_email_suggested_drafts__user_id" ON "public"."email_suggested_drafts" USING "btree" ("user_id");



CREATE INDEX "idx_email_suggested_drafts__user_id__created_at_desc" ON "public"."email_suggested_drafts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_email_threads__user_id" ON "public"."email_threads" USING "btree" ("user_id");



CREATE INDEX "idx_email_threads__user_id__created_at_desc" ON "public"."email_threads" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_email_threads__user_id__updated_at_desc" ON "public"."email_threads" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_email_threads_deal_id" ON "public"."email_threads" USING "btree" ("deal_id");



CREATE INDEX "idx_email_threads_needs_response" ON "public"."email_threads" USING "btree" ("needs_response");



CREATE INDEX "idx_email_threads_owner_user_id" ON "public"."email_threads" USING "btree" ("owner_user_id");



CREATE INDEX "idx_email_threads_user_id" ON "public"."email_threads" USING "btree" ("user_id");



CREATE INDEX "idx_email_triage_items__user_id" ON "public"."email_triage_items" USING "btree" ("user_id");



CREATE INDEX "idx_email_triage_items__user_id__created_at_desc" ON "public"."email_triage_items" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_email_triage_items__user_id__updated_at_desc" ON "public"."email_triage_items" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_emails__user_id" ON "public"."emails" USING "btree" ("user_id");



CREATE INDEX "idx_emails__user_id__created_at_desc" ON "public"."emails" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_emails_owner_user_id" ON "public"."emails" USING "btree" ("owner_user_id");



CREATE INDEX "idx_emails_user" ON "public"."emails" USING "btree" ("user_id");



CREATE INDEX "idx_emo_adaptive_responses__user_id" ON "public"."emo_adaptive_responses" USING "btree" ("user_id");



CREATE INDEX "idx_emo_adaptive_responses__user_id__created_at_desc" ON "public"."emo_adaptive_responses" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_emo_adaptive_responses_owner_user_id" ON "public"."emo_adaptive_responses" USING "btree" ("owner_user_id");



CREATE INDEX "idx_emo_checkins__user_id" ON "public"."emo_checkins" USING "btree" ("user_id");



CREATE INDEX "idx_emo_checkins__user_id__created_at_desc" ON "public"."emo_checkins" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_emo_checkins_owner_user_id" ON "public"."emo_checkins" USING "btree" ("owner_user_id");



CREATE INDEX "idx_emo_goals__user_id" ON "public"."emo_goals" USING "btree" ("user_id");



CREATE INDEX "idx_emo_goals__user_id__created_at_desc" ON "public"."emo_goals" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_emo_goals__user_id__updated_at_desc" ON "public"."emo_goals" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_emo_goals_owner_user_id" ON "public"."emo_goals" USING "btree" ("owner_user_id");



CREATE INDEX "idx_emo_interventions__user_id" ON "public"."emo_interventions" USING "btree" ("user_id");



CREATE INDEX "idx_emo_interventions__user_id__created_at_desc" ON "public"."emo_interventions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_emo_interventions__user_id__updated_at_desc" ON "public"."emo_interventions" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_emo_interventions_owner_user_id" ON "public"."emo_interventions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_emo_profiles__user_id" ON "public"."emo_profiles" USING "btree" ("user_id");



CREATE INDEX "idx_emo_profiles__user_id__created_at_desc" ON "public"."emo_profiles" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_emo_profiles__user_id__updated_at_desc" ON "public"."emo_profiles" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_emo_profiles_owner_user_id" ON "public"."emo_profiles" USING "btree" ("owner_user_id");



CREATE INDEX "idx_emo_states__user_id" ON "public"."emo_states" USING "btree" ("user_id");



CREATE INDEX "idx_emo_states__user_id__created_at_desc" ON "public"."emo_states" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_emo_states_owner_user_id" ON "public"."emo_states" USING "btree" ("owner_user_id");



CREATE INDEX "idx_emo_transitions__user_id" ON "public"."emo_transitions" USING "btree" ("user_id");



CREATE INDEX "idx_emo_transitions__user_id__created_at_desc" ON "public"."emo_transitions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_emo_transitions_owner_user_id" ON "public"."emo_transitions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_emotion_channel_settings__user_id" ON "public"."emotion_channel_settings" USING "btree" ("user_id");



CREATE INDEX "idx_emotion_channel_settings__user_id__created_at_desc" ON "public"."emotion_channel_settings" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_emotion_channel_settings__user_id__updated_at_desc" ON "public"."emotion_channel_settings" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_emotion_channel_settings_owner_user_id" ON "public"."emotion_channel_settings" USING "btree" ("owner_user_id");



CREATE UNIQUE INDEX "idx_emotion_channel_settings_user_channel" ON "public"."emotion_channel_settings" USING "btree" ("user_id", "channel", "context");



CREATE INDEX "idx_emotion_interaction_log__user_id" ON "public"."emotion_interaction_log" USING "btree" ("user_id");



CREATE INDEX "idx_emotion_interaction_log_owner_user_id" ON "public"."emotion_interaction_log" USING "btree" ("owner_user_id");



CREATE INDEX "idx_emotion_interaction_log_user_time" ON "public"."emotion_interaction_log" USING "btree" ("user_id", "occurred_at");



CREATE INDEX "idx_emotion_resonance_events__user_id" ON "public"."emotion_resonance_events" USING "btree" ("user_id");



CREATE INDEX "idx_emotion_resonance_events__user_id__created_at_desc" ON "public"."emotion_resonance_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_emotion_resonance_events_owner_user_id" ON "public"."emotion_resonance_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_emotion_resonance_events_user" ON "public"."emotion_resonance_events" USING "btree" ("user_id", "created_at");



CREATE INDEX "idx_emotion_samples__user_id" ON "public"."emotion_samples" USING "btree" ("user_id");



CREATE INDEX "idx_emotion_samples_owner_user_id" ON "public"."emotion_samples" USING "btree" ("owner_user_id");



CREATE INDEX "idx_emotion_samples_user_time" ON "public"."emotion_samples" USING "btree" ("user_id", "sampled_at");



CREATE INDEX "idx_emotion_state_daily__user_id" ON "public"."emotion_state_daily" USING "btree" ("user_id");



CREATE INDEX "idx_emotion_state_daily__user_id__created_at_desc" ON "public"."emotion_state_daily" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_emotion_state_daily__user_id__updated_at_desc" ON "public"."emotion_state_daily" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_emotion_state_daily_owner_user_id" ON "public"."emotion_state_daily" USING "btree" ("owner_user_id");



CREATE INDEX "idx_emotion_style_profile__user_id" ON "public"."emotion_style_profile" USING "btree" ("user_id");



CREATE INDEX "idx_emotion_style_profile__user_id__created_at_desc" ON "public"."emotion_style_profile" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_emotion_style_profile__user_id__updated_at_desc" ON "public"."emotion_style_profile" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_emotion_style_profile_owner_user_id" ON "public"."emotion_style_profile" USING "btree" ("owner_user_id");



CREATE UNIQUE INDEX "idx_emotion_style_profile_user" ON "public"."emotion_style_profile" USING "btree" ("user_id");



CREATE INDEX "idx_emotional_checkins__user_id" ON "public"."emotional_checkins" USING "btree" ("user_id");



CREATE INDEX "idx_emotional_checkins__user_id__created_at_desc" ON "public"."emotional_checkins" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_emotional_checkins_date" ON "public"."emotional_checkins" USING "btree" ("checked_in_at");



CREATE INDEX "idx_emotional_checkins_owner_user_id" ON "public"."emotional_checkins" USING "btree" ("owner_user_id");



CREATE INDEX "idx_emotional_checkins_user" ON "public"."emotional_checkins" USING "btree" ("user_id");



CREATE INDEX "idx_emotional_patterns__user_id" ON "public"."emotional_patterns" USING "btree" ("user_id");



CREATE INDEX "idx_emotional_patterns_owner_user_id" ON "public"."emotional_patterns" USING "btree" ("owner_user_id");



CREATE INDEX "idx_emotional_support_logs__user_id" ON "public"."emotional_support_logs" USING "btree" ("user_id");



CREATE INDEX "idx_emotional_support_logs__user_id__created_at_desc" ON "public"."emotional_support_logs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_emotional_support_logs_owner_user_id" ON "public"."emotional_support_logs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_empathic_events__user_id" ON "public"."empathic_events" USING "btree" ("user_id");



CREATE INDEX "idx_empathic_events__user_id__created_at_desc" ON "public"."empathic_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_empathic_events_owner_user_id" ON "public"."empathic_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_empathic_events_user" ON "public"."empathic_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_ep_user_id" ON "public"."emotional_patterns" USING "btree" ("user_id");



CREATE INDEX "idx_ep_user_type" ON "public"."emotional_patterns" USING "btree" ("user_id", "pattern_type");



CREATE INDEX "idx_es_user_id" ON "public"."executive_summaries" USING "btree" ("user_id");



CREATE INDEX "idx_es_user_period" ON "public"."executive_summaries" USING "btree" ("user_id", "period_start");



CREATE INDEX "idx_esl_user_id" ON "public"."emotional_support_logs" USING "btree" ("user_id");



CREATE INDEX "idx_ethical_policies__user_id" ON "public"."ethical_policies" USING "btree" ("user_id");



CREATE INDEX "idx_ethical_policies__user_id__created_at_desc" ON "public"."ethical_policies" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_ethical_policies__user_id__updated_at_desc" ON "public"."ethical_policies" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_ethical_policies_owner_user_id" ON "public"."ethical_policies" USING "btree" ("owner_user_id");



CREATE INDEX "idx_ethical_policies_user" ON "public"."ethical_policies" USING "btree" ("user_id", "scope", "domain");



CREATE INDEX "idx_exec_logs_exec" ON "public"."execution_logs" USING "btree" ("execution_id", "created_at" DESC);



CREATE INDEX "idx_exec_logs_user" ON "public"."execution_logs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_exec_ready" ON "public"."executions" USING "btree" ("status", "run_at", "priority" DESC);



CREATE INDEX "idx_exec_runs_exec" ON "public"."execution_runs" USING "btree" ("execution_id", "started_at" DESC);



CREATE INDEX "idx_exec_runs_user" ON "public"."execution_runs" USING "btree" ("user_id", "started_at" DESC);



CREATE INDEX "idx_execution_logs__user_id" ON "public"."execution_logs" USING "btree" ("user_id");



CREATE INDEX "idx_execution_logs__user_id__created_at_desc" ON "public"."execution_logs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_execution_logs_trace" ON "public"."execution_logs" USING "btree" ("trace_id", "created_at" DESC);



CREATE INDEX "idx_execution_logs_user_id_text" ON "public"."execution_logs" USING "btree" ("user_id_text");



CREATE INDEX "idx_execution_runs__user_id" ON "public"."execution_runs" USING "btree" ("user_id");



CREATE INDEX "idx_execution_runs_trace" ON "public"."execution_runs" USING "btree" ("trace_id", "started_at" DESC);



CREATE INDEX "idx_execution_runs_user_id_text" ON "public"."execution_runs" USING "btree" ("user_id_text");



CREATE INDEX "idx_executions_user_id_text" ON "public"."executions" USING "btree" ("user_id_text");



CREATE INDEX "idx_executive_council_members__user_id" ON "public"."executive_council_members" USING "btree" ("user_id");



CREATE INDEX "idx_executive_council_members__user_id__created_at_desc" ON "public"."executive_council_members" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_executive_council_members_owner_user_id" ON "public"."executive_council_members" USING "btree" ("owner_user_id");



CREATE INDEX "idx_executive_council_votes_owner_user_id" ON "public"."executive_council_votes" USING "btree" ("owner_user_id");



CREATE INDEX "idx_executive_summaries__user_id" ON "public"."executive_summaries" USING "btree" ("user_id");



CREATE INDEX "idx_executive_summaries__user_id__created_at_desc" ON "public"."executive_summaries" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_executive_summaries_owner_user_id" ON "public"."executive_summaries" USING "btree" ("owner_user_id");



CREATE INDEX "idx_experience_events__user_id" ON "public"."experience_events" USING "btree" ("user_id");



CREATE INDEX "idx_experience_events__user_id__created_at_desc" ON "public"."experience_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_experience_events_owner_user_id" ON "public"."experience_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_experience_events_user_time" ON "public"."experience_events" USING "btree" ("user_id", "occurred_at");



CREATE INDEX "idx_experiment_metrics_owner_user_id" ON "public"."experiment_metrics" USING "btree" ("owner_user_id");



CREATE INDEX "idx_experiment_templates_owner_user_id" ON "public"."experiment_templates" USING "btree" ("owner_user_id");



CREATE INDEX "idx_fb_rating" ON "public"."feedback" USING "btree" ("user_id", "rating");



CREATE INDEX "idx_fb_user" ON "public"."feedback" USING "btree" ("user_id");



CREATE INDEX "idx_feedback__user_id" ON "public"."feedback" USING "btree" ("user_id");



CREATE INDEX "idx_feedback__user_id__created_at_desc" ON "public"."feedback" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_feedback_owner_user_id" ON "public"."feedback" USING "btree" ("owner_user_id");



CREATE INDEX "idx_finance_accounts__user_id" ON "public"."finance_accounts" USING "btree" ("user_id");



CREATE INDEX "idx_finance_accounts__user_id__created_at_desc" ON "public"."finance_accounts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_finance_accounts__user_id__updated_at_desc" ON "public"."finance_accounts" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_finance_accounts_owner_user_id" ON "public"."finance_accounts" USING "btree" ("owner_user_id");



CREATE INDEX "idx_finance_alerts__user_id" ON "public"."finance_alerts" USING "btree" ("user_id");



CREATE INDEX "idx_finance_alerts__user_id__created_at_desc" ON "public"."finance_alerts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_finance_alerts_owner_user_id" ON "public"."finance_alerts" USING "btree" ("owner_user_id");



CREATE INDEX "idx_finance_budgets__user_id" ON "public"."finance_budgets" USING "btree" ("user_id");



CREATE INDEX "idx_finance_budgets__user_id__created_at_desc" ON "public"."finance_budgets" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_finance_budgets__user_id__updated_at_desc" ON "public"."finance_budgets" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_finance_budgets_owner_user_id" ON "public"."finance_budgets" USING "btree" ("owner_user_id");



CREATE INDEX "idx_finance_goals__user_id" ON "public"."finance_goals" USING "btree" ("user_id");



CREATE INDEX "idx_finance_goals__user_id__created_at_desc" ON "public"."finance_goals" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_finance_goals__user_id__updated_at_desc" ON "public"."finance_goals" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_finance_goals_owner_user_id" ON "public"."finance_goals" USING "btree" ("owner_user_id");



CREATE INDEX "idx_finance_snapshots__user_id" ON "public"."finance_snapshots" USING "btree" ("user_id");



CREATE INDEX "idx_finance_snapshots__user_id__created_at_desc" ON "public"."finance_snapshots" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_finance_snapshots_owner_user_id" ON "public"."finance_snapshots" USING "btree" ("owner_user_id");



CREATE INDEX "idx_finance_transactions__user_id" ON "public"."finance_transactions" USING "btree" ("user_id");



CREATE INDEX "idx_finance_transactions__user_id__created_at_desc" ON "public"."finance_transactions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_finance_transactions_owner_user_id" ON "public"."finance_transactions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_financial_accounts_owner_user_id" ON "public"."financial_accounts" USING "btree" ("owner_user_id");



CREATE INDEX "idx_financial_budget_envelopes_owner_user_id" ON "public"."financial_budget_envelopes" USING "btree" ("owner_user_id");



CREATE INDEX "idx_financial_budgets_owner_user_id" ON "public"."financial_budgets" USING "btree" ("owner_user_id");



CREATE INDEX "idx_financial_connections__user_id" ON "public"."financial_connections" USING "btree" ("user_id");



CREATE INDEX "idx_financial_connections__user_id__created_at_desc" ON "public"."financial_connections" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_financial_connections_owner_user_id" ON "public"."financial_connections" USING "btree" ("owner_user_id");



CREATE INDEX "idx_financial_entities__user_id" ON "public"."financial_entities" USING "btree" ("user_id");



CREATE INDEX "idx_financial_entities__user_id__created_at_desc" ON "public"."financial_entities" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_financial_entities_owner_user_id" ON "public"."financial_entities" USING "btree" ("owner_user_id");



CREATE INDEX "idx_financial_imported_transactions_owner_user_id" ON "public"."financial_imported_transactions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_financial_ledger_entries_owner_user_id" ON "public"."financial_ledger_entries" USING "btree" ("owner_user_id");



CREATE INDEX "idx_financial_ledger_lines_owner_user_id" ON "public"."financial_ledger_lines" USING "btree" ("owner_user_id");



CREATE INDEX "idx_financial_snapshots_owner_user_id" ON "public"."financial_snapshots" USING "btree" ("owner_user_id");



CREATE INDEX "idx_focus_locks__user_id" ON "public"."focus_locks" USING "btree" ("user_id");



CREATE INDEX "idx_focus_locks__user_id__created_at_desc" ON "public"."focus_locks" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_focus_locks__user_id__updated_at_desc" ON "public"."focus_locks" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_focus_sessions__user_id" ON "public"."focus_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_focus_sessions_completed" ON "public"."focus_sessions" USING "btree" ("user_id", "completed_at");



CREATE INDEX "idx_focus_sessions_owner_user_id" ON "public"."focus_sessions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_focus_sessions_user" ON "public"."focus_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_follow_ups__user_id" ON "public"."follow_ups" USING "btree" ("user_id");



CREATE INDEX "idx_follow_ups__user_id__created_at_desc" ON "public"."follow_ups" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_follow_ups__user_id__updated_at_desc" ON "public"."follow_ups" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_follow_ups_due" ON "public"."follow_ups" USING "btree" ("user_id", "due_date");



CREATE INDEX "idx_follow_ups_due_at" ON "public"."follow_ups" USING "btree" ("due_at");



CREATE INDEX "idx_follow_ups_owner_user_id" ON "public"."follow_ups" USING "btree" ("owner_user_id");



CREATE INDEX "idx_follow_ups_status" ON "public"."follow_ups" USING "btree" ("user_id", "status");



CREATE INDEX "idx_follow_ups_user" ON "public"."follow_ups" USING "btree" ("user_id");



CREATE INDEX "idx_follow_ups_user_due" ON "public"."follow_ups" USING "btree" ("user_id_uuid", "due_at" DESC NULLS LAST);



CREATE INDEX "idx_follow_ups_user_id_uuid" ON "public"."follow_ups" USING "btree" ("user_id_uuid");



CREATE INDEX "idx_follow_ups_user_status" ON "public"."follow_ups" USING "btree" ("user_id_uuid", "status");



CREATE INDEX "idx_followups_due_at" ON "public"."follow_ups" USING "btree" ("due_at");



CREATE INDEX "idx_followups_user_due" ON "public"."follow_ups" USING "btree" ("user_id", "due_date");



CREATE INDEX "idx_followups_user_id_uuid" ON "public"."follow_ups" USING "btree" ("user_id_uuid");



CREATE INDEX "idx_gift_ideas__user_id" ON "public"."gift_ideas" USING "btree" ("user_id");



CREATE INDEX "idx_gift_ideas__user_id__created_at_desc" ON "public"."gift_ideas" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_gift_ideas__user_id__updated_at_desc" ON "public"."gift_ideas" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_gift_ideas_contact" ON "public"."gift_ideas" USING "btree" ("contact_id");



CREATE INDEX "idx_gift_ideas_status" ON "public"."gift_ideas" USING "btree" ("status");



CREATE INDEX "idx_gift_ideas_user" ON "public"."gift_ideas" USING "btree" ("user_id");



CREATE INDEX "idx_goal_hierarchy__user_id" ON "public"."goal_hierarchy" USING "btree" ("user_id");



CREATE INDEX "idx_goal_hierarchy__user_id__created_at_desc" ON "public"."goal_hierarchy" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_goal_hierarchy__user_id__updated_at_desc" ON "public"."goal_hierarchy" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_goal_hierarchy_owner_user_id" ON "public"."goal_hierarchy" USING "btree" ("owner_user_id");



CREATE INDEX "idx_goal_hierarchy_user_timescale" ON "public"."goal_hierarchy" USING "btree" ("user_id", "timescale");



CREATE INDEX "idx_goals__user_id" ON "public"."goals" USING "btree" ("user_id");



CREATE INDEX "idx_goals__user_id__created_at_desc" ON "public"."goals" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_goals__user_id__updated_at_desc" ON "public"."goals" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_goals_owner_user_id" ON "public"."goals" USING "btree" ("owner_user_id");



CREATE INDEX "idx_goals_user" ON "public"."goals" USING "btree" ("user_id");



CREATE INDEX "idx_guardrail_events__user_id" ON "public"."guardrail_events" USING "btree" ("user_id");



CREATE INDEX "idx_guardrail_events__user_id__created_at_desc" ON "public"."guardrail_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_guardrail_events_owner_user_id" ON "public"."guardrail_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_guardrail_events_user_time" ON "public"."guardrail_events" USING "btree" ("user_id", "occurred_at");



CREATE INDEX "idx_habit_completions__user_id" ON "public"."habit_completions" USING "btree" ("user_id");



CREATE INDEX "idx_habit_completions_date" ON "public"."habit_completions" USING "btree" ("user_id", "completed_at");



CREATE INDEX "idx_habit_completions_owner_user_id" ON "public"."habit_completions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_habit_completions_user" ON "public"."habit_completions" USING "btree" ("user_id");



CREATE INDEX "idx_habit_logs__user_id" ON "public"."habit_logs" USING "btree" ("user_id");



CREATE INDEX "idx_habit_logs__user_id__created_at_desc" ON "public"."habit_logs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_habit_logs_habit_date" ON "public"."habit_logs" USING "btree" ("habit_id", "occurred_at" DESC);



CREATE INDEX "idx_habit_logs_user_date" ON "public"."habit_logs" USING "btree" ("user_id", "occurred_on");



CREATE INDEX "idx_habit_streaks__user_id" ON "public"."habit_streaks" USING "btree" ("user_id");



CREATE INDEX "idx_habit_streaks__user_id__created_at_desc" ON "public"."habit_streaks" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_habit_streaks__user_id__updated_at_desc" ON "public"."habit_streaks" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_habit_streaks_owner_user_id" ON "public"."habit_streaks" USING "btree" ("owner_user_id");



CREATE INDEX "idx_habit_streaks_user" ON "public"."habit_streaks" USING "btree" ("user_id");



CREATE INDEX "idx_habits__user_id" ON "public"."habits" USING "btree" ("user_id");



CREATE INDEX "idx_habits__user_id__created_at_desc" ON "public"."habits" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_habits__user_id__updated_at_desc" ON "public"."habits" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_habits_owner_user_id" ON "public"."habits" USING "btree" ("owner_user_id");



CREATE INDEX "idx_habits_user_active" ON "public"."habits" USING "btree" ("user_id", "is_active");



CREATE INDEX "idx_household_members__user_id" ON "public"."household_members" USING "btree" ("user_id");



CREATE INDEX "idx_household_members__user_id__created_at_desc" ON "public"."household_members" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_household_members_owner_user_id" ON "public"."household_members" USING "btree" ("owner_user_id");



CREATE INDEX "idx_households_owner_user_id" ON "public"."households" USING "btree" ("owner_user_id");



CREATE INDEX "idx_id_aspirations__user_id" ON "public"."id_aspirations" USING "btree" ("user_id");



CREATE INDEX "idx_id_aspirations__user_id__created_at_desc" ON "public"."id_aspirations" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_id_aspirations__user_id__updated_at_desc" ON "public"."id_aspirations" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_id_aspirations_owner_user_id" ON "public"."id_aspirations" USING "btree" ("owner_user_id");



CREATE INDEX "idx_id_beliefs__user_id" ON "public"."id_beliefs" USING "btree" ("user_id");



CREATE INDEX "idx_id_beliefs__user_id__created_at_desc" ON "public"."id_beliefs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_id_beliefs__user_id__updated_at_desc" ON "public"."id_beliefs" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_id_beliefs_owner_user_id" ON "public"."id_beliefs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_id_growth_areas__user_id" ON "public"."id_growth_areas" USING "btree" ("user_id");



CREATE INDEX "idx_id_growth_areas__user_id__created_at_desc" ON "public"."id_growth_areas" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_id_growth_areas__user_id__updated_at_desc" ON "public"."id_growth_areas" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_id_growth_areas_owner_user_id" ON "public"."id_growth_areas" USING "btree" ("owner_user_id");



CREATE INDEX "idx_id_momentum_daily__user_id" ON "public"."id_momentum_daily" USING "btree" ("user_id");



CREATE INDEX "idx_id_momentum_daily__user_id__created_at_desc" ON "public"."id_momentum_daily" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_id_momentum_daily_date" ON "public"."id_momentum_daily" USING "btree" ("user_id", "date");



CREATE INDEX "idx_id_momentum_daily_owner_user_id" ON "public"."id_momentum_daily" USING "btree" ("owner_user_id");



CREATE INDEX "idx_id_momentum_daily_user" ON "public"."id_momentum_daily" USING "btree" ("user_id");



CREATE INDEX "idx_id_narrative_chapters__user_id" ON "public"."id_narrative_chapters" USING "btree" ("user_id");



CREATE INDEX "idx_id_narrative_chapters__user_id__created_at_desc" ON "public"."id_narrative_chapters" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_id_narrative_chapters__user_id__updated_at_desc" ON "public"."id_narrative_chapters" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_id_narrative_chapters_owner_user_id" ON "public"."id_narrative_chapters" USING "btree" ("owner_user_id");



CREATE INDEX "idx_id_roles__user_id" ON "public"."id_roles" USING "btree" ("user_id");



CREATE INDEX "idx_id_roles__user_id__created_at_desc" ON "public"."id_roles" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_id_roles__user_id__updated_at_desc" ON "public"."id_roles" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_id_roles_owner_user_id" ON "public"."id_roles" USING "btree" ("owner_user_id");



CREATE INDEX "idx_id_snapshots__user_id" ON "public"."id_snapshots" USING "btree" ("user_id");



CREATE INDEX "idx_id_snapshots__user_id__created_at_desc" ON "public"."id_snapshots" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_id_snapshots_owner_user_id" ON "public"."id_snapshots" USING "btree" ("owner_user_id");



CREATE INDEX "idx_id_strengths__user_id" ON "public"."id_strengths" USING "btree" ("user_id");



CREATE INDEX "idx_id_strengths__user_id__created_at_desc" ON "public"."id_strengths" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_id_strengths__user_id__updated_at_desc" ON "public"."id_strengths" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_id_strengths_owner_user_id" ON "public"."id_strengths" USING "btree" ("owner_user_id");



CREATE INDEX "idx_id_values__user_id" ON "public"."id_values" USING "btree" ("user_id");



CREATE INDEX "idx_id_values__user_id__created_at_desc" ON "public"."id_values" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_id_values__user_id__updated_at_desc" ON "public"."id_values" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_id_values_owner_user_id" ON "public"."id_values" USING "btree" ("owner_user_id");



CREATE INDEX "idx_identity_arcs__user_id" ON "public"."identity_arcs" USING "btree" ("user_id");



CREATE INDEX "idx_identity_arcs__user_id__created_at_desc" ON "public"."identity_arcs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_identity_arcs__user_id__updated_at_desc" ON "public"."identity_arcs" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_identity_arcs_owner_user_id" ON "public"."identity_arcs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_identity_arcs_user" ON "public"."identity_arcs" USING "btree" ("user_id");



CREATE INDEX "idx_identity_events__user_id" ON "public"."identity_events" USING "btree" ("user_id");



CREATE INDEX "idx_identity_events__user_id__created_at_desc" ON "public"."identity_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_identity_events_user_date" ON "public"."identity_events" USING "btree" ("user_id", "occurred_at" DESC);



CREATE INDEX "idx_identity_transforms__user_id" ON "public"."identity_transforms" USING "btree" ("user_id");



CREATE INDEX "idx_identity_transforms_owner_user_id" ON "public"."identity_transforms" USING "btree" ("owner_user_id");



CREATE UNIQUE INDEX "idx_identity_users_clerk" ON "public"."identity_users" USING "btree" ("clerk_user_id");



CREATE INDEX "idx_inbox_actions_user_time" ON "public"."inbox_actions" USING "btree" ("user_id_uuid", "created_at" DESC);



CREATE INDEX "idx_inbox_items_user_archived" ON "public"."inbox_items" USING "btree" ("user_id_uuid", "is_archived", "received_at" DESC NULLS LAST);



CREATE INDEX "idx_inbox_items_user_priority" ON "public"."inbox_items" USING "btree" ("user_id_uuid", "triage_priority", "received_at" DESC NULLS LAST);



CREATE INDEX "idx_inbox_items_user_triage" ON "public"."inbox_items" USING "btree" ("user_id_uuid", "triage_status", "received_at" DESC NULLS LAST);



CREATE INDEX "idx_inbox_items_user_unread" ON "public"."inbox_items" USING "btree" ("user_id_uuid", "is_unread", "received_at" DESC NULLS LAST);



CREATE INDEX "idx_inbox_rule_outcomes_inbox_item" ON "public"."inbox_rule_outcomes" USING "btree" ("inbox_item_id");



CREATE INDEX "idx_inbox_rule_outcomes_user_run" ON "public"."inbox_rule_outcomes" USING "btree" ("user_id_uuid", "run_id");



CREATE INDEX "idx_inbox_rule_runs_user_started" ON "public"."inbox_rule_runs" USING "btree" ("user_id_uuid", "started_at" DESC);



CREATE INDEX "idx_inbox_rules_user_enabled_priority" ON "public"."inbox_rules" USING "btree" ("user_id_uuid", "enabled", "priority");



CREATE INDEX "idx_inbox_triage_events_user_time" ON "public"."inbox_triage_events" USING "btree" ("user_id_uuid", "created_at" DESC);



CREATE INDEX "idx_industries_owner_user_id" ON "public"."industries" USING "btree" ("owner_user_id");



CREATE INDEX "idx_inner_monologue_entries__user_id" ON "public"."inner_monologue_entries" USING "btree" ("user_id");



CREATE INDEX "idx_inner_monologue_entries__user_id__created_at_desc" ON "public"."inner_monologue_entries" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_inner_monologue_entries_owner_user_id" ON "public"."inner_monologue_entries" USING "btree" ("owner_user_id");



CREATE INDEX "idx_inner_monologue_turns__user_id" ON "public"."inner_monologue_turns" USING "btree" ("user_id");



CREATE INDEX "idx_inner_monologue_turns__user_id__created_at_desc" ON "public"."inner_monologue_turns" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_inner_monologue_turns_owner_user_id" ON "public"."inner_monologue_turns" USING "btree" ("owner_user_id");



CREATE INDEX "idx_inner_monologue_user_time" ON "public"."inner_monologue_entries" USING "btree" ("user_id", "created_at");



CREATE INDEX "idx_intel_sources_contact" ON "public"."crm_contact_intel_sources" USING "btree" ("contact_id", "match_score" DESC);



CREATE INDEX "idx_interaction_events__user_id" ON "public"."interaction_events" USING "btree" ("user_id");



CREATE INDEX "idx_interaction_events__user_id__created_at_desc" ON "public"."interaction_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_interaction_events_contact" ON "public"."interaction_events" USING "btree" ("contact_id");



CREATE INDEX "idx_interaction_events_occurred" ON "public"."interaction_events" USING "btree" ("occurred_at" DESC);



CREATE INDEX "idx_interaction_events_type" ON "public"."interaction_events" USING "btree" ("type");



CREATE INDEX "idx_interaction_events_user" ON "public"."interaction_events" USING "btree" ("user_id");



CREATE INDEX "idx_interactions__user_id" ON "public"."interactions" USING "btree" ("user_id");



CREATE INDEX "idx_interactions__user_id__created_at_desc" ON "public"."interactions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_interactions_contact_id" ON "public"."interactions" USING "btree" ("contact_id");



CREATE INDEX "idx_interactions_owner_user_id" ON "public"."interactions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_interviews_user_status" ON "public"."user_interview_sessions" USING "btree" ("user_id", "status");



CREATE INDEX "idx_job_categories_industry" ON "public"."job_categories" USING "btree" ("industry_id");



CREATE INDEX "idx_job_categories_owner_user_id" ON "public"."job_categories" USING "btree" ("owner_user_id");



CREATE INDEX "idx_job_graph_nodes_owner_user_id" ON "public"."job_graph_nodes" USING "btree" ("owner_user_id");



CREATE INDEX "idx_job_kpis_owner_user_id" ON "public"."job_kpis" USING "btree" ("owner_user_id");



CREATE INDEX "idx_job_queue__user_id" ON "public"."job_queue" USING "btree" ("user_id");



CREATE INDEX "idx_job_queue__user_id__created_at_desc" ON "public"."job_queue" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_job_queue__user_id__updated_at_desc" ON "public"."job_queue" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_job_queue_agent_status" ON "public"."job_queue" USING "btree" ("agent_id", "status");



CREATE INDEX "idx_job_queue_agents__user_id" ON "public"."job_queue_agents" USING "btree" ("user_id");



CREATE INDEX "idx_job_queue_agents__user_id__created_at_desc" ON "public"."job_queue_agents" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_job_queue_agents__user_id__updated_at_desc" ON "public"."job_queue_agents" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_job_queue_agents_user" ON "public"."job_queue_agents" USING "btree" ("user_id");



CREATE INDEX "idx_job_queue_alerts_created" ON "public"."job_queue_alerts" USING "btree" ("created_at" DESC);



CREATE INDEX "idx_job_queue_budget_ledger__user_id" ON "public"."job_queue_budget_ledger" USING "btree" ("user_id");



CREATE INDEX "idx_job_queue_budget_ledger_ts" ON "public"."job_queue_budget_ledger" USING "btree" ("ts" DESC);



CREATE INDEX "idx_job_queue_budget_ledger_user_day" ON "public"."job_queue_budget_ledger" USING "btree" ("user_id", "day");



CREATE INDEX "idx_job_queue_budget_ledger_user_day_ts" ON "public"."job_queue_budget_ledger" USING "btree" ("user_id", "day", "ts" DESC);



CREATE INDEX "idx_job_queue_budget_rollover__user_id" ON "public"."job_queue_budget_rollover" USING "btree" ("user_id");



CREATE INDEX "idx_job_queue_budget_rollover__user_id__created_at_desc" ON "public"."job_queue_budget_rollover" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_job_queue_budget_rollover_expires" ON "public"."job_queue_budget_rollover" USING "btree" ("expires_at");



CREATE INDEX "idx_job_queue_budget_rollover_user" ON "public"."job_queue_budget_rollover" USING "btree" ("user_id");



CREATE INDEX "idx_job_queue_credit_balances__user_id" ON "public"."job_queue_credit_balances" USING "btree" ("user_id");



CREATE INDEX "idx_job_queue_credit_balances__user_id__updated_at_desc" ON "public"."job_queue_credit_balances" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_job_queue_credits_ledger__user_id" ON "public"."job_queue_credits_ledger" USING "btree" ("user_id");



CREATE INDEX "idx_job_queue_credits_ledger__user_id__created_at_desc" ON "public"."job_queue_credits_ledger" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_job_queue_credits_ledger_user_day" ON "public"."job_queue_credits_ledger" USING "btree" ("user_id", "day");



CREATE INDEX "idx_job_queue_daily_budget__user_id" ON "public"."job_queue_daily_budget" USING "btree" ("user_id");



CREATE INDEX "idx_job_queue_daily_budget__user_id__updated_at_desc" ON "public"."job_queue_daily_budget" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_job_queue_daily_budget_user_day" ON "public"."job_queue_daily_budget" USING "btree" ("user_id", "day");



CREATE INDEX "idx_job_queue_fairness_ledger__user_id" ON "public"."job_queue_fairness_ledger" USING "btree" ("user_id");



CREATE INDEX "idx_job_queue_fairness_ledger__user_id__created_at_desc" ON "public"."job_queue_fairness_ledger" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_job_queue_fairness_ledger_lane_ts" ON "public"."job_queue_fairness_ledger" USING "btree" ("lane", "ts" DESC);



CREATE INDEX "idx_job_queue_fairness_ledger_ts" ON "public"."job_queue_fairness_ledger" USING "btree" ("ts" DESC);



CREATE INDEX "idx_job_queue_fairness_ledger_user" ON "public"."job_queue_fairness_ledger" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_job_queue_fairness_ledger_user_ts" ON "public"."job_queue_fairness_ledger" USING "btree" ("user_id", "ts" DESC);



CREATE INDEX "idx_job_queue_health_snapshots_created" ON "public"."job_queue_health_snapshots" USING "btree" ("created_at" DESC);



CREATE INDEX "idx_job_queue_lane_priority_run_at" ON "public"."job_queue" USING "btree" ("lane", "priority", "run_at", "created_at") WHERE ("status" = 'queued'::"text");



CREATE INDEX "idx_job_queue_lane_quota__user_id" ON "public"."job_queue_lane_quota" USING "btree" ("user_id");



CREATE INDEX "idx_job_queue_lane_quota__user_id__updated_at_desc" ON "public"."job_queue_lane_quota" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_job_queue_lane_quota_user_day" ON "public"."job_queue_lane_quota" USING "btree" ("user_id", "day");



CREATE INDEX "idx_job_queue_rate_window__user_id" ON "public"."job_queue_rate_window" USING "btree" ("user_id");



CREATE INDEX "idx_job_queue_rate_window__user_id__updated_at_desc" ON "public"."job_queue_rate_window" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_job_queue_rate_window_user_start" ON "public"."job_queue_rate_window" USING "btree" ("user_id", "window_start" DESC);



CREATE INDEX "idx_job_queue_results_job_id_created" ON "public"."job_queue_results" USING "btree" ("job_id", "created_at" DESC);



CREATE INDEX "idx_job_queue_scheduler_decisions__user_id" ON "public"."job_queue_scheduler_decisions" USING "btree" ("user_id");



CREATE INDEX "idx_job_queue_scheduler_decisions__user_id__created_at_desc" ON "public"."job_queue_scheduler_decisions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_job_queue_scheduler_decisions_created" ON "public"."job_queue_scheduler_decisions" USING "btree" ("created_at" DESC);



CREATE INDEX "idx_job_queue_scheduler_decisions_user" ON "public"."job_queue_scheduler_decisions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_job_queue_status_scheduled_priority" ON "public"."job_queue" USING "btree" ("status", "scheduled_at", "priority");



CREATE INDEX "idx_job_queue_user_priority" ON "public"."job_queue" USING "btree" ("user_id", "priority" DESC, "status");



CREATE INDEX "idx_job_queue_user_status" ON "public"."job_queue" USING "btree" ("user_id", "status");



CREATE INDEX "idx_job_queue_user_status_scheduled" ON "public"."job_queue" USING "btree" ("user_id", "status", "scheduled_at");



CREATE INDEX "idx_job_queue_user_tiers__user_id" ON "public"."job_queue_user_tiers" USING "btree" ("user_id");



CREATE INDEX "idx_job_queue_user_tiers__user_id__created_at_desc" ON "public"."job_queue_user_tiers" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_job_queue_user_tiers__user_id__updated_at_desc" ON "public"."job_queue_user_tiers" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_job_queue_user_tiers_tier" ON "public"."job_queue_user_tiers" USING "btree" ("tier");



CREATE INDEX "idx_job_requests__user_id" ON "public"."job_requests" USING "btree" ("user_id");



CREATE INDEX "idx_job_requests__user_id__created_at_desc" ON "public"."job_requests" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_job_requests_owner_user_id" ON "public"."job_requests" USING "btree" ("owner_user_id");



CREATE INDEX "idx_job_requests_status" ON "public"."job_requests" USING "btree" ("status");



CREATE INDEX "idx_job_runs__user_id" ON "public"."job_runs" USING "btree" ("user_id");



CREATE INDEX "idx_job_runs__user_id__created_at_desc" ON "public"."job_runs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_job_runs_job_id_started_at" ON "public"."job_runs" USING "btree" ("job_id", "started_at" DESC);



CREATE INDEX "idx_job_runs_user_started_at" ON "public"."job_runs" USING "btree" ("user_id", "started_at" DESC);



CREATE INDEX "idx_job_scorecards__user_id" ON "public"."job_scorecards" USING "btree" ("user_id");



CREATE INDEX "idx_job_scorecards__user_id__created_at_desc" ON "public"."job_scorecards" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_job_scorecards_owner_user_id" ON "public"."job_scorecards" USING "btree" ("owner_user_id");



CREATE INDEX "idx_job_titles_category" ON "public"."job_titles" USING "btree" ("category_id");



CREATE INDEX "idx_job_titles_name" ON "public"."job_titles" USING "btree" ("name");



CREATE INDEX "idx_job_titles_owner_user_id" ON "public"."job_titles" USING "btree" ("owner_user_id");



CREATE INDEX "idx_job_verticals__user_id" ON "public"."job_verticals" USING "btree" ("user_id");



CREATE INDEX "idx_job_verticals__user_id__created_at_desc" ON "public"."job_verticals" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_job_verticals_owner_user_id" ON "public"."job_verticals" USING "btree" ("owner_user_id");



CREATE INDEX "idx_journal_entries__user_id" ON "public"."journal_entries" USING "btree" ("user_id");



CREATE INDEX "idx_journal_entries__user_id__created_at_desc" ON "public"."journal_entries" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_journal_entries_date" ON "public"."journal_entries" USING "btree" ("date");



CREATE INDEX "idx_journal_entries_owner_user_id" ON "public"."journal_entries" USING "btree" ("owner_user_id");



CREATE INDEX "idx_journal_entries_user_id" ON "public"."journal_entries" USING "btree" ("user_id");



CREATE INDEX "idx_journal_user_date" ON "public"."journal_entries" USING "btree" ("user_id", "entry_date");



CREATE INDEX "idx_knowledge_context_links__user_id" ON "public"."knowledge_context_links" USING "btree" ("user_id");



CREATE INDEX "idx_knowledge_context_links__user_id__created_at_desc" ON "public"."knowledge_context_links" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_knowledge_context_links_owner_user_id" ON "public"."knowledge_context_links" USING "btree" ("owner_user_id");



CREATE INDEX "idx_knowledge_contexts__user_id" ON "public"."knowledge_contexts" USING "btree" ("user_id");



CREATE INDEX "idx_knowledge_contexts__user_id__created_at_desc" ON "public"."knowledge_contexts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_knowledge_contexts_owner_user_id" ON "public"."knowledge_contexts" USING "btree" ("owner_user_id");



CREATE INDEX "idx_knowledge_edges__user_id" ON "public"."knowledge_edges" USING "btree" ("user_id");



CREATE INDEX "idx_knowledge_edges__user_id__created_at_desc" ON "public"."knowledge_edges" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_knowledge_edges_owner_user_id" ON "public"."knowledge_edges" USING "btree" ("owner_user_id");



CREATE INDEX "idx_knowledge_nodes__user_id" ON "public"."knowledge_nodes" USING "btree" ("user_id");



CREATE INDEX "idx_knowledge_nodes__user_id__created_at_desc" ON "public"."knowledge_nodes" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_knowledge_nodes_owner_user_id" ON "public"."knowledge_nodes" USING "btree" ("owner_user_id");



CREATE INDEX "idx_layouts_user" ON "public"."user_dashboard_layouts" USING "btree" ("user_id", "is_active");



CREATE INDEX "idx_lb_daily_metrics__user_id" ON "public"."lb_daily_metrics" USING "btree" ("user_id");



CREATE INDEX "idx_lb_daily_metrics__user_id__created_at_desc" ON "public"."lb_daily_metrics" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_lb_daily_metrics__user_id__updated_at_desc" ON "public"."lb_daily_metrics" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_lb_daily_metrics_owner_user_id" ON "public"."lb_daily_metrics" USING "btree" ("owner_user_id");



CREATE INDEX "idx_lb_daily_metrics_user_date" ON "public"."lb_daily_metrics" USING "btree" ("user_id", "date");



CREATE INDEX "idx_lb_insights__user_id" ON "public"."lb_insights" USING "btree" ("user_id");



CREATE INDEX "idx_lb_insights__user_id__created_at_desc" ON "public"."lb_insights" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_lb_insights_owner_user_id" ON "public"."lb_insights" USING "btree" ("owner_user_id");



CREATE INDEX "idx_lb_insights_status" ON "public"."lb_insights" USING "btree" ("user_id", "status");



CREATE INDEX "idx_lb_insights_user" ON "public"."lb_insights" USING "btree" ("user_id");



CREATE INDEX "idx_ld_user_id" ON "public"."life_domains" USING "btree" ("user_id");



CREATE INDEX "idx_league_members__user_id" ON "public"."league_members" USING "btree" ("user_id");



CREATE INDEX "idx_league_members__user_id__created_at_desc" ON "public"."league_members" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_league_members_owner_user_id" ON "public"."league_members" USING "btree" ("owner_user_id");



CREATE INDEX "idx_league_scores__user_id" ON "public"."league_scores" USING "btree" ("user_id");



CREATE INDEX "idx_league_scores__user_id__updated_at_desc" ON "public"."league_scores" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_league_scores_owner_user_id" ON "public"."league_scores" USING "btree" ("owner_user_id");



CREATE INDEX "idx_leagues_owner_user_id" ON "public"."leagues" USING "btree" ("owner_user_id");



CREATE INDEX "idx_life_arc_autopilot_runs__user_id" ON "public"."life_arc_autopilot_runs" USING "btree" ("user_id");



CREATE INDEX "idx_life_arc_autopilot_runs__user_id__created_at_desc" ON "public"."life_arc_autopilot_runs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_life_arc_autopilot_runs_owner_user_id" ON "public"."life_arc_autopilot_runs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_life_arc_autopilot_suggestions__user_id" ON "public"."life_arc_autopilot_suggestions" USING "btree" ("user_id");



CREATE INDEX "idx_life_arc_autopilot_suggestions__user_id__created_at_desc" ON "public"."life_arc_autopilot_suggestions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_life_arc_autopilot_suggestions__user_id__updated_at_desc" ON "public"."life_arc_autopilot_suggestions" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_life_arc_checkpoints_owner_user_id" ON "public"."life_arc_checkpoints" USING "btree" ("owner_user_id");



CREATE INDEX "idx_life_arc_daily_focus__user_id" ON "public"."life_arc_daily_focus" USING "btree" ("user_id");



CREATE INDEX "idx_life_arc_daily_focus__user_id__created_at_desc" ON "public"."life_arc_daily_focus" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_life_arc_daily_focus__user_id__updated_at_desc" ON "public"."life_arc_daily_focus" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_life_arc_daily_focus_owner_user_id" ON "public"."life_arc_daily_focus" USING "btree" ("owner_user_id");



CREATE INDEX "idx_life_arc_objectives__user_id" ON "public"."life_arc_objectives" USING "btree" ("user_id");



CREATE INDEX "idx_life_arc_objectives__user_id__created_at_desc" ON "public"."life_arc_objectives" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_life_arc_objectives__user_id__updated_at_desc" ON "public"."life_arc_objectives" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_life_arc_objectives_owner_user_id" ON "public"."life_arc_objectives" USING "btree" ("owner_user_id");



CREATE INDEX "idx_life_arc_quests_owner_user_id" ON "public"."life_arc_quests" USING "btree" ("owner_user_id");



CREATE INDEX "idx_life_arc_risk_events__user_id" ON "public"."life_arc_risk_events" USING "btree" ("user_id");



CREATE INDEX "idx_life_arc_risk_events__user_id__created_at_desc" ON "public"."life_arc_risk_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_life_arc_risk_events_owner_user_id" ON "public"."life_arc_risk_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_life_arc_sources_owner_user_id" ON "public"."life_arc_sources" USING "btree" ("owner_user_id");



CREATE INDEX "idx_life_arcs__user_id" ON "public"."life_arcs" USING "btree" ("user_id");



CREATE INDEX "idx_life_arcs__user_id__created_at_desc" ON "public"."life_arcs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_life_arcs__user_id__updated_at_desc" ON "public"."life_arcs" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_life_arcs_owner_user_id" ON "public"."life_arcs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_life_canon_entries__user_id" ON "public"."life_canon_entries" USING "btree" ("user_id");



CREATE INDEX "idx_life_canon_entries__user_id__created_at_desc" ON "public"."life_canon_entries" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_life_canon_snapshots__user_id" ON "public"."life_canon_snapshots" USING "btree" ("user_id");



CREATE INDEX "idx_life_canon_snapshots_owner_user_id" ON "public"."life_canon_snapshots" USING "btree" ("owner_user_id");



CREATE INDEX "idx_life_chapters__user_id" ON "public"."life_chapters" USING "btree" ("user_id");



CREATE INDEX "idx_life_chapters__user_id__created_at_desc" ON "public"."life_chapters" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_life_chapters__user_id__updated_at_desc" ON "public"."life_chapters" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_life_chapters_owner_user_id" ON "public"."life_chapters" USING "btree" ("owner_user_id");



CREATE INDEX "idx_life_chapters_user" ON "public"."life_chapters" USING "btree" ("user_id", "chapter_index");



CREATE INDEX "idx_life_domains__user_id" ON "public"."life_domains" USING "btree" ("user_id");



CREATE INDEX "idx_life_domains__user_id__created_at_desc" ON "public"."life_domains" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_life_domains__user_id__updated_at_desc" ON "public"."life_domains" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_life_domains_owner_user_id" ON "public"."life_domains" USING "btree" ("owner_user_id");



CREATE INDEX "idx_life_events__user_id" ON "public"."life_events" USING "btree" ("user_id");



CREATE INDEX "idx_life_events__user_id__created_at_desc" ON "public"."life_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_life_events_owner_user_id" ON "public"."life_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_life_events_user_chapter" ON "public"."life_events" USING "btree" ("user_id", "chapter_id");



CREATE INDEX "idx_life_events_user_time" ON "public"."life_events" USING "btree" ("user_id", "occurred_at");



CREATE INDEX "idx_life_evidence__user_id" ON "public"."life_evidence" USING "btree" ("user_id");



CREATE INDEX "idx_life_evidence__user_id__created_at_desc" ON "public"."life_evidence" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_life_evidence_event" ON "public"."life_evidence" USING "btree" ("life_event_id");



CREATE INDEX "idx_life_evidence_trace" ON "public"."life_evidence" USING "btree" ("user_id", "trace_id", "created_at" DESC);



CREATE INDEX "idx_life_evidence_user_id_text" ON "public"."life_evidence" USING "btree" ("user_id_text");



CREATE INDEX "idx_life_evidence_user_time" ON "public"."life_evidence" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_life_themes__user_id" ON "public"."life_themes" USING "btree" ("user_id");



CREATE INDEX "idx_life_themes__user_id__created_at_desc" ON "public"."life_themes" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_life_themes__user_id__updated_at_desc" ON "public"."life_themes" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_life_themes_owner_user_id" ON "public"."life_themes" USING "btree" ("owner_user_id");



CREATE INDEX "idx_life_themes_user" ON "public"."life_themes" USING "btree" ("user_id");



CREATE INDEX "idx_long_chapters__user_id" ON "public"."long_chapters" USING "btree" ("user_id");



CREATE INDEX "idx_long_chapters__user_id__created_at_desc" ON "public"."long_chapters" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_long_chapters__user_id__updated_at_desc" ON "public"."long_chapters" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_long_chapters_owner_user_id" ON "public"."long_chapters" USING "btree" ("owner_user_id");



CREATE INDEX "idx_long_milestones__user_id" ON "public"."long_milestones" USING "btree" ("user_id");



CREATE INDEX "idx_long_milestones__user_id__created_at_desc" ON "public"."long_milestones" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_long_milestones_owner_user_id" ON "public"."long_milestones" USING "btree" ("owner_user_id");



CREATE INDEX "idx_long_predictions__user_id" ON "public"."long_predictions" USING "btree" ("user_id");



CREATE INDEX "idx_long_predictions__user_id__created_at_desc" ON "public"."long_predictions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_long_predictions_owner_user_id" ON "public"."long_predictions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_long_snapshots__user_id" ON "public"."long_snapshots" USING "btree" ("user_id");



CREATE INDEX "idx_long_snapshots__user_id__created_at_desc" ON "public"."long_snapshots" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_long_snapshots_owner_user_id" ON "public"."long_snapshots" USING "btree" ("owner_user_id");



CREATE INDEX "idx_long_trajectories__user_id" ON "public"."long_trajectories" USING "btree" ("user_id");



CREATE INDEX "idx_long_trajectories__user_id__created_at_desc" ON "public"."long_trajectories" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_long_trajectories__user_id__updated_at_desc" ON "public"."long_trajectories" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_long_trajectories_owner_user_id" ON "public"."long_trajectories" USING "btree" ("owner_user_id");



CREATE INDEX "idx_long_trends__user_id" ON "public"."long_trends" USING "btree" ("user_id");



CREATE INDEX "idx_long_trends__user_id__created_at_desc" ON "public"."long_trends" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_long_trends__user_id__updated_at_desc" ON "public"."long_trends" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_long_trends_owner_user_id" ON "public"."long_trends" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mc_events__user_id" ON "public"."mc_events" USING "btree" ("user_id");



CREATE INDEX "idx_mc_events__user_id__created_at_desc" ON "public"."mc_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mc_events_owner_user_id" ON "public"."mc_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mc_events_type" ON "public"."mc_events" USING "btree" ("user_id", "event_type");



CREATE INDEX "idx_mc_events_user" ON "public"."mc_events" USING "btree" ("user_id");



CREATE INDEX "idx_mc_interventions__user_id" ON "public"."mc_interventions" USING "btree" ("user_id");



CREATE INDEX "idx_mc_interventions__user_id__created_at_desc" ON "public"."mc_interventions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mc_interventions_owner_user_id" ON "public"."mc_interventions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mc_interventions_user" ON "public"."mc_interventions" USING "btree" ("user_id");



CREATE INDEX "idx_mc_strategy_profiles__user_id" ON "public"."mc_strategy_profiles" USING "btree" ("user_id");



CREATE INDEX "idx_mc_strategy_profiles__user_id__created_at_desc" ON "public"."mc_strategy_profiles" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mc_strategy_profiles__user_id__updated_at_desc" ON "public"."mc_strategy_profiles" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_mc_strategy_profiles_owner_user_id" ON "public"."mc_strategy_profiles" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mc_strategy_profiles_user" ON "public"."mc_strategy_profiles" USING "btree" ("user_id");



CREATE INDEX "idx_mem_archives__user_id" ON "public"."mem_archives" USING "btree" ("user_id");



CREATE INDEX "idx_mem_archives_owner_user_id" ON "public"."mem_archives" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mem_category" ON "public"."memories" USING "btree" ("user_id", "category");



CREATE INDEX "idx_mem_compressed__user_id" ON "public"."mem_compressed" USING "btree" ("user_id");



CREATE INDEX "idx_mem_compressed__user_id__created_at_desc" ON "public"."mem_compressed" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mem_compressed_owner_user_id" ON "public"."mem_compressed" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mem_compression_jobs__user_id" ON "public"."mem_compression_jobs" USING "btree" ("user_id");



CREATE INDEX "idx_mem_compression_jobs__user_id__created_at_desc" ON "public"."mem_compression_jobs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mem_compression_jobs_owner_user_id" ON "public"."mem_compression_jobs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mem_compression_settings__user_id" ON "public"."mem_compression_settings" USING "btree" ("user_id");



CREATE INDEX "idx_mem_compression_settings__user_id__created_at_desc" ON "public"."mem_compression_settings" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mem_compression_settings__user_id__updated_at_desc" ON "public"."mem_compression_settings" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_mem_compression_settings_owner_user_id" ON "public"."mem_compression_settings" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mem_importance" ON "public"."memories" USING "btree" ("user_id", "importance" DESC);



CREATE INDEX "idx_mem_type" ON "public"."memories" USING "btree" ("user_id", "type");



CREATE INDEX "idx_mem_user" ON "public"."memories" USING "btree" ("user_id");



CREATE INDEX "idx_memories__user_id" ON "public"."memories" USING "btree" ("user_id");



CREATE INDEX "idx_memories__user_id__created_at_desc" ON "public"."memories" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_memories__user_id__updated_at_desc" ON "public"."memories" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_memories_owner_user_id" ON "public"."memories" USING "btree" ("owner_user_id");



CREATE INDEX "idx_memory_events__user_id" ON "public"."memory_events" USING "btree" ("user_id");



CREATE INDEX "idx_memory_events__user_id__created_at_desc" ON "public"."memory_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_memory_events_owner_user_id" ON "public"."memory_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_memory_patterns__user_id" ON "public"."memory_patterns" USING "btree" ("user_id");



CREATE INDEX "idx_memory_patterns__user_id__created_at_desc" ON "public"."memory_patterns" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_memory_patterns_owner_user_id" ON "public"."memory_patterns" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mind_models__user_id" ON "public"."mind_models" USING "btree" ("user_id");



CREATE INDEX "idx_mind_models__user_id__created_at_desc" ON "public"."mind_models" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mind_models__user_id__updated_at_desc" ON "public"."mind_models" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_mind_models_owner_user_id" ON "public"."mind_models" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mind_models_user_entity" ON "public"."mind_models" USING "btree" ("user_id", "entity_type", "entity_id");



CREATE INDEX "idx_motor_routine_metrics__user_id" ON "public"."motor_routine_metrics" USING "btree" ("user_id");



CREATE INDEX "idx_motor_routine_metrics__user_id__updated_at_desc" ON "public"."motor_routine_metrics" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_motor_routine_metrics_owner_user_id" ON "public"."motor_routine_metrics" USING "btree" ("owner_user_id");



CREATE UNIQUE INDEX "idx_motor_routine_metrics_user_routine" ON "public"."motor_routine_metrics" USING "btree" ("user_id", "routine_id");



CREATE INDEX "idx_motor_routine_runs__user_id" ON "public"."motor_routine_runs" USING "btree" ("user_id");



CREATE INDEX "idx_motor_routine_runs_owner_user_id" ON "public"."motor_routine_runs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_motor_routine_runs_user" ON "public"."motor_routine_runs" USING "btree" ("user_id", "started_at" DESC);



CREATE INDEX "idx_motor_routine_steps__user_id" ON "public"."motor_routine_steps" USING "btree" ("user_id");



CREATE INDEX "idx_motor_routine_steps__user_id__created_at_desc" ON "public"."motor_routine_steps" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_motor_routine_steps__user_id__updated_at_desc" ON "public"."motor_routine_steps" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_motor_routine_steps_owner_user_id" ON "public"."motor_routine_steps" USING "btree" ("owner_user_id");



CREATE INDEX "idx_motor_routine_steps_routine" ON "public"."motor_routine_steps" USING "btree" ("routine_id", "step_index");



CREATE INDEX "idx_motor_routine_triggers__user_id" ON "public"."motor_routine_triggers" USING "btree" ("user_id");



CREATE INDEX "idx_motor_routine_triggers__user_id__created_at_desc" ON "public"."motor_routine_triggers" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_motor_routine_triggers__user_id__updated_at_desc" ON "public"."motor_routine_triggers" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_motor_routine_triggers_owner_user_id" ON "public"."motor_routine_triggers" USING "btree" ("owner_user_id");



CREATE INDEX "idx_motor_routine_triggers_user" ON "public"."motor_routine_triggers" USING "btree" ("user_id", "enabled");



CREATE INDEX "idx_motor_routines__user_id" ON "public"."motor_routines" USING "btree" ("user_id");



CREATE INDEX "idx_motor_routines__user_id__created_at_desc" ON "public"."motor_routines" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_motor_routines__user_id__updated_at_desc" ON "public"."motor_routines" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_motor_routines_owner_user_id" ON "public"."motor_routines" USING "btree" ("owner_user_id");



CREATE INDEX "idx_motor_routines_user" ON "public"."motor_routines" USING "btree" ("user_id", "status");



CREATE INDEX "idx_mp_user" ON "public"."memory_patterns" USING "btree" ("user_id");



CREATE INDEX "idx_mythic_achievements__user_id" ON "public"."mythic_achievements" USING "btree" ("user_id");



CREATE INDEX "idx_mythic_achievements__user_id__created_at_desc" ON "public"."mythic_achievements" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mythic_achievements_owner_user_id" ON "public"."mythic_achievements" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mythic_achievements_user" ON "public"."mythic_achievements" USING "btree" ("user_id", "archetype_id");



CREATE INDEX "idx_mythic_archetypes_owner_user_id" ON "public"."mythic_archetypes" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mythic_arcs__user_id" ON "public"."mythic_arcs" USING "btree" ("user_id");



CREATE INDEX "idx_mythic_arcs__user_id__created_at_desc" ON "public"."mythic_arcs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mythic_arcs__user_id__updated_at_desc" ON "public"."mythic_arcs" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_mythic_belt_levels_owner_user_id" ON "public"."mythic_belt_levels" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mythic_belt_progress__user_id" ON "public"."mythic_belt_progress" USING "btree" ("user_id");



CREATE INDEX "idx_mythic_belt_progress__user_id__created_at_desc" ON "public"."mythic_belt_progress" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mythic_belt_progress__user_id__updated_at_desc" ON "public"."mythic_belt_progress" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_mythic_belt_progress_owner_user_id" ON "public"."mythic_belt_progress" USING "btree" ("owner_user_id");



CREATE UNIQUE INDEX "idx_mythic_belt_progress_user_archetype" ON "public"."mythic_belt_progress" USING "btree" ("user_id", "archetype_id");



CREATE INDEX "idx_mythic_coach_sessions__user_id" ON "public"."mythic_coach_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_mythic_coach_sessions__user_id__created_at_desc" ON "public"."mythic_coach_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mythic_coach_sessions_owner_user_id" ON "public"."mythic_coach_sessions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mythic_playbooks_owner_user_id" ON "public"."mythic_playbooks" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mythic_quests__user_id" ON "public"."mythic_quests" USING "btree" ("user_id");



CREATE INDEX "idx_mythic_quests__user_id__created_at_desc" ON "public"."mythic_quests" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mythic_rituals__user_id" ON "public"."mythic_rituals" USING "btree" ("user_id");



CREATE INDEX "idx_mythic_rituals__user_id__created_at_desc" ON "public"."mythic_rituals" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mythic_sessions__user_id" ON "public"."mythic_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_mythic_sessions__user_id__created_at_desc" ON "public"."mythic_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mythic_training_focus__user_id" ON "public"."mythic_training_focus" USING "btree" ("user_id");



CREATE INDEX "idx_mythic_training_focus__user_id__created_at_desc" ON "public"."mythic_training_focus" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mythic_training_focus_owner_user_id" ON "public"."mythic_training_focus" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mythic_training_focus_user_time" ON "public"."mythic_training_focus" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mythic_training_missions__user_id" ON "public"."mythic_training_missions" USING "btree" ("user_id");



CREATE INDEX "idx_mythic_training_missions__user_id__created_at_desc" ON "public"."mythic_training_missions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mythic_training_missions_owner_user_id" ON "public"."mythic_training_missions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mythic_training_missions_user_due" ON "public"."mythic_training_missions" USING "btree" ("user_id", "due_date");



CREATE INDEX "idx_mythic_training_plans__user_id" ON "public"."mythic_training_plans" USING "btree" ("user_id");



CREATE INDEX "idx_mythic_training_plans__user_id__created_at_desc" ON "public"."mythic_training_plans" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mythic_training_plans__user_id__updated_at_desc" ON "public"."mythic_training_plans" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_mythic_training_plans_owner_user_id" ON "public"."mythic_training_plans" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mythic_training_plans_user" ON "public"."mythic_training_plans" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mythic_training_reflections__user_id" ON "public"."mythic_training_reflections" USING "btree" ("user_id");



CREATE INDEX "idx_mythic_training_reflections__user_id__created_at_desc" ON "public"."mythic_training_reflections" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mythic_training_reflections_owner_user_id" ON "public"."mythic_training_reflections" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mythic_training_reflections_user_time" ON "public"."mythic_training_reflections" USING "btree" ("user_id", "period_start", "period_end");



CREATE INDEX "idx_mythic_voice_mappings__user_id" ON "public"."mythic_voice_mappings" USING "btree" ("user_id");



CREATE INDEX "idx_mythic_voice_mappings__user_id__created_at_desc" ON "public"."mythic_voice_mappings" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_mythic_voice_mappings__user_id__updated_at_desc" ON "public"."mythic_voice_mappings" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_mythic_voice_mappings_owner_user_id" ON "public"."mythic_voice_mappings" USING "btree" ("owner_user_id");



CREATE INDEX "idx_mythic_voice_mappings_user" ON "public"."mythic_voice_mappings" USING "btree" ("user_id", "archetype_id");



CREATE INDEX "idx_narrative_snapshots__user_id" ON "public"."narrative_snapshots" USING "btree" ("user_id");



CREATE INDEX "idx_narrative_snapshots__user_id__created_at_desc" ON "public"."narrative_snapshots" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_narrative_snapshots_owner_user_id" ON "public"."narrative_snapshots" USING "btree" ("owner_user_id");



CREATE INDEX "idx_narrative_snapshots_user_time" ON "public"."narrative_snapshots" USING "btree" ("user_id", "snapshot_at");



CREATE INDEX "idx_nl_type" ON "public"."notification_log" USING "btree" ("type");



CREATE INDEX "idx_nl_user_created" ON "public"."notification_log" USING "btree" ("user_id", "created_at");



CREATE INDEX "idx_nl_user_id" ON "public"."notification_log" USING "btree" ("user_id");



CREATE INDEX "idx_notes__user_id" ON "public"."notes" USING "btree" ("user_id");



CREATE INDEX "idx_notes__user_id__created_at_desc" ON "public"."notes" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_notes_owner_user_id" ON "public"."notes" USING "btree" ("owner_user_id");



CREATE INDEX "idx_notes_user" ON "public"."notes" USING "btree" ("user_id");



CREATE INDEX "idx_notification_log__user_id" ON "public"."notification_log" USING "btree" ("user_id");



CREATE INDEX "idx_notification_log__user_id__created_at_desc" ON "public"."notification_log" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_notification_log_owner_user_id" ON "public"."notification_log" USING "btree" ("owner_user_id");



CREATE INDEX "idx_notification_preferences__user_id" ON "public"."notification_preferences" USING "btree" ("user_id");



CREATE INDEX "idx_notification_preferences__user_id__created_at_desc" ON "public"."notification_preferences" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_notification_preferences__user_id__updated_at_desc" ON "public"."notification_preferences" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_notification_preferences_owner_user_id" ON "public"."notification_preferences" USING "btree" ("owner_user_id");



CREATE INDEX "idx_notification_queue__user_id" ON "public"."notification_queue" USING "btree" ("user_id");



CREATE INDEX "idx_notification_queue__user_id__created_at_desc" ON "public"."notification_queue" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_notification_queue_owner_user_id" ON "public"."notification_queue" USING "btree" ("owner_user_id");



CREATE INDEX "idx_np_user_id" ON "public"."notification_preferences" USING "btree" ("user_id");



CREATE INDEX "idx_nq_status" ON "public"."notification_queue" USING "btree" ("status") WHERE ("status" = 'queued'::"text");



CREATE INDEX "idx_nq_user_status" ON "public"."notification_queue" USING "btree" ("user_id", "status");



CREATE INDEX "idx_onboarding_conversations__user_id" ON "public"."onboarding_conversations" USING "btree" ("user_id");



CREATE INDEX "idx_onboarding_conversations__user_id__created_at_desc" ON "public"."onboarding_conversations" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_onboarding_conversations__user_id__updated_at_desc" ON "public"."onboarding_conversations" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_onboarding_conversations_owner_user_id" ON "public"."onboarding_conversations" USING "btree" ("owner_user_id");



CREATE INDEX "idx_onboarding_state__user_id" ON "public"."onboarding_state" USING "btree" ("user_id");



CREATE INDEX "idx_onboarding_state__user_id__created_at_desc" ON "public"."onboarding_state" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_onboarding_state__user_id__updated_at_desc" ON "public"."onboarding_state" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_onboarding_state_owner_user_id" ON "public"."onboarding_state" USING "btree" ("owner_user_id");



CREATE INDEX "idx_onboarding_user" ON "public"."onboarding_conversations" USING "btree" ("user_id");



CREATE INDEX "idx_ops_audit_log_action_time" ON "public"."ops_audit_log" USING "btree" ("action", "created_at" DESC);



CREATE INDEX "idx_ops_audit_log_actor_time" ON "public"."ops_audit_log" USING "btree" ("actor_user_id", "created_at" DESC);



CREATE INDEX "idx_ops_audit_log_resource" ON "public"."ops_audit_log" USING "btree" ("resource_type", "resource_id");



CREATE INDEX "idx_ops_audit_log_target_time" ON "public"."ops_audit_log" USING "btree" ("target_user_id", "created_at" DESC);



CREATE INDEX "idx_org_members__user_id" ON "public"."org_members" USING "btree" ("user_id");



CREATE INDEX "idx_org_members__user_id__created_at_desc" ON "public"."org_members" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_org_members_owner_user_id" ON "public"."org_members" USING "btree" ("owner_user_id");



CREATE INDEX "idx_organizations_owner_user_id" ON "public"."organizations" USING "btree" ("owner_user_id");



CREATE INDEX "idx_persona_arc_events__user_id" ON "public"."persona_arc_events" USING "btree" ("user_id");



CREATE INDEX "idx_persona_arc_events__user_id__created_at_desc" ON "public"."persona_arc_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_persona_arc_events_owner_user_id" ON "public"."persona_arc_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_persona_archetype_stats_owner_user_id" ON "public"."persona_archetype_stats" USING "btree" ("owner_user_id");



CREATE INDEX "idx_persona_archetypes_owner_user_id" ON "public"."persona_archetypes" USING "btree" ("owner_user_id");



CREATE INDEX "idx_persona_companion_events__user_id" ON "public"."persona_companion_events" USING "btree" ("user_id");



CREATE INDEX "idx_persona_companion_events__user_id__created_at_desc" ON "public"."persona_companion_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_persona_companion_events_owner_user_id" ON "public"."persona_companion_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_persona_companion_highlights__user_id" ON "public"."persona_companion_highlights" USING "btree" ("user_id");



CREATE INDEX "idx_persona_companion_highlights__user_id__created_at_desc" ON "public"."persona_companion_highlights" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_persona_companion_highlights_owner_user_id" ON "public"."persona_companion_highlights" USING "btree" ("owner_user_id");



CREATE INDEX "idx_persona_companion_state__user_id" ON "public"."persona_companion_state" USING "btree" ("user_id");



CREATE INDEX "idx_persona_companion_state__user_id__created_at_desc" ON "public"."persona_companion_state" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_persona_companion_state__user_id__updated_at_desc" ON "public"."persona_companion_state" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_persona_companion_state_owner_user_id" ON "public"."persona_companion_state" USING "btree" ("owner_user_id");



CREATE INDEX "idx_persona_dna_templates_owner_user_id" ON "public"."persona_dna_templates" USING "btree" ("owner_user_id");



CREATE INDEX "idx_persona_interaction_stats__user_id" ON "public"."persona_interaction_stats" USING "btree" ("user_id");



CREATE INDEX "idx_persona_interaction_stats__user_id__created_at_desc" ON "public"."persona_interaction_stats" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_persona_interaction_stats__user_id__updated_at_desc" ON "public"."persona_interaction_stats" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_persona_interaction_stats_owner_user_id" ON "public"."persona_interaction_stats" USING "btree" ("owner_user_id");



CREATE INDEX "idx_persona_memory_snapshots__user_id" ON "public"."persona_memory_snapshots" USING "btree" ("user_id");



CREATE INDEX "idx_persona_memory_snapshots__user_id__created_at_desc" ON "public"."persona_memory_snapshots" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_persona_memory_snapshots_owner_user_id" ON "public"."persona_memory_snapshots" USING "btree" ("owner_user_id");



CREATE INDEX "idx_persona_microstyle_prefs__user_id" ON "public"."persona_microstyle_prefs" USING "btree" ("user_id");



CREATE INDEX "idx_persona_microstyle_prefs__user_id__created_at_desc" ON "public"."persona_microstyle_prefs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_persona_microstyle_prefs__user_id__updated_at_desc" ON "public"."persona_microstyle_prefs" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_persona_microstyle_prefs_owner_user_id" ON "public"."persona_microstyle_prefs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_persona_style_variants_owner_user_id" ON "public"."persona_style_variants" USING "btree" ("owner_user_id");



CREATE INDEX "idx_persona_user_arc__user_id" ON "public"."persona_user_arc" USING "btree" ("user_id");



CREATE INDEX "idx_persona_user_arc_owner_user_id" ON "public"."persona_user_arc" USING "btree" ("owner_user_id");



CREATE INDEX "idx_personal_heuristics__user_id" ON "public"."personal_heuristics" USING "btree" ("user_id");



CREATE INDEX "idx_personal_heuristics__user_id__created_at_desc" ON "public"."personal_heuristics" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_personal_heuristics__user_id__updated_at_desc" ON "public"."personal_heuristics" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_personal_heuristics_owner_user_id" ON "public"."personal_heuristics" USING "btree" ("owner_user_id");



CREATE INDEX "idx_personal_heuristics_user" ON "public"."personal_heuristics" USING "btree" ("user_id");



CREATE INDEX "idx_personas__user_id" ON "public"."personas" USING "btree" ("user_id");



CREATE INDEX "idx_personas__user_id__created_at_desc" ON "public"."personas" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_personas__user_id__updated_at_desc" ON "public"."personas" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_personas_active" ON "public"."personas" USING "btree" ("user_id", "is_active") WHERE ("is_active" = true);



CREATE INDEX "idx_personas_owner_user_id" ON "public"."personas" USING "btree" ("owner_user_id");



CREATE INDEX "idx_personas_user" ON "public"."personas" USING "btree" ("user_id");



CREATE INDEX "idx_philosophy_exercises_owner_user_id" ON "public"."philosophy_exercises" USING "btree" ("owner_user_id");



CREATE INDEX "idx_philosophy_lessons_owner_user_id" ON "public"."philosophy_lessons" USING "btree" ("owner_user_id");



CREATE INDEX "idx_philosophy_schools_owner_user_id" ON "public"."philosophy_schools" USING "btree" ("owner_user_id");



CREATE INDEX "idx_photo_candidates_contact_id" ON "public"."crm_contact_photo_candidates" USING "btree" ("contact_id");



CREATE INDEX "idx_pi_day_plan" ON "public"."plan_items" USING "btree" ("day_plan_id");



CREATE INDEX "idx_pi_scheduled" ON "public"."plan_items" USING "btree" ("user_id", "scheduled_for") WHERE ("scheduled_for" IS NOT NULL);



CREATE INDEX "idx_pi_user_id" ON "public"."plan_items" USING "btree" ("user_id");



CREATE INDEX "idx_pi_user_status" ON "public"."plan_items" USING "btree" ("user_id", "status");



CREATE INDEX "idx_plan_items__user_id" ON "public"."plan_items" USING "btree" ("user_id");



CREATE INDEX "idx_plan_items__user_id__created_at_desc" ON "public"."plan_items" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_plan_items__user_id__updated_at_desc" ON "public"."plan_items" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_plan_items_owner_user_id" ON "public"."plan_items" USING "btree" ("owner_user_id");



CREATE INDEX "idx_planning_constraints__user_id" ON "public"."planning_constraints" USING "btree" ("user_id");



CREATE INDEX "idx_planning_constraints__user_id__created_at_desc" ON "public"."planning_constraints" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_planning_constraints_owner_user_id" ON "public"."planning_constraints" USING "btree" ("owner_user_id");



CREATE INDEX "idx_planning_constraints_session" ON "public"."planning_constraints" USING "btree" ("session_id");



CREATE INDEX "idx_planning_decisions__user_id" ON "public"."planning_decisions" USING "btree" ("user_id");



CREATE INDEX "idx_planning_decisions__user_id__created_at_desc" ON "public"."planning_decisions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_planning_decisions_owner_user_id" ON "public"."planning_decisions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_planning_decisions_session" ON "public"."planning_decisions" USING "btree" ("session_id");



CREATE INDEX "idx_planning_overrides__user_id" ON "public"."planning_overrides" USING "btree" ("user_id");



CREATE INDEX "idx_planning_overrides__user_id__created_at_desc" ON "public"."planning_overrides" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_planning_overrides_owner_user_id" ON "public"."planning_overrides" USING "btree" ("owner_user_id");



CREATE INDEX "idx_planning_overrides_user" ON "public"."planning_overrides" USING "btree" ("user_id", "created_at");



CREATE INDEX "idx_planning_sessions__user_id" ON "public"."planning_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_planning_sessions__user_id__created_at_desc" ON "public"."planning_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_planning_sessions_owner_user_id" ON "public"."planning_sessions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_planning_sessions_user" ON "public"."planning_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_plugin_api_keys__user_id" ON "public"."plugin_api_keys" USING "btree" ("user_id");



CREATE INDEX "idx_plugin_api_keys__user_id__created_at_desc" ON "public"."plugin_api_keys" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_plugin_api_keys_owner_user_id" ON "public"."plugin_api_keys" USING "btree" ("owner_user_id");



CREATE INDEX "idx_plugin_automations__user_id" ON "public"."plugin_automations" USING "btree" ("user_id");



CREATE INDEX "idx_plugin_automations__user_id__created_at_desc" ON "public"."plugin_automations" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_plugin_automations__user_id__updated_at_desc" ON "public"."plugin_automations" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_plugin_automations_owner_user_id" ON "public"."plugin_automations" USING "btree" ("owner_user_id");



CREATE INDEX "idx_plugin_data__user_id" ON "public"."plugin_data" USING "btree" ("user_id");



CREATE INDEX "idx_plugin_data__user_id__created_at_desc" ON "public"."plugin_data" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_plugin_data__user_id__updated_at_desc" ON "public"."plugin_data" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_plugin_data_owner_user_id" ON "public"."plugin_data" USING "btree" ("owner_user_id");



CREATE INDEX "idx_plugin_events__user_id" ON "public"."plugin_events" USING "btree" ("user_id");



CREATE INDEX "idx_plugin_events__user_id__created_at_desc" ON "public"."plugin_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_plugin_events_owner_user_id" ON "public"."plugin_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_plugin_webhooks__user_id" ON "public"."plugin_webhooks" USING "btree" ("user_id");



CREATE INDEX "idx_plugin_webhooks__user_id__created_at_desc" ON "public"."plugin_webhooks" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_plugin_webhooks_owner_user_id" ON "public"."plugin_webhooks" USING "btree" ("owner_user_id");



CREATE INDEX "idx_plugins_owner_user_id" ON "public"."plugins" USING "btree" ("owner_user_id");



CREATE INDEX "idx_prefrontal_goals__user_id" ON "public"."prefrontal_goals" USING "btree" ("user_id");



CREATE INDEX "idx_prefrontal_goals__user_id__created_at_desc" ON "public"."prefrontal_goals" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_prefrontal_goals__user_id__updated_at_desc" ON "public"."prefrontal_goals" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_prefrontal_goals_owner_user_id" ON "public"."prefrontal_goals" USING "btree" ("owner_user_id");



CREATE INDEX "idx_prefrontal_goals_user" ON "public"."prefrontal_goals" USING "btree" ("user_id");



CREATE INDEX "idx_presence_daily_summaries__user_id" ON "public"."presence_daily_summaries" USING "btree" ("user_id");



CREATE INDEX "idx_presence_daily_summaries__user_id__created_at_desc" ON "public"."presence_daily_summaries" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_presence_daily_summaries__user_id__updated_at_desc" ON "public"."presence_daily_summaries" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_presence_daily_summaries_owner_user_id" ON "public"."presence_daily_summaries" USING "btree" ("owner_user_id");



CREATE UNIQUE INDEX "idx_presence_daily_summaries_user_date" ON "public"."presence_daily_summaries" USING "btree" ("user_id", "summary_date");



CREATE INDEX "idx_presence_decisions__user_id" ON "public"."presence_decisions" USING "btree" ("user_id");



CREATE INDEX "idx_presence_decisions__user_id__created_at_desc" ON "public"."presence_decisions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_presence_decisions_owner_user_id" ON "public"."presence_decisions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_presence_decisions_user_time" ON "public"."presence_decisions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_presence_events__user_id" ON "public"."presence_events" USING "btree" ("user_id");



CREATE INDEX "idx_presence_events__user_id__created_at_desc" ON "public"."presence_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_presence_events_consumed" ON "public"."presence_events" USING "btree" ("user_id", "consumed");



CREATE INDEX "idx_presence_events_owner_user_id" ON "public"."presence_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_presence_events_user_time" ON "public"."presence_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_proactive_created" ON "public"."proactive_interventions" USING "btree" ("created_at" DESC);



CREATE INDEX "idx_proactive_interventions__user_id" ON "public"."proactive_interventions" USING "btree" ("user_id");



CREATE INDEX "idx_proactive_interventions__user_id__created_at_desc" ON "public"."proactive_interventions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_proactive_interventions_owner_user_id" ON "public"."proactive_interventions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_proactive_user_status" ON "public"."proactive_interventions" USING "btree" ("user_id", "status");



CREATE INDEX "idx_profiles_clerk_user_id" ON "public"."profiles" USING "btree" ("clerk_user_id");



CREATE INDEX "idx_profiles_user" ON "public"."user_profiles" USING "btree" ("user_id");



CREATE INDEX "idx_ps_user_enabled" ON "public"."push_subscriptions" USING "btree" ("user_id", "enabled") WHERE ("enabled" = true);



CREATE INDEX "idx_ps_user_id" ON "public"."push_subscriptions" USING "btree" ("user_id");



CREATE INDEX "idx_pulse_brain_preferences__user_id" ON "public"."pulse_brain_preferences" USING "btree" ("user_id");



CREATE INDEX "idx_pulse_brain_preferences__user_id__created_at_desc" ON "public"."pulse_brain_preferences" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_pulse_brain_preferences__user_id__updated_at_desc" ON "public"."pulse_brain_preferences" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_pulse_brain_preferences_owner_user_id" ON "public"."pulse_brain_preferences" USING "btree" ("owner_user_id");



CREATE UNIQUE INDEX "idx_pulse_brain_preferences_user" ON "public"."pulse_brain_preferences" USING "btree" ("user_id");



CREATE INDEX "idx_pulse_brain_surface_events__user_id" ON "public"."pulse_brain_surface_events" USING "btree" ("user_id");



CREATE INDEX "idx_pulse_brain_surface_events__user_id__created_at_desc" ON "public"."pulse_brain_surface_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_pulse_brain_surface_events_owner_user_id" ON "public"."pulse_brain_surface_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_pulse_brain_surface_events_user" ON "public"."pulse_brain_surface_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_pulse_docs_owner_user_id" ON "public"."pulse_docs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_pulse_events__user_id" ON "public"."pulse_events" USING "btree" ("user_id");



CREATE INDEX "idx_pulse_events__user_id__created_at_desc" ON "public"."pulse_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_pulse_events_created_at" ON "public"."pulse_events" USING "btree" ("created_at" DESC);



CREATE INDEX "idx_pulse_events_event_name" ON "public"."pulse_events" USING "btree" ("event_name");



CREATE INDEX "idx_pulse_events_feature_id" ON "public"."pulse_events" USING "btree" ("feature_id");



CREATE INDEX "idx_pulse_events_path" ON "public"."pulse_events" USING "btree" ("path");



CREATE INDEX "idx_pulse_events_user_id" ON "public"."pulse_events" USING "btree" ("user_id");



CREATE INDEX "idx_pulse_insight_acknowledgements__user_id" ON "public"."pulse_insight_acknowledgements" USING "btree" ("user_id");



CREATE INDEX "idx_pulse_insight_acknowledgements__user_id__created_at_desc" ON "public"."pulse_insight_acknowledgements" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_pulse_insight_acknowledgements_owner_user_id" ON "public"."pulse_insight_acknowledgements" USING "btree" ("owner_user_id");



CREATE INDEX "idx_pulse_insight_acknowledgements_user" ON "public"."pulse_insight_acknowledgements" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_pulse_introduction_sessions__user_id" ON "public"."pulse_introduction_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_pulse_introduction_sessions__user_id__created_at_desc" ON "public"."pulse_introduction_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_pulse_introduction_sessions_owner_user_id" ON "public"."pulse_introduction_sessions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_pulse_introduction_sessions_user" ON "public"."pulse_introduction_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_push_subscriptions__user_id" ON "public"."push_subscriptions" USING "btree" ("user_id");



CREATE INDEX "idx_push_subscriptions__user_id__created_at_desc" ON "public"."push_subscriptions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_push_subscriptions_owner_user_id" ON "public"."push_subscriptions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_quest_completions__user_id" ON "public"."quest_completions" USING "btree" ("user_id");



CREATE INDEX "idx_quest_completions__user_id__created_at_desc" ON "public"."quest_completions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_quest_completions_date" ON "public"."quest_completions" USING "btree" ("completed_at");



CREATE INDEX "idx_quest_completions_owner_user_id" ON "public"."quest_completions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_quest_completions_user" ON "public"."quest_completions" USING "btree" ("user_id");



CREATE INDEX "idx_referral_rewards_owner_user_id" ON "public"."referral_rewards" USING "btree" ("owner_user_id");



CREATE INDEX "idx_referral_rewards_referred" ON "public"."referral_rewards" USING "btree" ("referred_user_id");



CREATE INDEX "idx_referral_rewards_referrer" ON "public"."referral_rewards" USING "btree" ("referrer_user_id");



CREATE INDEX "idx_rel_followup" ON "public"."relationships" USING "btree" ("user_id", "next_followup_at");



CREATE INDEX "idx_rel_health" ON "public"."relationships" USING "btree" ("user_id", "health_score");



CREATE INDEX "idx_rel_importance" ON "public"."relationships" USING "btree" ("user_id", "importance");



CREATE INDEX "idx_rel_user_id" ON "public"."relationships" USING "btree" ("user_id");



CREATE INDEX "idx_relational_identities__user_id" ON "public"."relational_identities" USING "btree" ("user_id");



CREATE INDEX "idx_relational_identities__user_id__created_at_desc" ON "public"."relational_identities" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_relational_identities__user_id__updated_at_desc" ON "public"."relational_identities" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_relational_identities_contact" ON "public"."relational_identities" USING "btree" ("user_id", "contact_id");



CREATE INDEX "idx_relational_identities_owner_user_id" ON "public"."relational_identities" USING "btree" ("owner_user_id");



CREATE INDEX "idx_relational_identities_user" ON "public"."relational_identities" USING "btree" ("user_id", "importance" DESC);



CREATE INDEX "idx_relational_predictions__user_id" ON "public"."relational_predictions" USING "btree" ("user_id");



CREATE INDEX "idx_relational_predictions__user_id__created_at_desc" ON "public"."relational_predictions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_relational_predictions_identity" ON "public"."relational_predictions" USING "btree" ("relational_identity_id", "created_at" DESC);



CREATE INDEX "idx_relational_predictions_owner_user_id" ON "public"."relational_predictions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_relational_state_snapshots__user_id" ON "public"."relational_state_snapshots" USING "btree" ("user_id");



CREATE INDEX "idx_relational_state_snapshots_identity" ON "public"."relational_state_snapshots" USING "btree" ("relational_identity_id", "snapshot_time" DESC);



CREATE INDEX "idx_relational_state_snapshots_owner_user_id" ON "public"."relational_state_snapshots" USING "btree" ("owner_user_id");



CREATE INDEX "idx_relational_state_snapshots_user_time" ON "public"."relational_state_snapshots" USING "btree" ("user_id", "snapshot_time" DESC);



CREATE INDEX "idx_relationship_highlights__user_id" ON "public"."relationship_highlights" USING "btree" ("user_id");



CREATE INDEX "idx_relationship_highlights__user_id__created_at_desc" ON "public"."relationship_highlights" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_relationship_highlights_owner_user_id" ON "public"."relationship_highlights" USING "btree" ("owner_user_id");



CREATE INDEX "idx_relationship_highlights_user" ON "public"."relationship_highlights" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_relationship_interactions__user_id" ON "public"."relationship_interactions" USING "btree" ("user_id");



CREATE INDEX "idx_relationship_interactions__user_id__created_at_desc" ON "public"."relationship_interactions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_relationship_interactions_owner_user_id" ON "public"."relationship_interactions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_relationships__user_id" ON "public"."relationships" USING "btree" ("user_id");



CREATE INDEX "idx_relationships__user_id__created_at_desc" ON "public"."relationships" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_relationships__user_id__updated_at_desc" ON "public"."relationships" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_relationships_owner_user_id" ON "public"."relationships" USING "btree" ("owner_user_id");



CREATE INDEX "idx_reminder_subscriptions__user_id" ON "public"."reminder_subscriptions" USING "btree" ("user_id");



CREATE INDEX "idx_reminder_subscriptions__user_id__created_at_desc" ON "public"."reminder_subscriptions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_reply_drafts_user_updated" ON "public"."reply_drafts" USING "btree" ("user_id_uuid", "updated_at" DESC);



CREATE INDEX "idx_response_style_profiles_owner_user_id" ON "public"."response_style_profiles" USING "btree" ("owner_user_id");



CREATE INDEX "idx_ri_occurred" ON "public"."relationship_interactions" USING "btree" ("occurred_at" DESC);



CREATE INDEX "idx_ri_rel" ON "public"."relationship_interactions" USING "btree" ("relationship_id");



CREATE INDEX "idx_ri_user" ON "public"."relationship_interactions" USING "btree" ("user_id");



CREATE INDEX "idx_safety_incidents__user_id" ON "public"."safety_incidents" USING "btree" ("user_id");



CREATE INDEX "idx_safety_incidents__user_id__created_at_desc" ON "public"."safety_incidents" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_safety_incidents_owner_user_id" ON "public"."safety_incidents" USING "btree" ("owner_user_id");



CREATE INDEX "idx_safety_policies_owner_user_id" ON "public"."safety_policies" USING "btree" ("owner_user_id");



CREATE INDEX "idx_scheduler_targets__user_id" ON "public"."scheduler_targets" USING "btree" ("user_id");



CREATE INDEX "idx_scheduler_targets__user_id__created_at_desc" ON "public"."scheduler_targets" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_scheduler_targets__user_id__updated_at_desc" ON "public"."scheduler_targets" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_self_identity_snapshots__user_id" ON "public"."self_identity_snapshots" USING "btree" ("user_id");



CREATE INDEX "idx_self_identity_snapshots__user_id__created_at_desc" ON "public"."self_identity_snapshots" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_self_identity_snapshots_owner_user_id" ON "public"."self_identity_snapshots" USING "btree" ("owner_user_id");



CREATE INDEX "idx_self_mirror_deltas__user_id" ON "public"."self_mirror_deltas" USING "btree" ("user_id");



CREATE INDEX "idx_self_mirror_deltas__user_id__created_at_desc" ON "public"."self_mirror_deltas" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_self_mirror_deltas_owner_user_id" ON "public"."self_mirror_deltas" USING "btree" ("owner_user_id");



CREATE INDEX "idx_self_mirror_deltas_user" ON "public"."self_mirror_deltas" USING "btree" ("user_id", "created_at");



CREATE INDEX "idx_self_mirror_facets__user_id" ON "public"."self_mirror_facets" USING "btree" ("user_id");



CREATE INDEX "idx_self_mirror_facets__user_id__created_at_desc" ON "public"."self_mirror_facets" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_self_mirror_facets_owner_user_id" ON "public"."self_mirror_facets" USING "btree" ("owner_user_id");



CREATE INDEX "idx_self_mirror_highlights__user_id" ON "public"."self_mirror_highlights" USING "btree" ("user_id");



CREATE INDEX "idx_self_mirror_highlights__user_id__created_at_desc" ON "public"."self_mirror_highlights" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_self_mirror_highlights_owner_user_id" ON "public"."self_mirror_highlights" USING "btree" ("owner_user_id");



CREATE INDEX "idx_self_mirror_highlights_user" ON "public"."self_mirror_highlights" USING "btree" ("user_id", "created_at");



CREATE INDEX "idx_self_mirror_sessions__user_id" ON "public"."self_mirror_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_self_mirror_sessions__user_id__created_at_desc" ON "public"."self_mirror_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_self_mirror_sessions_owner_user_id" ON "public"."self_mirror_sessions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_self_mirror_snapshots__user_id" ON "public"."self_mirror_snapshots" USING "btree" ("user_id");



CREATE INDEX "idx_self_mirror_snapshots__user_id__created_at_desc" ON "public"."self_mirror_snapshots" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_self_mirror_snapshots_owner_user_id" ON "public"."self_mirror_snapshots" USING "btree" ("owner_user_id");



CREATE UNIQUE INDEX "idx_self_mirror_snapshots_user_date" ON "public"."self_mirror_snapshots" USING "btree" ("user_id", "snapshot_date");



CREATE INDEX "idx_self_perception_signals__user_id" ON "public"."self_perception_signals" USING "btree" ("user_id");



CREATE INDEX "idx_self_perception_signals__user_id__created_at_desc" ON "public"."self_perception_signals" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_self_perception_signals_owner_user_id" ON "public"."self_perception_signals" USING "btree" ("owner_user_id");



CREATE INDEX "idx_sim_decision_trees__user_id" ON "public"."sim_decision_trees" USING "btree" ("user_id");



CREATE INDEX "idx_sim_decision_trees__user_id__created_at_desc" ON "public"."sim_decision_trees" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_sim_decision_trees_owner_user_id" ON "public"."sim_decision_trees" USING "btree" ("owner_user_id");



CREATE INDEX "idx_sim_history__user_id" ON "public"."sim_history" USING "btree" ("user_id");



CREATE INDEX "idx_sim_history__user_id__created_at_desc" ON "public"."sim_history" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_sim_history_owner_user_id" ON "public"."sim_history" USING "btree" ("owner_user_id");



CREATE INDEX "idx_sim_runs__user_id" ON "public"."sim_runs" USING "btree" ("user_id");



CREATE INDEX "idx_sim_runs__user_id__created_at_desc" ON "public"."sim_runs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_sim_runs_owner_user_id" ON "public"."sim_runs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_sim_runs_scenario" ON "public"."sim_runs" USING "btree" ("scenario_id");



CREATE INDEX "idx_sim_runs_user" ON "public"."sim_runs" USING "btree" ("user_id");



CREATE INDEX "idx_sim_scenarios__user_id" ON "public"."sim_scenarios" USING "btree" ("user_id");



CREATE INDEX "idx_sim_scenarios__user_id__created_at_desc" ON "public"."sim_scenarios" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_sim_scenarios_owner_user_id" ON "public"."sim_scenarios" USING "btree" ("owner_user_id");



CREATE INDEX "idx_sim_scenarios_user" ON "public"."sim_scenarios" USING "btree" ("user_id");



CREATE INDEX "idx_sim_simulations__user_id" ON "public"."sim_simulations" USING "btree" ("user_id");



CREATE INDEX "idx_sim_simulations__user_id__created_at_desc" ON "public"."sim_simulations" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_sim_simulations_owner_user_id" ON "public"."sim_simulations" USING "btree" ("owner_user_id");



CREATE INDEX "idx_sim_templates_owner_user_id" ON "public"."sim_templates" USING "btree" ("owner_user_id");



CREATE INDEX "idx_sim_what_ifs__user_id" ON "public"."sim_what_ifs" USING "btree" ("user_id");



CREATE INDEX "idx_sim_what_ifs__user_id__created_at_desc" ON "public"."sim_what_ifs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_sim_what_ifs_owner_user_id" ON "public"."sim_what_ifs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_simulation_fix_plans__user_id" ON "public"."simulation_fix_plans" USING "btree" ("user_id");



CREATE INDEX "idx_simulation_fix_plans__user_id__created_at_desc" ON "public"."simulation_fix_plans" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_simulation_metrics_owner_user_id" ON "public"."simulation_metrics" USING "btree" ("owner_user_id");



CREATE INDEX "idx_simulation_models__user_id" ON "public"."simulation_models" USING "btree" ("user_id");



CREATE INDEX "idx_simulation_models__user_id__created_at_desc" ON "public"."simulation_models" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_simulation_models_owner_user_id" ON "public"."simulation_models" USING "btree" ("owner_user_id");



CREATE INDEX "idx_simulation_outcomes__user_id" ON "public"."simulation_outcomes" USING "btree" ("user_id");



CREATE INDEX "idx_simulation_outcomes__user_id__created_at_desc" ON "public"."simulation_outcomes" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_simulation_outcomes_owner_user_id" ON "public"."simulation_outcomes" USING "btree" ("owner_user_id");



CREATE INDEX "idx_simulation_outcomes_user_run" ON "public"."simulation_outcomes" USING "btree" ("user_id", "run_id");



CREATE INDEX "idx_simulation_policies__user_id" ON "public"."simulation_policies" USING "btree" ("user_id");



CREATE INDEX "idx_simulation_policies__user_id__created_at_desc" ON "public"."simulation_policies" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_simulation_policies__user_id__updated_at_desc" ON "public"."simulation_policies" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_simulation_policies_owner_user_id" ON "public"."simulation_policies" USING "btree" ("owner_user_id");



CREATE INDEX "idx_simulation_runs__user_id" ON "public"."simulation_runs" USING "btree" ("user_id");



CREATE INDEX "idx_simulation_runs__user_id__created_at_desc" ON "public"."simulation_runs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_simulation_runs_owner_user_id" ON "public"."simulation_runs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_simulation_runs_user_time" ON "public"."simulation_runs" USING "btree" ("user_id", "created_at");



CREATE INDEX "idx_simulation_steps__user_id" ON "public"."simulation_steps" USING "btree" ("user_id");



CREATE INDEX "idx_simulation_steps__user_id__created_at_desc" ON "public"."simulation_steps" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_simulation_steps_owner_user_id" ON "public"."simulation_steps" USING "btree" ("owner_user_id");



CREATE INDEX "idx_simulation_steps_timeline" ON "public"."simulation_steps" USING "btree" ("timeline_id", "step_index");



CREATE INDEX "idx_simulation_timelines__user_id" ON "public"."simulation_timelines" USING "btree" ("user_id");



CREATE INDEX "idx_simulation_timelines__user_id__created_at_desc" ON "public"."simulation_timelines" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_simulation_timelines_owner_user_id" ON "public"."simulation_timelines" USING "btree" ("owner_user_id");



CREATE INDEX "idx_simulation_timelines_user_run" ON "public"."simulation_timelines" USING "btree" ("user_id", "run_id");



CREATE INDEX "idx_sms_messages__user_id" ON "public"."sms_messages" USING "btree" ("user_id");



CREATE INDEX "idx_sms_messages__user_id__created_at_desc" ON "public"."sms_messages" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_sms_messages_owner_user_id" ON "public"."sms_messages" USING "btree" ("owner_user_id");



CREATE INDEX "idx_sms_user_id" ON "public"."sms_messages" USING "btree" ("user_id");



CREATE INDEX "idx_social_edges__user_id" ON "public"."social_edges" USING "btree" ("user_id");



CREATE INDEX "idx_social_edges__user_id__created_at_desc" ON "public"."social_edges" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_social_edges_owner_user_id" ON "public"."social_edges" USING "btree" ("owner_user_id");



CREATE INDEX "idx_social_edges_user" ON "public"."social_edges" USING "btree" ("user_id");



CREATE INDEX "idx_social_entities__user_id" ON "public"."social_entities" USING "btree" ("user_id");



CREATE INDEX "idx_social_entities__user_id__created_at_desc" ON "public"."social_entities" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_social_entities__user_id__updated_at_desc" ON "public"."social_entities" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_social_entities_owner_user_id" ON "public"."social_entities" USING "btree" ("owner_user_id");



CREATE INDEX "idx_social_entities_user" ON "public"."social_entities" USING "btree" ("user_id");



CREATE INDEX "idx_social_insights__user_id" ON "public"."social_insights" USING "btree" ("user_id");



CREATE INDEX "idx_social_insights__user_id__created_at_desc" ON "public"."social_insights" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_social_insights_owner_user_id" ON "public"."social_insights" USING "btree" ("owner_user_id");



CREATE INDEX "idx_social_insights_user_time" ON "public"."social_insights" USING "btree" ("user_id", "generated_at");



CREATE INDEX "idx_social_nodes__user_id" ON "public"."social_nodes" USING "btree" ("user_id");



CREATE INDEX "idx_social_nodes__user_id__created_at_desc" ON "public"."social_nodes" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_social_nodes__user_id__updated_at_desc" ON "public"."social_nodes" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_social_nodes_owner_user_id" ON "public"."social_nodes" USING "btree" ("owner_user_id");



CREATE INDEX "idx_social_nodes_user" ON "public"."social_nodes" USING "btree" ("user_id");



CREATE INDEX "idx_social_recommendations__user_id" ON "public"."social_recommendations" USING "btree" ("user_id");



CREATE INDEX "idx_social_recommendations__user_id__created_at_desc" ON "public"."social_recommendations" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_social_recommendations_owner_user_id" ON "public"."social_recommendations" USING "btree" ("owner_user_id");



CREATE INDEX "idx_social_recommendations_user" ON "public"."social_recommendations" USING "btree" ("user_id", "recommended_for_date");



CREATE INDEX "idx_social_risk_events__user_id" ON "public"."social_risk_events" USING "btree" ("user_id");



CREATE INDEX "idx_social_risk_events__user_id__created_at_desc" ON "public"."social_risk_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_social_risk_events_owner_user_id" ON "public"."social_risk_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_social_risk_events_user" ON "public"."social_risk_events" USING "btree" ("user_id", "created_at");



CREATE INDEX "idx_social_state_snapshots__user_id" ON "public"."social_state_snapshots" USING "btree" ("user_id");



CREATE INDEX "idx_social_state_snapshots__user_id__created_at_desc" ON "public"."social_state_snapshots" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_social_state_snapshots_owner_user_id" ON "public"."social_state_snapshots" USING "btree" ("owner_user_id");



CREATE UNIQUE INDEX "idx_social_state_snapshots_user_date" ON "public"."social_state_snapshots" USING "btree" ("user_id", "snapshot_date");



CREATE INDEX "idx_somatic_alerts__user_id" ON "public"."somatic_alerts" USING "btree" ("user_id");



CREATE INDEX "idx_somatic_alerts__user_id__created_at_desc" ON "public"."somatic_alerts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_somatic_alerts_owner_user_id" ON "public"."somatic_alerts" USING "btree" ("owner_user_id");



CREATE INDEX "idx_somatic_alerts_user_time" ON "public"."somatic_alerts" USING "btree" ("user_id", "occurred_at");



CREATE INDEX "idx_somatic_daily_metrics__user_id" ON "public"."somatic_daily_metrics" USING "btree" ("user_id");



CREATE INDEX "idx_somatic_daily_metrics__user_id__created_at_desc" ON "public"."somatic_daily_metrics" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_somatic_daily_metrics__user_id__updated_at_desc" ON "public"."somatic_daily_metrics" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_somatic_daily_metrics_owner_user_id" ON "public"."somatic_daily_metrics" USING "btree" ("owner_user_id");



CREATE INDEX "idx_somatic_daily_metrics_user" ON "public"."somatic_daily_metrics" USING "btree" ("user_id", "metrics_date");



CREATE INDEX "idx_somatic_device_settings__user_id" ON "public"."somatic_device_settings" USING "btree" ("user_id");



CREATE INDEX "idx_somatic_device_settings__user_id__created_at_desc" ON "public"."somatic_device_settings" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_somatic_device_settings_owner_user_id" ON "public"."somatic_device_settings" USING "btree" ("owner_user_id");



CREATE UNIQUE INDEX "idx_somatic_device_settings_user" ON "public"."somatic_device_settings" USING "btree" ("user_id");



CREATE INDEX "idx_somatic_patterns__user_id" ON "public"."somatic_patterns" USING "btree" ("user_id");



CREATE INDEX "idx_somatic_patterns__user_id__created_at_desc" ON "public"."somatic_patterns" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_somatic_patterns__user_id__updated_at_desc" ON "public"."somatic_patterns" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_somatic_patterns_owner_user_id" ON "public"."somatic_patterns" USING "btree" ("owner_user_id");



CREATE UNIQUE INDEX "idx_somatic_patterns_user" ON "public"."somatic_patterns" USING "btree" ("user_id");



CREATE INDEX "idx_somatic_raw_device_events__user_id" ON "public"."somatic_raw_device_events" USING "btree" ("user_id");



CREATE INDEX "idx_somatic_raw_device_events__user_id__created_at_desc" ON "public"."somatic_raw_device_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_somatic_raw_device_events_owner_user_id" ON "public"."somatic_raw_device_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_somatic_raw_events_user_time" ON "public"."somatic_raw_device_events" USING "btree" ("user_id", "occurred_at");



CREATE INDEX "idx_somatic_samples__user_id" ON "public"."somatic_samples" USING "btree" ("user_id");



CREATE INDEX "idx_somatic_samples__user_id__created_at_desc" ON "public"."somatic_samples" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_somatic_samples_owner_user_id" ON "public"."somatic_samples" USING "btree" ("owner_user_id");



CREATE INDEX "idx_somatic_samples_user_time" ON "public"."somatic_samples" USING "btree" ("user_id", "sampled_at");



CREATE INDEX "idx_somatic_state_daily__user_id" ON "public"."somatic_state_daily" USING "btree" ("user_id");



CREATE INDEX "idx_somatic_state_daily__user_id__created_at_desc" ON "public"."somatic_state_daily" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_somatic_state_daily__user_id__updated_at_desc" ON "public"."somatic_state_daily" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_somatic_state_daily_owner_user_id" ON "public"."somatic_state_daily" USING "btree" ("owner_user_id");



CREATE INDEX "idx_strategic_conflicts__user_id" ON "public"."strategic_conflicts" USING "btree" ("user_id");



CREATE INDEX "idx_strategic_conflicts__user_id__created_at_desc" ON "public"."strategic_conflicts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_strategic_conflicts_owner_user_id" ON "public"."strategic_conflicts" USING "btree" ("owner_user_id");



CREATE INDEX "idx_strategic_conflicts_user_time" ON "public"."strategic_conflicts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_strategic_domains__user_id" ON "public"."strategic_domains" USING "btree" ("user_id");



CREATE INDEX "idx_strategic_domains__user_id__created_at_desc" ON "public"."strategic_domains" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_strategic_domains_owner_user_id" ON "public"."strategic_domains" USING "btree" ("owner_user_id");



CREATE INDEX "idx_strategic_equilibria__user_id" ON "public"."strategic_equilibria" USING "btree" ("user_id");



CREATE INDEX "idx_strategic_equilibria__user_id__created_at_desc" ON "public"."strategic_equilibria" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_strategic_equilibria_owner_user_id" ON "public"."strategic_equilibria" USING "btree" ("owner_user_id");



CREATE INDEX "idx_strategic_equilibria_user_time" ON "public"."strategic_equilibria" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_strategic_objectives__user_id" ON "public"."strategic_objectives" USING "btree" ("user_id");



CREATE INDEX "idx_strategic_objectives__user_id__created_at_desc" ON "public"."strategic_objectives" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_strategic_objectives_owner_user_id" ON "public"."strategic_objectives" USING "btree" ("owner_user_id");



CREATE INDEX "idx_strategic_plans__user_id" ON "public"."strategic_plans" USING "btree" ("user_id");



CREATE INDEX "idx_strategic_plans__user_id__created_at_desc" ON "public"."strategic_plans" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_strategic_plans_owner_user_id" ON "public"."strategic_plans" USING "btree" ("owner_user_id");



CREATE INDEX "idx_strategic_playbooks_owner_user_id" ON "public"."strategic_playbooks" USING "btree" ("owner_user_id");



CREATE INDEX "idx_strategic_review_events__user_id" ON "public"."strategic_review_events" USING "btree" ("user_id");



CREATE INDEX "idx_strategic_review_events__user_id__created_at_desc" ON "public"."strategic_review_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_strategic_review_events_owner_user_id" ON "public"."strategic_review_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_strategic_review_events_user_session" ON "public"."strategic_review_events" USING "btree" ("user_id", "session_id");



CREATE INDEX "idx_strategic_state_snapshots__user_id" ON "public"."strategic_state_snapshots" USING "btree" ("user_id");



CREATE INDEX "idx_strategic_state_snapshots_owner_user_id" ON "public"."strategic_state_snapshots" USING "btree" ("owner_user_id");



CREATE INDEX "idx_strategic_state_snapshots_user_time" ON "public"."strategic_state_snapshots" USING "btree" ("user_id", "snapshot_time" DESC);



CREATE INDEX "idx_strategist_sessions__user_id" ON "public"."strategist_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_strategist_sessions__user_id__created_at_desc" ON "public"."strategist_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_strategist_sessions_owner_user_id" ON "public"."strategist_sessions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_strategist_sessions_user_time" ON "public"."strategist_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_strategy_actions_owner_user_id" ON "public"."strategy_actions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_strategy_feedback__user_id" ON "public"."strategy_feedback" USING "btree" ("user_id");



CREATE INDEX "idx_strategy_feedback__user_id__created_at_desc" ON "public"."strategy_feedback" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_strategy_feedback_owner_user_id" ON "public"."strategy_feedback" USING "btree" ("owner_user_id");



CREATE INDEX "idx_strategy_feedback_user_time" ON "public"."strategy_feedback" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_strategy_paths_owner_user_id" ON "public"."strategy_paths" USING "btree" ("owner_user_id");



CREATE INDEX "idx_strategy_pillars_owner_user_id" ON "public"."strategy_pillars" USING "btree" ("owner_user_id");



CREATE INDEX "idx_strategy_recommendations__user_id" ON "public"."strategy_recommendations" USING "btree" ("user_id");



CREATE INDEX "idx_strategy_recommendations__user_id__created_at_desc" ON "public"."strategy_recommendations" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_strategy_recommendations_owner_user_id" ON "public"."strategy_recommendations" USING "btree" ("owner_user_id");



CREATE INDEX "idx_strategy_snapshots__user_id" ON "public"."strategy_snapshots" USING "btree" ("user_id");



CREATE INDEX "idx_strategy_snapshots__user_id__created_at_desc" ON "public"."strategy_snapshots" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_strategy_snapshots_owner_user_id" ON "public"."strategy_snapshots" USING "btree" ("owner_user_id");



CREATE INDEX "idx_streaks__user_id" ON "public"."streaks" USING "btree" ("user_id");



CREATE INDEX "idx_streaks__user_id__created_at_desc" ON "public"."streaks" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_streaks__user_id__updated_at_desc" ON "public"."streaks" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_streaks_owner_user_id" ON "public"."streaks" USING "btree" ("owner_user_id");



CREATE INDEX "idx_streaks_user" ON "public"."streaks" USING "btree" ("user_id");



CREATE INDEX "idx_system_capabilities_owner_user_id" ON "public"."system_capabilities" USING "btree" ("owner_user_id");



CREATE INDEX "idx_system_capability_health_owner_user_id" ON "public"."system_capability_health" USING "btree" ("owner_user_id");



CREATE INDEX "idx_system_changelog_owner_user_id" ON "public"."system_changelog" USING "btree" ("owner_user_id");



CREATE INDEX "idx_system_diagnostics_findings_owner_user_id" ON "public"."system_diagnostics_findings" USING "btree" ("owner_user_id");



CREATE INDEX "idx_system_diagnostics_runs_owner_user_id" ON "public"."system_diagnostics_runs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_system_experiment_runs_owner_user_id" ON "public"."system_experiment_runs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_system_experiments_owner_user_id" ON "public"."system_experiments" USING "btree" ("owner_user_id");



CREATE INDEX "idx_system_improvement_ideas_owner_user_id" ON "public"."system_improvement_ideas" USING "btree" ("owner_user_id");



CREATE INDEX "idx_system_module_health_owner_user_id" ON "public"."system_module_health" USING "btree" ("owner_user_id");



CREATE INDEX "idx_system_module_metrics_owner_user_id" ON "public"."system_module_metrics" USING "btree" ("owner_user_id");



CREATE INDEX "idx_system_modules_owner_user_id" ON "public"."system_modules" USING "btree" ("owner_user_id");



CREATE INDEX "idx_system_user_feedback__user_id" ON "public"."system_user_feedback" USING "btree" ("user_id");



CREATE INDEX "idx_system_user_feedback__user_id__created_at_desc" ON "public"."system_user_feedback" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_system_user_feedback_owner_user_id" ON "public"."system_user_feedback" USING "btree" ("owner_user_id");



CREATE INDEX "idx_task_events__user_id" ON "public"."task_events" USING "btree" ("user_id");



CREATE INDEX "idx_task_events__user_id__created_at_desc" ON "public"."task_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_tasks__user_id" ON "public"."tasks" USING "btree" ("user_id");



CREATE INDEX "idx_tasks__user_id__created_at_desc" ON "public"."tasks" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_tasks__user_id__updated_at_desc" ON "public"."tasks" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_tasks_owner_user_id" ON "public"."tasks" USING "btree" ("owner_user_id");



CREATE INDEX "idx_tasks_trace" ON "public"."tasks" USING "btree" ("user_id", "trace_id", "created_at" DESC);



CREATE INDEX "idx_tasks_user_due" ON "public"."tasks" USING "btree" ("user_id_uuid", "due_at" DESC NULLS LAST);



CREATE INDEX "idx_tasks_user_id_due" ON "public"."tasks" USING "btree" ("user_id", "due_date");



CREATE INDEX "idx_tasks_user_id_status" ON "public"."tasks" USING "btree" ("user_id", "status");



CREATE INDEX "idx_tasks_user_id_text" ON "public"."tasks" USING "btree" ("user_id_text");



CREATE INDEX "idx_tasks_user_status" ON "public"."tasks" USING "btree" ("user_id_uuid", "status");



CREATE INDEX "idx_tb_chapters__user_id" ON "public"."tb_chapters" USING "btree" ("user_id");



CREATE INDEX "idx_tb_chapters__user_id__created_at_desc" ON "public"."tb_chapters" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_tb_chapters_owner_user_id" ON "public"."tb_chapters" USING "btree" ("owner_user_id");



CREATE INDEX "idx_tb_context_snapshots__user_id" ON "public"."tb_context_snapshots" USING "btree" ("user_id");



CREATE INDEX "idx_tb_context_snapshots__user_id__created_at_desc" ON "public"."tb_context_snapshots" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_tb_context_snapshots_owner_user_id" ON "public"."tb_context_snapshots" USING "btree" ("owner_user_id");



CREATE INDEX "idx_tb_edges__user_id" ON "public"."tb_edges" USING "btree" ("user_id");



CREATE INDEX "idx_tb_edges__user_id__created_at_desc" ON "public"."tb_edges" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_tb_edges_owner_user_id" ON "public"."tb_edges" USING "btree" ("owner_user_id");



CREATE INDEX "idx_tb_embeddings__user_id" ON "public"."tb_embeddings" USING "btree" ("user_id");



CREATE INDEX "idx_tb_embeddings__user_id__created_at_desc" ON "public"."tb_embeddings" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_tb_embeddings_owner_user_id" ON "public"."tb_embeddings" USING "btree" ("owner_user_id");



CREATE INDEX "idx_tb_entities__user_id" ON "public"."tb_entities" USING "btree" ("user_id");



CREATE INDEX "idx_tb_entities__user_id__created_at_desc" ON "public"."tb_entities" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_tb_entities__user_id__updated_at_desc" ON "public"."tb_entities" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_tb_entities_owner_user_id" ON "public"."tb_entities" USING "btree" ("owner_user_id");



CREATE INDEX "idx_tb_entity_edges__user_id" ON "public"."tb_entity_edges" USING "btree" ("user_id");



CREATE INDEX "idx_tb_entity_edges__user_id__created_at_desc" ON "public"."tb_entity_edges" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_tb_entity_edges__user_id__updated_at_desc" ON "public"."tb_entity_edges" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_tb_entity_edges_owner_user_id" ON "public"."tb_entity_edges" USING "btree" ("owner_user_id");



CREATE INDEX "idx_tb_entity_fragment_links__user_id" ON "public"."tb_entity_fragment_links" USING "btree" ("user_id");



CREATE INDEX "idx_tb_entity_fragment_links__user_id__created_at_desc" ON "public"."tb_entity_fragment_links" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_tb_entity_fragment_links_owner_user_id" ON "public"."tb_entity_fragment_links" USING "btree" ("owner_user_id");



CREATE INDEX "idx_tb_insights__user_id" ON "public"."tb_insights" USING "btree" ("user_id");



CREATE INDEX "idx_tb_insights__user_id__created_at_desc" ON "public"."tb_insights" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_tb_insights_owner_user_id" ON "public"."tb_insights" USING "btree" ("owner_user_id");



CREATE INDEX "idx_tb_memory_fragments__user_id" ON "public"."tb_memory_fragments" USING "btree" ("user_id");



CREATE INDEX "idx_tb_memory_fragments__user_id__created_at_desc" ON "public"."tb_memory_fragments" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_tb_memory_fragments__user_id__updated_at_desc" ON "public"."tb_memory_fragments" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_tb_memory_fragments_owner_user_id" ON "public"."tb_memory_fragments" USING "btree" ("owner_user_id");



CREATE INDEX "idx_tb_node_types_owner_user_id" ON "public"."tb_node_types" USING "btree" ("owner_user_id");



CREATE INDEX "idx_tb_nodes__user_id" ON "public"."tb_nodes" USING "btree" ("user_id");



CREATE INDEX "idx_tb_nodes__user_id__created_at_desc" ON "public"."tb_nodes" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_tb_nodes_owner_user_id" ON "public"."tb_nodes" USING "btree" ("owner_user_id");



CREATE INDEX "idx_tb_raw_events__user_id" ON "public"."tb_raw_events" USING "btree" ("user_id");



CREATE INDEX "idx_tb_raw_events__user_id__created_at_desc" ON "public"."tb_raw_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_tb_raw_events_owner_user_id" ON "public"."tb_raw_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_tb_user_patterns__user_id" ON "public"."tb_user_patterns" USING "btree" ("user_id");



CREATE INDEX "idx_tb_user_patterns__user_id__created_at_desc" ON "public"."tb_user_patterns" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_tb_user_patterns__user_id__updated_at_desc" ON "public"."tb_user_patterns" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_tb_user_patterns_owner_user_id" ON "public"."tb_user_patterns" USING "btree" ("owner_user_id");



CREATE INDEX "idx_tbe_source" ON "public"."third_brain_events" USING "btree" ("source");



CREATE INDEX "idx_tbe_user_id" ON "public"."third_brain_events" USING "btree" ("user_id");



CREATE INDEX "idx_tbe_user_occurred" ON "public"."third_brain_events" USING "btree" ("user_id", "occurred_at" DESC);



CREATE INDEX "idx_tbe_user_type" ON "public"."third_brain_events" USING "btree" ("user_id", "type");



CREATE INDEX "idx_tbi_related_key" ON "public"."third_brain_insights" USING "btree" ("related_key");



CREATE INDEX "idx_tbi_severity" ON "public"."third_brain_insights" USING "btree" ("user_id", "severity" DESC);



CREATE INDEX "idx_tbi_user_id" ON "public"."third_brain_insights" USING "btree" ("user_id");



CREATE INDEX "idx_tbi_user_kind" ON "public"."third_brain_insights" USING "btree" ("user_id", "kind");



CREATE INDEX "idx_tbi_user_status" ON "public"."third_brain_insights" USING "btree" ("user_id", "status");



CREATE INDEX "idx_tbm_importance" ON "public"."third_brain_memories" USING "btree" ("user_id", "importance" DESC);



CREATE INDEX "idx_tbm_user_category" ON "public"."third_brain_memories" USING "btree" ("user_id", "category");



CREATE INDEX "idx_tbm_user_id" ON "public"."third_brain_memories" USING "btree" ("user_id");



CREATE INDEX "idx_tbm_user_key" ON "public"."third_brain_memories" USING "btree" ("user_id", "key");



CREATE INDEX "idx_teach_active" ON "public"."teachings" USING "btree" ("user_id", "is_active") WHERE ("is_active" = true);



CREATE INDEX "idx_teach_type" ON "public"."teachings" USING "btree" ("user_id", "type");



CREATE INDEX "idx_teach_user" ON "public"."teachings" USING "btree" ("user_id");



CREATE INDEX "idx_teachings__user_id" ON "public"."teachings" USING "btree" ("user_id");



CREATE INDEX "idx_teachings__user_id__created_at_desc" ON "public"."teachings" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_teachings__user_id__updated_at_desc" ON "public"."teachings" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_teachings_owner_user_id" ON "public"."teachings" USING "btree" ("owner_user_id");



CREATE INDEX "idx_telemetry_user" ON "public"."dashboard_telemetry" USING "btree" ("user_id", "created_at");



CREATE INDEX "idx_theory_of_mind_profiles__user_id" ON "public"."theory_of_mind_profiles" USING "btree" ("user_id");



CREATE INDEX "idx_theory_of_mind_profiles__user_id__created_at_desc" ON "public"."theory_of_mind_profiles" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_theory_of_mind_profiles__user_id__updated_at_desc" ON "public"."theory_of_mind_profiles" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_theory_of_mind_profiles_owner_user_id" ON "public"."theory_of_mind_profiles" USING "btree" ("owner_user_id");



CREATE INDEX "idx_third_brain_events__user_id" ON "public"."third_brain_events" USING "btree" ("user_id");



CREATE INDEX "idx_third_brain_events__user_id__created_at_desc" ON "public"."third_brain_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_third_brain_events_owner_user_id" ON "public"."third_brain_events" USING "btree" ("owner_user_id");



CREATE INDEX "idx_third_brain_insights__user_id" ON "public"."third_brain_insights" USING "btree" ("user_id");



CREATE INDEX "idx_third_brain_insights__user_id__created_at_desc" ON "public"."third_brain_insights" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_third_brain_insights_owner_user_id" ON "public"."third_brain_insights" USING "btree" ("owner_user_id");



CREATE INDEX "idx_third_brain_memories__user_id" ON "public"."third_brain_memories" USING "btree" ("user_id");



CREATE INDEX "idx_third_brain_memories__user_id__created_at_desc" ON "public"."third_brain_memories" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_third_brain_memories_owner_user_id" ON "public"."third_brain_memories" USING "btree" ("owner_user_id");



CREATE INDEX "idx_timeline_coach_sessions__user_id" ON "public"."timeline_coach_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_timeline_coach_sessions__user_id__created_at_desc" ON "public"."timeline_coach_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_timeline_coach_sessions_owner_user_id" ON "public"."timeline_coach_sessions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_timeline_commitments__user_id" ON "public"."timeline_commitments" USING "btree" ("user_id");



CREATE INDEX "idx_timeline_commitments__user_id__created_at_desc" ON "public"."timeline_commitments" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_timeline_commitments_owner_user_id" ON "public"."timeline_commitments" USING "btree" ("owner_user_id");



CREATE INDEX "idx_timeline_commitments_user" ON "public"."timeline_commitments" USING "btree" ("user_id");



CREATE INDEX "idx_timeline_decisions__user_id" ON "public"."timeline_decisions" USING "btree" ("user_id");



CREATE INDEX "idx_timeline_decisions__user_id__created_at_desc" ON "public"."timeline_decisions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_timeline_decisions_owner_user_id" ON "public"."timeline_decisions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_timeline_decisions_user" ON "public"."timeline_decisions" USING "btree" ("user_id", "created_at");



CREATE INDEX "idx_timeline_preference_profile__user_id" ON "public"."timeline_preference_profile" USING "btree" ("user_id");



CREATE INDEX "idx_timeline_preference_profile__user_id__created_at_desc" ON "public"."timeline_preference_profile" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_timeline_preference_profile__user_id__updated_at_desc" ON "public"."timeline_preference_profile" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_timeline_preference_profile_owner_user_id" ON "public"."timeline_preference_profile" USING "btree" ("owner_user_id");



CREATE UNIQUE INDEX "idx_timeline_preference_profile_user" ON "public"."timeline_preference_profile" USING "btree" ("user_id");



CREATE INDEX "idx_timeline_reflections__user_id" ON "public"."timeline_reflections" USING "btree" ("user_id");



CREATE INDEX "idx_timeline_reflections__user_id__created_at_desc" ON "public"."timeline_reflections" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_timeline_reflections_owner_user_id" ON "public"."timeline_reflections" USING "btree" ("owner_user_id");



CREATE INDEX "idx_timeline_reflections_user" ON "public"."timeline_reflections" USING "btree" ("user_id", "created_at");



CREATE UNIQUE INDEX "idx_tom_profile_user_entity" ON "public"."theory_of_mind_profiles" USING "btree" ("user_id", "entity_id");



CREATE INDEX "idx_up_active" ON "public"."user_packs" USING "btree" ("user_id", "is_active") WHERE ("is_active" = true);



CREATE INDEX "idx_up_user" ON "public"."user_packs" USING "btree" ("user_id");



CREATE INDEX "idx_usage_logs__user_id" ON "public"."usage_logs" USING "btree" ("user_id");



CREATE INDEX "idx_usage_logs__user_id__created_at_desc" ON "public"."usage_logs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_usage_logs_created" ON "public"."usage_logs" USING "btree" ("created_at");



CREATE INDEX "idx_usage_logs_owner_user_id" ON "public"."usage_logs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_usage_logs_user" ON "public"."usage_logs" USING "btree" ("user_id");



CREATE INDEX "idx_usage_logs_user_created" ON "public"."usage_logs" USING "btree" ("user_id", "created_at");



CREATE INDEX "idx_user_agi_settings__user_id" ON "public"."user_agi_settings" USING "btree" ("user_id");



CREATE INDEX "idx_user_agi_settings_owner_user_id" ON "public"."user_agi_settings" USING "btree" ("owner_user_id");



CREATE INDEX "idx_user_archetype_profiles__user_id" ON "public"."user_archetype_profiles" USING "btree" ("user_id");



CREATE INDEX "idx_user_archetype_profiles__user_id__created_at_desc" ON "public"."user_archetype_profiles" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_user_archetype_profiles__user_id__updated_at_desc" ON "public"."user_archetype_profiles" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_user_archetype_profiles_owner_user_id" ON "public"."user_archetype_profiles" USING "btree" ("owner_user_id");



CREATE INDEX "idx_user_dashboard_layouts__user_id" ON "public"."user_dashboard_layouts" USING "btree" ("user_id");



CREATE INDEX "idx_user_dashboard_layouts__user_id__created_at_desc" ON "public"."user_dashboard_layouts" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_user_dashboard_layouts__user_id__updated_at_desc" ON "public"."user_dashboard_layouts" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_user_dashboard_layouts_owner_user_id" ON "public"."user_dashboard_layouts" USING "btree" ("owner_user_id");



CREATE INDEX "idx_user_experiment_arms_owner_user_id" ON "public"."user_experiment_arms" USING "btree" ("owner_user_id");



CREATE INDEX "idx_user_experiment_data_points_owner_user_id" ON "public"."user_experiment_data_points" USING "btree" ("owner_user_id");



CREATE INDEX "idx_user_experiment_results_owner_user_id" ON "public"."user_experiment_results" USING "btree" ("owner_user_id");



CREATE INDEX "idx_user_experiments__user_id" ON "public"."user_experiments" USING "btree" ("user_id");



CREATE INDEX "idx_user_experiments__user_id__created_at_desc" ON "public"."user_experiments" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_user_experiments__user_id__updated_at_desc" ON "public"."user_experiments" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_user_experiments_owner_user_id" ON "public"."user_experiments" USING "btree" ("owner_user_id");



CREATE INDEX "idx_user_focus_profile__user_id" ON "public"."user_focus_profile" USING "btree" ("user_id");



CREATE INDEX "idx_user_focus_profile__user_id__created_at_desc" ON "public"."user_focus_profile" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_user_focus_profile__user_id__updated_at_desc" ON "public"."user_focus_profile" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_user_focus_profile_owner_user_id" ON "public"."user_focus_profile" USING "btree" ("owner_user_id");



CREATE INDEX "idx_user_interview_sessions__user_id" ON "public"."user_interview_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_user_job_profiles__user_id" ON "public"."user_job_profiles" USING "btree" ("user_id");



CREATE INDEX "idx_user_job_profiles__user_id__created_at_desc" ON "public"."user_job_profiles" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_user_job_profiles__user_id__updated_at_desc" ON "public"."user_job_profiles" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_user_job_profiles_owner_user_id" ON "public"."user_job_profiles" USING "btree" ("owner_user_id");



CREATE INDEX "idx_user_mythic_coach_settings__user_id" ON "public"."user_mythic_coach_settings" USING "btree" ("user_id");



CREATE INDEX "idx_user_mythic_coach_settings_owner_user_id" ON "public"."user_mythic_coach_settings" USING "btree" ("owner_user_id");



CREATE INDEX "idx_user_mythic_profile__user_id" ON "public"."user_mythic_profile" USING "btree" ("user_id");



CREATE INDEX "idx_user_mythic_profile_owner_user_id" ON "public"."user_mythic_profile" USING "btree" ("owner_user_id");



CREATE INDEX "idx_user_onboarding_state__user_id" ON "public"."user_onboarding_state" USING "btree" ("user_id");



CREATE INDEX "idx_user_onboarding_state__user_id__created_at_desc" ON "public"."user_onboarding_state" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_user_onboarding_state__user_id__updated_at_desc" ON "public"."user_onboarding_state" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_user_onboarding_state_owner_user_id" ON "public"."user_onboarding_state" USING "btree" ("owner_user_id");



CREATE INDEX "idx_user_packs__user_id" ON "public"."user_packs" USING "btree" ("user_id");



CREATE INDEX "idx_user_packs_owner_user_id" ON "public"."user_packs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_user_persona_tuning__user_id" ON "public"."user_persona_tuning" USING "btree" ("user_id");



CREATE INDEX "idx_user_persona_tuning__user_id__created_at_desc" ON "public"."user_persona_tuning" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_user_persona_tuning_owner_user_id" ON "public"."user_persona_tuning" USING "btree" ("owner_user_id");



CREATE INDEX "idx_user_philosophy_progress__user_id" ON "public"."user_philosophy_progress" USING "btree" ("user_id");



CREATE INDEX "idx_user_philosophy_progress__user_id__created_at_desc" ON "public"."user_philosophy_progress" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_user_philosophy_progress_owner_user_id" ON "public"."user_philosophy_progress" USING "btree" ("owner_user_id");



CREATE INDEX "idx_user_plugins__user_id" ON "public"."user_plugins" USING "btree" ("user_id");



CREATE INDEX "idx_user_plugins__user_id__updated_at_desc" ON "public"."user_plugins" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_user_plugins_owner_user_id" ON "public"."user_plugins" USING "btree" ("owner_user_id");



CREATE INDEX "idx_user_prefs__user_id" ON "public"."user_prefs" USING "btree" ("user_id");



CREATE INDEX "idx_user_prefs__user_id__created_at_desc" ON "public"."user_prefs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_user_prefs__user_id__updated_at_desc" ON "public"."user_prefs" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_user_profiles__user_id" ON "public"."user_profiles" USING "btree" ("user_id");



CREATE INDEX "idx_user_profiles__user_id__created_at_desc" ON "public"."user_profiles" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_user_profiles__user_id__updated_at_desc" ON "public"."user_profiles" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_user_profiles_owner_user_id" ON "public"."user_profiles" USING "btree" ("owner_user_id");



CREATE INDEX "idx_user_profiles_plan" ON "public"."user_profiles" USING "btree" ("plan");



CREATE INDEX "idx_user_profiles_referral_code" ON "public"."user_profiles" USING "btree" ("referral_code");



CREATE INDEX "idx_user_profiles_stripe_customer" ON "public"."user_profiles" USING "btree" ("stripe_customer_id");



CREATE INDEX "idx_user_profiles_user_id" ON "public"."user_profiles" USING "btree" ("user_id");



CREATE INDEX "idx_user_safety_settings__user_id" ON "public"."user_safety_settings" USING "btree" ("user_id");



CREATE INDEX "idx_user_safety_settings__user_id__created_at_desc" ON "public"."user_safety_settings" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_user_safety_settings__user_id__updated_at_desc" ON "public"."user_safety_settings" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_user_safety_settings_owner_user_id" ON "public"."user_safety_settings" USING "btree" ("owner_user_id");



CREATE INDEX "idx_user_settings__user_id" ON "public"."user_settings" USING "btree" ("user_id");



CREATE INDEX "idx_user_settings__user_id__updated_at_desc" ON "public"."user_settings" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_users_owner_user_id" ON "public"."users" USING "btree" ("owner_user_id");



CREATE INDEX "idx_value_profile__user_id" ON "public"."value_profile" USING "btree" ("user_id");



CREATE INDEX "idx_value_profile__user_id__created_at_desc" ON "public"."value_profile" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_value_profile__user_id__updated_at_desc" ON "public"."value_profile" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_value_profile_owner_user_id" ON "public"."value_profile" USING "btree" ("owner_user_id");



CREATE UNIQUE INDEX "idx_value_profile_user" ON "public"."value_profile" USING "btree" ("user_id");



CREATE INDEX "idx_vault_access_log__user_id" ON "public"."vault_access_log" USING "btree" ("user_id");



CREATE INDEX "idx_vault_access_log__user_id__created_at_desc" ON "public"."vault_access_log" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_vault_access_log_owner_user_id" ON "public"."vault_access_log" USING "btree" ("owner_user_id");



CREATE INDEX "idx_vault_emergency_access__user_id" ON "public"."vault_emergency_access" USING "btree" ("user_id");



CREATE INDEX "idx_vault_emergency_access__user_id__created_at_desc" ON "public"."vault_emergency_access" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_vault_emergency_access_owner_user_id" ON "public"."vault_emergency_access" USING "btree" ("owner_user_id");



CREATE INDEX "idx_vault_items__user_id" ON "public"."vault_items" USING "btree" ("user_id");



CREATE INDEX "idx_vault_items__user_id__created_at_desc" ON "public"."vault_items" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_vault_items__user_id__updated_at_desc" ON "public"."vault_items" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_vault_items_owner_user_id" ON "public"."vault_items" USING "btree" ("owner_user_id");



CREATE INDEX "idx_vault_keys__user_id" ON "public"."vault_keys" USING "btree" ("user_id");



CREATE INDEX "idx_vault_keys__user_id__created_at_desc" ON "public"."vault_keys" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_vault_keys_owner_user_id" ON "public"."vault_keys" USING "btree" ("owner_user_id");



CREATE INDEX "idx_vault_secure_notes__user_id" ON "public"."vault_secure_notes" USING "btree" ("user_id");



CREATE INDEX "idx_vault_secure_notes__user_id__created_at_desc" ON "public"."vault_secure_notes" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_vault_secure_notes__user_id__updated_at_desc" ON "public"."vault_secure_notes" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_vault_secure_notes_owner_user_id" ON "public"."vault_secure_notes" USING "btree" ("owner_user_id");



CREATE INDEX "idx_vertical_metrics__user_id" ON "public"."vertical_metrics" USING "btree" ("user_id");



CREATE INDEX "idx_vertical_metrics__user_id__created_at_desc" ON "public"."vertical_metrics" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_vertical_metrics_owner_user_id" ON "public"."vertical_metrics" USING "btree" ("owner_user_id");



CREATE INDEX "idx_voice_profiles_owner_user_id" ON "public"."voice_profiles" USING "btree" ("owner_user_id");



CREATE INDEX "idx_voice_sessions__user_id" ON "public"."voice_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_voice_sessions_owner_user_id" ON "public"."voice_sessions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_voice_turns__user_id" ON "public"."voice_turns" USING "btree" ("user_id");



CREATE INDEX "idx_voice_turns__user_id__created_at_desc" ON "public"."voice_turns" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_voice_turns_owner_user_id" ON "public"."voice_turns" USING "btree" ("owner_user_id");



CREATE INDEX "idx_voicemails__user_id" ON "public"."voicemails" USING "btree" ("user_id");



CREATE INDEX "idx_voicemails__user_id__created_at_desc" ON "public"."voicemails" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_voicemails_owner_user_id" ON "public"."voicemails" USING "btree" ("owner_user_id");



CREATE INDEX "idx_voicemails_user" ON "public"."voicemails" USING "btree" ("user_id");



CREATE INDEX "idx_weekly_plans__user_id" ON "public"."weekly_plans" USING "btree" ("user_id");



CREATE INDEX "idx_weekly_plans__user_id__created_at_desc" ON "public"."weekly_plans" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_weekly_plans__user_id__updated_at_desc" ON "public"."weekly_plans" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_weekly_plans_owner_user_id" ON "public"."weekly_plans" USING "btree" ("owner_user_id");



CREATE INDEX "idx_what_if_outcomes__user_id" ON "public"."what_if_outcomes" USING "btree" ("user_id");



CREATE INDEX "idx_what_if_outcomes__user_id__created_at_desc" ON "public"."what_if_outcomes" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_what_if_outcomes_owner_user_id" ON "public"."what_if_outcomes" USING "btree" ("owner_user_id");



CREATE INDEX "idx_what_if_runs__user_id" ON "public"."what_if_runs" USING "btree" ("user_id");



CREATE INDEX "idx_what_if_runs__user_id__created_at_desc" ON "public"."what_if_runs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_what_if_runs_owner_user_id" ON "public"."what_if_runs" USING "btree" ("owner_user_id");



CREATE INDEX "idx_what_if_scenarios__user_id" ON "public"."what_if_scenarios" USING "btree" ("user_id");



CREATE INDEX "idx_what_if_scenarios__user_id__created_at_desc" ON "public"."what_if_scenarios" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_what_if_scenarios_owner_user_id" ON "public"."what_if_scenarios" USING "btree" ("owner_user_id");



CREATE INDEX "idx_what_if_scenarios_user_time" ON "public"."what_if_scenarios" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_wisdom_lessons__user_id" ON "public"."wisdom_lessons" USING "btree" ("user_id");



CREATE INDEX "idx_wisdom_lessons__user_id__created_at_desc" ON "public"."wisdom_lessons" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_wisdom_lessons__user_id__updated_at_desc" ON "public"."wisdom_lessons" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_wisdom_lessons_owner_user_id" ON "public"."wisdom_lessons" USING "btree" ("owner_user_id");



CREATE INDEX "idx_wisdom_lessons_user" ON "public"."wisdom_lessons" USING "btree" ("user_id", "status");



CREATE INDEX "idx_wisdom_playbooks__user_id" ON "public"."wisdom_playbooks" USING "btree" ("user_id");



CREATE INDEX "idx_wisdom_playbooks__user_id__created_at_desc" ON "public"."wisdom_playbooks" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_wisdom_playbooks__user_id__updated_at_desc" ON "public"."wisdom_playbooks" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_wisdom_playbooks_owner_user_id" ON "public"."wisdom_playbooks" USING "btree" ("owner_user_id");



CREATE INDEX "idx_wisdom_playbooks_user" ON "public"."wisdom_playbooks" USING "btree" ("user_id");



CREATE INDEX "idx_wisdom_refresh_runs__user_id" ON "public"."wisdom_refresh_runs" USING "btree" ("user_id");



CREATE INDEX "idx_wisdom_refresh_runs__user_id__updated_at_desc" ON "public"."wisdom_refresh_runs" USING "btree" ("user_id", "updated_at" DESC);



CREATE INDEX "idx_work_scoreboard_days_user_day" ON "public"."work_scoreboard_days" USING "btree" ("user_id_uuid", "day" DESC);



CREATE INDEX "idx_workspace_day_log__user_id" ON "public"."workspace_day_log" USING "btree" ("user_id");



CREATE INDEX "idx_workspace_day_log__user_id__created_at_desc" ON "public"."workspace_day_log" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_workspace_day_log_owner_user_id" ON "public"."workspace_day_log" USING "btree" ("owner_user_id");



CREATE INDEX "idx_workspace_focus_sessions__user_id" ON "public"."workspace_focus_sessions" USING "btree" ("user_id");



CREATE INDEX "idx_workspace_focus_sessions__user_id__created_at_desc" ON "public"."workspace_focus_sessions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_workspace_focus_sessions_owner_user_id" ON "public"."workspace_focus_sessions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_workspace_focus_sessions_user_time" ON "public"."workspace_focus_sessions" USING "btree" ("user_id", "started_at");



CREATE INDEX "idx_workspace_focus_states__user_id" ON "public"."workspace_focus_states" USING "btree" ("user_id");



CREATE INDEX "idx_workspace_focus_states__user_id__created_at_desc" ON "public"."workspace_focus_states" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_workspace_focus_states_owner_user_id" ON "public"."workspace_focus_states" USING "btree" ("owner_user_id");



CREATE INDEX "idx_workspace_interrupts__user_id" ON "public"."workspace_interrupts" USING "btree" ("user_id");



CREATE INDEX "idx_workspace_interrupts_owner_user_id" ON "public"."workspace_interrupts" USING "btree" ("owner_user_id");



CREATE INDEX "idx_workspace_interrupts_user" ON "public"."workspace_interrupts" USING "btree" ("user_id", "triggered_at");



CREATE INDEX "idx_workspace_state__user_id" ON "public"."workspace_state" USING "btree" ("user_id");



CREATE INDEX "idx_workspace_state__user_id__created_at_desc" ON "public"."workspace_state" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_workspace_state_owner_user_id" ON "public"."workspace_state" USING "btree" ("owner_user_id");



CREATE INDEX "idx_workspace_state_user_date" ON "public"."workspace_state" USING "btree" ("user_id", "state_date");



CREATE INDEX "idx_workspace_threads__user_id" ON "public"."workspace_threads" USING "btree" ("user_id");



CREATE INDEX "idx_workspace_threads__user_id__created_at_desc" ON "public"."workspace_threads" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_workspace_threads_owner_user_id" ON "public"."workspace_threads" USING "btree" ("owner_user_id");



CREATE INDEX "idx_workspace_threads_user_status" ON "public"."workspace_threads" USING "btree" ("user_id", "status", "last_touched_at");



CREATE INDEX "idx_workspace_timeline_links__user_id" ON "public"."workspace_timeline_links" USING "btree" ("user_id");



CREATE INDEX "idx_workspace_timeline_links__user_id__created_at_desc" ON "public"."workspace_timeline_links" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_workspace_timeline_links_owner_user_id" ON "public"."workspace_timeline_links" USING "btree" ("owner_user_id");



CREATE INDEX "idx_workspace_timeline_links_user_state" ON "public"."workspace_timeline_links" USING "btree" ("user_id", "state_date");



CREATE INDEX "idx_workspaces_owner" ON "public"."workspaces" USING "btree" ("owner_user_id");



CREATE INDEX "idx_wp_user" ON "public"."weekly_plans" USING "btree" ("user_id");



CREATE INDEX "idx_wp_week" ON "public"."weekly_plans" USING "btree" ("user_id", "week_start" DESC);



CREATE INDEX "idx_xp_eval_runs_evidence" ON "public"."xp_evaluation_runs" USING "btree" ("evidence_id");



CREATE INDEX "idx_xp_eval_runs_user_time" ON "public"."xp_evaluation_runs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_xp_evaluation_runs__user_id" ON "public"."xp_evaluation_runs" USING "btree" ("user_id");



CREATE INDEX "idx_xp_evaluation_runs__user_id__created_at_desc" ON "public"."xp_evaluation_runs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_xp_events__user_id" ON "public"."xp_events" USING "btree" ("user_id");



CREATE INDEX "idx_xp_events__user_id__created_at_desc" ON "public"."xp_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_xp_events_user_date" ON "public"."xp_events" USING "btree" ("user_id", "occurred_at" DESC);



CREATE INDEX "idx_xp_ledger__user_id" ON "public"."xp_ledger" USING "btree" ("user_id");



CREATE INDEX "idx_xp_ledger__user_id__created_at_desc" ON "public"."xp_ledger" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_xp_ledger_source" ON "public"."xp_ledger" USING "btree" ("source_kind", "source_id");



CREATE INDEX "idx_xp_ledger_user_time" ON "public"."xp_ledger" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_xp_transactions__user_id" ON "public"."xp_transactions" USING "btree" ("user_id");



CREATE INDEX "idx_xp_transactions__user_id__created_at_desc" ON "public"."xp_transactions" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "idx_xp_transactions_owner_user_id" ON "public"."xp_transactions" USING "btree" ("owner_user_id");



CREATE INDEX "idx_xp_transactions_user" ON "public"."xp_transactions" USING "btree" ("user_id");



CREATE INDEX "idx_xp_user" ON "public"."xp_transactions" USING "btree" ("user_id");



CREATE INDEX "inner_monologue_entries_user_id_idx" ON "public"."inner_monologue_entries" USING "btree" ("user_id");



CREATE INDEX "inner_monologue_entries_user_id_text_idx" ON "public"."inner_monologue_entries" USING "btree" ("user_id_text");



CREATE INDEX "inner_monologue_entries_user_id_uuid_idx" ON "public"."inner_monologue_entries" USING "btree" ("user_id_uuid");



CREATE INDEX "inner_monologue_turns_user_id_idx" ON "public"."inner_monologue_turns" USING "btree" ("user_id");



CREATE INDEX "inner_monologue_turns_user_id_text_idx" ON "public"."inner_monologue_turns" USING "btree" ("user_id_text");



CREATE INDEX "inner_monologue_turns_user_id_uuid_idx" ON "public"."inner_monologue_turns" USING "btree" ("user_id_uuid");



CREATE INDEX "interaction_events_user_id_idx" ON "public"."interaction_events" USING "btree" ("user_id");



CREATE INDEX "interaction_events_user_id_text_idx" ON "public"."interaction_events" USING "btree" ("user_id_text");



CREATE INDEX "interaction_events_user_id_uuid_idx" ON "public"."interaction_events" USING "btree" ("user_id_uuid");



CREATE INDEX "interactions_user_id_idx" ON "public"."interactions" USING "btree" ("user_id");



CREATE INDEX "interactions_user_id_text_idx" ON "public"."interactions" USING "btree" ("user_id_text");



CREATE INDEX "interactions_user_id_uuid_idx" ON "public"."interactions" USING "btree" ("user_id_uuid");



CREATE INDEX "ix_life_arc_autopilot_suggestions_entity" ON "public"."life_arc_autopilot_suggestions" USING "btree" ("user_id", "entity_type", "entity_id");



CREATE INDEX "ix_life_arc_autopilot_suggestions_policy" ON "public"."life_arc_autopilot_suggestions" USING "btree" ("policy_id");



CREATE INDEX "ix_life_arc_autopilot_suggestions_run" ON "public"."life_arc_autopilot_suggestions" USING "btree" ("run_id");



CREATE INDEX "ix_life_arc_autopilot_suggestions_user_snooze" ON "public"."life_arc_autopilot_suggestions" USING "btree" ("user_id", "snoozed_until");



CREATE INDEX "ix_life_arc_autopilot_suggestions_user_status_created" ON "public"."life_arc_autopilot_suggestions" USING "btree" ("user_id", "status", "created_at" DESC);



CREATE INDEX "job_graph_nodes_industry_idx" ON "public"."job_graph_nodes" USING "btree" ("industry_id");



CREATE INDEX "job_kpis_job_idx" ON "public"."job_kpis" USING "btree" ("job_graph_node_id");



CREATE INDEX "job_provider_incidents_provider_at_idx" ON "public"."job_provider_incidents" USING "btree" ("provider", "at" DESC);



CREATE INDEX "job_queue_agents_user_id_idx" ON "public"."job_queue_agents" USING "btree" ("user_id");



CREATE INDEX "job_queue_agents_user_id_text_idx" ON "public"."job_queue_agents" USING "btree" ("user_id_text");



CREATE INDEX "job_queue_agents_user_id_uuid_idx" ON "public"."job_queue_agents" USING "btree" ("user_id_uuid");



CREATE INDEX "job_queue_budget_ledger_user_id_idx" ON "public"."job_queue_budget_ledger" USING "btree" ("user_id");



CREATE INDEX "job_queue_budget_ledger_user_id_text_idx" ON "public"."job_queue_budget_ledger" USING "btree" ("user_id_text");



CREATE INDEX "job_queue_budget_ledger_user_id_uuid_idx" ON "public"."job_queue_budget_ledger" USING "btree" ("user_id_uuid");



CREATE INDEX "job_queue_budget_rollover_user_id_idx" ON "public"."job_queue_budget_rollover" USING "btree" ("user_id");



CREATE INDEX "job_queue_budget_rollover_user_id_text_idx" ON "public"."job_queue_budget_rollover" USING "btree" ("user_id_text");



CREATE INDEX "job_queue_budget_rollover_user_id_uuid_idx" ON "public"."job_queue_budget_rollover" USING "btree" ("user_id_uuid");



CREATE INDEX "job_queue_credit_balances_user_id_idx" ON "public"."job_queue_credit_balances" USING "btree" ("user_id");



CREATE INDEX "job_queue_credit_balances_user_id_text_idx" ON "public"."job_queue_credit_balances" USING "btree" ("user_id_text");



CREATE INDEX "job_queue_credit_balances_user_id_uuid_idx" ON "public"."job_queue_credit_balances" USING "btree" ("user_id_uuid");



CREATE INDEX "job_queue_credits_ledger_user_id_idx" ON "public"."job_queue_credits_ledger" USING "btree" ("user_id");



CREATE INDEX "job_queue_credits_ledger_user_id_text_idx" ON "public"."job_queue_credits_ledger" USING "btree" ("user_id_text");



CREATE INDEX "job_queue_credits_ledger_user_id_uuid_idx" ON "public"."job_queue_credits_ledger" USING "btree" ("user_id_uuid");



CREATE INDEX "job_queue_daily_budget_user_id_idx" ON "public"."job_queue_daily_budget" USING "btree" ("user_id");



CREATE INDEX "job_queue_daily_budget_user_id_text_idx" ON "public"."job_queue_daily_budget" USING "btree" ("user_id_text");



CREATE INDEX "job_queue_daily_budget_user_id_uuid_idx" ON "public"."job_queue_daily_budget" USING "btree" ("user_id_uuid");



CREATE INDEX "job_queue_events_job_ts_idx" ON "public"."job_queue_events" USING "btree" ("job_id", "ts" DESC);



CREATE INDEX "job_queue_fairness_ledger_user_id_idx" ON "public"."job_queue_fairness_ledger" USING "btree" ("user_id");



CREATE INDEX "job_queue_fairness_ledger_user_id_text_idx" ON "public"."job_queue_fairness_ledger" USING "btree" ("user_id_text");



CREATE INDEX "job_queue_fairness_ledger_user_id_uuid_idx" ON "public"."job_queue_fairness_ledger" USING "btree" ("user_id_uuid");



CREATE UNIQUE INDEX "job_queue_idempotency_unique" ON "public"."job_queue" USING "btree" ("user_id", "job_type", "idempotency_key") WHERE ("idempotency_key" IS NOT NULL);



CREATE INDEX "job_queue_lane_priority_idx" ON "public"."job_queue" USING "btree" ("lane", "priority", "run_at");



CREATE INDEX "job_queue_lane_quota_user_day_idx" ON "public"."job_queue_lane_quota" USING "btree" ("user_id", "day" DESC);



CREATE INDEX "job_queue_lane_quota_user_id_idx" ON "public"."job_queue_lane_quota" USING "btree" ("user_id");



CREATE INDEX "job_queue_lane_quota_user_id_text_idx" ON "public"."job_queue_lane_quota" USING "btree" ("user_id_text");



CREATE INDEX "job_queue_lane_quota_user_id_uuid_idx" ON "public"."job_queue_lane_quota" USING "btree" ("user_id_uuid");



CREATE INDEX "job_queue_lock_idx" ON "public"."job_queue" USING "btree" ("locked_at");



CREATE INDEX "job_queue_locked_idx" ON "public"."job_queue" USING "btree" ("locked_at");



CREATE INDEX "job_queue_pick_idx" ON "public"."job_queue" USING "btree" ("status", "run_at", "priority", "created_at");



CREATE INDEX "job_queue_rate_window_user_id_idx" ON "public"."job_queue_rate_window" USING "btree" ("user_id");



CREATE INDEX "job_queue_rate_window_user_id_text_idx" ON "public"."job_queue_rate_window" USING "btree" ("user_id_text");



CREATE INDEX "job_queue_rate_window_user_id_uuid_idx" ON "public"."job_queue_rate_window" USING "btree" ("user_id_uuid");



CREATE INDEX "job_queue_rate_window_user_start_idx" ON "public"."job_queue_rate_window" USING "btree" ("user_id", "window_start" DESC);



CREATE INDEX "job_queue_run_at_status_idx" ON "public"."job_queue" USING "btree" ("status", "run_at");



CREATE INDEX "job_queue_running_lease_idx" ON "public"."job_queue" USING "btree" ("status", "lease_expires_at");



CREATE INDEX "job_queue_scheduler_decisions_user_id_idx" ON "public"."job_queue_scheduler_decisions" USING "btree" ("user_id");



CREATE INDEX "job_queue_scheduler_decisions_user_id_text_idx" ON "public"."job_queue_scheduler_decisions" USING "btree" ("user_id_text");



CREATE INDEX "job_queue_scheduler_decisions_user_id_uuid_idx" ON "public"."job_queue_scheduler_decisions" USING "btree" ("user_id_uuid");



CREATE INDEX "job_queue_status_run_at_idx" ON "public"."job_queue" USING "btree" ("status", "run_at");



CREATE INDEX "job_queue_status_sched_idx" ON "public"."job_queue" USING "btree" ("status", "scheduled_at");



CREATE INDEX "job_queue_user_id_idx" ON "public"."job_queue" USING "btree" ("user_id");



CREATE INDEX "job_queue_user_id_text_idx" ON "public"."job_queue" USING "btree" ("user_id_text");



CREATE INDEX "job_queue_user_id_uuid_idx" ON "public"."job_queue" USING "btree" ("user_id_uuid");



CREATE INDEX "job_queue_user_status_idx" ON "public"."job_queue" USING "btree" ("user_id", "status");



CREATE INDEX "job_queue_user_tiers_user_id_idx" ON "public"."job_queue_user_tiers" USING "btree" ("user_id");



CREATE INDEX "job_queue_user_tiers_user_id_text_idx" ON "public"."job_queue_user_tiers" USING "btree" ("user_id_text");



CREATE INDEX "job_queue_user_tiers_user_id_uuid_idx" ON "public"."job_queue_user_tiers" USING "btree" ("user_id_uuid");



CREATE INDEX "job_queue_user_type_idem_idx" ON "public"."job_queue" USING "btree" ("user_id", "job_type", "idempotency_key");



CREATE INDEX "job_requests_user_id_idx" ON "public"."job_requests" USING "btree" ("user_id");



CREATE INDEX "job_requests_user_id_uuid_idx" ON "public"."job_requests" USING "btree" ("user_id_uuid");



CREATE INDEX "job_runs_user_id_idx" ON "public"."job_runs" USING "btree" ("user_id");



CREATE INDEX "job_runs_user_id_text_idx" ON "public"."job_runs" USING "btree" ("user_id_text");



CREATE INDEX "job_runs_user_id_uuid_idx" ON "public"."job_runs" USING "btree" ("user_id_uuid");



CREATE INDEX "job_scorecards_user_date_idx" ON "public"."job_scorecards" USING "btree" ("user_id", "date");



CREATE INDEX "job_scorecards_user_id_idx" ON "public"."job_scorecards" USING "btree" ("user_id");



CREATE INDEX "job_scorecards_user_id_text_idx" ON "public"."job_scorecards" USING "btree" ("user_id_text");



CREATE INDEX "job_scorecards_user_id_uuid_idx" ON "public"."job_scorecards" USING "btree" ("user_id_uuid");



CREATE INDEX "job_verticals_user_id_idx" ON "public"."job_verticals" USING "btree" ("user_id");



CREATE INDEX "job_verticals_user_id_text_idx" ON "public"."job_verticals" USING "btree" ("user_id_text");



CREATE INDEX "job_verticals_user_id_uuid_idx" ON "public"."job_verticals" USING "btree" ("user_id_uuid");



CREATE INDEX "journal_entries_user_id_idx" ON "public"."journal_entries" USING "btree" ("user_id");



CREATE INDEX "journal_entries_user_id_text_idx" ON "public"."journal_entries" USING "btree" ("user_id_text");



CREATE INDEX "journal_entries_user_id_uuid_idx" ON "public"."journal_entries" USING "btree" ("user_id_uuid");



CREATE INDEX "knowledge_context_links_user_id_idx" ON "public"."knowledge_context_links" USING "btree" ("user_id");



CREATE INDEX "knowledge_context_links_user_id_text_idx" ON "public"."knowledge_context_links" USING "btree" ("user_id_text");



CREATE INDEX "knowledge_context_links_user_id_uuid_idx" ON "public"."knowledge_context_links" USING "btree" ("user_id_uuid");



CREATE INDEX "knowledge_contexts_user_id_idx" ON "public"."knowledge_contexts" USING "btree" ("user_id");



CREATE INDEX "knowledge_contexts_user_id_text_idx" ON "public"."knowledge_contexts" USING "btree" ("user_id_text");



CREATE INDEX "knowledge_contexts_user_id_uuid_idx" ON "public"."knowledge_contexts" USING "btree" ("user_id_uuid");



CREATE INDEX "knowledge_edges_user_id_idx" ON "public"."knowledge_edges" USING "btree" ("user_id");



CREATE INDEX "knowledge_edges_user_id_text_idx" ON "public"."knowledge_edges" USING "btree" ("user_id_text");



CREATE INDEX "knowledge_edges_user_id_uuid_idx" ON "public"."knowledge_edges" USING "btree" ("user_id_uuid");



CREATE INDEX "knowledge_nodes_user_id_idx" ON "public"."knowledge_nodes" USING "btree" ("user_id");



CREATE INDEX "knowledge_nodes_user_id_text_idx" ON "public"."knowledge_nodes" USING "btree" ("user_id_text");



CREATE INDEX "knowledge_nodes_user_id_uuid_idx" ON "public"."knowledge_nodes" USING "btree" ("user_id_uuid");



CREATE INDEX "lb_daily_metrics_user_id_idx" ON "public"."lb_daily_metrics" USING "btree" ("user_id");



CREATE INDEX "lb_daily_metrics_user_id_uuid_idx" ON "public"."lb_daily_metrics" USING "btree" ("user_id_uuid");



CREATE INDEX "lb_insights_user_id_idx" ON "public"."lb_insights" USING "btree" ("user_id");



CREATE INDEX "lb_insights_user_id_uuid_idx" ON "public"."lb_insights" USING "btree" ("user_id_uuid");



CREATE UNIQUE INDEX "league_members_unique" ON "public"."league_members" USING "btree" ("league_id", "user_id");



CREATE INDEX "league_members_user_id_idx" ON "public"."league_members" USING "btree" ("user_id");



CREATE INDEX "league_members_user_id_text_idx" ON "public"."league_members" USING "btree" ("user_id_text");



CREATE INDEX "league_members_user_id_uuid_idx" ON "public"."league_members" USING "btree" ("user_id_uuid");



CREATE INDEX "league_scores_league_idx" ON "public"."league_scores" USING "btree" ("league_id");



CREATE INDEX "league_scores_user_id_idx" ON "public"."league_scores" USING "btree" ("user_id");



CREATE INDEX "league_scores_user_id_text_idx" ON "public"."league_scores" USING "btree" ("user_id_text");



CREATE INDEX "league_scores_user_id_uuid_idx" ON "public"."league_scores" USING "btree" ("user_id_uuid");



CREATE INDEX "league_scores_user_idx" ON "public"."league_scores" USING "btree" ("user_id");



CREATE UNIQUE INDEX "leagues_key_season_unique" ON "public"."leagues" USING "btree" ("key", "season_key");



CREATE INDEX "life_arc_autopilot_runs_user_id_idx" ON "public"."life_arc_autopilot_runs" USING "btree" ("user_id");



CREATE INDEX "life_arc_autopilot_runs_user_id_text_idx" ON "public"."life_arc_autopilot_runs" USING "btree" ("user_id_text");



CREATE INDEX "life_arc_autopilot_runs_user_id_uuid_idx" ON "public"."life_arc_autopilot_runs" USING "btree" ("user_id_uuid");



CREATE INDEX "life_arc_autopilot_runs_user_idx" ON "public"."life_arc_autopilot_runs" USING "btree" ("user_id", "run_date" DESC, "run_type");



CREATE INDEX "life_arc_autopilot_suggestions_user_id_idx" ON "public"."life_arc_autopilot_suggestions" USING "btree" ("user_id");



CREATE INDEX "life_arc_autopilot_suggestions_user_id_text_idx" ON "public"."life_arc_autopilot_suggestions" USING "btree" ("user_id_text");



CREATE INDEX "life_arc_autopilot_suggestions_user_id_uuid_idx" ON "public"."life_arc_autopilot_suggestions" USING "btree" ("user_id_uuid");



CREATE INDEX "life_arc_checkpoints_arc_idx" ON "public"."life_arc_checkpoints" USING "btree" ("arc_id", "date" DESC);



CREATE INDEX "life_arc_daily_focus_user_id_idx" ON "public"."life_arc_daily_focus" USING "btree" ("user_id");



CREATE INDEX "life_arc_daily_focus_user_id_text_idx" ON "public"."life_arc_daily_focus" USING "btree" ("user_id_text");



CREATE INDEX "life_arc_daily_focus_user_id_uuid_idx" ON "public"."life_arc_daily_focus" USING "btree" ("user_id_uuid");



CREATE INDEX "life_arc_daily_focus_user_idx" ON "public"."life_arc_daily_focus" USING "btree" ("user_id", "focus_date" DESC);



CREATE INDEX "life_arc_objectives_user_id_idx" ON "public"."life_arc_objectives" USING "btree" ("user_id");



CREATE INDEX "life_arc_objectives_user_id_text_idx" ON "public"."life_arc_objectives" USING "btree" ("user_id_text");



CREATE INDEX "life_arc_objectives_user_id_uuid_idx" ON "public"."life_arc_objectives" USING "btree" ("user_id_uuid");



CREATE INDEX "life_arc_objectives_user_idx" ON "public"."life_arc_objectives" USING "btree" ("user_id", "week_start_date" DESC);



CREATE INDEX "life_arc_quests_arc_idx" ON "public"."life_arc_quests" USING "btree" ("arc_id", "status", "due_date");



CREATE INDEX "life_arc_risk_events_user_id_idx" ON "public"."life_arc_risk_events" USING "btree" ("user_id");



CREATE INDEX "life_arc_risk_events_user_id_text_idx" ON "public"."life_arc_risk_events" USING "btree" ("user_id_text");



CREATE INDEX "life_arc_risk_events_user_id_uuid_idx" ON "public"."life_arc_risk_events" USING "btree" ("user_id_uuid");



CREATE INDEX "life_arc_risk_events_user_idx" ON "public"."life_arc_risk_events" USING "btree" ("user_id", "arc_id", "created_at" DESC);



CREATE INDEX "life_arcs_user_id_idx" ON "public"."life_arcs" USING "btree" ("user_id");



CREATE INDEX "life_arcs_user_id_text_idx" ON "public"."life_arcs" USING "btree" ("user_id_text");



CREATE INDEX "life_arcs_user_id_uuid_idx" ON "public"."life_arcs" USING "btree" ("user_id_uuid");



CREATE INDEX "life_arcs_user_idx" ON "public"."life_arcs" USING "btree" ("user_id", "status", "priority");



CREATE INDEX "life_canon_entries_arc_id_idx" ON "public"."life_canon_entries" USING "btree" ("arc_id");



CREATE INDEX "life_canon_entries_session_id_idx" ON "public"."life_canon_entries" USING "btree" ("session_id");



CREATE INDEX "life_canon_entries_user_id_idx" ON "public"."life_canon_entries" USING "btree" ("user_id");



CREATE INDEX "life_canon_entries_user_id_text_idx" ON "public"."life_canon_entries" USING "btree" ("user_id_text");



CREATE INDEX "life_canon_entries_user_id_uuid_idx" ON "public"."life_canon_entries" USING "btree" ("user_id_uuid");



CREATE INDEX "life_canon_snapshots_user_id_idx" ON "public"."life_canon_snapshots" USING "btree" ("user_id");



CREATE INDEX "life_canon_snapshots_user_id_text_idx" ON "public"."life_canon_snapshots" USING "btree" ("user_id_text");



CREATE INDEX "life_canon_snapshots_user_id_uuid_idx" ON "public"."life_canon_snapshots" USING "btree" ("user_id_uuid");



CREATE INDEX "life_chapters_user_id_idx" ON "public"."life_chapters" USING "btree" ("user_id");



CREATE INDEX "life_chapters_user_id_text_idx" ON "public"."life_chapters" USING "btree" ("user_id_text");



CREATE INDEX "life_chapters_user_id_uuid_idx" ON "public"."life_chapters" USING "btree" ("user_id_uuid");



CREATE INDEX "life_domains_user_id_idx" ON "public"."life_domains" USING "btree" ("user_id");



CREATE INDEX "life_domains_user_id_uuid_idx" ON "public"."life_domains" USING "btree" ("user_id_uuid");



CREATE INDEX "life_events_user_id_idx" ON "public"."life_events" USING "btree" ("user_id");



CREATE INDEX "life_events_user_id_text_idx" ON "public"."life_events" USING "btree" ("user_id_text");



CREATE INDEX "life_events_user_id_uuid_idx" ON "public"."life_events" USING "btree" ("user_id_uuid");



CREATE INDEX "life_evidence_user_id_idx" ON "public"."life_evidence" USING "btree" ("user_id");



CREATE INDEX "life_evidence_user_id_text_idx" ON "public"."life_evidence" USING "btree" ("user_id_text");



CREATE INDEX "life_evidence_user_id_uuid_idx" ON "public"."life_evidence" USING "btree" ("user_id_uuid");



CREATE INDEX "life_themes_user_id_idx" ON "public"."life_themes" USING "btree" ("user_id");



CREATE INDEX "life_themes_user_id_text_idx" ON "public"."life_themes" USING "btree" ("user_id_text");



CREATE INDEX "life_themes_user_id_uuid_idx" ON "public"."life_themes" USING "btree" ("user_id_uuid");



CREATE INDEX "long_chapters_user_id_idx" ON "public"."long_chapters" USING "btree" ("user_id");



CREATE INDEX "long_chapters_user_id_uuid_idx" ON "public"."long_chapters" USING "btree" ("user_id_uuid");



CREATE INDEX "long_chapters_user_idx" ON "public"."long_chapters" USING "btree" ("user_id", "status");



CREATE INDEX "long_milestones_user_id_idx" ON "public"."long_milestones" USING "btree" ("user_id");



CREATE INDEX "long_milestones_user_id_uuid_idx" ON "public"."long_milestones" USING "btree" ("user_id_uuid");



CREATE INDEX "long_milestones_user_idx" ON "public"."long_milestones" USING "btree" ("user_id", "occurred_at" DESC);



CREATE INDEX "long_predictions_user_id_idx" ON "public"."long_predictions" USING "btree" ("user_id");



CREATE INDEX "long_predictions_user_id_uuid_idx" ON "public"."long_predictions" USING "btree" ("user_id_uuid");



CREATE INDEX "long_predictions_user_idx" ON "public"."long_predictions" USING "btree" ("user_id", "status");



CREATE UNIQUE INDEX "long_snapshots_unique_idx" ON "public"."long_snapshots" USING "btree" ("user_id", "snapshot_type", "period_start");



CREATE INDEX "long_snapshots_user_id_idx" ON "public"."long_snapshots" USING "btree" ("user_id");



CREATE INDEX "long_snapshots_user_id_uuid_idx" ON "public"."long_snapshots" USING "btree" ("user_id_uuid");



CREATE INDEX "long_snapshots_user_idx" ON "public"."long_snapshots" USING "btree" ("user_id", "snapshot_type", "period_start" DESC);



CREATE UNIQUE INDEX "long_trajectories_unique_idx" ON "public"."long_trajectories" USING "btree" ("user_id", "attribute_name");



CREATE INDEX "long_trajectories_user_id_idx" ON "public"."long_trajectories" USING "btree" ("user_id");



CREATE INDEX "long_trajectories_user_id_uuid_idx" ON "public"."long_trajectories" USING "btree" ("user_id_uuid");



CREATE INDEX "long_trajectories_user_idx" ON "public"."long_trajectories" USING "btree" ("user_id", "category");



CREATE INDEX "long_trends_user_id_idx" ON "public"."long_trends" USING "btree" ("user_id");



CREATE INDEX "long_trends_user_id_uuid_idx" ON "public"."long_trends" USING "btree" ("user_id_uuid");



CREATE INDEX "long_trends_user_idx" ON "public"."long_trends" USING "btree" ("user_id", "metric_name");



CREATE INDEX "mc_events_user_id_idx" ON "public"."mc_events" USING "btree" ("user_id");



CREATE INDEX "mc_events_user_id_uuid_idx" ON "public"."mc_events" USING "btree" ("user_id_uuid");



CREATE INDEX "mc_interventions_user_id_idx" ON "public"."mc_interventions" USING "btree" ("user_id");



CREATE INDEX "mc_interventions_user_id_uuid_idx" ON "public"."mc_interventions" USING "btree" ("user_id_uuid");



CREATE INDEX "mc_strategy_profiles_user_id_idx" ON "public"."mc_strategy_profiles" USING "btree" ("user_id");



CREATE INDEX "mc_strategy_profiles_user_id_uuid_idx" ON "public"."mc_strategy_profiles" USING "btree" ("user_id_uuid");



CREATE INDEX "mem_archives_compression_idx" ON "public"."mem_archives" USING "btree" ("compression_id");



CREATE INDEX "mem_archives_user_id_idx" ON "public"."mem_archives" USING "btree" ("user_id");



CREATE INDEX "mem_archives_user_id_uuid_idx" ON "public"."mem_archives" USING "btree" ("user_id_uuid");



CREATE INDEX "mem_archives_user_idx" ON "public"."mem_archives" USING "btree" ("user_id");



CREATE INDEX "mem_compressed_time_idx" ON "public"."mem_compressed" USING "btree" ("user_id", "time_period_start" DESC);



CREATE INDEX "mem_compressed_topic_idx" ON "public"."mem_compressed" USING "btree" ("user_id", "topic") WHERE ("topic" IS NOT NULL);



CREATE INDEX "mem_compressed_user_id_idx" ON "public"."mem_compressed" USING "btree" ("user_id");



CREATE INDEX "mem_compressed_user_id_uuid_idx" ON "public"."mem_compressed" USING "btree" ("user_id_uuid");



CREATE INDEX "mem_compressed_user_idx" ON "public"."mem_compressed" USING "btree" ("user_id", "compression_type");



CREATE INDEX "mem_compression_jobs_user_id_idx" ON "public"."mem_compression_jobs" USING "btree" ("user_id");



CREATE INDEX "mem_compression_jobs_user_id_uuid_idx" ON "public"."mem_compression_jobs" USING "btree" ("user_id_uuid");



CREATE INDEX "mem_compression_settings_user_id_idx" ON "public"."mem_compression_settings" USING "btree" ("user_id");



CREATE INDEX "mem_compression_settings_user_id_uuid_idx" ON "public"."mem_compression_settings" USING "btree" ("user_id_uuid");



CREATE INDEX "mem_jobs_user_idx" ON "public"."mem_compression_jobs" USING "btree" ("user_id", "status");



CREATE INDEX "memories_user_id_idx" ON "public"."memories" USING "btree" ("user_id");



CREATE INDEX "memories_user_id_uuid_idx" ON "public"."memories" USING "btree" ("user_id_uuid");



CREATE INDEX "memory_events_user_id_idx" ON "public"."memory_events" USING "btree" ("user_id");



CREATE INDEX "memory_events_user_id_text_idx" ON "public"."memory_events" USING "btree" ("user_id_text");



CREATE INDEX "memory_events_user_id_uuid_idx" ON "public"."memory_events" USING "btree" ("user_id_uuid");



CREATE INDEX "memory_patterns_user_id_idx" ON "public"."memory_patterns" USING "btree" ("user_id");



CREATE INDEX "memory_patterns_user_id_uuid_idx" ON "public"."memory_patterns" USING "btree" ("user_id_uuid");



CREATE INDEX "mind_models_user_id_idx" ON "public"."mind_models" USING "btree" ("user_id");



CREATE INDEX "mind_models_user_id_text_idx" ON "public"."mind_models" USING "btree" ("user_id_text");



CREATE INDEX "mind_models_user_id_uuid_idx" ON "public"."mind_models" USING "btree" ("user_id_uuid");



CREATE INDEX "motor_routine_metrics_user_id_idx" ON "public"."motor_routine_metrics" USING "btree" ("user_id");



CREATE INDEX "motor_routine_metrics_user_id_text_idx" ON "public"."motor_routine_metrics" USING "btree" ("user_id_text");



CREATE INDEX "motor_routine_metrics_user_id_uuid_idx" ON "public"."motor_routine_metrics" USING "btree" ("user_id_uuid");



CREATE INDEX "motor_routine_runs_user_id_idx" ON "public"."motor_routine_runs" USING "btree" ("user_id");



CREATE INDEX "motor_routine_runs_user_id_text_idx" ON "public"."motor_routine_runs" USING "btree" ("user_id_text");



CREATE INDEX "motor_routine_runs_user_id_uuid_idx" ON "public"."motor_routine_runs" USING "btree" ("user_id_uuid");



CREATE INDEX "motor_routine_steps_user_id_idx" ON "public"."motor_routine_steps" USING "btree" ("user_id");



CREATE INDEX "motor_routine_steps_user_id_text_idx" ON "public"."motor_routine_steps" USING "btree" ("user_id_text");



CREATE INDEX "motor_routine_steps_user_id_uuid_idx" ON "public"."motor_routine_steps" USING "btree" ("user_id_uuid");



CREATE INDEX "motor_routine_triggers_user_id_idx" ON "public"."motor_routine_triggers" USING "btree" ("user_id");



CREATE INDEX "motor_routine_triggers_user_id_text_idx" ON "public"."motor_routine_triggers" USING "btree" ("user_id_text");



CREATE INDEX "motor_routine_triggers_user_id_uuid_idx" ON "public"."motor_routine_triggers" USING "btree" ("user_id_uuid");



CREATE INDEX "motor_routines_user_id_idx" ON "public"."motor_routines" USING "btree" ("user_id");



CREATE INDEX "motor_routines_user_id_text_idx" ON "public"."motor_routines" USING "btree" ("user_id_text");



CREATE INDEX "motor_routines_user_id_uuid_idx" ON "public"."motor_routines" USING "btree" ("user_id_uuid");



CREATE INDEX "mythic_achievements_user_id_idx" ON "public"."mythic_achievements" USING "btree" ("user_id");



CREATE INDEX "mythic_achievements_user_id_text_idx" ON "public"."mythic_achievements" USING "btree" ("user_id_text");



CREATE INDEX "mythic_achievements_user_id_uuid_idx" ON "public"."mythic_achievements" USING "btree" ("user_id_uuid");



CREATE INDEX "mythic_arcs_status_idx" ON "public"."mythic_arcs" USING "btree" ("status");



CREATE INDEX "mythic_arcs_user_id_idx" ON "public"."mythic_arcs" USING "btree" ("user_id");



CREATE INDEX "mythic_arcs_user_id_text_idx" ON "public"."mythic_arcs" USING "btree" ("user_id_text");



CREATE INDEX "mythic_arcs_user_id_uuid_idx" ON "public"."mythic_arcs" USING "btree" ("user_id_uuid");



CREATE INDEX "mythic_belt_progress_user_id_idx" ON "public"."mythic_belt_progress" USING "btree" ("user_id");



CREATE INDEX "mythic_belt_progress_user_id_text_idx" ON "public"."mythic_belt_progress" USING "btree" ("user_id_text");



CREATE INDEX "mythic_belt_progress_user_id_uuid_idx" ON "public"."mythic_belt_progress" USING "btree" ("user_id_uuid");



CREATE INDEX "mythic_coach_sessions_user_id_idx" ON "public"."mythic_coach_sessions" USING "btree" ("user_id");



CREATE INDEX "mythic_coach_sessions_user_id_text_idx" ON "public"."mythic_coach_sessions" USING "btree" ("user_id_text");



CREATE INDEX "mythic_coach_sessions_user_id_uuid_idx" ON "public"."mythic_coach_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "mythic_quests_arc_id_idx" ON "public"."mythic_quests" USING "btree" ("arc_id");



CREATE INDEX "mythic_quests_status_idx" ON "public"."mythic_quests" USING "btree" ("status");



CREATE INDEX "mythic_quests_user_id_idx" ON "public"."mythic_quests" USING "btree" ("user_id");



CREATE INDEX "mythic_quests_user_id_text_idx" ON "public"."mythic_quests" USING "btree" ("user_id_text");



CREATE INDEX "mythic_quests_user_id_uuid_idx" ON "public"."mythic_quests" USING "btree" ("user_id_uuid");



CREATE INDEX "mythic_rituals_arc_id_idx" ON "public"."mythic_rituals" USING "btree" ("arc_id");



CREATE INDEX "mythic_rituals_status_idx" ON "public"."mythic_rituals" USING "btree" ("status");



CREATE INDEX "mythic_rituals_user_id_idx" ON "public"."mythic_rituals" USING "btree" ("user_id");



CREATE INDEX "mythic_rituals_user_id_text_idx" ON "public"."mythic_rituals" USING "btree" ("user_id_text");



CREATE INDEX "mythic_rituals_user_id_uuid_idx" ON "public"."mythic_rituals" USING "btree" ("user_id_uuid");



CREATE INDEX "mythic_sessions_arc_id_idx" ON "public"."mythic_sessions" USING "btree" ("arc_id");



CREATE INDEX "mythic_sessions_type_idx" ON "public"."mythic_sessions" USING "btree" ("session_type");



CREATE INDEX "mythic_sessions_user_id_idx" ON "public"."mythic_sessions" USING "btree" ("user_id");



CREATE INDEX "mythic_sessions_user_id_text_idx" ON "public"."mythic_sessions" USING "btree" ("user_id_text");



CREATE INDEX "mythic_sessions_user_id_uuid_idx" ON "public"."mythic_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "mythic_training_focus_user_id_idx" ON "public"."mythic_training_focus" USING "btree" ("user_id");



CREATE INDEX "mythic_training_focus_user_id_text_idx" ON "public"."mythic_training_focus" USING "btree" ("user_id_text");



CREATE INDEX "mythic_training_focus_user_id_uuid_idx" ON "public"."mythic_training_focus" USING "btree" ("user_id_uuid");



CREATE INDEX "mythic_training_missions_user_id_idx" ON "public"."mythic_training_missions" USING "btree" ("user_id");



CREATE INDEX "mythic_training_missions_user_id_text_idx" ON "public"."mythic_training_missions" USING "btree" ("user_id_text");



CREATE INDEX "mythic_training_missions_user_id_uuid_idx" ON "public"."mythic_training_missions" USING "btree" ("user_id_uuid");



CREATE INDEX "mythic_training_plans_user_id_idx" ON "public"."mythic_training_plans" USING "btree" ("user_id");



CREATE INDEX "mythic_training_plans_user_id_text_idx" ON "public"."mythic_training_plans" USING "btree" ("user_id_text");



CREATE INDEX "mythic_training_plans_user_id_uuid_idx" ON "public"."mythic_training_plans" USING "btree" ("user_id_uuid");



CREATE INDEX "mythic_training_reflections_user_id_idx" ON "public"."mythic_training_reflections" USING "btree" ("user_id");



CREATE INDEX "mythic_training_reflections_user_id_text_idx" ON "public"."mythic_training_reflections" USING "btree" ("user_id_text");



CREATE INDEX "mythic_training_reflections_user_id_uuid_idx" ON "public"."mythic_training_reflections" USING "btree" ("user_id_uuid");



CREATE INDEX "mythic_voice_mappings_user_id_idx" ON "public"."mythic_voice_mappings" USING "btree" ("user_id");



CREATE INDEX "mythic_voice_mappings_user_id_text_idx" ON "public"."mythic_voice_mappings" USING "btree" ("user_id_text");



CREATE INDEX "mythic_voice_mappings_user_id_uuid_idx" ON "public"."mythic_voice_mappings" USING "btree" ("user_id_uuid");



CREATE INDEX "narrative_snapshots_user_id_idx" ON "public"."narrative_snapshots" USING "btree" ("user_id");



CREATE INDEX "narrative_snapshots_user_id_text_idx" ON "public"."narrative_snapshots" USING "btree" ("user_id_text");



CREATE INDEX "narrative_snapshots_user_id_uuid_idx" ON "public"."narrative_snapshots" USING "btree" ("user_id_uuid");



CREATE INDEX "notes_user_id_idx" ON "public"."notes" USING "btree" ("user_id");



CREATE INDEX "notes_user_id_uuid_idx" ON "public"."notes" USING "btree" ("user_id_uuid");



CREATE INDEX "notification_log_user_id_idx" ON "public"."notification_log" USING "btree" ("user_id");



CREATE INDEX "notification_log_user_id_uuid_idx" ON "public"."notification_log" USING "btree" ("user_id_uuid");



CREATE INDEX "notification_preferences_user_id_idx" ON "public"."notification_preferences" USING "btree" ("user_id");



CREATE INDEX "notification_preferences_user_id_uuid_idx" ON "public"."notification_preferences" USING "btree" ("user_id_uuid");



CREATE INDEX "notification_queue_user_id_idx" ON "public"."notification_queue" USING "btree" ("user_id");



CREATE INDEX "notification_queue_user_id_uuid_idx" ON "public"."notification_queue" USING "btree" ("user_id_uuid");



CREATE INDEX "onboarding_conversations_user_id_idx" ON "public"."onboarding_conversations" USING "btree" ("user_id");



CREATE INDEX "onboarding_conversations_user_id_uuid_idx" ON "public"."onboarding_conversations" USING "btree" ("user_id_uuid");



CREATE INDEX "onboarding_state_user_id_idx" ON "public"."onboarding_state" USING "btree" ("user_id");



CREATE INDEX "onboarding_state_user_id_text_idx" ON "public"."onboarding_state" USING "btree" ("user_id_text");



CREATE INDEX "onboarding_state_user_id_uuid_idx" ON "public"."onboarding_state" USING "btree" ("user_id_uuid");



CREATE INDEX "ops_automation_locks_enabled_idx" ON "public"."ops_automation_locks" USING "btree" ("enabled");



CREATE INDEX "ops_incident_events_created_at_idx" ON "public"."ops_incident_events" USING "btree" ("created_at" DESC);



CREATE INDEX "ops_incident_events_payload_gin_idx" ON "public"."ops_incident_events" USING "gin" ("payload");



CREATE INDEX "ops_incident_events_source_created_at_idx" ON "public"."ops_incident_events" USING "btree" ("source", "created_at" DESC);



CREATE INDEX "ops_incident_events_type_created_at_idx" ON "public"."ops_incident_events" USING "btree" ("event_type", "created_at" DESC);



CREATE INDEX "ops_incidents_status_created_at_idx" ON "public"."ops_incidents" USING "btree" ("status", "created_at" DESC);



CREATE UNIQUE INDEX "org_members_org_user_unique" ON "public"."org_members" USING "btree" ("org_id", "user_id");



CREATE INDEX "org_members_user_id_idx" ON "public"."org_members" USING "btree" ("user_id");



CREATE INDEX "org_members_user_id_text_idx" ON "public"."org_members" USING "btree" ("user_id_text");



CREATE INDEX "org_members_user_id_uuid_idx" ON "public"."org_members" USING "btree" ("user_id_uuid");



CREATE INDEX "persona_arc_events_user_id_idx" ON "public"."persona_arc_events" USING "btree" ("user_id");



CREATE INDEX "persona_arc_events_user_id_text_idx" ON "public"."persona_arc_events" USING "btree" ("user_id_text");



CREATE INDEX "persona_arc_events_user_id_uuid_idx" ON "public"."persona_arc_events" USING "btree" ("user_id_uuid");



CREATE INDEX "persona_arc_events_user_idx" ON "public"."persona_arc_events" USING "btree" ("user_id", "persona_id", "created_at" DESC);



CREATE INDEX "persona_archetype_stats_idx" ON "public"."persona_archetype_stats" USING "btree" ("archetype_id", "coach_id");



CREATE INDEX "persona_companion_events_user_id_idx" ON "public"."persona_companion_events" USING "btree" ("user_id");



CREATE INDEX "persona_companion_events_user_id_text_idx" ON "public"."persona_companion_events" USING "btree" ("user_id_text");



CREATE INDEX "persona_companion_events_user_id_uuid_idx" ON "public"."persona_companion_events" USING "btree" ("user_id_uuid");



CREATE INDEX "persona_companion_events_user_idx" ON "public"."persona_companion_events" USING "btree" ("user_id", "persona_id", "created_at" DESC);



CREATE INDEX "persona_companion_highlights_user_id_idx" ON "public"."persona_companion_highlights" USING "btree" ("user_id");



CREATE INDEX "persona_companion_highlights_user_id_text_idx" ON "public"."persona_companion_highlights" USING "btree" ("user_id_text");



CREATE INDEX "persona_companion_highlights_user_id_uuid_idx" ON "public"."persona_companion_highlights" USING "btree" ("user_id_uuid");



CREATE INDEX "persona_companion_highlights_user_idx" ON "public"."persona_companion_highlights" USING "btree" ("user_id", "persona_id", "importance" DESC, "created_at" DESC);



CREATE UNIQUE INDEX "persona_companion_state_unique" ON "public"."persona_companion_state" USING "btree" ("user_id", "persona_id", COALESCE("coach_id", 'global'::"text"));



CREATE INDEX "persona_companion_state_user_id_idx" ON "public"."persona_companion_state" USING "btree" ("user_id");



CREATE INDEX "persona_companion_state_user_id_text_idx" ON "public"."persona_companion_state" USING "btree" ("user_id_text");



CREATE INDEX "persona_companion_state_user_id_uuid_idx" ON "public"."persona_companion_state" USING "btree" ("user_id_uuid");



CREATE INDEX "persona_interaction_stats_user_id_idx" ON "public"."persona_interaction_stats" USING "btree" ("user_id");



CREATE INDEX "persona_interaction_stats_user_id_text_idx" ON "public"."persona_interaction_stats" USING "btree" ("user_id_text");



CREATE INDEX "persona_interaction_stats_user_id_uuid_idx" ON "public"."persona_interaction_stats" USING "btree" ("user_id_uuid");



CREATE INDEX "persona_memory_snapshots_user_id_idx" ON "public"."persona_memory_snapshots" USING "btree" ("user_id");



CREATE INDEX "persona_memory_snapshots_user_id_text_idx" ON "public"."persona_memory_snapshots" USING "btree" ("user_id_text");



CREATE INDEX "persona_memory_snapshots_user_id_uuid_idx" ON "public"."persona_memory_snapshots" USING "btree" ("user_id_uuid");



CREATE INDEX "persona_memory_user_idx" ON "public"."persona_memory_snapshots" USING "btree" ("user_id", "persona_key");



CREATE UNIQUE INDEX "persona_microstyle_prefs_unique" ON "public"."persona_microstyle_prefs" USING "btree" ("user_id", "persona_id", COALESCE("coach_id", 'global'::"text"));



CREATE INDEX "persona_microstyle_prefs_user_id_idx" ON "public"."persona_microstyle_prefs" USING "btree" ("user_id");



CREATE INDEX "persona_microstyle_prefs_user_id_text_idx" ON "public"."persona_microstyle_prefs" USING "btree" ("user_id_text");



CREATE INDEX "persona_microstyle_prefs_user_id_uuid_idx" ON "public"."persona_microstyle_prefs" USING "btree" ("user_id_uuid");



CREATE UNIQUE INDEX "persona_user_arc_unique" ON "public"."persona_user_arc" USING "btree" ("user_id", "persona_id", COALESCE("coach_id", 'global'::"text"));



CREATE INDEX "persona_user_arc_user_id_idx" ON "public"."persona_user_arc" USING "btree" ("user_id");



CREATE INDEX "persona_user_arc_user_id_text_idx" ON "public"."persona_user_arc" USING "btree" ("user_id_text");



CREATE INDEX "persona_user_arc_user_id_uuid_idx" ON "public"."persona_user_arc" USING "btree" ("user_id_uuid");



CREATE INDEX "personal_heuristics_user_id_idx" ON "public"."personal_heuristics" USING "btree" ("user_id");



CREATE INDEX "personal_heuristics_user_id_text_idx" ON "public"."personal_heuristics" USING "btree" ("user_id_text");



CREATE INDEX "personal_heuristics_user_id_uuid_idx" ON "public"."personal_heuristics" USING "btree" ("user_id_uuid");



CREATE INDEX "personas_user_id_idx" ON "public"."personas" USING "btree" ("user_id");



CREATE INDEX "personas_user_id_uuid_idx" ON "public"."personas" USING "btree" ("user_id_uuid");



CREATE UNIQUE INDEX "philosophy_lessons_key_unique" ON "public"."philosophy_lessons" USING "btree" ("school_key", "key");



CREATE UNIQUE INDEX "philosophy_schools_key_unique" ON "public"."philosophy_schools" USING "btree" ("key");



CREATE INDEX "plan_items_user_id_idx" ON "public"."plan_items" USING "btree" ("user_id");



CREATE INDEX "plan_items_user_id_uuid_idx" ON "public"."plan_items" USING "btree" ("user_id_uuid");



CREATE INDEX "planning_constraints_user_id_idx" ON "public"."planning_constraints" USING "btree" ("user_id");



CREATE INDEX "planning_constraints_user_id_text_idx" ON "public"."planning_constraints" USING "btree" ("user_id_text");



CREATE INDEX "planning_constraints_user_id_uuid_idx" ON "public"."planning_constraints" USING "btree" ("user_id_uuid");



CREATE INDEX "planning_decisions_user_id_idx" ON "public"."planning_decisions" USING "btree" ("user_id");



CREATE INDEX "planning_decisions_user_id_text_idx" ON "public"."planning_decisions" USING "btree" ("user_id_text");



CREATE INDEX "planning_decisions_user_id_uuid_idx" ON "public"."planning_decisions" USING "btree" ("user_id_uuid");



CREATE INDEX "planning_overrides_user_id_idx" ON "public"."planning_overrides" USING "btree" ("user_id");



CREATE INDEX "planning_overrides_user_id_text_idx" ON "public"."planning_overrides" USING "btree" ("user_id_text");



CREATE INDEX "planning_overrides_user_id_uuid_idx" ON "public"."planning_overrides" USING "btree" ("user_id_uuid");



CREATE INDEX "planning_sessions_user_id_idx" ON "public"."planning_sessions" USING "btree" ("user_id");



CREATE INDEX "planning_sessions_user_id_text_idx" ON "public"."planning_sessions" USING "btree" ("user_id_text");



CREATE INDEX "planning_sessions_user_id_uuid_idx" ON "public"."planning_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "plugin_api_keys_prefix_idx" ON "public"."plugin_api_keys" USING "btree" ("key_prefix");



CREATE INDEX "plugin_api_keys_user_id_idx" ON "public"."plugin_api_keys" USING "btree" ("user_id");



CREATE INDEX "plugin_api_keys_user_id_uuid_idx" ON "public"."plugin_api_keys" USING "btree" ("user_id_uuid");



CREATE INDEX "plugin_api_keys_user_idx" ON "public"."plugin_api_keys" USING "btree" ("user_id", "is_active");



CREATE INDEX "plugin_automations_user_id_idx" ON "public"."plugin_automations" USING "btree" ("user_id");



CREATE INDEX "plugin_automations_user_id_uuid_idx" ON "public"."plugin_automations" USING "btree" ("user_id_uuid");



CREATE INDEX "plugin_automations_user_idx" ON "public"."plugin_automations" USING "btree" ("user_id", "is_active");



CREATE UNIQUE INDEX "plugin_data_unique_idx" ON "public"."plugin_data" USING "btree" ("user_plugin_id", "data_key");



CREATE INDEX "plugin_data_user_id_idx" ON "public"."plugin_data" USING "btree" ("user_id");



CREATE INDEX "plugin_data_user_id_uuid_idx" ON "public"."plugin_data" USING "btree" ("user_id_uuid");



CREATE INDEX "plugin_data_user_plugin_idx" ON "public"."plugin_data" USING "btree" ("user_plugin_id");



CREATE INDEX "plugin_events_plugin_idx" ON "public"."plugin_events" USING "btree" ("plugin_slug", "created_at" DESC);



CREATE INDEX "plugin_events_user_id_idx" ON "public"."plugin_events" USING "btree" ("user_id");



CREATE INDEX "plugin_events_user_id_uuid_idx" ON "public"."plugin_events" USING "btree" ("user_id_uuid");



CREATE INDEX "plugin_events_user_idx" ON "public"."plugin_events" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "plugin_webhooks_user_id_idx" ON "public"."plugin_webhooks" USING "btree" ("user_id");



CREATE INDEX "plugin_webhooks_user_id_uuid_idx" ON "public"."plugin_webhooks" USING "btree" ("user_id_uuid");



CREATE INDEX "plugin_webhooks_user_plugin_idx" ON "public"."plugin_webhooks" USING "btree" ("user_plugin_id");



CREATE INDEX "plugins_slug_idx" ON "public"."plugins" USING "btree" ("slug");



CREATE INDEX "plugins_type_idx" ON "public"."plugins" USING "btree" ("plugin_type", "status");



CREATE INDEX "prefrontal_goals_user_id_idx" ON "public"."prefrontal_goals" USING "btree" ("user_id");



CREATE INDEX "prefrontal_goals_user_id_text_idx" ON "public"."prefrontal_goals" USING "btree" ("user_id_text");



CREATE INDEX "prefrontal_goals_user_id_uuid_idx" ON "public"."prefrontal_goals" USING "btree" ("user_id_uuid");



CREATE INDEX "presence_daily_summaries_user_id_idx" ON "public"."presence_daily_summaries" USING "btree" ("user_id");



CREATE INDEX "presence_daily_summaries_user_id_text_idx" ON "public"."presence_daily_summaries" USING "btree" ("user_id_text");



CREATE INDEX "presence_daily_summaries_user_id_uuid_idx" ON "public"."presence_daily_summaries" USING "btree" ("user_id_uuid");



CREATE INDEX "presence_decisions_user_id_idx" ON "public"."presence_decisions" USING "btree" ("user_id");



CREATE INDEX "presence_decisions_user_id_text_idx" ON "public"."presence_decisions" USING "btree" ("user_id_text");



CREATE INDEX "presence_decisions_user_id_uuid_idx" ON "public"."presence_decisions" USING "btree" ("user_id_uuid");



CREATE INDEX "presence_events_user_id_idx" ON "public"."presence_events" USING "btree" ("user_id");



CREATE INDEX "presence_events_user_id_text_idx" ON "public"."presence_events" USING "btree" ("user_id_text");



CREATE INDEX "presence_events_user_id_uuid_idx" ON "public"."presence_events" USING "btree" ("user_id_uuid");



CREATE INDEX "proactive_interventions_user_id_idx" ON "public"."proactive_interventions" USING "btree" ("user_id");



CREATE INDEX "proactive_interventions_user_id_uuid_idx" ON "public"."proactive_interventions" USING "btree" ("user_id_uuid");



CREATE INDEX "pulse_brain_preferences_user_id_idx" ON "public"."pulse_brain_preferences" USING "btree" ("user_id");



CREATE INDEX "pulse_brain_preferences_user_id_text_idx" ON "public"."pulse_brain_preferences" USING "btree" ("user_id_text");



CREATE INDEX "pulse_brain_preferences_user_id_uuid_idx" ON "public"."pulse_brain_preferences" USING "btree" ("user_id_uuid");



CREATE INDEX "pulse_brain_surface_events_user_id_idx" ON "public"."pulse_brain_surface_events" USING "btree" ("user_id");



CREATE INDEX "pulse_brain_surface_events_user_id_text_idx" ON "public"."pulse_brain_surface_events" USING "btree" ("user_id_text");



CREATE INDEX "pulse_brain_surface_events_user_id_uuid_idx" ON "public"."pulse_brain_surface_events" USING "btree" ("user_id_uuid");



CREATE UNIQUE INDEX "pulse_docs_slug_unique" ON "public"."pulse_docs" USING "btree" ("slug");



CREATE UNIQUE INDEX "pulse_events_event_fingerprint_uidx" ON "public"."pulse_events" USING "btree" ("event_fingerprint") WHERE ("event_fingerprint" IS NOT NULL);



CREATE INDEX "pulse_events_user_id_idx" ON "public"."pulse_events" USING "btree" ("user_id");



CREATE INDEX "pulse_events_user_id_uuid_idx" ON "public"."pulse_events" USING "btree" ("user_id_uuid");



CREATE INDEX "pulse_insight_acknowledgements_user_id_idx" ON "public"."pulse_insight_acknowledgements" USING "btree" ("user_id");



CREATE INDEX "pulse_insight_acknowledgements_user_id_text_idx" ON "public"."pulse_insight_acknowledgements" USING "btree" ("user_id_text");



CREATE INDEX "pulse_insight_acknowledgements_user_id_uuid_idx" ON "public"."pulse_insight_acknowledgements" USING "btree" ("user_id_uuid");



CREATE INDEX "pulse_introduction_sessions_user_id_idx" ON "public"."pulse_introduction_sessions" USING "btree" ("user_id");



CREATE INDEX "pulse_introduction_sessions_user_id_text_idx" ON "public"."pulse_introduction_sessions" USING "btree" ("user_id_text");



CREATE INDEX "pulse_introduction_sessions_user_id_uuid_idx" ON "public"."pulse_introduction_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "push_subscriptions_user_id_idx" ON "public"."push_subscriptions" USING "btree" ("user_id");



CREATE INDEX "push_subscriptions_user_id_uuid_idx" ON "public"."push_subscriptions" USING "btree" ("user_id_uuid");



CREATE INDEX "quest_completions_user_id_idx" ON "public"."quest_completions" USING "btree" ("user_id");



CREATE INDEX "quest_completions_user_id_uuid_idx" ON "public"."quest_completions" USING "btree" ("user_id_uuid");



CREATE INDEX "relational_identities_user_id_idx" ON "public"."relational_identities" USING "btree" ("user_id");



CREATE INDEX "relational_identities_user_id_text_idx" ON "public"."relational_identities" USING "btree" ("user_id_text");



CREATE INDEX "relational_identities_user_id_uuid_idx" ON "public"."relational_identities" USING "btree" ("user_id_uuid");



CREATE INDEX "relational_predictions_user_id_idx" ON "public"."relational_predictions" USING "btree" ("user_id");



CREATE INDEX "relational_predictions_user_id_text_idx" ON "public"."relational_predictions" USING "btree" ("user_id_text");



CREATE INDEX "relational_predictions_user_id_uuid_idx" ON "public"."relational_predictions" USING "btree" ("user_id_uuid");



CREATE INDEX "relational_state_snapshots_user_id_idx" ON "public"."relational_state_snapshots" USING "btree" ("user_id");



CREATE INDEX "relational_state_snapshots_user_id_text_idx" ON "public"."relational_state_snapshots" USING "btree" ("user_id_text");



CREATE INDEX "relational_state_snapshots_user_id_uuid_idx" ON "public"."relational_state_snapshots" USING "btree" ("user_id_uuid");



CREATE INDEX "relationship_highlights_user_id_idx" ON "public"."relationship_highlights" USING "btree" ("user_id");



CREATE INDEX "relationship_highlights_user_id_text_idx" ON "public"."relationship_highlights" USING "btree" ("user_id_text");



CREATE INDEX "relationship_highlights_user_id_uuid_idx" ON "public"."relationship_highlights" USING "btree" ("user_id_uuid");



CREATE INDEX "relationship_interactions_user_id_idx" ON "public"."relationship_interactions" USING "btree" ("user_id");



CREATE INDEX "relationship_interactions_user_id_uuid_idx" ON "public"."relationship_interactions" USING "btree" ("user_id_uuid");



CREATE INDEX "relationships_user_id_idx" ON "public"."relationships" USING "btree" ("user_id");



CREATE INDEX "relationships_user_id_uuid_idx" ON "public"."relationships" USING "btree" ("user_id_uuid");



CREATE UNIQUE INDEX "reminder_subscriptions_dedupe_idx" ON "public"."reminder_subscriptions" USING "btree" ("source_type", "source_id", "kind", "next_run_at");



CREATE INDEX "reminder_subscriptions_due_idx" ON "public"."reminder_subscriptions" USING "btree" ("active", "next_run_at");



CREATE INDEX "reminder_subscriptions_user_id_idx" ON "public"."reminder_subscriptions" USING "btree" ("user_id");



CREATE INDEX "reminder_subscriptions_user_id_uuid_idx" ON "public"."reminder_subscriptions" USING "btree" ("user_id_uuid");



CREATE INDEX "reminder_subscriptions_user_idx" ON "public"."reminder_subscriptions" USING "btree" ("user_id", "active", "next_run_at");



CREATE INDEX "safety_incidents_user_id_idx" ON "public"."safety_incidents" USING "btree" ("user_id");



CREATE INDEX "safety_incidents_user_id_text_idx" ON "public"."safety_incidents" USING "btree" ("user_id_text");



CREATE INDEX "safety_incidents_user_id_uuid_idx" ON "public"."safety_incidents" USING "btree" ("user_id_uuid");



CREATE INDEX "safety_incidents_user_idx" ON "public"."safety_incidents" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "scheduler_targets_user_id_idx" ON "public"."scheduler_targets" USING "btree" ("user_id");



CREATE INDEX "scheduler_targets_user_id_text_idx" ON "public"."scheduler_targets" USING "btree" ("user_id_text");



CREATE INDEX "scheduler_targets_user_id_uuid_idx" ON "public"."scheduler_targets" USING "btree" ("user_id_uuid");



CREATE INDEX "self_identity_snapshots_user_id_idx" ON "public"."self_identity_snapshots" USING "btree" ("user_id");



CREATE INDEX "self_identity_snapshots_user_id_text_idx" ON "public"."self_identity_snapshots" USING "btree" ("user_id_text");



CREATE INDEX "self_identity_snapshots_user_id_uuid_idx" ON "public"."self_identity_snapshots" USING "btree" ("user_id_uuid");



CREATE INDEX "self_mirror_deltas_user_id_idx" ON "public"."self_mirror_deltas" USING "btree" ("user_id");



CREATE INDEX "self_mirror_deltas_user_id_text_idx" ON "public"."self_mirror_deltas" USING "btree" ("user_id_text");



CREATE INDEX "self_mirror_deltas_user_id_uuid_idx" ON "public"."self_mirror_deltas" USING "btree" ("user_id_uuid");



CREATE INDEX "self_mirror_facets_user_id_idx" ON "public"."self_mirror_facets" USING "btree" ("user_id");



CREATE INDEX "self_mirror_facets_user_id_text_idx" ON "public"."self_mirror_facets" USING "btree" ("user_id_text");



CREATE INDEX "self_mirror_facets_user_id_uuid_idx" ON "public"."self_mirror_facets" USING "btree" ("user_id_uuid");



CREATE INDEX "self_mirror_highlights_user_id_idx" ON "public"."self_mirror_highlights" USING "btree" ("user_id");



CREATE INDEX "self_mirror_highlights_user_id_text_idx" ON "public"."self_mirror_highlights" USING "btree" ("user_id_text");



CREATE INDEX "self_mirror_highlights_user_id_uuid_idx" ON "public"."self_mirror_highlights" USING "btree" ("user_id_uuid");



CREATE INDEX "self_mirror_sessions_user_id_idx" ON "public"."self_mirror_sessions" USING "btree" ("user_id");



CREATE INDEX "self_mirror_sessions_user_id_text_idx" ON "public"."self_mirror_sessions" USING "btree" ("user_id_text");



CREATE INDEX "self_mirror_sessions_user_id_uuid_idx" ON "public"."self_mirror_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "self_mirror_snapshots_user_id_idx" ON "public"."self_mirror_snapshots" USING "btree" ("user_id");



CREATE INDEX "self_mirror_snapshots_user_id_text_idx" ON "public"."self_mirror_snapshots" USING "btree" ("user_id_text");



CREATE INDEX "self_mirror_snapshots_user_id_uuid_idx" ON "public"."self_mirror_snapshots" USING "btree" ("user_id_uuid");



CREATE INDEX "self_perception_signals_user_id_idx" ON "public"."self_perception_signals" USING "btree" ("user_id");



CREATE INDEX "self_perception_signals_user_id_text_idx" ON "public"."self_perception_signals" USING "btree" ("user_id_text");



CREATE INDEX "self_perception_signals_user_id_uuid_idx" ON "public"."self_perception_signals" USING "btree" ("user_id_uuid");



CREATE INDEX "sim_decision_trees_user_id_idx" ON "public"."sim_decision_trees" USING "btree" ("user_id");



CREATE INDEX "sim_decision_trees_user_id_uuid_idx" ON "public"."sim_decision_trees" USING "btree" ("user_id_uuid");



CREATE INDEX "sim_history_user_id_idx" ON "public"."sim_history" USING "btree" ("user_id");



CREATE INDEX "sim_history_user_id_uuid_idx" ON "public"."sim_history" USING "btree" ("user_id_uuid");



CREATE INDEX "sim_history_user_idx" ON "public"."sim_history" USING "btree" ("user_id");



CREATE INDEX "sim_runs_user_id_idx" ON "public"."sim_runs" USING "btree" ("user_id");



CREATE INDEX "sim_runs_user_id_uuid_idx" ON "public"."sim_runs" USING "btree" ("user_id_uuid");



CREATE INDEX "sim_scenarios_simulation_idx" ON "public"."sim_scenarios" USING "btree" ("simulation_id");



CREATE INDEX "sim_scenarios_user_id_idx" ON "public"."sim_scenarios" USING "btree" ("user_id");



CREATE INDEX "sim_scenarios_user_id_uuid_idx" ON "public"."sim_scenarios" USING "btree" ("user_id_uuid");



CREATE INDEX "sim_scenarios_user_idx" ON "public"."sim_scenarios" USING "btree" ("user_id");



CREATE INDEX "sim_simulations_user_id_idx" ON "public"."sim_simulations" USING "btree" ("user_id");



CREATE INDEX "sim_simulations_user_id_uuid_idx" ON "public"."sim_simulations" USING "btree" ("user_id_uuid");



CREATE INDEX "sim_simulations_user_idx" ON "public"."sim_simulations" USING "btree" ("user_id", "status");



CREATE INDEX "sim_templates_category_idx" ON "public"."sim_templates" USING "btree" ("category");



CREATE INDEX "sim_trees_simulation_idx" ON "public"."sim_decision_trees" USING "btree" ("simulation_id");



CREATE INDEX "sim_what_ifs_user_id_idx" ON "public"."sim_what_ifs" USING "btree" ("user_id");



CREATE INDEX "sim_what_ifs_user_id_uuid_idx" ON "public"."sim_what_ifs" USING "btree" ("user_id_uuid");



CREATE INDEX "sim_what_ifs_user_idx" ON "public"."sim_what_ifs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "simulation_fix_plans_created_at_idx" ON "public"."simulation_fix_plans" USING "btree" ("created_at" DESC);



CREATE INDEX "simulation_fix_plans_request_id_idx" ON "public"."simulation_fix_plans" USING "btree" ("request_id");



CREATE INDEX "simulation_fix_plans_run_id_idx" ON "public"."simulation_fix_plans" USING "btree" ("run_id");



CREATE INDEX "simulation_fix_plans_user_id_idx" ON "public"."simulation_fix_plans" USING "btree" ("user_id");



CREATE INDEX "simulation_fix_plans_user_id_uuid_idx" ON "public"."simulation_fix_plans" USING "btree" ("user_id_uuid");



CREATE INDEX "simulation_models_user_id_idx" ON "public"."simulation_models" USING "btree" ("user_id");



CREATE INDEX "simulation_models_user_id_text_idx" ON "public"."simulation_models" USING "btree" ("user_id_text");



CREATE INDEX "simulation_models_user_id_uuid_idx" ON "public"."simulation_models" USING "btree" ("user_id_uuid");



CREATE INDEX "simulation_models_user_idx" ON "public"."simulation_models" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "simulation_outcomes_user_id_idx" ON "public"."simulation_outcomes" USING "btree" ("user_id");



CREATE INDEX "simulation_outcomes_user_id_text_idx" ON "public"."simulation_outcomes" USING "btree" ("user_id_text");



CREATE INDEX "simulation_outcomes_user_id_uuid_idx" ON "public"."simulation_outcomes" USING "btree" ("user_id_uuid");



CREATE INDEX "simulation_policies_user_id_idx" ON "public"."simulation_policies" USING "btree" ("user_id");



CREATE INDEX "simulation_policies_user_id_text_idx" ON "public"."simulation_policies" USING "btree" ("user_id_text");



CREATE INDEX "simulation_policies_user_id_uuid_idx" ON "public"."simulation_policies" USING "btree" ("user_id_uuid");



CREATE INDEX "simulation_runs_user_id_idx" ON "public"."simulation_runs" USING "btree" ("user_id");



CREATE INDEX "simulation_runs_user_id_text_idx" ON "public"."simulation_runs" USING "btree" ("user_id_text");



CREATE INDEX "simulation_runs_user_id_uuid_idx" ON "public"."simulation_runs" USING "btree" ("user_id_uuid");



CREATE INDEX "simulation_runs_user_idx" ON "public"."simulation_runs" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "simulation_steps_user_id_idx" ON "public"."simulation_steps" USING "btree" ("user_id");



CREATE INDEX "simulation_steps_user_id_text_idx" ON "public"."simulation_steps" USING "btree" ("user_id_text");



CREATE INDEX "simulation_steps_user_id_uuid_idx" ON "public"."simulation_steps" USING "btree" ("user_id_uuid");



CREATE INDEX "simulation_timelines_user_id_idx" ON "public"."simulation_timelines" USING "btree" ("user_id");



CREATE INDEX "simulation_timelines_user_id_text_idx" ON "public"."simulation_timelines" USING "btree" ("user_id_text");



CREATE INDEX "simulation_timelines_user_id_uuid_idx" ON "public"."simulation_timelines" USING "btree" ("user_id_uuid");



CREATE INDEX "sms_messages_user_id_idx" ON "public"."sms_messages" USING "btree" ("user_id");



CREATE INDEX "sms_messages_user_id_text_idx" ON "public"."sms_messages" USING "btree" ("user_id_text");



CREATE INDEX "sms_messages_user_id_uuid_idx" ON "public"."sms_messages" USING "btree" ("user_id_uuid");



CREATE INDEX "social_edges_user_id_idx" ON "public"."social_edges" USING "btree" ("user_id");



CREATE INDEX "social_edges_user_id_text_idx" ON "public"."social_edges" USING "btree" ("user_id_text");



CREATE INDEX "social_edges_user_id_uuid_idx" ON "public"."social_edges" USING "btree" ("user_id_uuid");



CREATE INDEX "social_entities_user_id_idx" ON "public"."social_entities" USING "btree" ("user_id");



CREATE INDEX "social_entities_user_id_text_idx" ON "public"."social_entities" USING "btree" ("user_id_text");



CREATE INDEX "social_entities_user_id_uuid_idx" ON "public"."social_entities" USING "btree" ("user_id_uuid");



CREATE INDEX "social_insights_user_id_idx" ON "public"."social_insights" USING "btree" ("user_id");



CREATE INDEX "social_insights_user_id_text_idx" ON "public"."social_insights" USING "btree" ("user_id_text");



CREATE INDEX "social_insights_user_id_uuid_idx" ON "public"."social_insights" USING "btree" ("user_id_uuid");



CREATE INDEX "social_nodes_user_id_idx" ON "public"."social_nodes" USING "btree" ("user_id");



CREATE INDEX "social_nodes_user_id_text_idx" ON "public"."social_nodes" USING "btree" ("user_id_text");



CREATE INDEX "social_nodes_user_id_uuid_idx" ON "public"."social_nodes" USING "btree" ("user_id_uuid");



CREATE INDEX "social_recommendations_user_id_idx" ON "public"."social_recommendations" USING "btree" ("user_id");



CREATE INDEX "social_recommendations_user_id_text_idx" ON "public"."social_recommendations" USING "btree" ("user_id_text");



CREATE INDEX "social_recommendations_user_id_uuid_idx" ON "public"."social_recommendations" USING "btree" ("user_id_uuid");



CREATE INDEX "social_risk_events_user_id_idx" ON "public"."social_risk_events" USING "btree" ("user_id");



CREATE INDEX "social_risk_events_user_id_text_idx" ON "public"."social_risk_events" USING "btree" ("user_id_text");



CREATE INDEX "social_risk_events_user_id_uuid_idx" ON "public"."social_risk_events" USING "btree" ("user_id_uuid");



CREATE INDEX "social_state_snapshots_user_id_idx" ON "public"."social_state_snapshots" USING "btree" ("user_id");



CREATE INDEX "social_state_snapshots_user_id_text_idx" ON "public"."social_state_snapshots" USING "btree" ("user_id_text");



CREATE INDEX "social_state_snapshots_user_id_uuid_idx" ON "public"."social_state_snapshots" USING "btree" ("user_id_uuid");



CREATE INDEX "somatic_alerts_user_id_idx" ON "public"."somatic_alerts" USING "btree" ("user_id");



CREATE INDEX "somatic_alerts_user_id_text_idx" ON "public"."somatic_alerts" USING "btree" ("user_id_text");



CREATE INDEX "somatic_alerts_user_id_uuid_idx" ON "public"."somatic_alerts" USING "btree" ("user_id_uuid");



CREATE INDEX "somatic_daily_metrics_user_id_idx" ON "public"."somatic_daily_metrics" USING "btree" ("user_id");



CREATE INDEX "somatic_daily_metrics_user_id_text_idx" ON "public"."somatic_daily_metrics" USING "btree" ("user_id_text");



CREATE INDEX "somatic_daily_metrics_user_id_uuid_idx" ON "public"."somatic_daily_metrics" USING "btree" ("user_id_uuid");



CREATE INDEX "somatic_device_settings_user_id_idx" ON "public"."somatic_device_settings" USING "btree" ("user_id");



CREATE INDEX "somatic_device_settings_user_id_text_idx" ON "public"."somatic_device_settings" USING "btree" ("user_id_text");



CREATE INDEX "somatic_device_settings_user_id_uuid_idx" ON "public"."somatic_device_settings" USING "btree" ("user_id_uuid");



CREATE INDEX "somatic_patterns_user_id_idx" ON "public"."somatic_patterns" USING "btree" ("user_id");



CREATE INDEX "somatic_patterns_user_id_text_idx" ON "public"."somatic_patterns" USING "btree" ("user_id_text");



CREATE INDEX "somatic_patterns_user_id_uuid_idx" ON "public"."somatic_patterns" USING "btree" ("user_id_uuid");



CREATE INDEX "somatic_raw_device_events_user_id_idx" ON "public"."somatic_raw_device_events" USING "btree" ("user_id");



CREATE INDEX "somatic_raw_device_events_user_id_text_idx" ON "public"."somatic_raw_device_events" USING "btree" ("user_id_text");



CREATE INDEX "somatic_raw_device_events_user_id_uuid_idx" ON "public"."somatic_raw_device_events" USING "btree" ("user_id_uuid");



CREATE INDEX "somatic_samples_user_id_idx" ON "public"."somatic_samples" USING "btree" ("user_id");



CREATE INDEX "somatic_samples_user_id_text_idx" ON "public"."somatic_samples" USING "btree" ("user_id_text");



CREATE INDEX "somatic_samples_user_id_uuid_idx" ON "public"."somatic_samples" USING "btree" ("user_id_uuid");



CREATE INDEX "somatic_state_daily_user_id_idx" ON "public"."somatic_state_daily" USING "btree" ("user_id");



CREATE INDEX "somatic_state_daily_user_id_text_idx" ON "public"."somatic_state_daily" USING "btree" ("user_id_text");



CREATE INDEX "somatic_state_daily_user_id_uuid_idx" ON "public"."somatic_state_daily" USING "btree" ("user_id_uuid");



CREATE INDEX "strategic_conflicts_user_id_idx" ON "public"."strategic_conflicts" USING "btree" ("user_id");



CREATE INDEX "strategic_conflicts_user_id_text_idx" ON "public"."strategic_conflicts" USING "btree" ("user_id_text");



CREATE INDEX "strategic_conflicts_user_id_uuid_idx" ON "public"."strategic_conflicts" USING "btree" ("user_id_uuid");



CREATE INDEX "strategic_domains_user_id_idx" ON "public"."strategic_domains" USING "btree" ("user_id");



CREATE INDEX "strategic_domains_user_id_text_idx" ON "public"."strategic_domains" USING "btree" ("user_id_text");



CREATE INDEX "strategic_domains_user_id_uuid_idx" ON "public"."strategic_domains" USING "btree" ("user_id_uuid");



CREATE INDEX "strategic_equilibria_user_id_idx" ON "public"."strategic_equilibria" USING "btree" ("user_id");



CREATE INDEX "strategic_equilibria_user_id_text_idx" ON "public"."strategic_equilibria" USING "btree" ("user_id_text");



CREATE INDEX "strategic_equilibria_user_id_uuid_idx" ON "public"."strategic_equilibria" USING "btree" ("user_id_uuid");



CREATE INDEX "strategic_objectives_user_id_idx" ON "public"."strategic_objectives" USING "btree" ("user_id");



CREATE INDEX "strategic_objectives_user_id_text_idx" ON "public"."strategic_objectives" USING "btree" ("user_id_text");



CREATE INDEX "strategic_objectives_user_id_uuid_idx" ON "public"."strategic_objectives" USING "btree" ("user_id_uuid");



CREATE INDEX "strategic_plans_user_id_idx" ON "public"."strategic_plans" USING "btree" ("user_id");



CREATE INDEX "strategic_plans_user_id_text_idx" ON "public"."strategic_plans" USING "btree" ("user_id_text");



CREATE INDEX "strategic_plans_user_id_uuid_idx" ON "public"."strategic_plans" USING "btree" ("user_id_uuid");



CREATE INDEX "strategic_review_events_user_id_idx" ON "public"."strategic_review_events" USING "btree" ("user_id");



CREATE INDEX "strategic_review_events_user_id_text_idx" ON "public"."strategic_review_events" USING "btree" ("user_id_text");



CREATE INDEX "strategic_review_events_user_id_uuid_idx" ON "public"."strategic_review_events" USING "btree" ("user_id_uuid");



CREATE INDEX "strategic_state_snapshots_user_id_idx" ON "public"."strategic_state_snapshots" USING "btree" ("user_id");



CREATE INDEX "strategic_state_snapshots_user_id_text_idx" ON "public"."strategic_state_snapshots" USING "btree" ("user_id_text");



CREATE INDEX "strategic_state_snapshots_user_id_uuid_idx" ON "public"."strategic_state_snapshots" USING "btree" ("user_id_uuid");



CREATE INDEX "strategist_sessions_user_id_idx" ON "public"."strategist_sessions" USING "btree" ("user_id");



CREATE INDEX "strategist_sessions_user_id_text_idx" ON "public"."strategist_sessions" USING "btree" ("user_id_text");



CREATE INDEX "strategist_sessions_user_id_uuid_idx" ON "public"."strategist_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "strategy_feedback_user_id_idx" ON "public"."strategy_feedback" USING "btree" ("user_id");



CREATE INDEX "strategy_feedback_user_id_text_idx" ON "public"."strategy_feedback" USING "btree" ("user_id_text");



CREATE INDEX "strategy_feedback_user_id_uuid_idx" ON "public"."strategy_feedback" USING "btree" ("user_id_uuid");



CREATE INDEX "strategy_recommendations_user_id_idx" ON "public"."strategy_recommendations" USING "btree" ("user_id");



CREATE INDEX "strategy_recommendations_user_id_text_idx" ON "public"."strategy_recommendations" USING "btree" ("user_id_text");



CREATE INDEX "strategy_recommendations_user_id_uuid_idx" ON "public"."strategy_recommendations" USING "btree" ("user_id_uuid");



CREATE INDEX "strategy_snapshots_user_id_idx" ON "public"."strategy_snapshots" USING "btree" ("user_id");



CREATE INDEX "strategy_snapshots_user_id_text_idx" ON "public"."strategy_snapshots" USING "btree" ("user_id_text");



CREATE INDEX "strategy_snapshots_user_id_uuid_idx" ON "public"."strategy_snapshots" USING "btree" ("user_id_uuid");



CREATE INDEX "strategy_snapshots_user_idx" ON "public"."strategy_snapshots" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "streaks_user_id_idx" ON "public"."streaks" USING "btree" ("user_id");



CREATE INDEX "streaks_user_id_uuid_idx" ON "public"."streaks" USING "btree" ("user_id_uuid");



CREATE INDEX "system_user_feedback_user_id_idx" ON "public"."system_user_feedback" USING "btree" ("user_id");



CREATE INDEX "system_user_feedback_user_id_text_idx" ON "public"."system_user_feedback" USING "btree" ("user_id_text");



CREATE INDEX "system_user_feedback_user_id_uuid_idx" ON "public"."system_user_feedback" USING "btree" ("user_id_uuid");



CREATE INDEX "task_events_event_type_idx" ON "public"."task_events" USING "btree" ("event_type");



CREATE INDEX "task_events_task_id_created_at_idx" ON "public"."task_events" USING "btree" ("task_id", "created_at" DESC);



CREATE INDEX "task_events_user_id_idx" ON "public"."task_events" USING "btree" ("user_id");



CREATE INDEX "task_events_user_id_text_idx" ON "public"."task_events" USING "btree" ("user_id_text");



CREATE INDEX "task_events_user_id_uuid_idx" ON "public"."task_events" USING "btree" ("user_id_uuid");



CREATE INDEX "tasks_ai_triaged_at_idx" ON "public"."tasks" USING "btree" ("ai_triaged_at" DESC);



CREATE INDEX "tasks_deal_id_idx" ON "public"."tasks" USING "btree" ("deal_id");



CREATE INDEX "tasks_defer_until_idx" ON "public"."tasks" USING "btree" ("defer_until");



CREATE INDEX "tasks_due_at_idx" ON "public"."tasks" USING "btree" ("due_at");



CREATE INDEX "tasks_due_at_nulls_last_idx" ON "public"."tasks" USING "btree" ("due_at");



CREATE INDEX "tasks_due_date_idx" ON "public"."tasks" USING "btree" ("due_date");



CREATE INDEX "tasks_execution_idx" ON "public"."tasks" USING "btree" ("status", "defer_until", "due_at", "priority" DESC, "updated_at" DESC);



CREATE INDEX "tasks_owner_user_id_idx" ON "public"."tasks" USING "btree" ("owner_user_id");



CREATE INDEX "tasks_priority_idx" ON "public"."tasks" USING "btree" ("priority" DESC);



CREATE INDEX "tasks_status_due_idx" ON "public"."tasks" USING "btree" ("status", "due_at");



CREATE INDEX "tasks_status_idx" ON "public"."tasks" USING "btree" ("status");



CREATE INDEX "tasks_user_id_idx" ON "public"."tasks" USING "btree" ("user_id");



CREATE INDEX "tasks_user_id_status_due_idx" ON "public"."tasks" USING "btree" ("user_id", "status", "due_at");



CREATE INDEX "tasks_user_id_text_idx" ON "public"."tasks" USING "btree" ("user_id_text");



CREATE INDEX "tasks_user_id_uuid_idx" ON "public"."tasks" USING "btree" ("user_id_uuid");



CREATE INDEX "tb_chapters_user_id_idx" ON "public"."tb_chapters" USING "btree" ("user_id");



CREATE INDEX "tb_chapters_user_id_text_idx" ON "public"."tb_chapters" USING "btree" ("user_id_text");



CREATE INDEX "tb_chapters_user_id_uuid_idx" ON "public"."tb_chapters" USING "btree" ("user_id_uuid");



CREATE INDEX "tb_context_snapshots_user_date_idx" ON "public"."tb_context_snapshots" USING "btree" ("user_id", "snapshot_date" DESC);



CREATE INDEX "tb_context_snapshots_user_id_idx" ON "public"."tb_context_snapshots" USING "btree" ("user_id");



CREATE INDEX "tb_context_snapshots_user_id_uuid_idx" ON "public"."tb_context_snapshots" USING "btree" ("user_id_uuid");



CREATE INDEX "tb_edges_from_idx" ON "public"."tb_edges" USING "btree" ("from_node_id");



CREATE INDEX "tb_edges_kind_idx" ON "public"."tb_edges" USING "btree" ("kind");



CREATE INDEX "tb_edges_to_idx" ON "public"."tb_edges" USING "btree" ("to_node_id");



CREATE INDEX "tb_edges_user_id_idx" ON "public"."tb_edges" USING "btree" ("user_id");



CREATE INDEX "tb_edges_user_id_text_idx" ON "public"."tb_edges" USING "btree" ("user_id_text");



CREATE INDEX "tb_edges_user_id_uuid_idx" ON "public"."tb_edges" USING "btree" ("user_id_uuid");



CREATE INDEX "tb_edges_user_idx" ON "public"."tb_edges" USING "btree" ("user_id");



CREATE INDEX "tb_embeddings_fragment_idx" ON "public"."tb_embeddings" USING "btree" ("fragment_id");



CREATE INDEX "tb_embeddings_user_id_idx" ON "public"."tb_embeddings" USING "btree" ("user_id");



CREATE INDEX "tb_embeddings_user_id_uuid_idx" ON "public"."tb_embeddings" USING "btree" ("user_id_uuid");



CREATE INDEX "tb_embeddings_user_idx" ON "public"."tb_embeddings" USING "btree" ("user_id");



CREATE INDEX "tb_embeddings_vector_idx" ON "public"."tb_embeddings" USING "ivfflat" ("embedding" "public"."vector_cosine_ops") WITH ("lists"='100');



CREATE UNIQUE INDEX "tb_entities_canonical_idx" ON "public"."tb_entities" USING "btree" ("user_id", "canonical_key") WHERE ("canonical_key" IS NOT NULL);



CREATE INDEX "tb_entities_importance_idx" ON "public"."tb_entities" USING "btree" ("user_id", "importance" DESC);



CREATE INDEX "tb_entities_name_idx" ON "public"."tb_entities" USING "btree" ("user_id", "lower"("name"));



CREATE INDEX "tb_entities_user_id_idx" ON "public"."tb_entities" USING "btree" ("user_id");



CREATE INDEX "tb_entities_user_id_uuid_idx" ON "public"."tb_entities" USING "btree" ("user_id_uuid");



CREATE INDEX "tb_entities_user_type_idx" ON "public"."tb_entities" USING "btree" ("user_id", "entity_type");



CREATE INDEX "tb_entity_edges_from_idx" ON "public"."tb_entity_edges" USING "btree" ("user_id", "from_entity_id");



CREATE INDEX "tb_entity_edges_to_idx" ON "public"."tb_entity_edges" USING "btree" ("user_id", "to_entity_id");



CREATE INDEX "tb_entity_edges_type_idx" ON "public"."tb_entity_edges" USING "btree" ("user_id", "relation_type");



CREATE UNIQUE INDEX "tb_entity_edges_unique_idx" ON "public"."tb_entity_edges" USING "btree" ("user_id", "from_entity_id", "to_entity_id", "relation_type");



CREATE INDEX "tb_entity_edges_user_id_idx" ON "public"."tb_entity_edges" USING "btree" ("user_id");



CREATE INDEX "tb_entity_edges_user_id_uuid_idx" ON "public"."tb_entity_edges" USING "btree" ("user_id_uuid");



CREATE INDEX "tb_entity_fragment_entity_idx" ON "public"."tb_entity_fragment_links" USING "btree" ("entity_id");



CREATE INDEX "tb_entity_fragment_fragment_idx" ON "public"."tb_entity_fragment_links" USING "btree" ("fragment_id");



CREATE INDEX "tb_entity_fragment_links_user_id_idx" ON "public"."tb_entity_fragment_links" USING "btree" ("user_id");



CREATE INDEX "tb_entity_fragment_links_user_id_uuid_idx" ON "public"."tb_entity_fragment_links" USING "btree" ("user_id_uuid");



CREATE UNIQUE INDEX "tb_entity_fragment_unique_idx" ON "public"."tb_entity_fragment_links" USING "btree" ("entity_id", "fragment_id");



CREATE INDEX "tb_insights_category_idx" ON "public"."tb_insights" USING "btree" ("user_id", "category");



CREATE INDEX "tb_insights_user_id_idx" ON "public"."tb_insights" USING "btree" ("user_id");



CREATE INDEX "tb_insights_user_id_uuid_idx" ON "public"."tb_insights" USING "btree" ("user_id_uuid");



CREATE INDEX "tb_insights_user_status_idx" ON "public"."tb_insights" USING "btree" ("user_id", "status", "created_at" DESC);



CREATE INDEX "tb_memory_fragments_importance_idx" ON "public"."tb_memory_fragments" USING "btree" ("user_id", "importance" DESC);



CREATE INDEX "tb_memory_fragments_type_idx" ON "public"."tb_memory_fragments" USING "btree" ("user_id", "fragment_type");



CREATE INDEX "tb_memory_fragments_user_id_idx" ON "public"."tb_memory_fragments" USING "btree" ("user_id");



CREATE INDEX "tb_memory_fragments_user_id_uuid_idx" ON "public"."tb_memory_fragments" USING "btree" ("user_id_uuid");



CREATE INDEX "tb_memory_fragments_user_idx" ON "public"."tb_memory_fragments" USING "btree" ("user_id", "occurred_at" DESC);



CREATE UNIQUE INDEX "tb_node_types_key_unique" ON "public"."tb_node_types" USING "btree" ("key");



CREATE INDEX "tb_nodes_source_idx" ON "public"."tb_nodes" USING "btree" ("source_table", "source_id");



CREATE INDEX "tb_nodes_time_idx" ON "public"."tb_nodes" USING "btree" ("started_at", "ended_at");



CREATE INDEX "tb_nodes_type_idx" ON "public"."tb_nodes" USING "btree" ("type");



CREATE INDEX "tb_nodes_user_id_idx" ON "public"."tb_nodes" USING "btree" ("user_id");



CREATE INDEX "tb_nodes_user_id_text_idx" ON "public"."tb_nodes" USING "btree" ("user_id_text");



CREATE INDEX "tb_nodes_user_id_uuid_idx" ON "public"."tb_nodes" USING "btree" ("user_id_uuid");



CREATE INDEX "tb_nodes_user_idx" ON "public"."tb_nodes" USING "btree" ("user_id");



CREATE INDEX "tb_raw_events_unprocessed_idx" ON "public"."tb_raw_events" USING "btree" ("user_id", "processed") WHERE ("processed" = false);



CREATE INDEX "tb_raw_events_user_id_idx" ON "public"."tb_raw_events" USING "btree" ("user_id");



CREATE INDEX "tb_raw_events_user_id_uuid_idx" ON "public"."tb_raw_events" USING "btree" ("user_id_uuid");



CREATE INDEX "tb_raw_events_user_idx" ON "public"."tb_raw_events" USING "btree" ("user_id", "occurred_at" DESC);



CREATE INDEX "tb_user_patterns_user_id_idx" ON "public"."tb_user_patterns" USING "btree" ("user_id");



CREATE INDEX "tb_user_patterns_user_id_uuid_idx" ON "public"."tb_user_patterns" USING "btree" ("user_id_uuid");



CREATE INDEX "tb_user_patterns_user_type_idx" ON "public"."tb_user_patterns" USING "btree" ("user_id", "pattern_type");



CREATE INDEX "teachings_user_id_idx" ON "public"."teachings" USING "btree" ("user_id");



CREATE INDEX "teachings_user_id_uuid_idx" ON "public"."teachings" USING "btree" ("user_id_uuid");



CREATE INDEX "theory_of_mind_profiles_user_id_idx" ON "public"."theory_of_mind_profiles" USING "btree" ("user_id");



CREATE INDEX "theory_of_mind_profiles_user_id_text_idx" ON "public"."theory_of_mind_profiles" USING "btree" ("user_id_text");



CREATE INDEX "theory_of_mind_profiles_user_id_uuid_idx" ON "public"."theory_of_mind_profiles" USING "btree" ("user_id_uuid");



CREATE INDEX "third_brain_events_user_id_idx" ON "public"."third_brain_events" USING "btree" ("user_id");



CREATE INDEX "third_brain_events_user_id_uuid_idx" ON "public"."third_brain_events" USING "btree" ("user_id_uuid");



CREATE INDEX "third_brain_insights_user_id_idx" ON "public"."third_brain_insights" USING "btree" ("user_id");



CREATE INDEX "third_brain_insights_user_id_uuid_idx" ON "public"."third_brain_insights" USING "btree" ("user_id_uuid");



CREATE INDEX "third_brain_memories_user_id_idx" ON "public"."third_brain_memories" USING "btree" ("user_id");



CREATE INDEX "third_brain_memories_user_id_uuid_idx" ON "public"."third_brain_memories" USING "btree" ("user_id_uuid");



CREATE INDEX "timeline_coach_sessions_user_id_idx" ON "public"."timeline_coach_sessions" USING "btree" ("user_id");



CREATE INDEX "timeline_coach_sessions_user_id_text_idx" ON "public"."timeline_coach_sessions" USING "btree" ("user_id_text");



CREATE INDEX "timeline_coach_sessions_user_id_uuid_idx" ON "public"."timeline_coach_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "timeline_commitments_user_id_idx" ON "public"."timeline_commitments" USING "btree" ("user_id");



CREATE INDEX "timeline_commitments_user_id_text_idx" ON "public"."timeline_commitments" USING "btree" ("user_id_text");



CREATE INDEX "timeline_commitments_user_id_uuid_idx" ON "public"."timeline_commitments" USING "btree" ("user_id_uuid");



CREATE INDEX "timeline_decisions_user_id_idx" ON "public"."timeline_decisions" USING "btree" ("user_id");



CREATE INDEX "timeline_decisions_user_id_text_idx" ON "public"."timeline_decisions" USING "btree" ("user_id_text");



CREATE INDEX "timeline_decisions_user_id_uuid_idx" ON "public"."timeline_decisions" USING "btree" ("user_id_uuid");



CREATE INDEX "timeline_preference_profile_user_id_idx" ON "public"."timeline_preference_profile" USING "btree" ("user_id");



CREATE INDEX "timeline_preference_profile_user_id_text_idx" ON "public"."timeline_preference_profile" USING "btree" ("user_id_text");



CREATE INDEX "timeline_preference_profile_user_id_uuid_idx" ON "public"."timeline_preference_profile" USING "btree" ("user_id_uuid");



CREATE INDEX "timeline_reflections_user_id_idx" ON "public"."timeline_reflections" USING "btree" ("user_id");



CREATE INDEX "timeline_reflections_user_id_text_idx" ON "public"."timeline_reflections" USING "btree" ("user_id_text");



CREATE INDEX "timeline_reflections_user_id_uuid_idx" ON "public"."timeline_reflections" USING "btree" ("user_id_uuid");



CREATE UNIQUE INDEX "uq_inbox_actions_once_per_type" ON "public"."inbox_actions" USING "btree" ("user_id_uuid", "inbox_item_id", "action_type") WHERE ("action_type" = ANY (ARRAY['create_follow_up'::"text", 'create_task'::"text"]));



CREATE UNIQUE INDEX "uq_inbox_items_source_msg" ON "public"."inbox_items" USING "btree" ("user_id_uuid", "source", "source_message_id") WHERE ("source_message_id" IS NOT NULL);



CREATE UNIQUE INDEX "uq_inbox_rule_outcome_once" ON "public"."inbox_rule_outcomes" USING "btree" ("user_id_uuid", "inbox_item_id", "rule_id") WHERE (("matched" = true) AND ("rule_id" IS NOT NULL));



CREATE UNIQUE INDEX "uq_reply_drafts_one_per_item" ON "public"."reply_drafts" USING "btree" ("user_id_uuid", "inbox_item_id") WHERE ("status" <> 'archived'::"text");



CREATE UNIQUE INDEX "uq_reply_drafts_outbox_id" ON "public"."reply_drafts" USING "btree" ("user_id_uuid", "outbox_id") WHERE ("outbox_id" IS NOT NULL);



CREATE INDEX "usage_logs_user_id_idx" ON "public"."usage_logs" USING "btree" ("user_id");



CREATE INDEX "usage_logs_user_id_uuid_idx" ON "public"."usage_logs" USING "btree" ("user_id_uuid");



CREATE INDEX "user_agi_settings_user_id_idx" ON "public"."user_agi_settings" USING "btree" ("user_id");



CREATE INDEX "user_agi_settings_user_id_text_idx" ON "public"."user_agi_settings" USING "btree" ("user_id_text");



CREATE INDEX "user_agi_settings_user_id_uuid_idx" ON "public"."user_agi_settings" USING "btree" ("user_id_uuid");



CREATE INDEX "user_archetype_profiles_user_id_idx" ON "public"."user_archetype_profiles" USING "btree" ("user_id");



CREATE INDEX "user_archetype_profiles_user_id_text_idx" ON "public"."user_archetype_profiles" USING "btree" ("user_id_text");



CREATE INDEX "user_archetype_profiles_user_id_uuid_idx" ON "public"."user_archetype_profiles" USING "btree" ("user_id_uuid");



CREATE INDEX "user_dashboard_layouts_user_id_idx" ON "public"."user_dashboard_layouts" USING "btree" ("user_id");



CREATE INDEX "user_dashboard_layouts_user_id_uuid_idx" ON "public"."user_dashboard_layouts" USING "btree" ("user_id_uuid");



CREATE INDEX "user_experiment_arms_experiment_idx" ON "public"."user_experiment_arms" USING "btree" ("experiment_id");



CREATE INDEX "user_experiment_data_points_experiment_idx" ON "public"."user_experiment_data_points" USING "btree" ("experiment_id");



CREATE INDEX "user_experiment_data_points_metric_idx" ON "public"."user_experiment_data_points" USING "btree" ("metric_key");



CREATE UNIQUE INDEX "user_experiment_results_experiment_unique" ON "public"."user_experiment_results" USING "btree" ("experiment_id");



CREATE INDEX "user_experiments_user_id_idx" ON "public"."user_experiments" USING "btree" ("user_id");



CREATE INDEX "user_experiments_user_id_text_idx" ON "public"."user_experiments" USING "btree" ("user_id_text");



CREATE INDEX "user_experiments_user_id_uuid_idx" ON "public"."user_experiments" USING "btree" ("user_id_uuid");



CREATE INDEX "user_experiments_user_idx" ON "public"."user_experiments" USING "btree" ("user_id");



CREATE INDEX "user_focus_profile_user_id_idx" ON "public"."user_focus_profile" USING "btree" ("user_id");



CREATE INDEX "user_focus_profile_user_id_text_idx" ON "public"."user_focus_profile" USING "btree" ("user_id_text");



CREATE INDEX "user_focus_profile_user_id_uuid_idx" ON "public"."user_focus_profile" USING "btree" ("user_id_uuid");



CREATE INDEX "user_interview_sessions_user_id_idx" ON "public"."user_interview_sessions" USING "btree" ("user_id");



CREATE INDEX "user_interview_sessions_user_id_uuid_idx" ON "public"."user_interview_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "user_job_profiles_user_id_idx" ON "public"."user_job_profiles" USING "btree" ("user_id");



CREATE INDEX "user_job_profiles_user_id_text_idx" ON "public"."user_job_profiles" USING "btree" ("user_id_text");



CREATE INDEX "user_job_profiles_user_id_uuid_idx" ON "public"."user_job_profiles" USING "btree" ("user_id_uuid");



CREATE INDEX "user_mythic_coach_settings_user_id_idx" ON "public"."user_mythic_coach_settings" USING "btree" ("user_id");



CREATE INDEX "user_mythic_coach_settings_user_id_text_idx" ON "public"."user_mythic_coach_settings" USING "btree" ("user_id_text");



CREATE INDEX "user_mythic_coach_settings_user_id_uuid_idx" ON "public"."user_mythic_coach_settings" USING "btree" ("user_id_uuid");



CREATE INDEX "user_mythic_profile_user_id_idx" ON "public"."user_mythic_profile" USING "btree" ("user_id");



CREATE INDEX "user_mythic_profile_user_id_text_idx" ON "public"."user_mythic_profile" USING "btree" ("user_id_text");



CREATE INDEX "user_mythic_profile_user_id_uuid_idx" ON "public"."user_mythic_profile" USING "btree" ("user_id_uuid");



CREATE INDEX "user_onboarding_state_user_id_idx" ON "public"."user_onboarding_state" USING "btree" ("user_id");



CREATE INDEX "user_onboarding_state_user_id_text_idx" ON "public"."user_onboarding_state" USING "btree" ("user_id_text");



CREATE INDEX "user_onboarding_state_user_id_uuid_idx" ON "public"."user_onboarding_state" USING "btree" ("user_id_uuid");



CREATE INDEX "user_packs_user_id_idx" ON "public"."user_packs" USING "btree" ("user_id");



CREATE INDEX "user_packs_user_id_uuid_idx" ON "public"."user_packs" USING "btree" ("user_id_uuid");



CREATE INDEX "user_persona_tuning_user_id_idx" ON "public"."user_persona_tuning" USING "btree" ("user_id");



CREATE INDEX "user_persona_tuning_user_id_text_idx" ON "public"."user_persona_tuning" USING "btree" ("user_id_text");



CREATE INDEX "user_persona_tuning_user_id_uuid_idx" ON "public"."user_persona_tuning" USING "btree" ("user_id_uuid");



CREATE INDEX "user_philosophy_progress_user_id_idx" ON "public"."user_philosophy_progress" USING "btree" ("user_id");



CREATE INDEX "user_philosophy_progress_user_id_text_idx" ON "public"."user_philosophy_progress" USING "btree" ("user_id_text");



CREATE INDEX "user_philosophy_progress_user_id_uuid_idx" ON "public"."user_philosophy_progress" USING "btree" ("user_id_uuid");



CREATE INDEX "user_philosophy_progress_user_idx" ON "public"."user_philosophy_progress" USING "btree" ("user_id");



CREATE UNIQUE INDEX "user_plugins_unique_idx" ON "public"."user_plugins" USING "btree" ("user_id", "plugin_id");



CREATE INDEX "user_plugins_user_id_idx" ON "public"."user_plugins" USING "btree" ("user_id");



CREATE INDEX "user_plugins_user_id_uuid_idx" ON "public"."user_plugins" USING "btree" ("user_id_uuid");



CREATE INDEX "user_plugins_user_idx" ON "public"."user_plugins" USING "btree" ("user_id", "status");



CREATE INDEX "user_prefs_user_id_idx" ON "public"."user_prefs" USING "btree" ("user_id");



CREATE INDEX "user_prefs_user_id_uuid_idx" ON "public"."user_prefs" USING "btree" ("user_id_uuid");



CREATE INDEX "user_profiles_user_id_idx" ON "public"."user_profiles" USING "btree" ("user_id");



CREATE INDEX "user_profiles_user_id_uuid_idx" ON "public"."user_profiles" USING "btree" ("user_id_uuid");



CREATE INDEX "user_safety_settings_user_id_idx" ON "public"."user_safety_settings" USING "btree" ("user_id");



CREATE INDEX "user_safety_settings_user_id_text_idx" ON "public"."user_safety_settings" USING "btree" ("user_id_text");



CREATE INDEX "user_safety_settings_user_id_uuid_idx" ON "public"."user_safety_settings" USING "btree" ("user_id_uuid");



CREATE INDEX "user_settings_user_id_idx" ON "public"."user_settings" USING "btree" ("user_id");



CREATE INDEX "user_settings_user_id_uuid_idx" ON "public"."user_settings" USING "btree" ("user_id_uuid");



CREATE UNIQUE INDEX "users_clerk_id_uidx" ON "public"."users" USING "btree" ("clerk_id");



CREATE UNIQUE INDEX "users_clerk_user_id_uidx" ON "public"."users" USING "btree" ("clerk_user_id");



CREATE UNIQUE INDEX "ux_habit_logs_unique" ON "public"."habit_logs" USING "btree" ("user_id", "habit_id", "occurred_on");



CREATE UNIQUE INDEX "ux_job_queue_user_job_idempotency" ON "public"."job_queue" USING "btree" ("user_id", "job_type", "idempotency_key") WHERE ("idempotency_key" IS NOT NULL);



CREATE UNIQUE INDEX "ux_life_arc_autopilot_suggestions_user_idem" ON "public"."life_arc_autopilot_suggestions" USING "btree" ("user_id", "idempotency_key");



CREATE UNIQUE INDEX "ux_users_clerk_user_id" ON "public"."users" USING "btree" ("clerk_user_id") WHERE ("clerk_user_id" IS NOT NULL);



CREATE INDEX "value_profile_user_id_idx" ON "public"."value_profile" USING "btree" ("user_id");



CREATE INDEX "value_profile_user_id_text_idx" ON "public"."value_profile" USING "btree" ("user_id_text");



CREATE INDEX "value_profile_user_id_uuid_idx" ON "public"."value_profile" USING "btree" ("user_id_uuid");



CREATE INDEX "vault_access_item_idx" ON "public"."vault_access_log" USING "btree" ("item_id", "created_at" DESC);



CREATE INDEX "vault_access_log_user_id_idx" ON "public"."vault_access_log" USING "btree" ("user_id");



CREATE INDEX "vault_access_log_user_id_uuid_idx" ON "public"."vault_access_log" USING "btree" ("user_id_uuid");



CREATE INDEX "vault_access_user_idx" ON "public"."vault_access_log" USING "btree" ("user_id", "created_at" DESC);



CREATE INDEX "vault_emergency_access_user_id_idx" ON "public"."vault_emergency_access" USING "btree" ("user_id");



CREATE INDEX "vault_emergency_access_user_id_uuid_idx" ON "public"."vault_emergency_access" USING "btree" ("user_id_uuid");



CREATE INDEX "vault_emergency_user_idx" ON "public"."vault_emergency_access" USING "btree" ("user_id");



CREATE INDEX "vault_items_tags_idx" ON "public"."vault_items" USING "gin" ("tags") WHERE ("deleted" = false);



CREATE INDEX "vault_items_user_id_idx" ON "public"."vault_items" USING "btree" ("user_id");



CREATE INDEX "vault_items_user_id_uuid_idx" ON "public"."vault_items" USING "btree" ("user_id_uuid");



CREATE INDEX "vault_items_user_idx" ON "public"."vault_items" USING "btree" ("user_id", "deleted", "item_type");



CREATE INDEX "vault_keys_user_id_idx" ON "public"."vault_keys" USING "btree" ("user_id");



CREATE INDEX "vault_keys_user_id_uuid_idx" ON "public"."vault_keys" USING "btree" ("user_id_uuid");



CREATE UNIQUE INDEX "vault_keys_user_name_idx" ON "public"."vault_keys" USING "btree" ("user_id", "key_name") WHERE ("revoked" = false);



CREATE INDEX "vault_notes_user_idx" ON "public"."vault_secure_notes" USING "btree" ("user_id", "pinned" DESC, "updated_at" DESC);



CREATE INDEX "vault_secure_notes_user_id_idx" ON "public"."vault_secure_notes" USING "btree" ("user_id");



CREATE INDEX "vault_secure_notes_user_id_uuid_idx" ON "public"."vault_secure_notes" USING "btree" ("user_id_uuid");



CREATE INDEX "vault_shares_owner_idx" ON "public"."vault_shares" USING "btree" ("owner_user_id") WHERE ("revoked" = false);



CREATE INDEX "vault_shares_recipient_idx" ON "public"."vault_shares" USING "btree" ("shared_with_user_id") WHERE ("revoked" = false);



CREATE INDEX "vault_shares_token_idx" ON "public"."vault_shares" USING "btree" ("share_token") WHERE (("share_token" IS NOT NULL) AND ("revoked" = false));



CREATE INDEX "vertical_metrics_user_id_idx" ON "public"."vertical_metrics" USING "btree" ("user_id");



CREATE INDEX "vertical_metrics_user_id_text_idx" ON "public"."vertical_metrics" USING "btree" ("user_id_text");



CREATE INDEX "vertical_metrics_user_id_uuid_idx" ON "public"."vertical_metrics" USING "btree" ("user_id_uuid");



CREATE INDEX "vertical_metrics_user_vertical_idx" ON "public"."vertical_metrics" USING "btree" ("user_id", "vertical_key");



CREATE INDEX "voice_sessions_user_id_idx" ON "public"."voice_sessions" USING "btree" ("user_id");



CREATE INDEX "voice_sessions_user_id_text_idx" ON "public"."voice_sessions" USING "btree" ("user_id_text");



CREATE INDEX "voice_sessions_user_id_uuid_idx" ON "public"."voice_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "voice_turns_session_id_idx" ON "public"."voice_turns" USING "btree" ("session_id");



CREATE INDEX "voice_turns_user_id_idx" ON "public"."voice_turns" USING "btree" ("user_id");



CREATE INDEX "voice_turns_user_id_text_idx" ON "public"."voice_turns" USING "btree" ("user_id_text");



CREATE INDEX "voice_turns_user_id_uuid_idx" ON "public"."voice_turns" USING "btree" ("user_id_uuid");



CREATE INDEX "voicemails_user_id_idx" ON "public"."voicemails" USING "btree" ("user_id");



CREATE INDEX "voicemails_user_id_uuid_idx" ON "public"."voicemails" USING "btree" ("user_id_uuid");



CREATE INDEX "weekly_plans_user_id_idx" ON "public"."weekly_plans" USING "btree" ("user_id");



CREATE INDEX "weekly_plans_user_id_uuid_idx" ON "public"."weekly_plans" USING "btree" ("user_id_uuid");



CREATE INDEX "what_if_outcomes_user_id_idx" ON "public"."what_if_outcomes" USING "btree" ("user_id");



CREATE INDEX "what_if_outcomes_user_id_text_idx" ON "public"."what_if_outcomes" USING "btree" ("user_id_text");



CREATE INDEX "what_if_outcomes_user_id_uuid_idx" ON "public"."what_if_outcomes" USING "btree" ("user_id_uuid");



CREATE INDEX "what_if_runs_user_id_idx" ON "public"."what_if_runs" USING "btree" ("user_id");



CREATE INDEX "what_if_runs_user_id_text_idx" ON "public"."what_if_runs" USING "btree" ("user_id_text");



CREATE INDEX "what_if_runs_user_id_uuid_idx" ON "public"."what_if_runs" USING "btree" ("user_id_uuid");



CREATE INDEX "what_if_scenarios_user_id_idx" ON "public"."what_if_scenarios" USING "btree" ("user_id");



CREATE INDEX "what_if_scenarios_user_id_text_idx" ON "public"."what_if_scenarios" USING "btree" ("user_id_text");



CREATE INDEX "what_if_scenarios_user_id_uuid_idx" ON "public"."what_if_scenarios" USING "btree" ("user_id_uuid");



CREATE INDEX "wisdom_lessons_user_id_idx" ON "public"."wisdom_lessons" USING "btree" ("user_id");



CREATE INDEX "wisdom_lessons_user_id_text_idx" ON "public"."wisdom_lessons" USING "btree" ("user_id_text");



CREATE INDEX "wisdom_lessons_user_id_uuid_idx" ON "public"."wisdom_lessons" USING "btree" ("user_id_uuid");



CREATE INDEX "wisdom_playbooks_user_id_idx" ON "public"."wisdom_playbooks" USING "btree" ("user_id");



CREATE INDEX "wisdom_playbooks_user_id_text_idx" ON "public"."wisdom_playbooks" USING "btree" ("user_id_text");



CREATE INDEX "wisdom_playbooks_user_id_uuid_idx" ON "public"."wisdom_playbooks" USING "btree" ("user_id_uuid");



CREATE INDEX "wisdom_refresh_runs_last_run_at_idx" ON "public"."wisdom_refresh_runs" USING "btree" ("last_run_at" DESC);



CREATE INDEX "wisdom_refresh_runs_user_id_idx" ON "public"."wisdom_refresh_runs" USING "btree" ("user_id");



CREATE INDEX "wisdom_refresh_runs_user_id_uuid_idx" ON "public"."wisdom_refresh_runs" USING "btree" ("user_id_uuid");



CREATE INDEX "workspace_day_log_user_id_idx" ON "public"."workspace_day_log" USING "btree" ("user_id");



CREATE INDEX "workspace_day_log_user_id_text_idx" ON "public"."workspace_day_log" USING "btree" ("user_id_text");



CREATE INDEX "workspace_day_log_user_id_uuid_idx" ON "public"."workspace_day_log" USING "btree" ("user_id_uuid");



CREATE INDEX "workspace_focus_sessions_user_id_idx" ON "public"."workspace_focus_sessions" USING "btree" ("user_id");



CREATE INDEX "workspace_focus_sessions_user_id_text_idx" ON "public"."workspace_focus_sessions" USING "btree" ("user_id_text");



CREATE INDEX "workspace_focus_sessions_user_id_uuid_idx" ON "public"."workspace_focus_sessions" USING "btree" ("user_id_uuid");



CREATE INDEX "workspace_focus_states_user_id_idx" ON "public"."workspace_focus_states" USING "btree" ("user_id");



CREATE INDEX "workspace_focus_states_user_id_text_idx" ON "public"."workspace_focus_states" USING "btree" ("user_id_text");



CREATE INDEX "workspace_focus_states_user_id_uuid_idx" ON "public"."workspace_focus_states" USING "btree" ("user_id_uuid");



CREATE INDEX "workspace_interrupts_user_id_idx" ON "public"."workspace_interrupts" USING "btree" ("user_id");



CREATE INDEX "workspace_interrupts_user_id_text_idx" ON "public"."workspace_interrupts" USING "btree" ("user_id_text");



CREATE INDEX "workspace_interrupts_user_id_uuid_idx" ON "public"."workspace_interrupts" USING "btree" ("user_id_uuid");



CREATE INDEX "workspace_state_user_id_idx" ON "public"."workspace_state" USING "btree" ("user_id");



CREATE INDEX "workspace_state_user_id_text_idx" ON "public"."workspace_state" USING "btree" ("user_id_text");



CREATE INDEX "workspace_state_user_id_uuid_idx" ON "public"."workspace_state" USING "btree" ("user_id_uuid");



CREATE INDEX "workspace_threads_user_id_idx" ON "public"."workspace_threads" USING "btree" ("user_id");



CREATE INDEX "workspace_threads_user_id_text_idx" ON "public"."workspace_threads" USING "btree" ("user_id_text");



CREATE INDEX "workspace_threads_user_id_uuid_idx" ON "public"."workspace_threads" USING "btree" ("user_id_uuid");



CREATE INDEX "workspace_timeline_links_user_id_idx" ON "public"."workspace_timeline_links" USING "btree" ("user_id");



CREATE INDEX "workspace_timeline_links_user_id_text_idx" ON "public"."workspace_timeline_links" USING "btree" ("user_id_text");



CREATE INDEX "workspace_timeline_links_user_id_uuid_idx" ON "public"."workspace_timeline_links" USING "btree" ("user_id_uuid");



CREATE INDEX "xp_evaluation_runs_user_id_idx" ON "public"."xp_evaluation_runs" USING "btree" ("user_id");



CREATE INDEX "xp_evaluation_runs_user_id_text_idx" ON "public"."xp_evaluation_runs" USING "btree" ("user_id_text");



CREATE INDEX "xp_evaluation_runs_user_id_uuid_idx" ON "public"."xp_evaluation_runs" USING "btree" ("user_id_uuid");



CREATE INDEX "xp_events_ref_idx" ON "public"."xp_events" USING "btree" ("ref_table", "ref_id");



CREATE INDEX "xp_events_user_id_idx" ON "public"."xp_events" USING "btree" ("user_id");



CREATE INDEX "xp_events_user_id_uuid_idx" ON "public"."xp_events" USING "btree" ("user_id_uuid");



CREATE INDEX "xp_ledger_user_id_idx" ON "public"."xp_ledger" USING "btree" ("user_id");



CREATE INDEX "xp_ledger_user_id_text_idx" ON "public"."xp_ledger" USING "btree" ("user_id_text");



CREATE INDEX "xp_ledger_user_id_uuid_idx" ON "public"."xp_ledger" USING "btree" ("user_id_uuid");



CREATE INDEX "xp_transactions_user_id_idx" ON "public"."xp_transactions" USING "btree" ("user_id");



CREATE INDEX "xp_transactions_user_id_uuid_idx" ON "public"."xp_transactions" USING "btree" ("user_id_uuid");



CREATE OR REPLACE TRIGGER "emails_refresh_threads_insert" AFTER INSERT ON "public"."emails" REFERENCING NEW TABLE AS "new_rows" FOR EACH STATEMENT EXECUTE FUNCTION "public"."refresh_email_threads_for_pairs"();



CREATE OR REPLACE TRIGGER "emails_refresh_threads_update" AFTER UPDATE ON "public"."emails" REFERENCING NEW TABLE AS "new_rows" FOR EACH STATEMENT EXECUTE FUNCTION "public"."refresh_email_threads_for_pairs"();



CREATE OR REPLACE TRIGGER "entity_fragment_link_importance_trigger" AFTER INSERT ON "public"."tb_entity_fragment_links" FOR EACH ROW EXECUTE FUNCTION "public"."update_entity_importance_trigger"();



CREATE OR REPLACE TRIGGER "refresh_threads_after_email_insert" AFTER INSERT ON "public"."emails" FOR EACH ROW EXECUTE FUNCTION "public"."trg_refresh_threads_after_email_insert"();



CREATE OR REPLACE TRIGGER "tr_cron_locks_updated_at" BEFORE UPDATE ON "public"."cron_locks" FOR EACH ROW EXECUTE FUNCTION "public"."tg_set_updated_at"();



CREATE OR REPLACE TRIGGER "tr_exec_updated_at" BEFORE UPDATE ON "public"."executions" FOR EACH ROW EXECUTE FUNCTION "public"."tg_set_updated_at"();



CREATE OR REPLACE TRIGGER "tr_scheduler_targets_updated_at" BEFORE UPDATE ON "public"."scheduler_targets" FOR EACH ROW EXECUTE FUNCTION "public"."tg_set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_artifact_links_user_id_text" BEFORE INSERT OR UPDATE ON "public"."artifact_links" FOR EACH ROW EXECUTE FUNCTION "public"."tg_set_user_id_text"();



CREATE OR REPLACE TRIGGER "trg_autopilot_suggestions_set_updated_at" BEFORE UPDATE ON "public"."autopilot_suggestions" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_block_merged_contact_events" BEFORE INSERT OR UPDATE ON "public"."crm_contact_events" FOR EACH ROW EXECUTE FUNCTION "public"."crm_block_writes_to_merged_contacts"();



CREATE OR REPLACE TRIGGER "trg_block_merged_contact_facts" BEFORE INSERT OR UPDATE ON "public"."crm_contact_facts" FOR EACH ROW EXECUTE FUNCTION "public"."crm_block_writes_to_merged_contacts"();



CREATE OR REPLACE TRIGGER "trg_block_merged_contact_intel" BEFORE INSERT OR UPDATE ON "public"."crm_contact_intel" FOR EACH ROW EXECUTE FUNCTION "public"."crm_block_writes_to_merged_contacts"();



CREATE OR REPLACE TRIGGER "trg_block_merged_contact_intel_sources" BEFORE INSERT OR UPDATE ON "public"."crm_contact_intel_sources" FOR EACH ROW EXECUTE FUNCTION "public"."crm_block_writes_to_merged_contacts"();



CREATE OR REPLACE TRIGGER "trg_brain_entries_updated_at" BEFORE UPDATE ON "public"."brain_entries" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_canonical_schema_rules_updated_at" BEFORE UPDATE ON "public"."canonical_schema_rules" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_contacts_set_updated_at" BEFORE UPDATE ON "public"."contacts" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_contacts_updated_at" BEFORE UPDATE ON "public"."contacts" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_crm_contacts_foundation_before_write" BEFORE INSERT OR UPDATE ON "public"."crm_contacts" FOR EACH ROW EXECUTE FUNCTION "public"."crm_contacts_foundation_before_write"();



CREATE OR REPLACE TRIGGER "trg_daily_quests_updated_at" BEFORE UPDATE ON "public"."daily_quests" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_deals_set_updated_at" BEFORE UPDATE ON "public"."deals" FOR EACH ROW EXECUTE FUNCTION "public"."tg_set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_deals_updated_at" BEFORE UPDATE ON "public"."deals" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_email_accounts_updated_at" BEFORE UPDATE ON "public"."email_accounts" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_email_drafts_updated_at" BEFORE UPDATE ON "public"."email_drafts" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_email_outbox_emit_reminders" AFTER UPDATE OF "status", "next_attempt_at", "last_error" ON "public"."email_outbox" FOR EACH ROW EXECUTE FUNCTION "public"."email_outbox_emit_reminders"();



CREATE OR REPLACE TRIGGER "trg_email_outbox_user_id_text" BEFORE INSERT OR UPDATE ON "public"."email_outbox" FOR EACH ROW EXECUTE FUNCTION "public"."tg_set_user_id_text"();



CREATE OR REPLACE TRIGGER "trg_email_resolution_updated_at" BEFORE UPDATE ON "public"."email_resolution" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_email_triage_updated_at" BEFORE UPDATE ON "public"."email_triage_items" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_execution_logs_user_id_text" BEFORE INSERT OR UPDATE ON "public"."execution_logs" FOR EACH ROW EXECUTE FUNCTION "public"."tg_set_user_id_text"();



CREATE OR REPLACE TRIGGER "trg_execution_runs_user_id_text" BEFORE INSERT OR UPDATE ON "public"."execution_runs" FOR EACH ROW EXECUTE FUNCTION "public"."tg_set_user_id_text"();



CREATE OR REPLACE TRIGGER "trg_executions_user_id_text" BEFORE INSERT OR UPDATE ON "public"."executions" FOR EACH ROW EXECUTE FUNCTION "public"."tg_set_user_id_text"();



CREATE OR REPLACE TRIGGER "trg_follow_ups_set_updated_at" BEFORE UPDATE ON "public"."follow_ups" FOR EACH ROW EXECUTE FUNCTION "public"."tg_set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_follow_ups_updated_at" BEFORE UPDATE ON "public"."follow_ups" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_followups_updated_at" BEFORE UPDATE ON "public"."follow_ups" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_habits_set_updated_at" BEFORE UPDATE ON "public"."habits" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_habits_updated_at" BEFORE UPDATE ON "public"."habits" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_inbox_items_set_updated_at" BEFORE UPDATE ON "public"."inbox_items" FOR EACH ROW EXECUTE FUNCTION "public"."tg_set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_inbox_rules_set_updated_at" BEFORE UPDATE ON "public"."inbox_rules" FOR EACH ROW EXECUTE FUNCTION "public"."tg_set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_job_queue_agent_budgets_set_updated_at" BEFORE UPDATE ON "public"."job_queue_agent_budgets" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_job_queue_agents_set_updated_at" BEFORE UPDATE ON "public"."job_queue_agents" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_job_queue_credit_balances_set_updated_at" BEFORE UPDATE ON "public"."job_queue_credit_balances" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_job_queue_set_updated_at" BEFORE UPDATE ON "public"."job_queue" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_job_queue_tiers_set_updated_at" BEFORE UPDATE ON "public"."job_queue_tiers" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_job_queue_updated_at" BEFORE UPDATE ON "public"."job_queue" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_job_queue_user_tiers_set_updated_at" BEFORE UPDATE ON "public"."job_queue_user_tiers" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_journal_entries_updated_at" BEFORE UPDATE ON "public"."journal_entries" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_life_arc_autopilot_suggestions_updated_at" BEFORE UPDATE ON "public"."life_arc_autopilot_suggestions" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_life_evidence_user_id_text" BEFORE INSERT OR UPDATE ON "public"."life_evidence" FOR EACH ROW EXECUTE FUNCTION "public"."tg_set_user_id_text"();



CREATE OR REPLACE TRIGGER "trg_no_update_activity_events" BEFORE DELETE OR UPDATE ON "public"."activity_events" FOR EACH ROW EXECUTE FUNCTION "public"."prevent_activity_event_updates"();



CREATE OR REPLACE TRIGGER "trg_ops_incidents_updated_at" BEFORE UPDATE ON "public"."ops_incidents" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."achievements" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."activity_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."ag_messages" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."ag_runs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."agi_actions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."agi_agent_profiles" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."agi_feedback" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."agi_policies" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."agi_runs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."agi_scenario_runs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."agi_telemetry" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."agi_user_profile" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."align_feedback" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."align_user_profiles" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."align_violations" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."alignment_evaluations" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."archetype_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."archetype_snapshots" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."artifact_links" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."attention_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."autonomy_actions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."autopilot_jobs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."autopilot_suggestions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."behavior_predictions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."brain_capabilities" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."brain_changelog" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."brain_entries" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."brain_error_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."brain_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."brain_health_snapshots" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."brain_subsystems" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."brainstem_status" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."butler_notifications" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."butler_snoozes" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."calendar_accounts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."calendar_events_cache" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."call_intelligence_settings" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."call_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."call_summaries" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."calls" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."campaign_enrollments" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."campaigns" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."canon_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."canon_timeline_index" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."chapter_archetypes" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."civilization_domain_mappings" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."civilization_domains" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."civilization_settings" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."coach_council_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."coach_generated_scenarios" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."coach_multi_agent_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."coach_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."coach_training_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."coach_user_preferences" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."coach_voice_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."cognitive_hypotheses" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."cognitive_insights" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."cognitive_phases" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."cognitive_runs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."cognitive_self_reflections" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."cognitive_update_actions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."communication_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."conscious_conflicts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."conscious_frames" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."conscious_insights" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."conscious_items" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."conscious_links" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."contact_dates" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."contact_emails" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."contact_facts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."contact_identity_intel" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."contact_influence_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."contact_intelligence_sources" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."contact_phones" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."contact_playbooks" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."contact_relationship_scores" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."contact_relationships" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."contact_tag_links" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."contact_tags" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."contacts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."cortex_anomalies" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."cortex_areas" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."cortex_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."cortex_patterns" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."cortex_predictions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."cortex_signals" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."council_consensus" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."council_decision_dossiers" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."council_members" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."council_opinions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."council_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."creative_artifacts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."creative_assets" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."creative_evaluations" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."creative_ideas" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."creative_patterns" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."creative_projects" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."creative_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."creative_style_profiles" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."crm_alerts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."crm_contact_org_links" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."crm_contacts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."crm_deal_contacts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."crm_deal_health" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."crm_deals" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."crm_interactions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."crm_organizations" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."crm_relationship_health" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."cultural_highlights" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."cultural_inference_snapshots" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."cultural_predictions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."cultural_profiles" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."cultural_signals" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."culture_alignment_log" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."culture_contexts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."culture_norm_logs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."culture_profiles" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."daily_quest_generation_runs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."daily_quests" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."daily_timeline_views" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."dash_layouts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."dashboard_telemetry" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."dashboard_telemetry_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."day_plans" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."deal_archetype_runs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."deals" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."decision_tree_edges" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."decision_tree_nodes" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."decision_trees" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."decisions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."delegated_drafts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."desire_profiles" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."desire_signals" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."destiny_alignment_log" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."destiny_anchor_choices" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."destiny_arcs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."destiny_blueprints" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."destiny_checkpoints" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."destiny_timelines" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."domain_kpis" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."efc_action_sequences" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."efc_commitments" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."efc_energy_states" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."efc_execution_log" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."efc_generated_actions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."efc_nudges" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."email_accounts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."email_actions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."email_daily_briefs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."email_drafts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."email_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."email_followups" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."email_items" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."email_outbox" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."email_resolution" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."email_send_audit" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."email_suggested_drafts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."email_threads" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."email_triage_items" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."emails" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."emo_adaptive_responses" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."emo_checkins" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."emo_goals" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."emo_interventions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."emo_profiles" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."emo_states" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."emo_transitions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."emotion_channel_settings" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."emotion_interaction_log" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."emotion_resonance_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."emotion_samples" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."emotion_state_daily" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."emotion_style_profile" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."emotional_checkins" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."emotional_patterns" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."emotional_support_logs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."empathic_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."ethical_policies" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."execution_logs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."execution_runs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."executive_council_members" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."executive_summaries" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."experience_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."feedback" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."finance_accounts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."finance_alerts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."finance_budgets" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."finance_goals" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."finance_snapshots" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."finance_transactions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."financial_connections" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."financial_entities" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."focus_locks" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."focus_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."follow_ups" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."gift_ideas" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."goal_hierarchy" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."goals" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."guardrail_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."habit_completions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."habit_logs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."habit_streaks" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."habits" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."household_members" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."id_aspirations" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."id_beliefs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."id_growth_areas" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."id_momentum_daily" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."id_narrative_chapters" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."id_roles" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."id_snapshots" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."id_strengths" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."id_values" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."identity_arcs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."identity_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."identity_transforms" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."inner_monologue_entries" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."inner_monologue_turns" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."interaction_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."interactions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."job_queue" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."job_queue_agents" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."job_queue_budget_ledger" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."job_queue_budget_rollover" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."job_queue_credit_balances" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."job_queue_credits_ledger" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."job_queue_daily_budget" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."job_queue_fairness_ledger" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."job_queue_lane_quota" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."job_queue_rate_window" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."job_queue_scheduler_decisions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."job_queue_user_tiers" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."job_requests" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."job_runs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."job_scorecards" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."job_verticals" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."journal_entries" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."knowledge_context_links" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."knowledge_contexts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."knowledge_edges" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."knowledge_nodes" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."lb_daily_metrics" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."lb_insights" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."league_members" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."league_scores" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."life_arc_autopilot_runs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."life_arc_autopilot_suggestions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."life_arc_daily_focus" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."life_arc_objectives" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."life_arc_risk_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."life_arcs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."life_canon_entries" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."life_canon_snapshots" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."life_chapters" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."life_domains" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."life_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."life_evidence" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."life_themes" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."long_chapters" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."long_milestones" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."long_predictions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."long_snapshots" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."long_trajectories" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."long_trends" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mc_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mc_interventions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mc_strategy_profiles" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mem_archives" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mem_compressed" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mem_compression_jobs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mem_compression_settings" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."memories" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."memory_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."memory_patterns" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mind_models" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."motor_routine_metrics" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."motor_routine_runs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."motor_routine_steps" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."motor_routine_triggers" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."motor_routines" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mythic_achievements" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mythic_arcs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mythic_belt_progress" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mythic_coach_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mythic_quests" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mythic_rituals" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mythic_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mythic_training_focus" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mythic_training_missions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mythic_training_plans" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mythic_training_reflections" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."mythic_voice_mappings" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."narrative_snapshots" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."notes" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."notification_log" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."notification_preferences" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."notification_queue" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."onboarding_conversations" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."onboarding_state" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."org_members" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."persona_arc_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."persona_companion_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."persona_companion_highlights" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."persona_companion_state" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."persona_interaction_stats" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."persona_memory_snapshots" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."persona_microstyle_prefs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."persona_user_arc" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."personal_heuristics" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."personas" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."plan_items" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."planning_constraints" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."planning_decisions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."planning_overrides" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."planning_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."plugin_api_keys" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."plugin_automations" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."plugin_data" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."plugin_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."plugin_webhooks" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."prefrontal_goals" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."presence_daily_summaries" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."presence_decisions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."presence_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."proactive_interventions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."pulse_brain_preferences" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."pulse_brain_surface_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."pulse_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."pulse_insight_acknowledgements" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."pulse_introduction_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."push_subscriptions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."quest_completions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."relational_identities" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."relational_predictions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."relational_state_snapshots" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."relationship_highlights" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."relationship_interactions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."relationships" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."reminder_subscriptions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."safety_incidents" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."scheduler_targets" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."self_identity_snapshots" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."self_mirror_deltas" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."self_mirror_facets" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."self_mirror_highlights" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."self_mirror_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."self_mirror_snapshots" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."self_perception_signals" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."sim_decision_trees" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."sim_history" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."sim_runs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."sim_scenarios" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."sim_simulations" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."sim_what_ifs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."simulation_fix_plans" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."simulation_models" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."simulation_outcomes" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."simulation_policies" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."simulation_runs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."simulation_steps" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."simulation_timelines" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."sms_messages" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."social_edges" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."social_entities" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."social_insights" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."social_nodes" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."social_recommendations" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."social_risk_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."social_state_snapshots" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."somatic_alerts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."somatic_daily_metrics" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."somatic_device_settings" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."somatic_patterns" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."somatic_raw_device_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."somatic_samples" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."somatic_state_daily" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."strategic_conflicts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."strategic_domains" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."strategic_equilibria" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."strategic_objectives" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."strategic_plans" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."strategic_review_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."strategic_state_snapshots" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."strategist_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."strategy_feedback" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."strategy_recommendations" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."strategy_snapshots" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."streaks" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."system_user_feedback" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."task_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."tasks" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."tb_chapters" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."tb_context_snapshots" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."tb_edges" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."tb_embeddings" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."tb_entities" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."tb_entity_edges" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."tb_entity_fragment_links" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."tb_insights" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."tb_memory_fragments" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."tb_nodes" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."tb_raw_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."tb_user_patterns" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."teachings" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."theory_of_mind_profiles" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."third_brain_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."third_brain_insights" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."third_brain_memories" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."timeline_coach_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."timeline_commitments" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."timeline_decisions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."timeline_preference_profile" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."timeline_reflections" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."usage_logs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."user_agi_settings" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."user_archetype_profiles" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."user_dashboard_layouts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."user_experiments" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."user_focus_profile" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."user_interview_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."user_job_profiles" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."user_mythic_coach_settings" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."user_mythic_profile" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."user_onboarding_state" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."user_packs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."user_persona_tuning" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."user_philosophy_progress" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."user_plugins" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."user_prefs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."user_profiles" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."user_safety_settings" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."user_settings" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."value_profile" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."vault_access_log" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."vault_emergency_access" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."vault_items" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."vault_keys" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."vault_secure_notes" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."vertical_metrics" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."voice_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."voice_turns" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."voicemails" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."weekly_plans" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."what_if_outcomes" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."what_if_runs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."what_if_scenarios" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."wisdom_lessons" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."wisdom_playbooks" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."wisdom_refresh_runs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."workspace_day_log" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."workspace_focus_sessions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."workspace_focus_states" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."workspace_interrupts" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."workspace_state" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."workspace_threads" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."workspace_timeline_links" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."xp_evaluation_runs" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."xp_events" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."xp_ledger" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_pulse_sync_legacy_user_id" BEFORE INSERT OR UPDATE ON "public"."xp_transactions" FOR EACH ROW EXECUTE FUNCTION "public"."pulse_sync_legacy_user_id"();



CREATE OR REPLACE TRIGGER "trg_quest_catalog_updated_at" BEFORE UPDATE ON "public"."quest_catalog" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_reply_drafts_set_updated_at" BEFORE UPDATE ON "public"."reply_drafts" FOR EACH ROW EXECUTE FUNCTION "public"."tg_set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_sync_users_clerk_ids" BEFORE INSERT OR UPDATE ON "public"."users" FOR EACH ROW EXECUTE FUNCTION "public"."sync_users_clerk_ids"();



CREATE OR REPLACE TRIGGER "trg_tasks_enforce_completion" BEFORE INSERT OR UPDATE ON "public"."tasks" FOR EACH ROW EXECUTE FUNCTION "public"."tasks_enforce_completion"();



CREATE OR REPLACE TRIGGER "trg_tasks_set_updated_at" BEFORE UPDATE ON "public"."tasks" FOR EACH ROW EXECUTE FUNCTION "public"."tg_set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_tasks_updated_at" BEFORE UPDATE ON "public"."tasks" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_tasks_user_id_text" BEFORE INSERT OR UPDATE ON "public"."tasks" FOR EACH ROW EXECUTE FUNCTION "public"."tg_set_user_id_text"();



CREATE OR REPLACE TRIGGER "trg_user_prefs_updated_at" BEFORE UPDATE ON "public"."user_prefs" FOR EACH ROW EXECUTE FUNCTION "public"."set_updated_at"();



CREATE OR REPLACE TRIGGER "trg_work_scoreboard_days_set_updated_at" BEFORE UPDATE ON "public"."work_scoreboard_days" FOR EACH ROW EXECUTE FUNCTION "public"."tg_set_updated_at"();



CREATE OR REPLACE TRIGGER "trigger_autonomy_actions_updated_at" BEFORE UPDATE ON "public"."autonomy_actions" FOR EACH ROW EXECUTE FUNCTION "public"."update_autonomy_actions_updated_at"();



CREATE OR REPLACE TRIGGER "trigger_calendar_accounts_updated_at" BEFORE UPDATE ON "public"."calendar_accounts" FOR EACH ROW EXECUTE FUNCTION "public"."update_calendar_accounts_updated_at"();



CREATE OR REPLACE TRIGGER "trigger_calendar_events_cache_updated_at" BEFORE UPDATE ON "public"."calendar_events_cache" FOR EACH ROW EXECUTE FUNCTION "public"."update_calendar_events_cache_updated_at"();



CREATE OR REPLACE TRIGGER "trigger_day_plans_updated_at" BEFORE UPDATE ON "public"."day_plans" FOR EACH ROW EXECUTE FUNCTION "public"."update_day_plans_updated_at"();



CREATE OR REPLACE TRIGGER "trigger_delegated_drafts_updated_at" BEFORE UPDATE ON "public"."delegated_drafts" FOR EACH ROW EXECUTE FUNCTION "public"."update_delegated_drafts_updated_at"();



CREATE OR REPLACE TRIGGER "trigger_life_domains_updated_at" BEFORE UPDATE ON "public"."life_domains" FOR EACH ROW EXECUTE FUNCTION "public"."update_life_domains_updated_at"();



CREATE OR REPLACE TRIGGER "trigger_notification_preferences_updated_at" BEFORE UPDATE ON "public"."notification_preferences" FOR EACH ROW EXECUTE FUNCTION "public"."update_notification_preferences_updated_at"();



CREATE OR REPLACE TRIGGER "trigger_plan_items_updated_at" BEFORE UPDATE ON "public"."plan_items" FOR EACH ROW EXECUTE FUNCTION "public"."update_plan_items_updated_at"();



CREATE OR REPLACE TRIGGER "trigger_set_referral_code" BEFORE INSERT ON "public"."user_profiles" FOR EACH ROW EXECUTE FUNCTION "public"."set_referral_code"();



CREATE OR REPLACE TRIGGER "trigger_update_updated_at" BEFORE UPDATE ON "public"."user_profiles" FOR EACH ROW EXECUTE FUNCTION "public"."update_updated_at"();



ALTER TABLE ONLY "public"."achievements"
    ADD CONSTRAINT "achievements_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."activity_events"
    ADD CONSTRAINT "activity_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."ag_messages"
    ADD CONSTRAINT "ag_messages_run_id_fkey" FOREIGN KEY ("run_id") REFERENCES "public"."ag_runs"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."ag_messages"
    ADD CONSTRAINT "ag_messages_user_fk" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."ag_messages"
    ADD CONSTRAINT "ag_messages_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."ag_runs"
    ADD CONSTRAINT "ag_runs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."agi_actions"
    ADD CONSTRAINT "agi_actions_run_id_fkey" FOREIGN KEY ("run_id") REFERENCES "public"."agi_runs"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."agi_actions"
    ADD CONSTRAINT "agi_actions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."agi_agent_profiles"
    ADD CONSTRAINT "agi_agent_profiles_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."agi_feedback"
    ADD CONSTRAINT "agi_feedback_action_id_fkey" FOREIGN KEY ("action_id") REFERENCES "public"."agi_actions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."agi_feedback"
    ADD CONSTRAINT "agi_feedback_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."agi_policies"
    ADD CONSTRAINT "agi_policies_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."agi_runs"
    ADD CONSTRAINT "agi_runs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."agi_scenario_runs"
    ADD CONSTRAINT "agi_scenario_runs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."agi_telemetry"
    ADD CONSTRAINT "agi_telemetry_org_id_fkey" FOREIGN KEY ("org_id") REFERENCES "public"."organizations"("id");



ALTER TABLE ONLY "public"."agi_telemetry"
    ADD CONSTRAINT "agi_telemetry_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."agi_user_profile"
    ADD CONSTRAINT "agi_user_profile_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."align_feedback"
    ADD CONSTRAINT "align_feedback_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."align_user_profiles"
    ADD CONSTRAINT "align_user_profiles_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."align_violations"
    ADD CONSTRAINT "align_violations_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."alignment_evaluations"
    ADD CONSTRAINT "alignment_evaluations_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."archetype_events"
    ADD CONSTRAINT "archetype_events_archetype_id_fkey" FOREIGN KEY ("archetype_id") REFERENCES "public"."archetype_definitions"("id");



ALTER TABLE ONLY "public"."archetype_events"
    ADD CONSTRAINT "archetype_events_linked_canon_event_id_fkey" FOREIGN KEY ("linked_canon_event_id") REFERENCES "public"."canon_events"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."archetype_events"
    ADD CONSTRAINT "archetype_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."archetype_snapshots"
    ADD CONSTRAINT "archetype_snapshots_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."artifact_links"
    ADD CONSTRAINT "artifact_links_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."attention_events"
    ADD CONSTRAINT "attention_events_frame_id_fkey" FOREIGN KEY ("frame_id") REFERENCES "public"."conscious_frames"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."attention_events"
    ADD CONSTRAINT "attention_events_from_item_id_fkey" FOREIGN KEY ("from_item_id") REFERENCES "public"."conscious_items"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."attention_events"
    ADD CONSTRAINT "attention_events_to_item_id_fkey" FOREIGN KEY ("to_item_id") REFERENCES "public"."conscious_items"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."attention_events"
    ADD CONSTRAINT "attention_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."autonomy_actions"
    ADD CONSTRAINT "autonomy_actions_related_insight_id_fkey" FOREIGN KEY ("related_insight_id") REFERENCES "public"."third_brain_insights"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."autonomy_actions"
    ADD CONSTRAINT "autonomy_actions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."autopilot_jobs"
    ADD CONSTRAINT "autopilot_jobs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."autopilot_suggestions"
    ADD CONSTRAINT "autopilot_suggestions_job_id_fkey" FOREIGN KEY ("job_id") REFERENCES "public"."autopilot_jobs"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."autopilot_suggestions"
    ADD CONSTRAINT "autopilot_suggestions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."behavior_predictions"
    ADD CONSTRAINT "behavior_predictions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."brain_capabilities"
    ADD CONSTRAINT "brain_capabilities_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."brain_changelog"
    ADD CONSTRAINT "brain_changelog_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."brain_entries"
    ADD CONSTRAINT "brain_entries_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."brain_error_events"
    ADD CONSTRAINT "brain_error_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."brain_events"
    ADD CONSTRAINT "brain_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."brain_health_snapshots"
    ADD CONSTRAINT "brain_health_snapshots_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."brain_subsystems"
    ADD CONSTRAINT "brain_subsystems_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."brainstem_status"
    ADD CONSTRAINT "brainstem_status_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."branch_comparisons"
    ADD CONSTRAINT "branch_comparisons_tree_id_fkey" FOREIGN KEY ("tree_id") REFERENCES "public"."decision_trees"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."branch_simulation_runs"
    ADD CONSTRAINT "branch_simulation_runs_leaf_node_id_fkey" FOREIGN KEY ("leaf_node_id") REFERENCES "public"."decision_tree_nodes"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."branch_simulation_runs"
    ADD CONSTRAINT "branch_simulation_runs_root_node_id_fkey" FOREIGN KEY ("root_node_id") REFERENCES "public"."decision_tree_nodes"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."branch_simulation_runs"
    ADD CONSTRAINT "branch_simulation_runs_tree_id_fkey" FOREIGN KEY ("tree_id") REFERENCES "public"."decision_trees"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."butler_notifications"
    ADD CONSTRAINT "butler_notifications_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."butler_snoozes"
    ADD CONSTRAINT "butler_snoozes_notification_id_fkey" FOREIGN KEY ("notification_id") REFERENCES "public"."butler_notifications"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."butler_snoozes"
    ADD CONSTRAINT "butler_snoozes_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."calendar_accounts"
    ADD CONSTRAINT "calendar_accounts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."calendar_events_cache"
    ADD CONSTRAINT "calendar_events_cache_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."call_intelligence_settings"
    ADD CONSTRAINT "call_intelligence_settings_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."call_links"
    ADD CONSTRAINT "call_links_call_id_fkey" FOREIGN KEY ("call_id") REFERENCES "public"."call_sessions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."call_segments"
    ADD CONSTRAINT "call_segments_call_id_fkey" FOREIGN KEY ("call_id") REFERENCES "public"."call_sessions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."call_sessions"
    ADD CONSTRAINT "call_sessions_org_id_fkey" FOREIGN KEY ("org_id") REFERENCES "public"."organizations"("id");



ALTER TABLE ONLY "public"."call_sessions"
    ADD CONSTRAINT "call_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."call_summaries"
    ADD CONSTRAINT "call_summaries_call_id_fkey" FOREIGN KEY ("call_id") REFERENCES "public"."call_sessions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."call_summaries"
    ADD CONSTRAINT "call_summaries_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."calls"
    ADD CONSTRAINT "calls_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."contacts"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."calls"
    ADD CONSTRAINT "calls_deal_id_fkey" FOREIGN KEY ("deal_id") REFERENCES "public"."deals"("id");



ALTER TABLE ONLY "public"."calls"
    ADD CONSTRAINT "calls_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."campaign_enrollments"
    ADD CONSTRAINT "campaign_enrollments_campaign_id_fkey" FOREIGN KEY ("campaign_id") REFERENCES "public"."campaigns"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."campaign_enrollments"
    ADD CONSTRAINT "campaign_enrollments_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."campaigns"
    ADD CONSTRAINT "campaigns_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."canon_events"
    ADD CONSTRAINT "canon_events_attached_chapter_fkey" FOREIGN KEY ("attached_chapter") REFERENCES "public"."life_chapters"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."canon_events"
    ADD CONSTRAINT "canon_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."canon_timeline_index"
    ADD CONSTRAINT "canon_timeline_index_chapter_id_fkey" FOREIGN KEY ("chapter_id") REFERENCES "public"."life_chapters"("id");



ALTER TABLE ONLY "public"."canon_timeline_index"
    ADD CONSTRAINT "canon_timeline_index_event_id_fkey" FOREIGN KEY ("event_id") REFERENCES "public"."canon_events"("id");



ALTER TABLE ONLY "public"."canon_timeline_index"
    ADD CONSTRAINT "canon_timeline_index_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."chapter_archetypes"
    ADD CONSTRAINT "chapter_archetypes_chapter_id_fkey" FOREIGN KEY ("chapter_id") REFERENCES "public"."life_chapters"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."chapter_archetypes"
    ADD CONSTRAINT "chapter_archetypes_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."civilization_domain_mappings"
    ADD CONSTRAINT "civilization_domain_mappings_domain_id_fkey" FOREIGN KEY ("domain_id") REFERENCES "public"."civilization_domains"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."civilization_domain_mappings"
    ADD CONSTRAINT "civilization_domain_mappings_node_id_fkey" FOREIGN KEY ("node_id") REFERENCES "public"."knowledge_nodes"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."civilization_domain_mappings"
    ADD CONSTRAINT "civilization_domain_mappings_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."civilization_domain_state"
    ADD CONSTRAINT "civilization_domain_state_domain_id_fkey" FOREIGN KEY ("domain_id") REFERENCES "public"."civilization_domains"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."civilization_domains"
    ADD CONSTRAINT "civilization_domains_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."civilization_settings"
    ADD CONSTRAINT "civilization_settings_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."coach_council_deliberations"
    ADD CONSTRAINT "coach_council_deliberations_session_id_fkey" FOREIGN KEY ("session_id") REFERENCES "public"."coach_council_sessions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."coach_council_members"
    ADD CONSTRAINT "coach_council_members_session_id_fkey" FOREIGN KEY ("session_id") REFERENCES "public"."coach_council_sessions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."coach_council_sessions"
    ADD CONSTRAINT "coach_council_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."coach_council_summary"
    ADD CONSTRAINT "coach_council_summary_session_id_fkey" FOREIGN KEY ("session_id") REFERENCES "public"."coach_council_sessions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."coach_generated_scenarios"
    ADD CONSTRAINT "coach_generated_scenarios_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."coach_multi_agent_sessions"
    ADD CONSTRAINT "coach_multi_agent_sessions_scenario_id_fkey" FOREIGN KEY ("scenario_id") REFERENCES "public"."coach_scenarios"("id");



ALTER TABLE ONLY "public"."coach_multi_agent_sessions"
    ADD CONSTRAINT "coach_multi_agent_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."coach_sessions"
    ADD CONSTRAINT "coach_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."coach_training_sessions"
    ADD CONSTRAINT "coach_training_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."coach_user_preferences"
    ADD CONSTRAINT "coach_user_preferences_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."coach_voice_overrides"
    ADD CONSTRAINT "coach_voice_overrides_voice_profile_id_fkey" FOREIGN KEY ("voice_profile_id") REFERENCES "public"."voice_profiles"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."coach_voice_sessions"
    ADD CONSTRAINT "coach_voice_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."cognitive_hypotheses"
    ADD CONSTRAINT "cognitive_hypotheses_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."cognitive_insights"
    ADD CONSTRAINT "cognitive_insights_run_id_fkey" FOREIGN KEY ("run_id") REFERENCES "public"."cognitive_runs"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."cognitive_insights"
    ADD CONSTRAINT "cognitive_insights_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."cognitive_phases"
    ADD CONSTRAINT "cognitive_phases_run_id_fkey" FOREIGN KEY ("run_id") REFERENCES "public"."cognitive_runs"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."cognitive_phases"
    ADD CONSTRAINT "cognitive_phases_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."cognitive_runs"
    ADD CONSTRAINT "cognitive_runs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."cognitive_self_reflections"
    ADD CONSTRAINT "cognitive_self_reflections_run_id_fkey" FOREIGN KEY ("run_id") REFERENCES "public"."cognitive_runs"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."cognitive_self_reflections"
    ADD CONSTRAINT "cognitive_self_reflections_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."cognitive_update_actions"
    ADD CONSTRAINT "cognitive_update_actions_run_id_fkey" FOREIGN KEY ("run_id") REFERENCES "public"."cognitive_runs"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."cognitive_update_actions"
    ADD CONSTRAINT "cognitive_update_actions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."communication_sessions"
    ADD CONSTRAINT "communication_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."communication_turns"
    ADD CONSTRAINT "communication_turns_session_id_fkey" FOREIGN KEY ("session_id") REFERENCES "public"."communication_sessions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."conscious_conflicts"
    ADD CONSTRAINT "conscious_conflicts_frame_id_fkey" FOREIGN KEY ("frame_id") REFERENCES "public"."conscious_frames"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."conscious_conflicts"
    ADD CONSTRAINT "conscious_conflicts_item_a_id_fkey" FOREIGN KEY ("item_a_id") REFERENCES "public"."conscious_items"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."conscious_conflicts"
    ADD CONSTRAINT "conscious_conflicts_item_b_id_fkey" FOREIGN KEY ("item_b_id") REFERENCES "public"."conscious_items"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."conscious_conflicts"
    ADD CONSTRAINT "conscious_conflicts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."conscious_frames"
    ADD CONSTRAINT "conscious_frames_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."conscious_insights"
    ADD CONSTRAINT "conscious_insights_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."conscious_items"
    ADD CONSTRAINT "conscious_items_frame_id_fkey" FOREIGN KEY ("frame_id") REFERENCES "public"."conscious_frames"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."conscious_items"
    ADD CONSTRAINT "conscious_items_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."conscious_links"
    ADD CONSTRAINT "conscious_links_from_item_id_fkey" FOREIGN KEY ("from_item_id") REFERENCES "public"."conscious_items"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."conscious_links"
    ADD CONSTRAINT "conscious_links_to_item_id_fkey" FOREIGN KEY ("to_item_id") REFERENCES "public"."conscious_items"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."conscious_links"
    ADD CONSTRAINT "conscious_links_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."contact_dates"
    ADD CONSTRAINT "contact_dates_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."contact_dates"
    ADD CONSTRAINT "contact_dates_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."contact_emails"
    ADD CONSTRAINT "contact_emails_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."contact_emails"
    ADD CONSTRAINT "contact_emails_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."contact_facts"
    ADD CONSTRAINT "contact_facts_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."contact_facts"
    ADD CONSTRAINT "contact_facts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."contact_identity_intel"
    ADD CONSTRAINT "contact_identity_intel_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."contact_identity_intel"
    ADD CONSTRAINT "contact_identity_intel_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."contact_influence_events"
    ADD CONSTRAINT "contact_influence_events_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."contact_influence_events"
    ADD CONSTRAINT "contact_influence_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."contact_intelligence_sources"
    ADD CONSTRAINT "contact_intelligence_sources_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."contact_intelligence_sources"
    ADD CONSTRAINT "contact_intelligence_sources_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."contact_phones"
    ADD CONSTRAINT "contact_phones_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."contact_phones"
    ADD CONSTRAINT "contact_phones_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."contact_playbooks"
    ADD CONSTRAINT "contact_playbooks_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."contact_playbooks"
    ADD CONSTRAINT "contact_playbooks_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."contact_relationship_scores"
    ADD CONSTRAINT "contact_relationship_scores_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."contact_relationship_scores"
    ADD CONSTRAINT "contact_relationship_scores_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."contact_relationships"
    ADD CONSTRAINT "contact_relationships_from_contact_id_fkey" FOREIGN KEY ("from_contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."contact_relationships"
    ADD CONSTRAINT "contact_relationships_to_contact_id_fkey" FOREIGN KEY ("to_contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."contact_relationships"
    ADD CONSTRAINT "contact_relationships_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."contact_tag_links"
    ADD CONSTRAINT "contact_tag_links_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."contact_tag_links"
    ADD CONSTRAINT "contact_tag_links_tag_id_fkey" FOREIGN KEY ("tag_id") REFERENCES "public"."contact_tags"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."contact_tag_links"
    ADD CONSTRAINT "contact_tag_links_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."contact_tags"
    ADD CONSTRAINT "contact_tags_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."contacts"
    ADD CONSTRAINT "contacts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."cortex_anomalies"
    ADD CONSTRAINT "cortex_anomalies_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."cortex_areas"
    ADD CONSTRAINT "cortex_areas_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."cortex_events"
    ADD CONSTRAINT "cortex_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."cortex_patterns"
    ADD CONSTRAINT "cortex_patterns_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."cortex_predictions"
    ADD CONSTRAINT "cortex_predictions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."cortex_signals"
    ADD CONSTRAINT "cortex_signals_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."council_consensus"
    ADD CONSTRAINT "council_consensus_session_id_fkey" FOREIGN KEY ("session_id") REFERENCES "public"."council_sessions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."council_consensus"
    ADD CONSTRAINT "council_consensus_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."council_decision_dossiers"
    ADD CONSTRAINT "council_decision_dossiers_consensus_id_fkey" FOREIGN KEY ("consensus_id") REFERENCES "public"."council_consensus"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."council_decision_dossiers"
    ADD CONSTRAINT "council_decision_dossiers_session_id_fkey" FOREIGN KEY ("session_id") REFERENCES "public"."council_sessions"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."council_decision_dossiers"
    ADD CONSTRAINT "council_decision_dossiers_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."council_members"
    ADD CONSTRAINT "council_members_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."council_opinions"
    ADD CONSTRAINT "council_opinions_session_id_fkey" FOREIGN KEY ("session_id") REFERENCES "public"."council_sessions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."council_opinions"
    ADD CONSTRAINT "council_opinions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."council_sessions"
    ADD CONSTRAINT "council_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."creative_artifacts"
    ADD CONSTRAINT "creative_artifacts_idea_id_fkey" FOREIGN KEY ("idea_id") REFERENCES "public"."creative_ideas"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."creative_artifacts"
    ADD CONSTRAINT "creative_artifacts_session_id_fkey" FOREIGN KEY ("session_id") REFERENCES "public"."creative_sessions"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."creative_artifacts"
    ADD CONSTRAINT "creative_artifacts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."creative_assets"
    ADD CONSTRAINT "creative_assets_project_id_fkey" FOREIGN KEY ("project_id") REFERENCES "public"."creative_projects"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."creative_assets"
    ADD CONSTRAINT "creative_assets_related_node_id_fkey" FOREIGN KEY ("related_node_id") REFERENCES "public"."knowledge_nodes"("id");



ALTER TABLE ONLY "public"."creative_assets"
    ADD CONSTRAINT "creative_assets_session_id_fkey" FOREIGN KEY ("session_id") REFERENCES "public"."creative_sessions"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."creative_assets"
    ADD CONSTRAINT "creative_assets_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."creative_evaluations"
    ADD CONSTRAINT "creative_evaluations_artifact_id_fkey" FOREIGN KEY ("artifact_id") REFERENCES "public"."creative_artifacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."creative_evaluations"
    ADD CONSTRAINT "creative_evaluations_idea_id_fkey" FOREIGN KEY ("idea_id") REFERENCES "public"."creative_ideas"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."creative_evaluations"
    ADD CONSTRAINT "creative_evaluations_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."creative_ideas"
    ADD CONSTRAINT "creative_ideas_session_id_fkey" FOREIGN KEY ("session_id") REFERENCES "public"."creative_sessions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."creative_ideas"
    ADD CONSTRAINT "creative_ideas_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."creative_patterns"
    ADD CONSTRAINT "creative_patterns_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."creative_projects"
    ADD CONSTRAINT "creative_projects_related_node_id_fkey" FOREIGN KEY ("related_node_id") REFERENCES "public"."knowledge_nodes"("id");



ALTER TABLE ONLY "public"."creative_projects"
    ADD CONSTRAINT "creative_projects_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."creative_sessions"
    ADD CONSTRAINT "creative_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."creative_style_profiles"
    ADD CONSTRAINT "creative_style_profiles_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."crm_alerts"
    ADD CONSTRAINT "crm_alerts_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."crm_alerts"
    ADD CONSTRAINT "crm_alerts_deal_id_fkey" FOREIGN KEY ("deal_id") REFERENCES "public"."crm_deals"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."crm_alerts"
    ADD CONSTRAINT "crm_alerts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."crm_contact_events"
    ADD CONSTRAINT "crm_contact_events_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."crm_contact_facts"
    ADD CONSTRAINT "crm_contact_facts_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."crm_contact_intel"
    ADD CONSTRAINT "crm_contact_intel_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."crm_contact_intel_sources"
    ADD CONSTRAINT "crm_contact_intel_sources_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."crm_contact_org_links"
    ADD CONSTRAINT "crm_contact_org_links_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."crm_contact_org_links"
    ADD CONSTRAINT "crm_contact_org_links_organization_id_fkey" FOREIGN KEY ("organization_id") REFERENCES "public"."crm_organizations"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."crm_contact_org_links"
    ADD CONSTRAINT "crm_contact_org_links_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."crm_contact_photo_candidates"
    ADD CONSTRAINT "crm_contact_photo_candidates_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."crm_contacts"
    ADD CONSTRAINT "crm_contacts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."crm_deal_contacts"
    ADD CONSTRAINT "crm_deal_contacts_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."crm_deal_contacts"
    ADD CONSTRAINT "crm_deal_contacts_deal_id_fkey" FOREIGN KEY ("deal_id") REFERENCES "public"."crm_deals"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."crm_deal_contacts"
    ADD CONSTRAINT "crm_deal_contacts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."crm_deal_health"
    ADD CONSTRAINT "crm_deal_health_deal_id_fkey" FOREIGN KEY ("deal_id") REFERENCES "public"."crm_deals"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."crm_deal_health"
    ADD CONSTRAINT "crm_deal_health_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."crm_deals"
    ADD CONSTRAINT "crm_deals_organization_id_fkey" FOREIGN KEY ("organization_id") REFERENCES "public"."crm_organizations"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."crm_deals"
    ADD CONSTRAINT "crm_deals_primary_contact_id_fkey" FOREIGN KEY ("primary_contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."crm_deals"
    ADD CONSTRAINT "crm_deals_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."crm_interactions"
    ADD CONSTRAINT "crm_interactions_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."crm_interactions"
    ADD CONSTRAINT "crm_interactions_deal_id_fkey" FOREIGN KEY ("deal_id") REFERENCES "public"."crm_deals"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."crm_interactions"
    ADD CONSTRAINT "crm_interactions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."crm_organizations"
    ADD CONSTRAINT "crm_organizations_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."crm_relationship_health"
    ADD CONSTRAINT "crm_relationship_health_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."crm_relationship_health"
    ADD CONSTRAINT "crm_relationship_health_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."cultural_highlights"
    ADD CONSTRAINT "cultural_highlights_domain_fkey" FOREIGN KEY ("domain") REFERENCES "public"."cultural_domains"("id");



ALTER TABLE ONLY "public"."cultural_highlights"
    ADD CONSTRAINT "cultural_highlights_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."cultural_inference_snapshots"
    ADD CONSTRAINT "cultural_inference_snapshots_domain_fkey" FOREIGN KEY ("domain") REFERENCES "public"."cultural_domains"("id");



ALTER TABLE ONLY "public"."cultural_inference_snapshots"
    ADD CONSTRAINT "cultural_inference_snapshots_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."cultural_predictions"
    ADD CONSTRAINT "cultural_predictions_domain_fkey" FOREIGN KEY ("domain") REFERENCES "public"."cultural_domains"("id");



ALTER TABLE ONLY "public"."cultural_predictions"
    ADD CONSTRAINT "cultural_predictions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."cultural_profiles"
    ADD CONSTRAINT "cultural_profiles_domain_fkey" FOREIGN KEY ("domain") REFERENCES "public"."cultural_domains"("id");



ALTER TABLE ONLY "public"."cultural_profiles"
    ADD CONSTRAINT "cultural_profiles_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."cultural_signals"
    ADD CONSTRAINT "cultural_signals_domain_fkey" FOREIGN KEY ("domain") REFERENCES "public"."cultural_domains"("id");



ALTER TABLE ONLY "public"."cultural_signals"
    ADD CONSTRAINT "cultural_signals_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."culture_alignment_log"
    ADD CONSTRAINT "culture_alignment_log_context_id_fkey" FOREIGN KEY ("context_id") REFERENCES "public"."culture_contexts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."culture_alignment_log"
    ADD CONSTRAINT "culture_alignment_log_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."culture_contexts"
    ADD CONSTRAINT "culture_contexts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."culture_norm_logs"
    ADD CONSTRAINT "culture_norm_logs_context_id_fkey" FOREIGN KEY ("context_id") REFERENCES "public"."culture_contexts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."culture_norm_logs"
    ADD CONSTRAINT "culture_norm_logs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."culture_profiles"
    ADD CONSTRAINT "culture_profiles_context_id_fkey" FOREIGN KEY ("context_id") REFERENCES "public"."culture_contexts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."culture_profiles"
    ADD CONSTRAINT "culture_profiles_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."daily_briefs"
    ADD CONSTRAINT "daily_briefs_user_id_uuid_fkey" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."daily_quest_generation_runs"
    ADD CONSTRAINT "daily_quest_generation_runs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."daily_quests"
    ADD CONSTRAINT "daily_quests_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."daily_timeline_views"
    ADD CONSTRAINT "daily_timeline_views_branch_run_id_fkey" FOREIGN KEY ("branch_run_id") REFERENCES "public"."branch_simulation_runs"("id");



ALTER TABLE ONLY "public"."daily_timeline_views"
    ADD CONSTRAINT "daily_timeline_views_timeline_id_fkey" FOREIGN KEY ("timeline_id") REFERENCES "public"."destiny_timelines"("id");



ALTER TABLE ONLY "public"."daily_timeline_views"
    ADD CONSTRAINT "daily_timeline_views_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."dash_layouts"
    ADD CONSTRAINT "dash_layouts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."dashboard_telemetry_events"
    ADD CONSTRAINT "dashboard_telemetry_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."dashboard_telemetry"
    ADD CONSTRAINT "dashboard_telemetry_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."day_plans"
    ADD CONSTRAINT "day_plans_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."deal_archetype_runs"
    ADD CONSTRAINT "deal_archetype_runs_archetype_id_fkey" FOREIGN KEY ("archetype_id") REFERENCES "public"."mythic_archetypes"("id");



ALTER TABLE ONLY "public"."deal_archetype_runs"
    ADD CONSTRAINT "deal_archetype_runs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."deal_archetypes"
    ADD CONSTRAINT "deal_archetypes_archetype_id_fkey" FOREIGN KEY ("archetype_id") REFERENCES "public"."mythic_archetypes"("id");



ALTER TABLE ONLY "public"."deal_intelligence"
    ADD CONSTRAINT "deal_intelligence_deal_id_fkey" FOREIGN KEY ("deal_id") REFERENCES "public"."deals"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."deal_participants"
    ADD CONSTRAINT "deal_participants_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."contacts"("id");



ALTER TABLE ONLY "public"."deal_participants"
    ADD CONSTRAINT "deal_participants_deal_id_fkey" FOREIGN KEY ("deal_id") REFERENCES "public"."deals"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."deal_stages"
    ADD CONSTRAINT "deal_stages_user_id_uuid_fkey" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."deals"
    ADD CONSTRAINT "deals_user_id_uuid_fkey" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."deals"
    ADD CONSTRAINT "deals_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."decision_options"
    ADD CONSTRAINT "decision_options_decision_id_fkey" FOREIGN KEY ("decision_id") REFERENCES "public"."decisions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."decision_scenarios"
    ADD CONSTRAINT "decision_scenarios_decision_id_fkey" FOREIGN KEY ("decision_id") REFERENCES "public"."decisions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."decision_scenarios"
    ADD CONSTRAINT "decision_scenarios_option_id_fkey" FOREIGN KEY ("option_id") REFERENCES "public"."decision_options"("id");



ALTER TABLE ONLY "public"."decision_tree_edges"
    ADD CONSTRAINT "decision_tree_edges_from_node_id_fkey" FOREIGN KEY ("from_node_id") REFERENCES "public"."decision_tree_nodes"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."decision_tree_edges"
    ADD CONSTRAINT "decision_tree_edges_to_node_id_fkey" FOREIGN KEY ("to_node_id") REFERENCES "public"."decision_tree_nodes"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."decision_tree_edges"
    ADD CONSTRAINT "decision_tree_edges_tree_id_fkey" FOREIGN KEY ("tree_id") REFERENCES "public"."decision_trees"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."decision_tree_edges"
    ADD CONSTRAINT "decision_tree_edges_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."decision_tree_nodes"
    ADD CONSTRAINT "decision_tree_nodes_parent_node_id_fkey" FOREIGN KEY ("parent_node_id") REFERENCES "public"."decision_tree_nodes"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."decision_tree_nodes"
    ADD CONSTRAINT "decision_tree_nodes_related_decision_option_id_fkey" FOREIGN KEY ("related_decision_option_id") REFERENCES "public"."decision_options"("id");



ALTER TABLE ONLY "public"."decision_tree_nodes"
    ADD CONSTRAINT "decision_tree_nodes_related_timeline_id_fkey" FOREIGN KEY ("related_timeline_id") REFERENCES "public"."destiny_timelines"("id");



ALTER TABLE ONLY "public"."decision_tree_nodes"
    ADD CONSTRAINT "decision_tree_nodes_tree_id_fkey" FOREIGN KEY ("tree_id") REFERENCES "public"."decision_trees"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."decision_tree_nodes"
    ADD CONSTRAINT "decision_tree_nodes_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."decision_trees"
    ADD CONSTRAINT "decision_trees_decision_id_fkey" FOREIGN KEY ("decision_id") REFERENCES "public"."decisions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."decision_trees"
    ADD CONSTRAINT "decision_trees_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."decisions"
    ADD CONSTRAINT "decisions_domain_id_fkey" FOREIGN KEY ("domain_id") REFERENCES "public"."strategic_domains"("id");



ALTER TABLE ONLY "public"."decisions"
    ADD CONSTRAINT "decisions_objective_id_fkey" FOREIGN KEY ("objective_id") REFERENCES "public"."strategic_objectives"("id");



ALTER TABLE ONLY "public"."decisions"
    ADD CONSTRAINT "decisions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."delegated_drafts"
    ADD CONSTRAINT "delegated_drafts_related_event_id_fkey" FOREIGN KEY ("related_event_id") REFERENCES "public"."third_brain_events"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."delegated_drafts"
    ADD CONSTRAINT "delegated_drafts_related_insight_id_fkey" FOREIGN KEY ("related_insight_id") REFERENCES "public"."third_brain_insights"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."delegated_drafts"
    ADD CONSTRAINT "delegated_drafts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."desire_profiles"
    ADD CONSTRAINT "desire_profiles_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."desire_signals"
    ADD CONSTRAINT "desire_signals_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."destiny_alignment_log"
    ADD CONSTRAINT "destiny_alignment_log_arc_id_fkey" FOREIGN KEY ("arc_id") REFERENCES "public"."destiny_arcs"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."destiny_alignment_log"
    ADD CONSTRAINT "destiny_alignment_log_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."destiny_anchor_choices"
    ADD CONSTRAINT "destiny_anchor_choices_timeline_id_fkey" FOREIGN KEY ("timeline_id") REFERENCES "public"."destiny_timelines"("id");



ALTER TABLE ONLY "public"."destiny_anchor_choices"
    ADD CONSTRAINT "destiny_anchor_choices_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."destiny_arcs"
    ADD CONSTRAINT "destiny_arcs_blueprint_id_fkey" FOREIGN KEY ("blueprint_id") REFERENCES "public"."destiny_blueprints"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."destiny_arcs"
    ADD CONSTRAINT "destiny_arcs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."destiny_blueprints"
    ADD CONSTRAINT "destiny_blueprints_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."destiny_checkpoints"
    ADD CONSTRAINT "destiny_checkpoints_arc_id_fkey" FOREIGN KEY ("arc_id") REFERENCES "public"."destiny_arcs"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."destiny_checkpoints"
    ADD CONSTRAINT "destiny_checkpoints_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."destiny_milestones"
    ADD CONSTRAINT "destiny_milestones_waypoint_id_fkey" FOREIGN KEY ("waypoint_id") REFERENCES "public"."destiny_waypoints"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."destiny_simulation_runs"
    ADD CONSTRAINT "destiny_simulation_runs_timeline_id_fkey" FOREIGN KEY ("timeline_id") REFERENCES "public"."destiny_timelines"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."destiny_timeline_scores"
    ADD CONSTRAINT "destiny_timeline_scores_timeline_id_fkey" FOREIGN KEY ("timeline_id") REFERENCES "public"."destiny_timelines"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."destiny_timelines"
    ADD CONSTRAINT "destiny_timelines_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."destiny_waypoints"
    ADD CONSTRAINT "destiny_waypoints_related_node_id_fkey" FOREIGN KEY ("related_node_id") REFERENCES "public"."knowledge_nodes"("id");



ALTER TABLE ONLY "public"."destiny_waypoints"
    ADD CONSTRAINT "destiny_waypoints_strategic_objective_id_fkey" FOREIGN KEY ("strategic_objective_id") REFERENCES "public"."strategic_objectives"("id");



ALTER TABLE ONLY "public"."destiny_waypoints"
    ADD CONSTRAINT "destiny_waypoints_timeline_id_fkey" FOREIGN KEY ("timeline_id") REFERENCES "public"."destiny_timelines"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."domain_kpis"
    ADD CONSTRAINT "domain_kpis_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."efc_action_sequences"
    ADD CONSTRAINT "efc_action_sequences_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."efc_commitments"
    ADD CONSTRAINT "efc_commitments_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."efc_energy_states"
    ADD CONSTRAINT "efc_energy_states_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."efc_execution_log"
    ADD CONSTRAINT "efc_execution_log_action_id_fkey" FOREIGN KEY ("action_id") REFERENCES "public"."efc_generated_actions"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."efc_execution_log"
    ADD CONSTRAINT "efc_execution_log_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."efc_generated_actions"
    ADD CONSTRAINT "efc_generated_actions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."efc_nudges"
    ADD CONSTRAINT "efc_nudges_action_id_fkey" FOREIGN KEY ("action_id") REFERENCES "public"."efc_generated_actions"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."efc_nudges"
    ADD CONSTRAINT "efc_nudges_commitment_id_fkey" FOREIGN KEY ("commitment_id") REFERENCES "public"."efc_commitments"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."efc_nudges"
    ADD CONSTRAINT "efc_nudges_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."email_accounts"
    ADD CONSTRAINT "email_accounts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."email_actions"
    ADD CONSTRAINT "email_actions_email_id_fkey" FOREIGN KEY ("email_id") REFERENCES "public"."email_items"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."email_actions"
    ADD CONSTRAINT "email_actions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."email_daily_briefs"
    ADD CONSTRAINT "email_daily_briefs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."email_drafts"
    ADD CONSTRAINT "email_drafts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."email_events"
    ADD CONSTRAINT "email_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."email_followups"
    ADD CONSTRAINT "email_followups_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."email_items"
    ADD CONSTRAINT "email_items_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."email_messages"
    ADD CONSTRAINT "email_messages_email_account_id_fkey" FOREIGN KEY ("email_account_id") REFERENCES "public"."email_accounts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."email_messages"
    ADD CONSTRAINT "email_messages_thread_id_fkey" FOREIGN KEY ("thread_id") REFERENCES "public"."email_threads"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."email_outbox"
    ADD CONSTRAINT "email_outbox_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."email_resolution"
    ADD CONSTRAINT "email_resolution_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."email_send_audit"
    ADD CONSTRAINT "email_send_audit_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."email_suggested_drafts"
    ADD CONSTRAINT "email_suggested_drafts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."email_threads"
    ADD CONSTRAINT "email_threads_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."email_triage_items"
    ADD CONSTRAINT "email_triage_items_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."emails"
    ADD CONSTRAINT "emails_deal_id_fkey" FOREIGN KEY ("deal_id") REFERENCES "public"."deals"("id");



ALTER TABLE ONLY "public"."emails"
    ADD CONSTRAINT "emails_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."emo_adaptive_responses"
    ADD CONSTRAINT "emo_adaptive_responses_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."emo_checkins"
    ADD CONSTRAINT "emo_checkins_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."emo_goals"
    ADD CONSTRAINT "emo_goals_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."emo_interventions"
    ADD CONSTRAINT "emo_interventions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."emo_profiles"
    ADD CONSTRAINT "emo_profiles_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."emo_states"
    ADD CONSTRAINT "emo_states_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."emo_transitions"
    ADD CONSTRAINT "emo_transitions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."emotion_channel_settings"
    ADD CONSTRAINT "emotion_channel_settings_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."emotion_interaction_log"
    ADD CONSTRAINT "emotion_interaction_log_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."emotion_resonance_events"
    ADD CONSTRAINT "emotion_resonance_events_interaction_id_fkey" FOREIGN KEY ("interaction_id") REFERENCES "public"."emotion_interaction_log"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."emotion_resonance_events"
    ADD CONSTRAINT "emotion_resonance_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."emotion_samples"
    ADD CONSTRAINT "emotion_samples_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."emotion_state_daily"
    ADD CONSTRAINT "emotion_state_daily_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."emotion_style_profile"
    ADD CONSTRAINT "emotion_style_profile_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."emotional_checkins"
    ADD CONSTRAINT "emotional_checkins_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."emotional_patterns"
    ADD CONSTRAINT "emotional_patterns_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."emotional_support_logs"
    ADD CONSTRAINT "emotional_support_logs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."empathic_events"
    ADD CONSTRAINT "empathic_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."ethical_policies"
    ADD CONSTRAINT "ethical_policies_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."execution_logs"
    ADD CONSTRAINT "execution_logs_execution_id_fkey" FOREIGN KEY ("execution_id") REFERENCES "public"."executions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."execution_logs"
    ADD CONSTRAINT "execution_logs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."execution_runs"
    ADD CONSTRAINT "execution_runs_execution_id_fkey" FOREIGN KEY ("execution_id") REFERENCES "public"."executions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."execution_runs"
    ADD CONSTRAINT "execution_runs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."executive_council_members"
    ADD CONSTRAINT "executive_council_members_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."executive_council_votes"
    ADD CONSTRAINT "executive_council_votes_decision_id_fkey" FOREIGN KEY ("decision_id") REFERENCES "public"."decisions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."executive_council_votes"
    ADD CONSTRAINT "executive_council_votes_member_id_fkey" FOREIGN KEY ("member_id") REFERENCES "public"."executive_council_members"("id");



ALTER TABLE ONLY "public"."executive_council_votes"
    ADD CONSTRAINT "executive_council_votes_option_id_fkey" FOREIGN KEY ("option_id") REFERENCES "public"."decision_options"("id");



ALTER TABLE ONLY "public"."executive_summaries"
    ADD CONSTRAINT "executive_summaries_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."experience_events"
    ADD CONSTRAINT "experience_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."feedback"
    ADD CONSTRAINT "feedback_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."finance_accounts"
    ADD CONSTRAINT "finance_accounts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."finance_alerts"
    ADD CONSTRAINT "finance_alerts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."finance_budgets"
    ADD CONSTRAINT "finance_budgets_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."finance_goals"
    ADD CONSTRAINT "finance_goals_linked_account_id_fkey" FOREIGN KEY ("linked_account_id") REFERENCES "public"."finance_accounts"("id");



ALTER TABLE ONLY "public"."finance_goals"
    ADD CONSTRAINT "finance_goals_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."finance_snapshots"
    ADD CONSTRAINT "finance_snapshots_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."finance_transactions"
    ADD CONSTRAINT "finance_transactions_account_id_fkey" FOREIGN KEY ("account_id") REFERENCES "public"."finance_accounts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."finance_transactions"
    ADD CONSTRAINT "finance_transactions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."financial_accounts"
    ADD CONSTRAINT "financial_accounts_entity_id_fkey" FOREIGN KEY ("entity_id") REFERENCES "public"."financial_entities"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."financial_budget_envelopes"
    ADD CONSTRAINT "financial_budget_envelopes_account_id_fkey" FOREIGN KEY ("account_id") REFERENCES "public"."financial_accounts"("id");



ALTER TABLE ONLY "public"."financial_budget_envelopes"
    ADD CONSTRAINT "financial_budget_envelopes_budget_id_fkey" FOREIGN KEY ("budget_id") REFERENCES "public"."financial_budgets"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."financial_budgets"
    ADD CONSTRAINT "financial_budgets_entity_id_fkey" FOREIGN KEY ("entity_id") REFERENCES "public"."financial_entities"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."financial_connections"
    ADD CONSTRAINT "financial_connections_entity_id_fkey" FOREIGN KEY ("entity_id") REFERENCES "public"."financial_entities"("id");



ALTER TABLE ONLY "public"."financial_connections"
    ADD CONSTRAINT "financial_connections_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."financial_entities"
    ADD CONSTRAINT "financial_entities_household_id_fkey" FOREIGN KEY ("household_id") REFERENCES "public"."households"("id");



ALTER TABLE ONLY "public"."financial_entities"
    ADD CONSTRAINT "financial_entities_org_id_fkey" FOREIGN KEY ("org_id") REFERENCES "public"."organizations"("id");



ALTER TABLE ONLY "public"."financial_entities"
    ADD CONSTRAINT "financial_entities_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."financial_imported_transactions"
    ADD CONSTRAINT "financial_imported_transactions_connection_id_fkey" FOREIGN KEY ("connection_id") REFERENCES "public"."financial_connections"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."financial_imported_transactions"
    ADD CONSTRAINT "financial_imported_transactions_ledger_entry_id_fkey" FOREIGN KEY ("ledger_entry_id") REFERENCES "public"."financial_ledger_entries"("id");



ALTER TABLE ONLY "public"."financial_ledger_entries"
    ADD CONSTRAINT "financial_ledger_entries_entity_id_fkey" FOREIGN KEY ("entity_id") REFERENCES "public"."financial_entities"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."financial_ledger_lines"
    ADD CONSTRAINT "financial_ledger_lines_account_id_fkey" FOREIGN KEY ("account_id") REFERENCES "public"."financial_accounts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."financial_ledger_lines"
    ADD CONSTRAINT "financial_ledger_lines_entry_id_fkey" FOREIGN KEY ("entry_id") REFERENCES "public"."financial_ledger_entries"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."financial_snapshots"
    ADD CONSTRAINT "financial_snapshots_entity_id_fkey" FOREIGN KEY ("entity_id") REFERENCES "public"."financial_entities"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."focus_locks"
    ADD CONSTRAINT "focus_locks_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."focus_sessions"
    ADD CONSTRAINT "focus_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."follow_ups"
    ADD CONSTRAINT "follow_ups_deal_id_fkey" FOREIGN KEY ("deal_id") REFERENCES "public"."deals"("id");



ALTER TABLE ONLY "public"."follow_ups"
    ADD CONSTRAINT "follow_ups_user_id_uuid_fkey" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."follow_ups"
    ADD CONSTRAINT "follow_ups_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."gift_ideas"
    ADD CONSTRAINT "gift_ideas_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."gift_ideas"
    ADD CONSTRAINT "gift_ideas_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."goal_hierarchy"
    ADD CONSTRAINT "goal_hierarchy_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."goals"
    ADD CONSTRAINT "goals_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."guardrail_events"
    ADD CONSTRAINT "guardrail_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."habit_completions"
    ADD CONSTRAINT "habit_completions_habit_id_fkey" FOREIGN KEY ("habit_id") REFERENCES "public"."habits"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."habit_completions"
    ADD CONSTRAINT "habit_completions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."habit_logs"
    ADD CONSTRAINT "habit_logs_habit_id_fkey" FOREIGN KEY ("habit_id") REFERENCES "public"."habits"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."habit_logs"
    ADD CONSTRAINT "habit_logs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."habit_streaks"
    ADD CONSTRAINT "habit_streaks_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."habits"
    ADD CONSTRAINT "habits_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."household_members"
    ADD CONSTRAINT "household_members_household_id_fkey" FOREIGN KEY ("household_id") REFERENCES "public"."households"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."household_members"
    ADD CONSTRAINT "household_members_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."id_aspirations"
    ADD CONSTRAINT "id_aspirations_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."id_beliefs"
    ADD CONSTRAINT "id_beliefs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."id_growth_areas"
    ADD CONSTRAINT "id_growth_areas_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."id_momentum_daily"
    ADD CONSTRAINT "id_momentum_daily_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."id_narrative_chapters"
    ADD CONSTRAINT "id_narrative_chapters_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."id_roles"
    ADD CONSTRAINT "id_roles_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."id_snapshots"
    ADD CONSTRAINT "id_snapshots_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."id_strengths"
    ADD CONSTRAINT "id_strengths_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."id_values"
    ADD CONSTRAINT "id_values_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."identity_arcs"
    ADD CONSTRAINT "identity_arcs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."identity_events"
    ADD CONSTRAINT "identity_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."identity_transforms"
    ADD CONSTRAINT "identity_transforms_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."inbox_actions"
    ADD CONSTRAINT "inbox_actions_inbox_item_id_fkey" FOREIGN KEY ("inbox_item_id") REFERENCES "public"."inbox_items"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."inbox_actions"
    ADD CONSTRAINT "inbox_actions_user_id_uuid_fkey" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."inbox_items"
    ADD CONSTRAINT "inbox_items_user_id_uuid_fkey" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."inbox_rule_outcomes"
    ADD CONSTRAINT "inbox_rule_outcomes_inbox_item_id_fkey" FOREIGN KEY ("inbox_item_id") REFERENCES "public"."inbox_items"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."inbox_rule_outcomes"
    ADD CONSTRAINT "inbox_rule_outcomes_rule_id_fkey" FOREIGN KEY ("rule_id") REFERENCES "public"."inbox_rules"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."inbox_rule_outcomes"
    ADD CONSTRAINT "inbox_rule_outcomes_run_id_fkey" FOREIGN KEY ("run_id") REFERENCES "public"."inbox_rule_runs"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."inbox_rule_outcomes"
    ADD CONSTRAINT "inbox_rule_outcomes_user_id_uuid_fkey" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."inbox_rule_runs"
    ADD CONSTRAINT "inbox_rule_runs_user_id_uuid_fkey" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."inbox_rules"
    ADD CONSTRAINT "inbox_rules_user_id_uuid_fkey" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."inbox_triage_events"
    ADD CONSTRAINT "inbox_triage_events_inbox_item_id_fkey" FOREIGN KEY ("inbox_item_id") REFERENCES "public"."inbox_items"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."inbox_triage_events"
    ADD CONSTRAINT "inbox_triage_events_user_id_uuid_fkey" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."inner_monologue_entries"
    ADD CONSTRAINT "inner_monologue_entries_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."inner_monologue_turns"
    ADD CONSTRAINT "inner_monologue_turns_focus_item_id_fkey" FOREIGN KEY ("focus_item_id") REFERENCES "public"."conscious_items"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."inner_monologue_turns"
    ADD CONSTRAINT "inner_monologue_turns_frame_id_fkey" FOREIGN KEY ("frame_id") REFERENCES "public"."conscious_frames"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."inner_monologue_turns"
    ADD CONSTRAINT "inner_monologue_turns_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."interaction_events"
    ADD CONSTRAINT "interaction_events_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."crm_contacts"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."interaction_events"
    ADD CONSTRAINT "interaction_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."interactions"
    ADD CONSTRAINT "interactions_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "public"."contacts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."interactions"
    ADD CONSTRAINT "interactions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."job_categories"
    ADD CONSTRAINT "job_categories_industry_id_fkey" FOREIGN KEY ("industry_id") REFERENCES "public"."industries"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."job_graph_nodes"
    ADD CONSTRAINT "job_graph_nodes_industry_id_fkey" FOREIGN KEY ("industry_id") REFERENCES "public"."industries"("id");



ALTER TABLE ONLY "public"."job_graph_nodes"
    ADD CONSTRAINT "job_graph_nodes_job_title_id_fkey" FOREIGN KEY ("job_title_id") REFERENCES "public"."job_titles"("id");



ALTER TABLE ONLY "public"."job_graph_nodes"
    ADD CONSTRAINT "job_graph_nodes_parent_id_fkey" FOREIGN KEY ("parent_id") REFERENCES "public"."job_graph_nodes"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."job_kpis"
    ADD CONSTRAINT "job_kpis_job_graph_node_id_fkey" FOREIGN KEY ("job_graph_node_id") REFERENCES "public"."job_graph_nodes"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."job_queue_agent_budgets"
    ADD CONSTRAINT "job_queue_agent_budgets_agent_id_fkey" FOREIGN KEY ("agent_id") REFERENCES "public"."job_queue_agents"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."job_queue_agents"
    ADD CONSTRAINT "job_queue_agents_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."job_queue_budget_ledger"
    ADD CONSTRAINT "job_queue_budget_ledger_job_id_fkey" FOREIGN KEY ("job_id") REFERENCES "public"."job_queue"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."job_queue_budget_ledger"
    ADD CONSTRAINT "job_queue_budget_ledger_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."job_queue_budget_rollover"
    ADD CONSTRAINT "job_queue_budget_rollover_tier_fkey" FOREIGN KEY ("tier") REFERENCES "public"."job_queue_tiers"("tier");



ALTER TABLE ONLY "public"."job_queue_budget_rollover"
    ADD CONSTRAINT "job_queue_budget_rollover_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."job_queue_credit_balances"
    ADD CONSTRAINT "job_queue_credit_balances_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."job_queue_credits_ledger"
    ADD CONSTRAINT "job_queue_credits_ledger_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."job_queue_daily_budget"
    ADD CONSTRAINT "job_queue_daily_budget_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."job_queue_events"
    ADD CONSTRAINT "job_queue_events_job_id_fkey" FOREIGN KEY ("job_id") REFERENCES "public"."job_queue"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."job_queue_fairness_ledger"
    ADD CONSTRAINT "job_queue_fairness_ledger_job_id_fkey" FOREIGN KEY ("job_id") REFERENCES "public"."job_queue"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."job_queue_fairness_ledger"
    ADD CONSTRAINT "job_queue_fairness_ledger_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."job_queue_lane_quota"
    ADD CONSTRAINT "job_queue_lane_quota_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."job_queue_pricing"
    ADD CONSTRAINT "job_queue_pricing_tier_fkey" FOREIGN KEY ("tier") REFERENCES "public"."job_queue_tiers"("tier");



ALTER TABLE ONLY "public"."job_queue_rate_window"
    ADD CONSTRAINT "job_queue_rate_window_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."job_queue_results"
    ADD CONSTRAINT "job_queue_results_job_id_fkey" FOREIGN KEY ("job_id") REFERENCES "public"."job_queue"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."job_queue_scheduler_decisions"
    ADD CONSTRAINT "job_queue_scheduler_decisions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."job_queue"
    ADD CONSTRAINT "job_queue_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."job_queue_user_tiers"
    ADD CONSTRAINT "job_queue_user_tiers_tier_fkey" FOREIGN KEY ("tier") REFERENCES "public"."job_queue_tiers"("tier");



ALTER TABLE ONLY "public"."job_queue_user_tiers"
    ADD CONSTRAINT "job_queue_user_tiers_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."job_requests"
    ADD CONSTRAINT "job_requests_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."job_runs"
    ADD CONSTRAINT "job_runs_job_id_fkey" FOREIGN KEY ("job_id") REFERENCES "public"."job_queue"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."job_runs"
    ADD CONSTRAINT "job_runs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."job_scorecards"
    ADD CONSTRAINT "job_scorecards_job_graph_node_id_fkey" FOREIGN KEY ("job_graph_node_id") REFERENCES "public"."job_graph_nodes"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."job_scorecards"
    ADD CONSTRAINT "job_scorecards_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."job_titles"
    ADD CONSTRAINT "job_titles_category_id_fkey" FOREIGN KEY ("category_id") REFERENCES "public"."job_categories"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."job_verticals"
    ADD CONSTRAINT "job_verticals_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."journal_entries"
    ADD CONSTRAINT "journal_entries_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."knowledge_context_links"
    ADD CONSTRAINT "knowledge_context_links_context_id_fkey" FOREIGN KEY ("context_id") REFERENCES "public"."knowledge_contexts"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."knowledge_context_links"
    ADD CONSTRAINT "knowledge_context_links_edge_id_fkey" FOREIGN KEY ("edge_id") REFERENCES "public"."knowledge_edges"("id");



ALTER TABLE ONLY "public"."knowledge_context_links"
    ADD CONSTRAINT "knowledge_context_links_node_id_fkey" FOREIGN KEY ("node_id") REFERENCES "public"."knowledge_nodes"("id");



ALTER TABLE ONLY "public"."knowledge_context_links"
    ADD CONSTRAINT "knowledge_context_links_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."knowledge_contexts"
    ADD CONSTRAINT "knowledge_contexts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."knowledge_edges"
    ADD CONSTRAINT "knowledge_edges_from_node_id_fkey" FOREIGN KEY ("from_node_id") REFERENCES "public"."knowledge_nodes"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."knowledge_edges"
    ADD CONSTRAINT "knowledge_edges_to_node_id_fkey" FOREIGN KEY ("to_node_id") REFERENCES "public"."knowledge_nodes"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."knowledge_edges"
    ADD CONSTRAINT "knowledge_edges_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."knowledge_nodes"
    ADD CONSTRAINT "knowledge_nodes_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."lb_daily_metrics"
    ADD CONSTRAINT "lb_daily_metrics_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."lb_insights"
    ADD CONSTRAINT "lb_insights_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."league_members"
    ADD CONSTRAINT "league_members_league_id_fkey" FOREIGN KEY ("league_id") REFERENCES "public"."leagues"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."league_members"
    ADD CONSTRAINT "league_members_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."league_scores"
    ADD CONSTRAINT "league_scores_league_id_fkey" FOREIGN KEY ("league_id") REFERENCES "public"."leagues"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."league_scores"
    ADD CONSTRAINT "league_scores_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."leagues"
    ADD CONSTRAINT "leagues_org_id_fkey" FOREIGN KEY ("org_id") REFERENCES "public"."organizations"("id");



ALTER TABLE ONLY "public"."life_arc_autopilot_runs"
    ADD CONSTRAINT "life_arc_autopilot_runs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."life_arc_autopilot_suggestions"
    ADD CONSTRAINT "life_arc_autopilot_suggestions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."life_arc_checkpoints"
    ADD CONSTRAINT "life_arc_checkpoints_arc_id_fkey" FOREIGN KEY ("arc_id") REFERENCES "public"."life_arcs"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."life_arc_daily_focus"
    ADD CONSTRAINT "life_arc_daily_focus_arc_id_fkey" FOREIGN KEY ("arc_id") REFERENCES "public"."life_arcs"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."life_arc_daily_focus"
    ADD CONSTRAINT "life_arc_daily_focus_quest_id_fkey" FOREIGN KEY ("quest_id") REFERENCES "public"."life_arc_quests"("id");



ALTER TABLE ONLY "public"."life_arc_daily_focus"
    ADD CONSTRAINT "life_arc_daily_focus_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."life_arc_objectives"
    ADD CONSTRAINT "life_arc_objectives_arc_id_fkey" FOREIGN KEY ("arc_id") REFERENCES "public"."life_arcs"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."life_arc_objectives"
    ADD CONSTRAINT "life_arc_objectives_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."life_arc_quests"
    ADD CONSTRAINT "life_arc_quests_arc_id_fkey" FOREIGN KEY ("arc_id") REFERENCES "public"."life_arcs"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."life_arc_risk_events"
    ADD CONSTRAINT "life_arc_risk_events_arc_id_fkey" FOREIGN KEY ("arc_id") REFERENCES "public"."life_arcs"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."life_arc_risk_events"
    ADD CONSTRAINT "life_arc_risk_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."life_arc_sources"
    ADD CONSTRAINT "life_arc_sources_arc_id_fkey" FOREIGN KEY ("arc_id") REFERENCES "public"."life_arcs"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."life_arcs"
    ADD CONSTRAINT "life_arcs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."life_canon_entries"
    ADD CONSTRAINT "life_canon_entries_arc_id_fkey" FOREIGN KEY ("arc_id") REFERENCES "public"."mythic_arcs"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."life_canon_entries"
    ADD CONSTRAINT "life_canon_entries_session_id_fkey" FOREIGN KEY ("session_id") REFERENCES "public"."mythic_sessions"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."life_canon_entries"
    ADD CONSTRAINT "life_canon_entries_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."life_canon_snapshots"
    ADD CONSTRAINT "life_canon_snapshots_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."life_chapters"
    ADD CONSTRAINT "life_chapters_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."life_domains"
    ADD CONSTRAINT "life_domains_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."life_events"
    ADD CONSTRAINT "life_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."life_evidence"
    ADD CONSTRAINT "life_evidence_life_event_id_fkey" FOREIGN KEY ("life_event_id") REFERENCES "public"."life_events"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."life_evidence"
    ADD CONSTRAINT "life_evidence_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."life_themes"
    ADD CONSTRAINT "life_themes_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."long_chapters"
    ADD CONSTRAINT "long_chapters_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."long_milestones"
    ADD CONSTRAINT "long_milestones_chapter_id_fkey" FOREIGN KEY ("chapter_id") REFERENCES "public"."long_chapters"("id");



ALTER TABLE ONLY "public"."long_milestones"
    ADD CONSTRAINT "long_milestones_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."long_predictions"
    ADD CONSTRAINT "long_predictions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."long_snapshots"
    ADD CONSTRAINT "long_snapshots_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."long_trajectories"
    ADD CONSTRAINT "long_trajectories_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."long_trends"
    ADD CONSTRAINT "long_trends_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mc_events"
    ADD CONSTRAINT "mc_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mc_interventions"
    ADD CONSTRAINT "mc_interventions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mc_strategy_profiles"
    ADD CONSTRAINT "mc_strategy_profiles_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mem_archives"
    ADD CONSTRAINT "mem_archives_compression_id_fkey" FOREIGN KEY ("compression_id") REFERENCES "public"."mem_compressed"("id");



ALTER TABLE ONLY "public"."mem_archives"
    ADD CONSTRAINT "mem_archives_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mem_compressed"
    ADD CONSTRAINT "mem_compressed_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mem_compression_jobs"
    ADD CONSTRAINT "mem_compression_jobs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mem_compression_settings"
    ADD CONSTRAINT "mem_compression_settings_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."memories"
    ADD CONSTRAINT "memories_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."memory_events"
    ADD CONSTRAINT "memory_events_context_id_fkey" FOREIGN KEY ("context_id") REFERENCES "public"."knowledge_contexts"("id");



ALTER TABLE ONLY "public"."memory_events"
    ADD CONSTRAINT "memory_events_node_id_fkey" FOREIGN KEY ("node_id") REFERENCES "public"."knowledge_nodes"("id");



ALTER TABLE ONLY "public"."memory_events"
    ADD CONSTRAINT "memory_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."memory_patterns"
    ADD CONSTRAINT "memory_patterns_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mind_models"
    ADD CONSTRAINT "mind_models_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."motor_routine_metrics"
    ADD CONSTRAINT "motor_routine_metrics_routine_id_fkey" FOREIGN KEY ("routine_id") REFERENCES "public"."motor_routines"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."motor_routine_metrics"
    ADD CONSTRAINT "motor_routine_metrics_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."motor_routine_runs"
    ADD CONSTRAINT "motor_routine_runs_routine_id_fkey" FOREIGN KEY ("routine_id") REFERENCES "public"."motor_routines"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."motor_routine_runs"
    ADD CONSTRAINT "motor_routine_runs_trigger_id_fkey" FOREIGN KEY ("trigger_id") REFERENCES "public"."motor_routine_triggers"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."motor_routine_runs"
    ADD CONSTRAINT "motor_routine_runs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."motor_routine_steps"
    ADD CONSTRAINT "motor_routine_steps_routine_id_fkey" FOREIGN KEY ("routine_id") REFERENCES "public"."motor_routines"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."motor_routine_steps"
    ADD CONSTRAINT "motor_routine_steps_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."motor_routine_triggers"
    ADD CONSTRAINT "motor_routine_triggers_routine_id_fkey" FOREIGN KEY ("routine_id") REFERENCES "public"."motor_routines"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."motor_routine_triggers"
    ADD CONSTRAINT "motor_routine_triggers_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."motor_routines"
    ADD CONSTRAINT "motor_routines_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mythic_achievements"
    ADD CONSTRAINT "mythic_achievements_archetype_id_fkey" FOREIGN KEY ("archetype_id") REFERENCES "public"."archetype_definitions"("id");



ALTER TABLE ONLY "public"."mythic_achievements"
    ADD CONSTRAINT "mythic_achievements_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mythic_arcs"
    ADD CONSTRAINT "mythic_arcs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mythic_belt_levels"
    ADD CONSTRAINT "mythic_belt_levels_archetype_id_fkey" FOREIGN KEY ("archetype_id") REFERENCES "public"."archetype_definitions"("id");



ALTER TABLE ONLY "public"."mythic_belt_progress"
    ADD CONSTRAINT "mythic_belt_progress_archetype_id_fkey" FOREIGN KEY ("archetype_id") REFERENCES "public"."archetype_definitions"("id");



ALTER TABLE ONLY "public"."mythic_belt_progress"
    ADD CONSTRAINT "mythic_belt_progress_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mythic_coach_sessions"
    ADD CONSTRAINT "mythic_coach_sessions_deal_archetype_run_id_fkey" FOREIGN KEY ("deal_archetype_run_id") REFERENCES "public"."deal_archetype_runs"("id");



ALTER TABLE ONLY "public"."mythic_coach_sessions"
    ADD CONSTRAINT "mythic_coach_sessions_dominant_archetype_id_fkey" FOREIGN KEY ("dominant_archetype_id") REFERENCES "public"."mythic_archetypes"("id");



ALTER TABLE ONLY "public"."mythic_coach_sessions"
    ADD CONSTRAINT "mythic_coach_sessions_life_chapter_id_fkey" FOREIGN KEY ("life_chapter_id") REFERENCES "public"."life_chapters"("id");



ALTER TABLE ONLY "public"."mythic_coach_sessions"
    ADD CONSTRAINT "mythic_coach_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mythic_playbooks"
    ADD CONSTRAINT "mythic_playbooks_archetype_id_fkey" FOREIGN KEY ("archetype_id") REFERENCES "public"."mythic_archetypes"("id");



ALTER TABLE ONLY "public"."mythic_quests"
    ADD CONSTRAINT "mythic_quests_arc_id_fkey" FOREIGN KEY ("arc_id") REFERENCES "public"."mythic_arcs"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."mythic_quests"
    ADD CONSTRAINT "mythic_quests_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mythic_rituals"
    ADD CONSTRAINT "mythic_rituals_arc_id_fkey" FOREIGN KEY ("arc_id") REFERENCES "public"."mythic_arcs"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."mythic_rituals"
    ADD CONSTRAINT "mythic_rituals_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mythic_sessions"
    ADD CONSTRAINT "mythic_sessions_arc_id_fkey" FOREIGN KEY ("arc_id") REFERENCES "public"."mythic_arcs"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."mythic_sessions"
    ADD CONSTRAINT "mythic_sessions_chapter_id_fkey" FOREIGN KEY ("chapter_id") REFERENCES "public"."life_chapters"("id");



ALTER TABLE ONLY "public"."mythic_sessions"
    ADD CONSTRAINT "mythic_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mythic_training_focus"
    ADD CONSTRAINT "mythic_training_focus_linked_archetype_snapshot_id_fkey" FOREIGN KEY ("linked_archetype_snapshot_id") REFERENCES "public"."archetype_snapshots"("id");



ALTER TABLE ONLY "public"."mythic_training_focus"
    ADD CONSTRAINT "mythic_training_focus_linked_chapter_id_fkey" FOREIGN KEY ("linked_chapter_id") REFERENCES "public"."life_chapters"("id");



ALTER TABLE ONLY "public"."mythic_training_focus"
    ADD CONSTRAINT "mythic_training_focus_linked_snapshot_id_fkey" FOREIGN KEY ("linked_snapshot_id") REFERENCES "public"."life_canon_snapshots"("id");



ALTER TABLE ONLY "public"."mythic_training_focus"
    ADD CONSTRAINT "mythic_training_focus_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mythic_training_missions"
    ADD CONSTRAINT "mythic_training_missions_archetype_id_fkey" FOREIGN KEY ("archetype_id") REFERENCES "public"."archetype_definitions"("id");



ALTER TABLE ONLY "public"."mythic_training_missions"
    ADD CONSTRAINT "mythic_training_missions_plan_id_fkey" FOREIGN KEY ("plan_id") REFERENCES "public"."mythic_training_plans"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."mythic_training_missions"
    ADD CONSTRAINT "mythic_training_missions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mythic_training_plans"
    ADD CONSTRAINT "mythic_training_plans_archetype_id_fkey" FOREIGN KEY ("archetype_id") REFERENCES "public"."archetype_definitions"("id");



ALTER TABLE ONLY "public"."mythic_training_plans"
    ADD CONSTRAINT "mythic_training_plans_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mythic_training_reflections"
    ADD CONSTRAINT "mythic_training_reflections_archetype_id_fkey" FOREIGN KEY ("archetype_id") REFERENCES "public"."archetype_definitions"("id");



ALTER TABLE ONLY "public"."mythic_training_reflections"
    ADD CONSTRAINT "mythic_training_reflections_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mythic_voice_mappings"
    ADD CONSTRAINT "mythic_voice_mappings_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."mythic_voice_mappings"
    ADD CONSTRAINT "mythic_voice_mappings_voice_profile_id_fkey" FOREIGN KEY ("voice_profile_id") REFERENCES "public"."voice_profiles"("id");



ALTER TABLE ONLY "public"."narrative_snapshots"
    ADD CONSTRAINT "narrative_snapshots_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."notes"
    ADD CONSTRAINT "notes_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."notification_log"
    ADD CONSTRAINT "notification_log_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."notification_preferences"
    ADD CONSTRAINT "notification_preferences_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."notification_queue"
    ADD CONSTRAINT "notification_queue_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."onboarding_conversations"
    ADD CONSTRAINT "onboarding_conversations_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."onboarding_state"
    ADD CONSTRAINT "onboarding_state_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."ops_incident_events"
    ADD CONSTRAINT "ops_incident_events_incident_id_fkey" FOREIGN KEY ("incident_id") REFERENCES "public"."ops_incidents"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."org_members"
    ADD CONSTRAINT "org_members_org_id_fkey" FOREIGN KEY ("org_id") REFERENCES "public"."organizations"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."org_members"
    ADD CONSTRAINT "org_members_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."persona_arc_events"
    ADD CONSTRAINT "persona_arc_events_arc_id_fkey" FOREIGN KEY ("arc_id") REFERENCES "public"."persona_user_arc"("id");



ALTER TABLE ONLY "public"."persona_arc_events"
    ADD CONSTRAINT "persona_arc_events_persona_id_fkey" FOREIGN KEY ("persona_id") REFERENCES "public"."voice_profiles"("id");



ALTER TABLE ONLY "public"."persona_arc_events"
    ADD CONSTRAINT "persona_arc_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."persona_archetype_stats"
    ADD CONSTRAINT "persona_archetype_stats_archetype_id_fkey" FOREIGN KEY ("archetype_id") REFERENCES "public"."persona_archetypes"("id");



ALTER TABLE ONLY "public"."persona_companion_events"
    ADD CONSTRAINT "persona_companion_events_persona_id_fkey" FOREIGN KEY ("persona_id") REFERENCES "public"."voice_profiles"("id");



ALTER TABLE ONLY "public"."persona_companion_events"
    ADD CONSTRAINT "persona_companion_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."persona_companion_highlights"
    ADD CONSTRAINT "persona_companion_highlights_persona_id_fkey" FOREIGN KEY ("persona_id") REFERENCES "public"."voice_profiles"("id");



ALTER TABLE ONLY "public"."persona_companion_highlights"
    ADD CONSTRAINT "persona_companion_highlights_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."persona_companion_state"
    ADD CONSTRAINT "persona_companion_state_persona_id_fkey" FOREIGN KEY ("persona_id") REFERENCES "public"."voice_profiles"("id");



ALTER TABLE ONLY "public"."persona_companion_state"
    ADD CONSTRAINT "persona_companion_state_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."persona_interaction_stats"
    ADD CONSTRAINT "persona_interaction_stats_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."persona_memory_snapshots"
    ADD CONSTRAINT "persona_memory_snapshots_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."persona_microstyle_prefs"
    ADD CONSTRAINT "persona_microstyle_prefs_persona_id_fkey" FOREIGN KEY ("persona_id") REFERENCES "public"."voice_profiles"("id");



ALTER TABLE ONLY "public"."persona_microstyle_prefs"
    ADD CONSTRAINT "persona_microstyle_prefs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."persona_user_arc"
    ADD CONSTRAINT "persona_user_arc_persona_id_fkey" FOREIGN KEY ("persona_id") REFERENCES "public"."voice_profiles"("id");



ALTER TABLE ONLY "public"."persona_user_arc"
    ADD CONSTRAINT "persona_user_arc_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."personal_heuristics"
    ADD CONSTRAINT "personal_heuristics_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."personas"
    ADD CONSTRAINT "personas_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."philosophy_exercises"
    ADD CONSTRAINT "philosophy_exercises_lesson_id_fkey" FOREIGN KEY ("lesson_id") REFERENCES "public"."philosophy_lessons"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."plan_items"
    ADD CONSTRAINT "plan_items_day_plan_id_fkey" FOREIGN KEY ("day_plan_id") REFERENCES "public"."day_plans"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."plan_items"
    ADD CONSTRAINT "plan_items_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."planning_constraints"
    ADD CONSTRAINT "planning_constraints_session_id_fkey" FOREIGN KEY ("session_id") REFERENCES "public"."planning_sessions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."planning_constraints"
    ADD CONSTRAINT "planning_constraints_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."planning_decisions"
    ADD CONSTRAINT "planning_decisions_session_id_fkey" FOREIGN KEY ("session_id") REFERENCES "public"."planning_sessions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."planning_decisions"
    ADD CONSTRAINT "planning_decisions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."planning_overrides"
    ADD CONSTRAINT "planning_overrides_session_id_fkey" FOREIGN KEY ("session_id") REFERENCES "public"."planning_sessions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."planning_overrides"
    ADD CONSTRAINT "planning_overrides_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."planning_sessions"
    ADD CONSTRAINT "planning_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."plugin_api_keys"
    ADD CONSTRAINT "plugin_api_keys_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."plugin_automations"
    ADD CONSTRAINT "plugin_automations_action_plugin_id_fkey" FOREIGN KEY ("action_plugin_id") REFERENCES "public"."plugins"("id");



ALTER TABLE ONLY "public"."plugin_automations"
    ADD CONSTRAINT "plugin_automations_trigger_plugin_id_fkey" FOREIGN KEY ("trigger_plugin_id") REFERENCES "public"."plugins"("id");



ALTER TABLE ONLY "public"."plugin_automations"
    ADD CONSTRAINT "plugin_automations_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."plugin_data"
    ADD CONSTRAINT "plugin_data_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."plugin_data"
    ADD CONSTRAINT "plugin_data_user_plugin_id_fkey" FOREIGN KEY ("user_plugin_id") REFERENCES "public"."user_plugins"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."plugin_events"
    ADD CONSTRAINT "plugin_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."plugin_events"
    ADD CONSTRAINT "plugin_events_user_plugin_id_fkey" FOREIGN KEY ("user_plugin_id") REFERENCES "public"."user_plugins"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."plugin_webhooks"
    ADD CONSTRAINT "plugin_webhooks_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."plugin_webhooks"
    ADD CONSTRAINT "plugin_webhooks_user_plugin_id_fkey" FOREIGN KEY ("user_plugin_id") REFERENCES "public"."user_plugins"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."prefrontal_goals"
    ADD CONSTRAINT "prefrontal_goals_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."presence_daily_summaries"
    ADD CONSTRAINT "presence_daily_summaries_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."presence_decisions"
    ADD CONSTRAINT "presence_decisions_presence_event_id_fkey" FOREIGN KEY ("presence_event_id") REFERENCES "public"."presence_events"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."presence_decisions"
    ADD CONSTRAINT "presence_decisions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."presence_events"
    ADD CONSTRAINT "presence_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."proactive_interventions"
    ADD CONSTRAINT "proactive_interventions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."pulse_brain_preferences"
    ADD CONSTRAINT "pulse_brain_preferences_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."pulse_brain_surface_events"
    ADD CONSTRAINT "pulse_brain_surface_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."pulse_events"
    ADD CONSTRAINT "pulse_events_user_id_uuid_fkey" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."pulse_events"
    ADD CONSTRAINT "pulse_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."pulse_insight_acknowledgements"
    ADD CONSTRAINT "pulse_insight_acknowledgements_surface_event_id_fkey" FOREIGN KEY ("surface_event_id") REFERENCES "public"."pulse_brain_surface_events"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."pulse_insight_acknowledgements"
    ADD CONSTRAINT "pulse_insight_acknowledgements_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."pulse_introduction_sessions"
    ADD CONSTRAINT "pulse_introduction_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."push_subscriptions"
    ADD CONSTRAINT "push_subscriptions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."quest_completions"
    ADD CONSTRAINT "quest_completions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."relational_identities"
    ADD CONSTRAINT "relational_identities_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."relational_predictions"
    ADD CONSTRAINT "relational_predictions_relational_identity_id_fkey" FOREIGN KEY ("relational_identity_id") REFERENCES "public"."relational_identities"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."relational_predictions"
    ADD CONSTRAINT "relational_predictions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."relational_state_snapshots"
    ADD CONSTRAINT "relational_state_snapshots_relational_identity_id_fkey" FOREIGN KEY ("relational_identity_id") REFERENCES "public"."relational_identities"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."relational_state_snapshots"
    ADD CONSTRAINT "relational_state_snapshots_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."relationship_highlights"
    ADD CONSTRAINT "relationship_highlights_relational_identity_id_fkey" FOREIGN KEY ("relational_identity_id") REFERENCES "public"."relational_identities"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."relationship_highlights"
    ADD CONSTRAINT "relationship_highlights_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."relationship_interactions"
    ADD CONSTRAINT "relationship_interactions_relationship_id_fkey" FOREIGN KEY ("relationship_id") REFERENCES "public"."relationships"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."relationship_interactions"
    ADD CONSTRAINT "relationship_interactions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."relationships"
    ADD CONSTRAINT "relationships_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."reminder_subscriptions"
    ADD CONSTRAINT "reminder_subscriptions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."reply_drafts"
    ADD CONSTRAINT "reply_drafts_inbox_item_id_fkey" FOREIGN KEY ("inbox_item_id") REFERENCES "public"."inbox_items"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."reply_drafts"
    ADD CONSTRAINT "reply_drafts_user_id_uuid_fkey" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."safety_incidents"
    ADD CONSTRAINT "safety_incidents_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."scheduler_targets"
    ADD CONSTRAINT "scheduler_targets_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."self_identity_snapshots"
    ADD CONSTRAINT "self_identity_snapshots_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."self_mirror_deltas"
    ADD CONSTRAINT "self_mirror_deltas_from_snapshot_id_fkey" FOREIGN KEY ("from_snapshot_id") REFERENCES "public"."self_mirror_snapshots"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."self_mirror_deltas"
    ADD CONSTRAINT "self_mirror_deltas_to_snapshot_id_fkey" FOREIGN KEY ("to_snapshot_id") REFERENCES "public"."self_mirror_snapshots"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."self_mirror_deltas"
    ADD CONSTRAINT "self_mirror_deltas_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."self_mirror_facets"
    ADD CONSTRAINT "self_mirror_facets_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."self_mirror_highlights"
    ADD CONSTRAINT "self_mirror_highlights_delta_id_fkey" FOREIGN KEY ("delta_id") REFERENCES "public"."self_mirror_deltas"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."self_mirror_highlights"
    ADD CONSTRAINT "self_mirror_highlights_snapshot_id_fkey" FOREIGN KEY ("snapshot_id") REFERENCES "public"."self_mirror_snapshots"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."self_mirror_highlights"
    ADD CONSTRAINT "self_mirror_highlights_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."self_mirror_sessions"
    ADD CONSTRAINT "self_mirror_sessions_snapshot_id_fkey" FOREIGN KEY ("snapshot_id") REFERENCES "public"."self_identity_snapshots"("id");



ALTER TABLE ONLY "public"."self_mirror_sessions"
    ADD CONSTRAINT "self_mirror_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."self_mirror_snapshots"
    ADD CONSTRAINT "self_mirror_snapshots_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."self_perception_signals"
    ADD CONSTRAINT "self_perception_signals_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."sim_decision_trees"
    ADD CONSTRAINT "sim_decision_trees_simulation_id_fkey" FOREIGN KEY ("simulation_id") REFERENCES "public"."sim_simulations"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."sim_decision_trees"
    ADD CONSTRAINT "sim_decision_trees_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."sim_history"
    ADD CONSTRAINT "sim_history_simulation_id_fkey" FOREIGN KEY ("simulation_id") REFERENCES "public"."sim_simulations"("id");



ALTER TABLE ONLY "public"."sim_history"
    ADD CONSTRAINT "sim_history_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."sim_history"
    ADD CONSTRAINT "sim_history_what_if_id_fkey" FOREIGN KEY ("what_if_id") REFERENCES "public"."sim_what_ifs"("id");



ALTER TABLE ONLY "public"."sim_runs"
    ADD CONSTRAINT "sim_runs_scenario_id_fkey" FOREIGN KEY ("scenario_id") REFERENCES "public"."sim_scenarios"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."sim_runs"
    ADD CONSTRAINT "sim_runs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."sim_scenarios"
    ADD CONSTRAINT "sim_scenarios_simulation_id_fkey" FOREIGN KEY ("simulation_id") REFERENCES "public"."sim_simulations"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."sim_scenarios"
    ADD CONSTRAINT "sim_scenarios_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."sim_simulations"
    ADD CONSTRAINT "sim_simulations_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."sim_what_ifs"
    ADD CONSTRAINT "sim_what_ifs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."simulation_fix_plans"
    ADD CONSTRAINT "simulation_fix_plans_run_id_fkey" FOREIGN KEY ("run_id") REFERENCES "public"."simulation_runs"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."simulation_fix_plans"
    ADD CONSTRAINT "simulation_fix_plans_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."simulation_metrics"
    ADD CONSTRAINT "simulation_metrics_simulation_id_fkey" FOREIGN KEY ("simulation_id") REFERENCES "public"."simulation_runs"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."simulation_models"
    ADD CONSTRAINT "simulation_models_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."simulation_outcomes"
    ADD CONSTRAINT "simulation_outcomes_run_id_fkey" FOREIGN KEY ("run_id") REFERENCES "public"."simulation_runs"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."simulation_outcomes"
    ADD CONSTRAINT "simulation_outcomes_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."simulation_policies"
    ADD CONSTRAINT "simulation_policies_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."simulation_runs"
    ADD CONSTRAINT "simulation_runs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."simulation_steps"
    ADD CONSTRAINT "simulation_steps_timeline_id_fkey" FOREIGN KEY ("timeline_id") REFERENCES "public"."simulation_timelines"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."simulation_steps"
    ADD CONSTRAINT "simulation_steps_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."simulation_timelines"
    ADD CONSTRAINT "simulation_timelines_run_id_fkey" FOREIGN KEY ("run_id") REFERENCES "public"."simulation_runs"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."simulation_timelines"
    ADD CONSTRAINT "simulation_timelines_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."sms_messages"
    ADD CONSTRAINT "sms_messages_deal_id_fkey" FOREIGN KEY ("deal_id") REFERENCES "public"."deals"("id");



ALTER TABLE ONLY "public"."sms_messages"
    ADD CONSTRAINT "sms_messages_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."social_edges"
    ADD CONSTRAINT "social_edges_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."social_entities"
    ADD CONSTRAINT "social_entities_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."social_insights"
    ADD CONSTRAINT "social_insights_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."social_nodes"
    ADD CONSTRAINT "social_nodes_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."social_recommendations"
    ADD CONSTRAINT "social_recommendations_edge_id_fkey" FOREIGN KEY ("edge_id") REFERENCES "public"."social_edges"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."social_recommendations"
    ADD CONSTRAINT "social_recommendations_entity_id_fkey" FOREIGN KEY ("entity_id") REFERENCES "public"."social_entities"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."social_recommendations"
    ADD CONSTRAINT "social_recommendations_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."social_risk_events"
    ADD CONSTRAINT "social_risk_events_edge_id_fkey" FOREIGN KEY ("edge_id") REFERENCES "public"."social_edges"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."social_risk_events"
    ADD CONSTRAINT "social_risk_events_entity_id_fkey" FOREIGN KEY ("entity_id") REFERENCES "public"."social_entities"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."social_risk_events"
    ADD CONSTRAINT "social_risk_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."social_state_snapshots"
    ADD CONSTRAINT "social_state_snapshots_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."somatic_alerts"
    ADD CONSTRAINT "somatic_alerts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."somatic_daily_metrics"
    ADD CONSTRAINT "somatic_daily_metrics_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."somatic_device_settings"
    ADD CONSTRAINT "somatic_device_settings_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."somatic_patterns"
    ADD CONSTRAINT "somatic_patterns_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."somatic_raw_device_events"
    ADD CONSTRAINT "somatic_raw_device_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."somatic_samples"
    ADD CONSTRAINT "somatic_samples_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."somatic_state_daily"
    ADD CONSTRAINT "somatic_state_daily_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."strategic_conflicts"
    ADD CONSTRAINT "strategic_conflicts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."strategic_domains"
    ADD CONSTRAINT "strategic_domains_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."strategic_equilibria"
    ADD CONSTRAINT "strategic_equilibria_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."strategic_objectives"
    ADD CONSTRAINT "strategic_objectives_domain_id_fkey" FOREIGN KEY ("domain_id") REFERENCES "public"."strategic_domains"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."strategic_objectives"
    ADD CONSTRAINT "strategic_objectives_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."strategic_plans"
    ADD CONSTRAINT "strategic_plans_objective_id_fkey" FOREIGN KEY ("objective_id") REFERENCES "public"."strategic_objectives"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."strategic_plans"
    ADD CONSTRAINT "strategic_plans_primary_playbook_id_fkey" FOREIGN KEY ("primary_playbook_id") REFERENCES "public"."strategic_playbooks"("id");



ALTER TABLE ONLY "public"."strategic_plans"
    ADD CONSTRAINT "strategic_plans_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."strategic_review_events"
    ADD CONSTRAINT "strategic_review_events_session_id_fkey" FOREIGN KEY ("session_id") REFERENCES "public"."strategist_sessions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."strategic_review_events"
    ADD CONSTRAINT "strategic_review_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."strategic_state_snapshots"
    ADD CONSTRAINT "strategic_state_snapshots_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."strategist_sessions"
    ADD CONSTRAINT "strategist_sessions_equilibrium_id_fkey" FOREIGN KEY ("equilibrium_id") REFERENCES "public"."strategic_equilibria"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."strategist_sessions"
    ADD CONSTRAINT "strategist_sessions_snapshot_id_fkey" FOREIGN KEY ("snapshot_id") REFERENCES "public"."strategic_state_snapshots"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."strategist_sessions"
    ADD CONSTRAINT "strategist_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."strategy_actions"
    ADD CONSTRAINT "strategy_actions_life_arc_id_fkey" FOREIGN KEY ("life_arc_id") REFERENCES "public"."life_arcs"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."strategy_actions"
    ADD CONSTRAINT "strategy_actions_pillar_id_fkey" FOREIGN KEY ("pillar_id") REFERENCES "public"."strategy_pillars"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."strategy_feedback"
    ADD CONSTRAINT "strategy_feedback_recommendation_id_fkey" FOREIGN KEY ("recommendation_id") REFERENCES "public"."strategy_recommendations"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."strategy_feedback"
    ADD CONSTRAINT "strategy_feedback_session_id_fkey" FOREIGN KEY ("session_id") REFERENCES "public"."strategist_sessions"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."strategy_feedback"
    ADD CONSTRAINT "strategy_feedback_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."strategy_paths"
    ADD CONSTRAINT "strategy_paths_snapshot_id_fkey" FOREIGN KEY ("snapshot_id") REFERENCES "public"."strategy_snapshots"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."strategy_pillars"
    ADD CONSTRAINT "strategy_pillars_path_id_fkey" FOREIGN KEY ("path_id") REFERENCES "public"."strategy_paths"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."strategy_pillars"
    ADD CONSTRAINT "strategy_pillars_snapshot_id_fkey" FOREIGN KEY ("snapshot_id") REFERENCES "public"."strategy_snapshots"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."strategy_recommendations"
    ADD CONSTRAINT "strategy_recommendations_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."strategy_snapshots"
    ADD CONSTRAINT "strategy_snapshots_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."streaks"
    ADD CONSTRAINT "streaks_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."system_capabilities"
    ADD CONSTRAINT "system_capabilities_module_id_fkey" FOREIGN KEY ("module_id") REFERENCES "public"."system_modules"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."system_capability_health"
    ADD CONSTRAINT "system_capability_health_capability_id_fkey" FOREIGN KEY ("capability_id") REFERENCES "public"."system_capabilities"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."system_changelog"
    ADD CONSTRAINT "system_changelog_experiment_id_fkey" FOREIGN KEY ("experiment_id") REFERENCES "public"."system_experiments"("id");



ALTER TABLE ONLY "public"."system_changelog"
    ADD CONSTRAINT "system_changelog_module_id_fkey" FOREIGN KEY ("module_id") REFERENCES "public"."system_modules"("id");



ALTER TABLE ONLY "public"."system_diagnostics_findings"
    ADD CONSTRAINT "system_diagnostics_findings_capability_id_fkey" FOREIGN KEY ("capability_id") REFERENCES "public"."system_capabilities"("id");



ALTER TABLE ONLY "public"."system_diagnostics_findings"
    ADD CONSTRAINT "system_diagnostics_findings_module_id_fkey" FOREIGN KEY ("module_id") REFERENCES "public"."system_modules"("id");



ALTER TABLE ONLY "public"."system_diagnostics_findings"
    ADD CONSTRAINT "system_diagnostics_findings_run_id_fkey" FOREIGN KEY ("run_id") REFERENCES "public"."system_diagnostics_runs"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."system_experiment_runs"
    ADD CONSTRAINT "system_experiment_runs_experiment_id_fkey" FOREIGN KEY ("experiment_id") REFERENCES "public"."system_experiments"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."system_improvement_ideas"
    ADD CONSTRAINT "system_improvement_ideas_capability_id_fkey" FOREIGN KEY ("capability_id") REFERENCES "public"."system_capabilities"("id");



ALTER TABLE ONLY "public"."system_improvement_ideas"
    ADD CONSTRAINT "system_improvement_ideas_module_id_fkey" FOREIGN KEY ("module_id") REFERENCES "public"."system_modules"("id");



ALTER TABLE ONLY "public"."system_module_health"
    ADD CONSTRAINT "system_module_health_module_id_fkey" FOREIGN KEY ("module_id") REFERENCES "public"."system_modules"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."system_module_metrics"
    ADD CONSTRAINT "system_module_metrics_module_id_fkey" FOREIGN KEY ("module_id") REFERENCES "public"."system_modules"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."system_user_feedback"
    ADD CONSTRAINT "system_user_feedback_capability_id_fkey" FOREIGN KEY ("capability_id") REFERENCES "public"."system_capabilities"("id");



ALTER TABLE ONLY "public"."system_user_feedback"
    ADD CONSTRAINT "system_user_feedback_module_id_fkey" FOREIGN KEY ("module_id") REFERENCES "public"."system_modules"("id");



ALTER TABLE ONLY "public"."system_user_feedback"
    ADD CONSTRAINT "system_user_feedback_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."task_events"
    ADD CONSTRAINT "task_events_task_id_fkey" FOREIGN KEY ("task_id") REFERENCES "public"."tasks"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."task_events"
    ADD CONSTRAINT "task_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."tasks"
    ADD CONSTRAINT "tasks_deal_id_fkey" FOREIGN KEY ("deal_id") REFERENCES "public"."deals"("id");



ALTER TABLE ONLY "public"."tasks"
    ADD CONSTRAINT "tasks_user_id_uuid_fkey" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."tasks"
    ADD CONSTRAINT "tasks_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."tb_chapters"
    ADD CONSTRAINT "tb_chapters_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."tb_context_snapshots"
    ADD CONSTRAINT "tb_context_snapshots_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."tb_edges"
    ADD CONSTRAINT "tb_edges_from_node_id_fkey" FOREIGN KEY ("from_node_id") REFERENCES "public"."tb_nodes"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."tb_edges"
    ADD CONSTRAINT "tb_edges_to_node_id_fkey" FOREIGN KEY ("to_node_id") REFERENCES "public"."tb_nodes"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."tb_edges"
    ADD CONSTRAINT "tb_edges_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."tb_embeddings"
    ADD CONSTRAINT "tb_embeddings_fragment_id_fkey" FOREIGN KEY ("fragment_id") REFERENCES "public"."tb_memory_fragments"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."tb_embeddings"
    ADD CONSTRAINT "tb_embeddings_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."tb_entities"
    ADD CONSTRAINT "tb_entities_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."tb_entity_edges"
    ADD CONSTRAINT "tb_entity_edges_from_entity_id_fkey" FOREIGN KEY ("from_entity_id") REFERENCES "public"."tb_entities"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."tb_entity_edges"
    ADD CONSTRAINT "tb_entity_edges_to_entity_id_fkey" FOREIGN KEY ("to_entity_id") REFERENCES "public"."tb_entities"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."tb_entity_edges"
    ADD CONSTRAINT "tb_entity_edges_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."tb_entity_fragment_links"
    ADD CONSTRAINT "tb_entity_fragment_links_entity_id_fkey" FOREIGN KEY ("entity_id") REFERENCES "public"."tb_entities"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."tb_entity_fragment_links"
    ADD CONSTRAINT "tb_entity_fragment_links_fragment_id_fkey" FOREIGN KEY ("fragment_id") REFERENCES "public"."tb_memory_fragments"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."tb_entity_fragment_links"
    ADD CONSTRAINT "tb_entity_fragment_links_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."tb_insights"
    ADD CONSTRAINT "tb_insights_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."tb_memory_fragments"
    ADD CONSTRAINT "tb_memory_fragments_raw_event_id_fkey" FOREIGN KEY ("raw_event_id") REFERENCES "public"."tb_raw_events"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."tb_memory_fragments"
    ADD CONSTRAINT "tb_memory_fragments_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."tb_nodes"
    ADD CONSTRAINT "tb_nodes_household_id_fkey" FOREIGN KEY ("household_id") REFERENCES "public"."households"("id");



ALTER TABLE ONLY "public"."tb_nodes"
    ADD CONSTRAINT "tb_nodes_org_id_fkey" FOREIGN KEY ("org_id") REFERENCES "public"."organizations"("id");



ALTER TABLE ONLY "public"."tb_nodes"
    ADD CONSTRAINT "tb_nodes_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."tb_raw_events"
    ADD CONSTRAINT "tb_raw_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."tb_user_patterns"
    ADD CONSTRAINT "tb_user_patterns_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."teachings"
    ADD CONSTRAINT "teachings_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."theory_of_mind_profiles"
    ADD CONSTRAINT "theory_of_mind_profiles_entity_id_fkey" FOREIGN KEY ("entity_id") REFERENCES "public"."social_entities"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."theory_of_mind_profiles"
    ADD CONSTRAINT "theory_of_mind_profiles_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."third_brain_events"
    ADD CONSTRAINT "third_brain_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."third_brain_insights"
    ADD CONSTRAINT "third_brain_insights_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."third_brain_memories"
    ADD CONSTRAINT "third_brain_memories_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."timeline_coach_sessions"
    ADD CONSTRAINT "timeline_coach_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."timeline_commitments"
    ADD CONSTRAINT "timeline_commitments_decision_id_fkey" FOREIGN KEY ("decision_id") REFERENCES "public"."timeline_decisions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."timeline_commitments"
    ADD CONSTRAINT "timeline_commitments_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."timeline_decisions"
    ADD CONSTRAINT "timeline_decisions_chosen_timeline_id_fkey" FOREIGN KEY ("chosen_timeline_id") REFERENCES "public"."simulation_timelines"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."timeline_decisions"
    ADD CONSTRAINT "timeline_decisions_run_id_fkey" FOREIGN KEY ("run_id") REFERENCES "public"."simulation_runs"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."timeline_decisions"
    ADD CONSTRAINT "timeline_decisions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."timeline_preference_profile"
    ADD CONSTRAINT "timeline_preference_profile_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."timeline_reflections"
    ADD CONSTRAINT "timeline_reflections_decision_id_fkey" FOREIGN KEY ("decision_id") REFERENCES "public"."timeline_decisions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."timeline_reflections"
    ADD CONSTRAINT "timeline_reflections_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."usage_logs"
    ADD CONSTRAINT "usage_logs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."user_agi_settings"
    ADD CONSTRAINT "user_agi_settings_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."user_archetype_profiles"
    ADD CONSTRAINT "user_archetype_profiles_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."user_dashboard_layouts"
    ADD CONSTRAINT "user_dashboard_layouts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."user_experiment_arms"
    ADD CONSTRAINT "user_experiment_arms_experiment_id_fkey" FOREIGN KEY ("experiment_id") REFERENCES "public"."user_experiments"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."user_experiment_data_points"
    ADD CONSTRAINT "user_experiment_data_points_arm_id_fkey" FOREIGN KEY ("arm_id") REFERENCES "public"."user_experiment_arms"("id");



ALTER TABLE ONLY "public"."user_experiment_data_points"
    ADD CONSTRAINT "user_experiment_data_points_experiment_id_fkey" FOREIGN KEY ("experiment_id") REFERENCES "public"."user_experiments"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."user_experiment_results"
    ADD CONSTRAINT "user_experiment_results_experiment_id_fkey" FOREIGN KEY ("experiment_id") REFERENCES "public"."user_experiments"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."user_experiments"
    ADD CONSTRAINT "user_experiments_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."user_focus_profile"
    ADD CONSTRAINT "user_focus_profile_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."user_interview_sessions"
    ADD CONSTRAINT "user_interview_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."user_job_profiles"
    ADD CONSTRAINT "user_job_profiles_job_graph_node_id_fkey" FOREIGN KEY ("job_graph_node_id") REFERENCES "public"."job_graph_nodes"("id");



ALTER TABLE ONLY "public"."user_job_profiles"
    ADD CONSTRAINT "user_job_profiles_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."user_mythic_coach_settings"
    ADD CONSTRAINT "user_mythic_coach_settings_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."user_mythic_profile"
    ADD CONSTRAINT "user_mythic_profile_current_chapter_id_fkey" FOREIGN KEY ("current_chapter_id") REFERENCES "public"."life_chapters"("id");



ALTER TABLE ONLY "public"."user_mythic_profile"
    ADD CONSTRAINT "user_mythic_profile_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."user_onboarding_state"
    ADD CONSTRAINT "user_onboarding_state_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."user_packs"
    ADD CONSTRAINT "user_packs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."user_persona_tuning"
    ADD CONSTRAINT "user_persona_tuning_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."user_philosophy_progress"
    ADD CONSTRAINT "user_philosophy_progress_exercise_id_fkey" FOREIGN KEY ("exercise_id") REFERENCES "public"."philosophy_exercises"("id");



ALTER TABLE ONLY "public"."user_philosophy_progress"
    ADD CONSTRAINT "user_philosophy_progress_lesson_id_fkey" FOREIGN KEY ("lesson_id") REFERENCES "public"."philosophy_lessons"("id");



ALTER TABLE ONLY "public"."user_philosophy_progress"
    ADD CONSTRAINT "user_philosophy_progress_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."user_plugins"
    ADD CONSTRAINT "user_plugins_plugin_id_fkey" FOREIGN KEY ("plugin_id") REFERENCES "public"."plugins"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."user_plugins"
    ADD CONSTRAINT "user_plugins_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."user_prefs"
    ADD CONSTRAINT "user_prefs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."user_profiles"
    ADD CONSTRAINT "user_profiles_job_title_id_fkey" FOREIGN KEY ("job_title_id") REFERENCES "public"."job_titles"("id");



ALTER TABLE ONLY "public"."user_profiles"
    ADD CONSTRAINT "user_profiles_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."user_safety_settings"
    ADD CONSTRAINT "user_safety_settings_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."user_settings"
    ADD CONSTRAINT "user_settings_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."value_profile"
    ADD CONSTRAINT "value_profile_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."vault_access_log"
    ADD CONSTRAINT "vault_access_log_item_id_fkey" FOREIGN KEY ("item_id") REFERENCES "public"."vault_items"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."vault_access_log"
    ADD CONSTRAINT "vault_access_log_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."vault_emergency_access"
    ADD CONSTRAINT "vault_emergency_access_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."vault_items"
    ADD CONSTRAINT "vault_items_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."vault_keys"
    ADD CONSTRAINT "vault_keys_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."vault_secure_notes"
    ADD CONSTRAINT "vault_secure_notes_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."vault_shares"
    ADD CONSTRAINT "vault_shares_item_id_fkey" FOREIGN KEY ("item_id") REFERENCES "public"."vault_items"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."vertical_metrics"
    ADD CONSTRAINT "vertical_metrics_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."voice_sessions"
    ADD CONSTRAINT "voice_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."voice_turns"
    ADD CONSTRAINT "voice_turns_session_id_fkey" FOREIGN KEY ("session_id") REFERENCES "public"."voice_sessions"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."voice_turns"
    ADD CONSTRAINT "voice_turns_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."voicemails"
    ADD CONSTRAINT "voicemails_deal_id_fkey" FOREIGN KEY ("deal_id") REFERENCES "public"."deals"("id");



ALTER TABLE ONLY "public"."voicemails"
    ADD CONSTRAINT "voicemails_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."weekly_plans"
    ADD CONSTRAINT "weekly_plans_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."what_if_outcomes"
    ADD CONSTRAINT "what_if_outcomes_run_id_fkey" FOREIGN KEY ("run_id") REFERENCES "public"."what_if_runs"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."what_if_outcomes"
    ADD CONSTRAINT "what_if_outcomes_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."what_if_runs"
    ADD CONSTRAINT "what_if_runs_scenario_id_fkey" FOREIGN KEY ("scenario_id") REFERENCES "public"."what_if_scenarios"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."what_if_runs"
    ADD CONSTRAINT "what_if_runs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."what_if_scenarios"
    ADD CONSTRAINT "what_if_scenarios_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."wisdom_lessons"
    ADD CONSTRAINT "wisdom_lessons_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."wisdom_playbooks"
    ADD CONSTRAINT "wisdom_playbooks_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."wisdom_refresh_runs"
    ADD CONSTRAINT "wisdom_refresh_runs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."work_scoreboard_days"
    ADD CONSTRAINT "work_scoreboard_days_user_id_uuid_fkey" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."workspace_day_log"
    ADD CONSTRAINT "workspace_day_log_chosen_focus_state_id_fkey" FOREIGN KEY ("chosen_focus_state_id") REFERENCES "public"."workspace_focus_states"("id");



ALTER TABLE ONLY "public"."workspace_day_log"
    ADD CONSTRAINT "workspace_day_log_executed_timeline_id_fkey" FOREIGN KEY ("executed_timeline_id") REFERENCES "public"."destiny_timelines"("id");



ALTER TABLE ONLY "public"."workspace_day_log"
    ADD CONSTRAINT "workspace_day_log_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."workspace_focus_sessions"
    ADD CONSTRAINT "workspace_focus_sessions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."workspace_focus_states"
    ADD CONSTRAINT "workspace_focus_states_active_branch_run_id_fkey" FOREIGN KEY ("active_branch_run_id") REFERENCES "public"."branch_simulation_runs"("id");



ALTER TABLE ONLY "public"."workspace_focus_states"
    ADD CONSTRAINT "workspace_focus_states_active_timeline_id_fkey" FOREIGN KEY ("active_timeline_id") REFERENCES "public"."destiny_timelines"("id");



ALTER TABLE ONLY "public"."workspace_focus_states"
    ADD CONSTRAINT "workspace_focus_states_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."workspace_interrupts"
    ADD CONSTRAINT "workspace_interrupts_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."workspace_state"
    ADD CONSTRAINT "workspace_state_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."workspace_threads"
    ADD CONSTRAINT "workspace_threads_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."workspace_timeline_links"
    ADD CONSTRAINT "workspace_timeline_links_timeline_id_fkey" FOREIGN KEY ("timeline_id") REFERENCES "public"."simulation_timelines"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."workspace_timeline_links"
    ADD CONSTRAINT "workspace_timeline_links_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."xp_evaluation_runs"
    ADD CONSTRAINT "xp_evaluation_runs_evidence_id_fkey" FOREIGN KEY ("evidence_id") REFERENCES "public"."life_evidence"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."xp_evaluation_runs"
    ADD CONSTRAINT "xp_evaluation_runs_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."xp_events"
    ADD CONSTRAINT "xp_events_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."xp_ledger"
    ADD CONSTRAINT "xp_ledger_evidence_id_fkey" FOREIGN KEY ("evidence_id") REFERENCES "public"."life_evidence"("id") ON DELETE SET NULL;



ALTER TABLE ONLY "public"."xp_ledger"
    ADD CONSTRAINT "xp_ledger_reversal_of_fkey" FOREIGN KEY ("reversal_of") REFERENCES "public"."xp_ledger"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."xp_ledger"
    ADD CONSTRAINT "xp_ledger_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



ALTER TABLE ONLY "public"."xp_transactions"
    ADD CONSTRAINT "xp_transactions_user_id_uuid_fkey_identity_users" FOREIGN KEY ("user_id_uuid") REFERENCES "public"."identity_users"("id") ON DELETE RESTRICT;



CREATE POLICY "Anyone can read industries" ON "public"."industries" FOR SELECT USING (true);



CREATE POLICY "Anyone can read job_categories" ON "public"."job_categories" FOR SELECT USING (true);



CREATE POLICY "Anyone can read job_titles" ON "public"."job_titles" FOR SELECT USING (true);



CREATE POLICY "Anyone can read public plugins" ON "public"."plugins" FOR SELECT USING (("is_public" = true));



CREATE POLICY "Anyone can read public sim_templates" ON "public"."sim_templates" FOR SELECT USING (("is_public" = true));



CREATE POLICY "Service can insert usage" ON "public"."usage_logs" FOR INSERT WITH CHECK (true);



CREATE POLICY "Service role can manage all tb_context_snapshots" ON "public"."tb_context_snapshots" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role can manage all tb_embeddings" ON "public"."tb_embeddings" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role can manage all tb_entities" ON "public"."tb_entities" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role can manage all tb_entity_edges" ON "public"."tb_entity_edges" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role can manage all tb_entity_fragment_links" ON "public"."tb_entity_fragment_links" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role can manage all tb_insights" ON "public"."tb_insights" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role can manage all tb_memory_fragments" ON "public"."tb_memory_fragments" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role can manage all tb_raw_events" ON "public"."tb_raw_events" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role can manage all tb_user_patterns" ON "public"."tb_user_patterns" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access campaigns" ON "public"."campaigns" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access enrollments" ON "public"."campaign_enrollments" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access feedback" ON "public"."feedback" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access interactions" ON "public"."relationship_interactions" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access memories" ON "public"."memories" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access packs" ON "public"."user_packs" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access patterns" ON "public"."memory_patterns" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access personas" ON "public"."personas" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access queue" ON "public"."notification_queue" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access relationships" ON "public"."relationships" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access teachings" ON "public"."teachings" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access to autonomy actions" ON "public"."autonomy_actions" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access to cached events" ON "public"."calendar_events_cache" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access to calendar accounts" ON "public"."calendar_accounts" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access to day plans" ON "public"."day_plans" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access to delegated drafts" ON "public"."delegated_drafts" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access to domain kpis" ON "public"."domain_kpis" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access to emotional checkins" ON "public"."emotional_checkins" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access to emotional patterns" ON "public"."emotional_patterns" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access to emotional support logs" ON "public"."emotional_support_logs" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access to events" ON "public"."third_brain_events" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access to executive summaries" ON "public"."executive_summaries" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access to insights" ON "public"."third_brain_insights" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access to life domains" ON "public"."life_domains" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access to memories" ON "public"."third_brain_memories" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access to notification log" ON "public"."notification_log" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access to notification preferences" ON "public"."notification_preferences" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access to plan items" ON "public"."plan_items" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access to push subscriptions" ON "public"."push_subscriptions" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role full access weekly plans" ON "public"."weekly_plans" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all efc_action_sequences" ON "public"."efc_action_sequences" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all efc_commitments" ON "public"."efc_commitments" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all efc_energy_states" ON "public"."efc_energy_states" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all efc_execution_log" ON "public"."efc_execution_log" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all efc_generated_actions" ON "public"."efc_generated_actions" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all efc_nudges" ON "public"."efc_nudges" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all emo_adaptive_responses" ON "public"."emo_adaptive_responses" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all emo_checkins" ON "public"."emo_checkins" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all emo_goals" ON "public"."emo_goals" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all emo_interventions" ON "public"."emo_interventions" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all emo_profiles" ON "public"."emo_profiles" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all emo_states" ON "public"."emo_states" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all emo_transitions" ON "public"."emo_transitions" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all id_aspirations" ON "public"."id_aspirations" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all id_beliefs" ON "public"."id_beliefs" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all id_growth_areas" ON "public"."id_growth_areas" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all id_narrative_chapters" ON "public"."id_narrative_chapters" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all id_roles" ON "public"."id_roles" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all id_snapshots" ON "public"."id_snapshots" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all id_strengths" ON "public"."id_strengths" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages all id_values" ON "public"."id_values" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages interventions" ON "public"."proactive_interventions" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages long_chapters" ON "public"."long_chapters" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages long_milestones" ON "public"."long_milestones" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages long_predictions" ON "public"."long_predictions" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages long_snapshots" ON "public"."long_snapshots" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages long_trajectories" ON "public"."long_trajectories" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages long_trends" ON "public"."long_trends" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages mem_archives" ON "public"."mem_archives" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages mem_compressed" ON "public"."mem_compressed" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages mem_compression_jobs" ON "public"."mem_compression_jobs" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages mem_compression_settings" ON "public"."mem_compression_settings" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages plugin_api_keys" ON "public"."plugin_api_keys" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages plugin_automations" ON "public"."plugin_automations" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages plugin_data" ON "public"."plugin_data" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages plugin_events" ON "public"."plugin_events" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages plugin_webhooks" ON "public"."plugin_webhooks" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages plugins" ON "public"."plugins" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages sim_decision_trees" ON "public"."sim_decision_trees" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages sim_history" ON "public"."sim_history" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages sim_scenarios" ON "public"."sim_scenarios" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages sim_simulations" ON "public"."sim_simulations" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages sim_templates" ON "public"."sim_templates" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages sim_what_ifs" ON "public"."sim_what_ifs" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages user_plugins" ON "public"."user_plugins" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages vault_access_log" ON "public"."vault_access_log" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages vault_emergency" ON "public"."vault_emergency_access" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages vault_items" ON "public"."vault_items" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages vault_keys" ON "public"."vault_keys" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages vault_notes" ON "public"."vault_secure_notes" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Service role manages vault_shares" ON "public"."vault_shares" USING (("auth"."role"() = 'service_role'::"text"));



CREATE POLICY "Users can delete own autonomy actions" ON "public"."autonomy_actions" FOR DELETE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can delete own cached events" ON "public"."calendar_events_cache" FOR DELETE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can delete own calendar accounts" ON "public"."calendar_accounts" FOR DELETE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can delete own day plans" ON "public"."day_plans" FOR DELETE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can delete own delegated drafts" ON "public"."delegated_drafts" FOR DELETE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can delete own events" ON "public"."third_brain_events" FOR DELETE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can delete own insights" ON "public"."third_brain_insights" FOR DELETE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can delete own life domains" ON "public"."life_domains" FOR DELETE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can delete own memories" ON "public"."third_brain_memories" FOR DELETE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can delete own plan items" ON "public"."plan_items" FOR DELETE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can delete own push subscriptions" ON "public"."push_subscriptions" FOR DELETE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can insert own autonomy actions" ON "public"."autonomy_actions" FOR INSERT WITH CHECK (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can insert own cached events" ON "public"."calendar_events_cache" FOR INSERT WITH CHECK (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can insert own calendar accounts" ON "public"."calendar_accounts" FOR INSERT WITH CHECK (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can insert own day plans" ON "public"."day_plans" FOR INSERT WITH CHECK (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can insert own delegated drafts" ON "public"."delegated_drafts" FOR INSERT WITH CHECK (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can insert own domain kpis" ON "public"."domain_kpis" FOR INSERT WITH CHECK (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can insert own emotional checkins" ON "public"."emotional_checkins" FOR INSERT WITH CHECK (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can insert own emotional support logs" ON "public"."emotional_support_logs" FOR INSERT WITH CHECK (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can insert own events" ON "public"."third_brain_events" FOR INSERT WITH CHECK (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can insert own executive summaries" ON "public"."executive_summaries" FOR INSERT WITH CHECK (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can insert own insights" ON "public"."third_brain_insights" FOR INSERT WITH CHECK (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can insert own life domains" ON "public"."life_domains" FOR INSERT WITH CHECK (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can insert own memories" ON "public"."third_brain_memories" FOR INSERT WITH CHECK (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can insert own notification preferences" ON "public"."notification_preferences" FOR INSERT WITH CHECK (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can insert own plan items" ON "public"."plan_items" FOR INSERT WITH CHECK (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can insert own profile" ON "public"."user_profiles" FOR INSERT WITH CHECK (("user_id" = "current_setting"('app.clerk_id'::"text", true)));



CREATE POLICY "Users can insert own push subscriptions" ON "public"."push_subscriptions" FOR INSERT WITH CHECK (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can manage own achievements" ON "public"."achievements" USING (("user_id" IN ( SELECT "users"."clerk_user_id" AS "clerk_id"
   FROM "public"."users"
  WHERE ("users"."clerk_user_id" = "current_setting"('app.clerk_id'::"text", true)))));



CREATE POLICY "Users can manage own checkins" ON "public"."emotional_checkins" USING (("user_id" IN ( SELECT "users"."clerk_user_id" AS "clerk_id"
   FROM "public"."users"
  WHERE ("users"."clerk_user_id" = "current_setting"('app.clerk_id'::"text", true)))));



CREATE POLICY "Users can manage own habit completions" ON "public"."habit_completions" USING (("user_id" IN ( SELECT "users"."clerk_user_id" AS "clerk_id"
   FROM "public"."users"
  WHERE ("users"."clerk_user_id" = "current_setting"('app.clerk_id'::"text", true)))));



CREATE POLICY "Users can manage own quest completions" ON "public"."quest_completions" USING (("user_id" IN ( SELECT "users"."clerk_user_id" AS "clerk_id"
   FROM "public"."users"
  WHERE ("users"."clerk_user_id" = "current_setting"('app.clerk_id'::"text", true)))));



CREATE POLICY "Users can manage own streaks" ON "public"."streaks" USING (("user_id" IN ( SELECT "users"."clerk_user_id" AS "clerk_id"
   FROM "public"."users"
  WHERE ("users"."clerk_user_id" = "current_setting"('app.clerk_id'::"text", true)))));



CREATE POLICY "Users can manage own xp" ON "public"."xp_transactions" USING (("user_id" IN ( SELECT "users"."clerk_user_id" AS "clerk_id"
   FROM "public"."users"
  WHERE ("users"."clerk_user_id" = "current_setting"('app.clerk_id'::"text", true)))));



CREATE POLICY "Users can manage their own briefs" ON "public"."email_daily_briefs" USING (("user_id" = (("current_setting"('request.jwt.claims'::"text", true))::json ->> 'sub'::"text")));



CREATE POLICY "Users can manage their own butler_notifications" ON "public"."butler_notifications" USING (true);



CREATE POLICY "Users can manage their own butler_snoozes" ON "public"."butler_snoozes" USING (true);



CREATE POLICY "Users can manage their own email actions" ON "public"."email_actions" USING (("user_id" = (("current_setting"('request.jwt.claims'::"text", true))::json ->> 'sub'::"text")));



CREATE POLICY "Users can manage their own emails" ON "public"."email_items" USING (("user_id" = (("current_setting"('request.jwt.claims'::"text", true))::json ->> 'sub'::"text")));



CREATE POLICY "Users can manage their own focus_sessions" ON "public"."focus_sessions" USING (true);



CREATE POLICY "Users can manage their own habit_streaks" ON "public"."habit_streaks" USING (true);



CREATE POLICY "Users can manage their own id_momentum_daily" ON "public"."id_momentum_daily" USING (true);



CREATE POLICY "Users can manage their own lb_daily_metrics" ON "public"."lb_daily_metrics" USING (true);



CREATE POLICY "Users can manage their own lb_insights" ON "public"."lb_insights" USING (true);



CREATE POLICY "Users can manage their own mc_events" ON "public"."mc_events" USING (true);



CREATE POLICY "Users can manage their own mc_interventions" ON "public"."mc_interventions" USING (true);



CREATE POLICY "Users can manage their own mc_strategy_profiles" ON "public"."mc_strategy_profiles" USING (true);



CREATE POLICY "Users can manage their own sim_runs" ON "public"."sim_runs" USING (true);



CREATE POLICY "Users can manage their own sim_scenarios" ON "public"."sim_scenarios" USING (true);



CREATE POLICY "Users can manage their own tb_context_snapshots" ON "public"."tb_context_snapshots" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can manage their own tb_embeddings" ON "public"."tb_embeddings" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can manage their own tb_entities" ON "public"."tb_entities" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can manage their own tb_entity_edges" ON "public"."tb_entity_edges" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can manage their own tb_entity_fragment_links" ON "public"."tb_entity_fragment_links" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can manage their own tb_insights" ON "public"."tb_insights" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can manage their own tb_memory_fragments" ON "public"."tb_memory_fragments" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can manage their own tb_raw_events" ON "public"."tb_raw_events" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can manage their own tb_user_patterns" ON "public"."tb_user_patterns" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can manage their own threads" ON "public"."email_threads" USING (("user_id" = (("current_setting"('request.jwt.claims'::"text", true))::json ->> 'sub'::"text")));



CREATE POLICY "Users can update own autonomy actions" ON "public"."autonomy_actions" FOR UPDATE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can update own cached events" ON "public"."calendar_events_cache" FOR UPDATE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can update own calendar accounts" ON "public"."calendar_accounts" FOR UPDATE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can update own day plans" ON "public"."day_plans" FOR UPDATE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can update own delegated drafts" ON "public"."delegated_drafts" FOR UPDATE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can update own emotional checkins" ON "public"."emotional_checkins" FOR UPDATE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can update own events" ON "public"."third_brain_events" FOR UPDATE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can update own insights" ON "public"."third_brain_insights" FOR UPDATE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can update own life domains" ON "public"."life_domains" FOR UPDATE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can update own memories" ON "public"."third_brain_memories" FOR UPDATE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can update own notification preferences" ON "public"."notification_preferences" FOR UPDATE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can update own plan items" ON "public"."plan_items" FOR UPDATE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can update own profile" ON "public"."user_profiles" FOR UPDATE USING (("user_id" = "current_setting"('app.clerk_id'::"text", true)));



CREATE POLICY "Users can update own push subscriptions" ON "public"."push_subscriptions" FOR UPDATE USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can view own achievements" ON "public"."achievements" USING (("user_id" IN ( SELECT "users"."clerk_user_id" AS "clerk_id"
   FROM "public"."users"
  WHERE ("users"."clerk_user_id" = "current_setting"('app.clerk_id'::"text", true)))));



CREATE POLICY "Users can view own autonomy actions" ON "public"."autonomy_actions" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can view own cached events" ON "public"."calendar_events_cache" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can view own calendar accounts" ON "public"."calendar_accounts" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can view own dashboard_layouts" ON "public"."user_dashboard_layouts" USING (("user_id" IN ( SELECT "users"."clerk_user_id" AS "clerk_id"
   FROM "public"."users"
  WHERE ("users"."clerk_user_id" = "current_setting"('app.clerk_id'::"text", true)))));



CREATE POLICY "Users can view own data" ON "public"."users" USING (("clerk_user_id" = "current_setting"('app.clerk_id'::"text", true)));



CREATE POLICY "Users can view own day plans" ON "public"."day_plans" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can view own delegated drafts" ON "public"."delegated_drafts" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can view own domain kpis" ON "public"."domain_kpis" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can view own emails" ON "public"."emails" USING (("user_id" IN ( SELECT "users"."clerk_user_id" AS "clerk_id"
   FROM "public"."users"
  WHERE ("users"."clerk_user_id" = "current_setting"('app.clerk_id'::"text", true)))));



CREATE POLICY "Users can view own emotional checkins" ON "public"."emotional_checkins" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can view own emotional patterns" ON "public"."emotional_patterns" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can view own emotional support logs" ON "public"."emotional_support_logs" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can view own events" ON "public"."third_brain_events" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can view own executive summaries" ON "public"."executive_summaries" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can view own goals" ON "public"."goals" USING (("user_id" IN ( SELECT "users"."clerk_user_id" AS "clerk_id"
   FROM "public"."users"
  WHERE ("users"."clerk_user_id" = "current_setting"('app.clerk_id'::"text", true)))));



CREATE POLICY "Users can view own habit_completions" ON "public"."habit_completions" USING (("user_id" IN ( SELECT "users"."clerk_user_id" AS "clerk_id"
   FROM "public"."users"
  WHERE ("users"."clerk_user_id" = "current_setting"('app.clerk_id'::"text", true)))));



CREATE POLICY "Users can view own insights" ON "public"."third_brain_insights" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can view own job_requests" ON "public"."job_requests" USING (("user_id" IN ( SELECT "users"."clerk_user_id" AS "clerk_id"
   FROM "public"."users"
  WHERE ("users"."clerk_user_id" = "current_setting"('app.clerk_id'::"text", true)))));



CREATE POLICY "Users can view own life domains" ON "public"."life_domains" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can view own memories" ON "public"."third_brain_memories" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can view own notes" ON "public"."notes" USING (("user_id" IN ( SELECT "users"."clerk_user_id" AS "clerk_id"
   FROM "public"."users"
  WHERE ("users"."clerk_user_id" = "current_setting"('app.clerk_id'::"text", true)))));



CREATE POLICY "Users can view own notification log" ON "public"."notification_log" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can view own notification preferences" ON "public"."notification_preferences" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can view own onboarding" ON "public"."onboarding_conversations" USING (("user_id" IN ( SELECT "users"."clerk_user_id" AS "clerk_id"
   FROM "public"."users"
  WHERE ("users"."clerk_user_id" = "current_setting"('app.clerk_id'::"text", true)))));



CREATE POLICY "Users can view own plan items" ON "public"."plan_items" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can view own profile" ON "public"."user_profiles" FOR SELECT USING (("user_id" = "current_setting"('app.clerk_id'::"text", true)));



CREATE POLICY "Users can view own push subscriptions" ON "public"."push_subscriptions" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users can view own referrals" ON "public"."referral_rewards" FOR SELECT USING (("referrer_user_id" = "current_setting"('app.clerk_id'::"text", true)));



CREATE POLICY "Users can view own streaks" ON "public"."streaks" USING (("user_id" IN ( SELECT "users"."clerk_user_id" AS "clerk_id"
   FROM "public"."users"
  WHERE ("users"."clerk_user_id" = "current_setting"('app.clerk_id'::"text", true)))));



CREATE POLICY "Users can view own telemetry" ON "public"."dashboard_telemetry" USING (("user_id" IN ( SELECT "users"."clerk_user_id" AS "clerk_id"
   FROM "public"."users"
  WHERE ("users"."clerk_user_id" = "current_setting"('app.clerk_id'::"text", true)))));



CREATE POLICY "Users can view own usage" ON "public"."usage_logs" FOR SELECT USING (("user_id" = "current_setting"('app.clerk_id'::"text", true)));



CREATE POLICY "Users can view own voicemails" ON "public"."voicemails" USING (("user_id" IN ( SELECT "users"."clerk_user_id" AS "clerk_id"
   FROM "public"."users"
  WHERE ("users"."clerk_user_id" = "current_setting"('app.clerk_id'::"text", true)))));



CREATE POLICY "Users can view own xp_transactions" ON "public"."xp_transactions" USING (("user_id" IN ( SELECT "users"."clerk_user_id" AS "clerk_id"
   FROM "public"."users"
  WHERE ("users"."clerk_user_id" = "current_setting"('app.clerk_id'::"text", true)))));



CREATE POLICY "Users manage own ag_messages" ON "public"."ag_messages" USING (true);



CREATE POLICY "Users manage own ag_runs" ON "public"."ag_runs" USING (true);



CREATE POLICY "Users manage own align_feedback" ON "public"."align_feedback" USING (true);



CREATE POLICY "Users manage own align_user_profiles" ON "public"."align_user_profiles" USING (true);



CREATE POLICY "Users manage own align_violations" ON "public"."align_violations" USING (true);



CREATE POLICY "Users manage own campaigns" ON "public"."campaigns" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own dash_layouts" ON "public"."dash_layouts" USING (true);



CREATE POLICY "Users manage own efc_action_sequences" ON "public"."efc_action_sequences" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own efc_commitments" ON "public"."efc_commitments" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own efc_energy_states" ON "public"."efc_energy_states" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own efc_execution_log" ON "public"."efc_execution_log" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own efc_generated_actions" ON "public"."efc_generated_actions" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own efc_nudges" ON "public"."efc_nudges" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own emo_adaptive_responses" ON "public"."emo_adaptive_responses" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own emo_checkins" ON "public"."emo_checkins" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own emo_goals" ON "public"."emo_goals" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own emo_interventions" ON "public"."emo_interventions" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own emo_profiles" ON "public"."emo_profiles" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own emo_states" ON "public"."emo_states" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own emo_transitions" ON "public"."emo_transitions" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own enrollments" ON "public"."campaign_enrollments" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own feedback" ON "public"."feedback" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own id_aspirations" ON "public"."id_aspirations" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own id_beliefs" ON "public"."id_beliefs" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own id_growth_areas" ON "public"."id_growth_areas" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own id_narrative_chapters" ON "public"."id_narrative_chapters" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own id_roles" ON "public"."id_roles" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own id_snapshots" ON "public"."id_snapshots" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own id_strengths" ON "public"."id_strengths" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own id_values" ON "public"."id_values" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own interactions" ON "public"."relationship_interactions" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own interventions" ON "public"."proactive_interventions" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own long_chapters" ON "public"."long_chapters" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own long_milestones" ON "public"."long_milestones" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own long_predictions" ON "public"."long_predictions" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own long_snapshots" ON "public"."long_snapshots" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own long_trajectories" ON "public"."long_trajectories" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own long_trends" ON "public"."long_trends" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own mem_archives" ON "public"."mem_archives" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own mem_compressed" ON "public"."mem_compressed" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own mem_compression_jobs" ON "public"."mem_compression_jobs" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own mem_compression_settings" ON "public"."mem_compression_settings" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own memories" ON "public"."memories" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own packs" ON "public"."user_packs" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own patterns" ON "public"."memory_patterns" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own personas" ON "public"."personas" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own plugin_api_keys" ON "public"."plugin_api_keys" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own plugin_automations" ON "public"."plugin_automations" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own plugin_data" ON "public"."plugin_data" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own plugin_webhooks" ON "public"."plugin_webhooks" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own relationships" ON "public"."relationships" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own sim_decision_trees" ON "public"."sim_decision_trees" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own sim_history" ON "public"."sim_history" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own sim_scenarios" ON "public"."sim_scenarios" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own sim_simulations" ON "public"."sim_simulations" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own sim_what_ifs" ON "public"."sim_what_ifs" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own teachings" ON "public"."teachings" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own user_plugins" ON "public"."user_plugins" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own vault_emergency" ON "public"."vault_emergency_access" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own vault_items" ON "public"."vault_items" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own vault_keys" ON "public"."vault_keys" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own vault_notes" ON "public"."vault_secure_notes" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own vault_shares" ON "public"."vault_shares" USING (("owner_user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users manage own weekly plans" ON "public"."weekly_plans" USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users view own plugin_events" ON "public"."plugin_events" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users view own queue" ON "public"."notification_queue" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users view own vault_access_log" ON "public"."vault_access_log" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



CREATE POLICY "Users view shares with them" ON "public"."vault_shares" FOR SELECT USING (("shared_with_user_id" = ("auth"."uid"())::"text"));



ALTER TABLE "public"."achievements" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."activity_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."ag_messages" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."ag_runs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."agi_actions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."agi_agent_profiles" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."agi_feedback" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."agi_policies" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."agi_runs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."agi_scenario_runs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."agi_telemetry" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."agi_user_profile" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."align_feedback" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."align_user_profiles" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."align_violations" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."alignment_evaluations" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."archetype_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."archetype_snapshots" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."artifact_links" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."attention_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."autonomy_actions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."autopilot_jobs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."autopilot_suggestions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."behavior_predictions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."brain_capabilities" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."brain_changelog" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."brain_entries" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."brain_error_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."brain_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."brain_health_snapshots" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."brain_subsystems" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."brainstem_status" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."butler_notifications" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."butler_snoozes" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."calendar_accounts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."calendar_events_cache" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."call_intelligence_settings" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."call_sessions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."call_summaries" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."calls" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."campaign_enrollments" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."campaigns" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."canon_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."canon_timeline_index" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."chapter_archetypes" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."civilization_domain_mappings" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."civilization_domains" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."civilization_settings" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."coach_council_sessions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."coach_generated_scenarios" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."coach_multi_agent_sessions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."coach_sessions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."coach_training_sessions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."coach_user_preferences" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."coach_voice_sessions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."cognitive_hypotheses" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."cognitive_insights" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."cognitive_phases" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."cognitive_runs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."cognitive_self_reflections" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."cognitive_update_actions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."communication_sessions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."conscious_conflicts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."conscious_frames" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."conscious_insights" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."conscious_items" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."conscious_links" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."contact_dates" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."contact_emails" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."contact_facts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."contact_identity_intel" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."contact_influence_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."contact_intelligence_sources" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."contact_phones" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."contact_playbooks" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."contact_relationship_scores" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."contact_relationships" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."contact_tag_links" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."contact_tags" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."contacts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."cortex_anomalies" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."cortex_areas" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."cortex_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."cortex_patterns" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."cortex_predictions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."cortex_signals" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."council_consensus" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."council_decision_dossiers" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."council_members" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."council_opinions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."council_sessions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."creative_artifacts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."creative_assets" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."creative_evaluations" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."creative_ideas" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."creative_patterns" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."creative_projects" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."creative_sessions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."creative_style_profiles" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."crm_alerts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."crm_contact_org_links" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."crm_contacts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."crm_deal_contacts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."crm_deal_health" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."crm_deals" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."crm_interactions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."crm_organizations" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."crm_relationship_health" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."cron_locks" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."cultural_highlights" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."cultural_inference_snapshots" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."cultural_predictions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."cultural_profiles" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."cultural_signals" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."culture_alignment_log" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."culture_contexts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."culture_norm_logs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."culture_profiles" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."daily_briefs" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "daily_briefs_owner_all" ON "public"."daily_briefs" USING (("user_id_uuid" = "public"."current_user_id_uuid"())) WITH CHECK (("user_id_uuid" = "public"."current_user_id_uuid"()));



ALTER TABLE "public"."daily_quest_generation_runs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."daily_quests" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "daily_quests_select_own" ON "public"."daily_quests" FOR SELECT USING ((("auth"."uid"())::"text" = "user_id"));



ALTER TABLE "public"."daily_timeline_views" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."dash_layouts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."dashboard_telemetry" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."dashboard_telemetry_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."day_plans" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."deal_archetype_runs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."deals" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "deals_owner_all" ON "public"."deals" USING (("user_id_uuid" = "public"."current_user_id_uuid"())) WITH CHECK (("user_id_uuid" = "public"."current_user_id_uuid"()));



ALTER TABLE "public"."decision_tree_edges" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."decision_tree_nodes" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."decision_trees" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."decisions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."delegated_drafts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."desire_profiles" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."desire_signals" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."destiny_alignment_log" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."destiny_anchor_choices" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."destiny_arcs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."destiny_blueprints" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."destiny_checkpoints" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."destiny_timelines" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."domain_kpis" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."efc_action_sequences" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."efc_commitments" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."efc_energy_states" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."efc_execution_log" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."efc_generated_actions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."efc_nudges" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."email_accounts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."email_actions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."email_daily_briefs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."email_drafts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."email_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."email_followups" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."email_items" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."email_outbox" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."email_resolution" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."email_send_audit" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."email_suggested_drafts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."email_threads" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."email_triage_items" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."emails" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."emo_adaptive_responses" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."emo_checkins" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."emo_goals" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."emo_interventions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."emo_profiles" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."emo_states" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."emo_transitions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."emotion_channel_settings" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."emotion_interaction_log" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."emotion_resonance_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."emotion_samples" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."emotion_state_daily" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."emotion_style_profile" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."emotional_checkins" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."emotional_patterns" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."emotional_support_logs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."empathic_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."ethical_policies" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."execution_logs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."execution_runs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."executions" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "executions_insert_own" ON "public"."executions" FOR INSERT WITH CHECK (("user_id_text" = ("auth"."uid"())::"text"));



CREATE POLICY "executions_select_own" ON "public"."executions" FOR SELECT USING (("user_id_text" = ("auth"."uid"())::"text"));



CREATE POLICY "executions_update_own" ON "public"."executions" FOR UPDATE USING (("user_id_text" = ("auth"."uid"())::"text"));



ALTER TABLE "public"."executive_council_members" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."executive_summaries" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."experience_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."feedback" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."finance_accounts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."finance_alerts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."finance_budgets" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."finance_goals" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."finance_snapshots" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."finance_transactions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."financial_connections" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."financial_entities" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."focus_locks" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."focus_sessions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."follow_ups" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "follow_ups_owner_all" ON "public"."follow_ups" USING (("user_id_uuid" = "public"."current_user_id_uuid"())) WITH CHECK (("user_id_uuid" = "public"."current_user_id_uuid"()));



ALTER TABLE "public"."gift_ideas" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."goal_hierarchy" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."goals" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."guardrail_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."habit_completions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."habit_logs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."habit_streaks" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."habits" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "health_select_none" ON "public"."job_queue_health_snapshots" FOR SELECT USING (false);



ALTER TABLE "public"."household_members" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."id_aspirations" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."id_beliefs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."id_growth_areas" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."id_momentum_daily" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."id_narrative_chapters" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."id_roles" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."id_snapshots" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."id_strengths" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."id_values" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."identity_arcs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."identity_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."identity_transforms" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."inbox_items" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "inbox_items_owner_all" ON "public"."inbox_items" USING (("user_id_uuid" = "public"."current_user_id_uuid"())) WITH CHECK (("user_id_uuid" = "public"."current_user_id_uuid"()));



ALTER TABLE "public"."inbox_rule_outcomes" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "inbox_rule_outcomes_owner_all" ON "public"."inbox_rule_outcomes" USING (("user_id_uuid" = "public"."current_user_id_uuid"())) WITH CHECK (("user_id_uuid" = "public"."current_user_id_uuid"()));



ALTER TABLE "public"."inbox_rule_runs" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "inbox_rule_runs_owner_all" ON "public"."inbox_rule_runs" USING (("user_id_uuid" = "public"."current_user_id_uuid"())) WITH CHECK (("user_id_uuid" = "public"."current_user_id_uuid"()));



ALTER TABLE "public"."inbox_rules" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "inbox_rules_owner_all" ON "public"."inbox_rules" USING (("user_id_uuid" = "public"."current_user_id_uuid"())) WITH CHECK (("user_id_uuid" = "public"."current_user_id_uuid"()));



ALTER TABLE "public"."inbox_triage_events" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "inbox_triage_events_owner_all" ON "public"."inbox_triage_events" USING (("user_id_uuid" = "public"."current_user_id_uuid"())) WITH CHECK (("user_id_uuid" = "public"."current_user_id_uuid"()));



ALTER TABLE "public"."inner_monologue_entries" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."inner_monologue_turns" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."interaction_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."interactions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."job_queue" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."job_queue_agents" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."job_queue_budget_ledger" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."job_queue_budget_rollover" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."job_queue_credit_balances" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."job_queue_credits_ledger" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."job_queue_daily_budget" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."job_queue_fairness_ledger" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."job_queue_health_snapshots" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."job_queue_lane_quota" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."job_queue_rate_window" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."job_queue_scheduler_decisions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."job_queue_user_tiers" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."job_requests" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."job_runs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."job_scorecards" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."job_verticals" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."journal_entries" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."knowledge_context_links" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."knowledge_contexts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."knowledge_edges" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."knowledge_nodes" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."lb_daily_metrics" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."lb_insights" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."league_members" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."league_scores" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."life_arc_autopilot_runs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."life_arc_autopilot_suggestions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."life_arc_daily_focus" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."life_arc_objectives" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."life_arc_risk_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."life_arcs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."life_canon_entries" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."life_canon_snapshots" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."life_chapters" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."life_domains" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."life_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."life_evidence" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."life_themes" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."long_chapters" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."long_milestones" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."long_predictions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."long_snapshots" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."long_trajectories" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."long_trends" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mc_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mc_interventions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mc_strategy_profiles" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mem_archives" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mem_compressed" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mem_compression_jobs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mem_compression_settings" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."memories" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."memory_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."memory_patterns" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mind_models" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."motor_routine_metrics" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."motor_routine_runs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."motor_routine_steps" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."motor_routine_triggers" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."motor_routines" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mythic_achievements" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mythic_arcs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mythic_belt_progress" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mythic_coach_sessions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mythic_quests" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mythic_rituals" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mythic_sessions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mythic_training_focus" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mythic_training_missions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mythic_training_plans" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mythic_training_reflections" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."mythic_voice_mappings" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."narrative_snapshots" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."notes" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."notification_log" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."notification_preferences" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."notification_queue" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."onboarding_conversations" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."onboarding_state" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."ops_audit_log" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "ops_audit_no_delete" ON "public"."ops_audit_log" FOR DELETE USING (false);



CREATE POLICY "ops_audit_no_insert" ON "public"."ops_audit_log" FOR INSERT WITH CHECK (false);



CREATE POLICY "ops_audit_no_update" ON "public"."ops_audit_log" FOR UPDATE USING (false);



CREATE POLICY "ops_audit_select_own" ON "public"."ops_audit_log" FOR SELECT USING (("actor_user_id" = ("auth"."uid"())::"text"));



ALTER TABLE "public"."ops_automation_locks" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "ops_automation_locks_read_auth" ON "public"."ops_automation_locks" FOR SELECT TO "authenticated" USING (true);



ALTER TABLE "public"."ops_incident_events" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "ops_incident_events_read_auth" ON "public"."ops_incident_events" FOR SELECT TO "authenticated" USING (true);



ALTER TABLE "public"."ops_incidents" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "ops_incidents_read_auth" ON "public"."ops_incidents" FOR SELECT TO "authenticated" USING (true);



ALTER TABLE "public"."org_members" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."persona_arc_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."persona_companion_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."persona_companion_highlights" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."persona_companion_state" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."persona_interaction_stats" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."persona_memory_snapshots" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."persona_microstyle_prefs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."persona_user_arc" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."personal_heuristics" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."personas" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."plan_items" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."planning_constraints" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."planning_decisions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."planning_overrides" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."planning_sessions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."plugin_api_keys" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."plugin_automations" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."plugin_data" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."plugin_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."plugin_webhooks" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."plugins" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."prefrontal_goals" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."presence_daily_summaries" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."presence_decisions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."presence_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."proactive_interventions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."pulse_brain_preferences" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."pulse_brain_surface_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."pulse_events" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "pulse_events_insert_service" ON "public"."pulse_events" FOR INSERT WITH CHECK (false);



CREATE POLICY "pulse_events_select_own" ON "public"."pulse_events" FOR SELECT USING (("user_id" = ("auth"."uid"())::"text"));



ALTER TABLE "public"."pulse_insight_acknowledgements" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."pulse_introduction_sessions" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "pulse_user_owns_row" ON "public"."achievements" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."activity_events" TO "authenticated" USING (("user_id" = "auth"."uid"())) WITH CHECK (("user_id" = "auth"."uid"()));



CREATE POLICY "pulse_user_owns_row" ON "public"."ag_messages" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."ag_runs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."agi_actions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."agi_agent_profiles" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."agi_feedback" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."agi_policies" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."agi_runs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."agi_scenario_runs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."agi_telemetry" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."agi_user_profile" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."align_feedback" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."align_user_profiles" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."align_violations" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."alignment_evaluations" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."archetype_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."archetype_snapshots" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."artifact_links" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."attention_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."autonomy_actions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."autopilot_jobs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."autopilot_suggestions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."behavior_predictions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."brain_capabilities" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."brain_changelog" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."brain_entries" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."brain_error_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."brain_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."brain_health_snapshots" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."brain_subsystems" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."brainstem_status" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."butler_notifications" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."butler_snoozes" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."calendar_accounts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."calendar_events_cache" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."call_intelligence_settings" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."call_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."call_summaries" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."calls" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."campaign_enrollments" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."campaigns" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."canon_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."canon_timeline_index" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."chapter_archetypes" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."civilization_domain_mappings" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."civilization_domains" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."civilization_settings" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."coach_council_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."coach_generated_scenarios" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."coach_multi_agent_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."coach_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."coach_training_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."coach_user_preferences" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."coach_voice_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."cognitive_hypotheses" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."cognitive_insights" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."cognitive_phases" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."cognitive_runs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."cognitive_self_reflections" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."cognitive_update_actions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."communication_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."conscious_conflicts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."conscious_frames" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."conscious_insights" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."conscious_items" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."conscious_links" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."contact_dates" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."contact_emails" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."contact_facts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."contact_identity_intel" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."contact_influence_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."contact_intelligence_sources" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."contact_phones" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."contact_playbooks" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."contact_relationship_scores" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."contact_relationships" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."contact_tag_links" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."contact_tags" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."contacts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."cortex_anomalies" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."cortex_areas" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."cortex_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."cortex_patterns" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."cortex_predictions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."cortex_signals" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."council_consensus" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."council_decision_dossiers" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."council_members" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."council_opinions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."council_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."creative_artifacts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."creative_assets" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."creative_evaluations" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."creative_ideas" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."creative_patterns" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."creative_projects" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."creative_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."creative_style_profiles" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."crm_alerts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."crm_contact_org_links" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."crm_contacts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."crm_deal_contacts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."crm_deal_health" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."crm_deals" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."crm_interactions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."crm_organizations" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."crm_relationship_health" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."cultural_highlights" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."cultural_inference_snapshots" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."cultural_predictions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."cultural_profiles" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."cultural_signals" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."culture_alignment_log" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."culture_contexts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."culture_norm_logs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."culture_profiles" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."daily_quest_generation_runs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."daily_quests" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."daily_timeline_views" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."dash_layouts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."dashboard_telemetry" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."dashboard_telemetry_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."day_plans" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."deal_archetype_runs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."deals" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."decision_tree_edges" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."decision_tree_nodes" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."decision_trees" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."decisions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."delegated_drafts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."desire_profiles" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."desire_signals" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."destiny_alignment_log" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."destiny_anchor_choices" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."destiny_arcs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."destiny_blueprints" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."destiny_checkpoints" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."destiny_timelines" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."domain_kpis" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."efc_action_sequences" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."efc_commitments" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."efc_energy_states" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."efc_execution_log" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."efc_generated_actions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."efc_nudges" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."email_accounts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."email_actions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."email_daily_briefs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."email_drafts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."email_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."email_followups" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."email_items" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."email_outbox" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."email_resolution" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."email_send_audit" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."email_suggested_drafts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."email_threads" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."email_triage_items" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."emails" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."emo_adaptive_responses" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."emo_checkins" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."emo_goals" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."emo_interventions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."emo_profiles" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."emo_states" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."emo_transitions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."emotion_channel_settings" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."emotion_interaction_log" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."emotion_resonance_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."emotion_samples" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."emotion_state_daily" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."emotion_style_profile" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."emotional_checkins" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."emotional_patterns" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."emotional_support_logs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."empathic_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."ethical_policies" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."execution_logs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."execution_runs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."executive_council_members" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."executive_summaries" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."experience_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."feedback" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."finance_accounts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."finance_alerts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."finance_budgets" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."finance_goals" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."finance_snapshots" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."finance_transactions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."financial_connections" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."financial_entities" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."focus_locks" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."focus_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."follow_ups" USING (("user_id_uuid" = "auth"."uid"())) WITH CHECK (("user_id_uuid" = "auth"."uid"()));



CREATE POLICY "pulse_user_owns_row" ON "public"."gift_ideas" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."goal_hierarchy" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."goals" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."guardrail_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."habit_completions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."habit_logs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."habit_streaks" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."habits" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."household_members" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."id_aspirations" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."id_beliefs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."id_growth_areas" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."id_momentum_daily" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."id_narrative_chapters" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."id_roles" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."id_snapshots" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."id_strengths" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."id_values" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."identity_arcs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."identity_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."identity_transforms" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."inner_monologue_entries" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."inner_monologue_turns" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."interaction_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."interactions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."job_queue" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."job_queue_agents" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."job_queue_budget_ledger" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."job_queue_budget_rollover" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."job_queue_credit_balances" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."job_queue_credits_ledger" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."job_queue_daily_budget" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."job_queue_fairness_ledger" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."job_queue_lane_quota" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."job_queue_rate_window" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."job_queue_scheduler_decisions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."job_queue_user_tiers" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."job_requests" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."job_runs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."job_scorecards" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."job_verticals" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."journal_entries" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."knowledge_context_links" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."knowledge_contexts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."knowledge_edges" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."knowledge_nodes" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."lb_daily_metrics" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."lb_insights" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."league_members" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."league_scores" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."life_arc_autopilot_runs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."life_arc_autopilot_suggestions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."life_arc_daily_focus" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."life_arc_objectives" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."life_arc_risk_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."life_arcs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."life_canon_entries" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."life_canon_snapshots" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."life_chapters" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."life_domains" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."life_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."life_evidence" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."life_themes" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."long_chapters" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."long_milestones" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."long_predictions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."long_snapshots" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."long_trajectories" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."long_trends" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mc_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mc_interventions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mc_strategy_profiles" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mem_archives" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mem_compressed" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mem_compression_jobs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mem_compression_settings" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."memories" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."memory_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."memory_patterns" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mind_models" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."motor_routine_metrics" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."motor_routine_runs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."motor_routine_steps" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."motor_routine_triggers" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."motor_routines" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mythic_achievements" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mythic_arcs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mythic_belt_progress" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mythic_coach_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mythic_quests" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mythic_rituals" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mythic_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mythic_training_focus" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mythic_training_missions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mythic_training_plans" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mythic_training_reflections" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."mythic_voice_mappings" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."narrative_snapshots" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."notes" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."notification_log" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."notification_preferences" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."notification_queue" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."onboarding_conversations" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."onboarding_state" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."org_members" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."persona_arc_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."persona_companion_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."persona_companion_highlights" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."persona_companion_state" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."persona_interaction_stats" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."persona_memory_snapshots" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."persona_microstyle_prefs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."persona_user_arc" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."personal_heuristics" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."personas" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."plan_items" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."planning_constraints" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."planning_decisions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."planning_overrides" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."planning_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."plugin_api_keys" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."plugin_automations" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."plugin_data" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."plugin_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."plugin_webhooks" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."prefrontal_goals" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."presence_daily_summaries" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."presence_decisions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."presence_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."proactive_interventions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."pulse_brain_preferences" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."pulse_brain_surface_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."pulse_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."pulse_insight_acknowledgements" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."pulse_introduction_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."push_subscriptions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."quest_completions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."relational_identities" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."relational_predictions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."relational_state_snapshots" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."relationship_highlights" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."relationship_interactions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."relationships" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."reminder_subscriptions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."safety_incidents" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."scheduler_targets" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."self_identity_snapshots" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."self_mirror_deltas" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."self_mirror_facets" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."self_mirror_highlights" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."self_mirror_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."self_mirror_snapshots" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."self_perception_signals" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."sim_decision_trees" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."sim_history" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."sim_runs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."sim_scenarios" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."sim_simulations" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."sim_what_ifs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."simulation_fix_plans" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."simulation_models" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."simulation_outcomes" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."simulation_policies" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."simulation_runs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."simulation_steps" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."simulation_timelines" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."sms_messages" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."social_edges" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."social_entities" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."social_insights" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."social_nodes" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."social_recommendations" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."social_risk_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."social_state_snapshots" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."somatic_alerts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."somatic_daily_metrics" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."somatic_device_settings" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."somatic_patterns" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."somatic_raw_device_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."somatic_samples" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."somatic_state_daily" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."strategic_conflicts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."strategic_domains" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."strategic_equilibria" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."strategic_objectives" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."strategic_plans" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."strategic_review_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."strategic_state_snapshots" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."strategist_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."strategy_feedback" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."strategy_recommendations" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."strategy_snapshots" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."streaks" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."system_user_feedback" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."task_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."tasks" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."tb_chapters" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."tb_context_snapshots" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."tb_edges" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."tb_embeddings" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."tb_entities" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."tb_entity_edges" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."tb_entity_fragment_links" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."tb_insights" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."tb_memory_fragments" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."tb_nodes" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."tb_raw_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."tb_user_patterns" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."teachings" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."theory_of_mind_profiles" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."third_brain_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."third_brain_insights" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."third_brain_memories" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."timeline_coach_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."timeline_commitments" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."timeline_decisions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."timeline_preference_profile" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."timeline_reflections" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."usage_logs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."user_agi_settings" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."user_archetype_profiles" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."user_dashboard_layouts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."user_experiments" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."user_focus_profile" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."user_interview_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."user_job_profiles" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."user_mythic_coach_settings" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."user_mythic_profile" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."user_onboarding_state" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."user_packs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."user_persona_tuning" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."user_philosophy_progress" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."user_plugins" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."user_prefs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."user_profiles" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."user_safety_settings" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."user_settings" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."value_profile" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."vault_access_log" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."vault_emergency_access" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."vault_items" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."vault_keys" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."vault_secure_notes" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."vertical_metrics" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."voice_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."voice_turns" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."voicemails" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."weekly_plans" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."what_if_outcomes" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."what_if_runs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."what_if_scenarios" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."wisdom_lessons" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."wisdom_playbooks" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."wisdom_refresh_runs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."workspace_day_log" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."workspace_focus_sessions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."workspace_focus_states" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."workspace_interrupts" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."workspace_state" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."workspace_threads" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."workspace_timeline_links" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."xp_evaluation_runs" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."xp_events" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."xp_ledger" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



CREATE POLICY "pulse_user_owns_row" ON "public"."xp_transactions" USING (("public"."current_user_sub"() = "user_id")) WITH CHECK (("public"."current_user_sub"() = "user_id"));



ALTER TABLE "public"."push_subscriptions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."quest_completions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."referral_rewards" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."relational_identities" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."relational_predictions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."relational_state_snapshots" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."relationship_highlights" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."relationship_interactions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."relationships" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."reminder_subscriptions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."reply_drafts" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "reply_drafts_owner_all" ON "public"."reply_drafts" USING (("user_id_uuid" = "public"."current_user_id_uuid"())) WITH CHECK (("user_id_uuid" = "public"."current_user_id_uuid"()));



ALTER TABLE "public"."safety_incidents" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."scheduler_targets" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."self_identity_snapshots" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."self_mirror_deltas" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."self_mirror_facets" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."self_mirror_highlights" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."self_mirror_sessions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."self_mirror_snapshots" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."self_perception_signals" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."sim_decision_trees" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."sim_history" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."sim_runs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."sim_scenarios" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."sim_simulations" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."sim_templates" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."sim_what_ifs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."simulation_fix_plans" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."simulation_models" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."simulation_outcomes" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."simulation_policies" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."simulation_runs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."simulation_steps" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."simulation_timelines" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."sms_messages" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."social_edges" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."social_entities" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."social_insights" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."social_nodes" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."social_recommendations" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."social_risk_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."social_state_snapshots" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."somatic_alerts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."somatic_daily_metrics" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."somatic_device_settings" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."somatic_patterns" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."somatic_raw_device_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."somatic_samples" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."somatic_state_daily" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."strategic_conflicts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."strategic_domains" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."strategic_equilibria" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."strategic_objectives" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."strategic_plans" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."strategic_review_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."strategic_state_snapshots" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."strategist_sessions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."strategy_feedback" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."strategy_recommendations" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."strategy_snapshots" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."streaks" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."system_user_feedback" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."task_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."tasks" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "tasks_owner_all" ON "public"."tasks" USING (("user_id_uuid" = "public"."current_user_id_uuid"())) WITH CHECK (("user_id_uuid" = "public"."current_user_id_uuid"()));



ALTER TABLE "public"."tb_chapters" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."tb_context_snapshots" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."tb_edges" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."tb_embeddings" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."tb_entities" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."tb_entity_edges" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."tb_entity_fragment_links" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."tb_insights" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."tb_memory_fragments" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."tb_nodes" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."tb_raw_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."tb_user_patterns" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."teachings" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."theory_of_mind_profiles" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."third_brain_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."third_brain_insights" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."third_brain_memories" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."timeline_coach_sessions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."timeline_commitments" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."timeline_decisions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."timeline_preference_profile" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."timeline_reflections" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."usage_logs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."user_agi_settings" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."user_archetype_profiles" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."user_dashboard_layouts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."user_experiments" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."user_focus_profile" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."user_interview_sessions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."user_job_profiles" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."user_mythic_coach_settings" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."user_mythic_profile" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."user_onboarding_state" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."user_packs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."user_persona_tuning" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."user_philosophy_progress" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."user_plugins" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."user_prefs" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "user_prefs_select_own" ON "public"."user_prefs" FOR SELECT USING ((("auth"."uid"())::"text" = "user_id"));



CREATE POLICY "user_prefs_update_own" ON "public"."user_prefs" FOR UPDATE USING ((("auth"."uid"())::"text" = "user_id")) WITH CHECK ((("auth"."uid"())::"text" = "user_id"));



CREATE POLICY "user_prefs_upsert_own" ON "public"."user_prefs" FOR INSERT WITH CHECK ((("auth"."uid"())::"text" = "user_id"));



ALTER TABLE "public"."user_profiles" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."user_safety_settings" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."user_settings" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."users" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."value_profile" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."vault_access_log" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."vault_emergency_access" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."vault_items" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."vault_keys" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."vault_secure_notes" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."vault_shares" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."vertical_metrics" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."voice_sessions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."voice_turns" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."voicemails" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."weekly_plans" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."what_if_outcomes" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."what_if_runs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."what_if_scenarios" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."wisdom_lessons" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."wisdom_playbooks" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."wisdom_refresh_runs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."work_scoreboard_days" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "work_scoreboard_days_owner_all" ON "public"."work_scoreboard_days" USING (("user_id_uuid" = "public"."current_user_id_uuid"())) WITH CHECK (("user_id_uuid" = "public"."current_user_id_uuid"()));



ALTER TABLE "public"."workspace_day_log" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."workspace_focus_sessions" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."workspace_focus_states" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."workspace_interrupts" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."workspace_state" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."workspace_threads" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."workspace_timeline_links" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."xp_evaluation_runs" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."xp_evaluators" ENABLE ROW LEVEL SECURITY;


CREATE POLICY "xp_evaluators_select_all" ON "public"."xp_evaluators" FOR SELECT USING (true);



ALTER TABLE "public"."xp_events" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."xp_ledger" ENABLE ROW LEVEL SECURITY;


ALTER TABLE "public"."xp_transactions" ENABLE ROW LEVEL SECURITY;


GRANT USAGE ON SCHEMA "public" TO "postgres";
GRANT USAGE ON SCHEMA "public" TO "anon";
GRANT USAGE ON SCHEMA "public" TO "authenticated";
GRANT USAGE ON SCHEMA "public" TO "service_role";



GRANT ALL ON FUNCTION "public"."_canon_has_col"("p_schema" "text", "p_table" "text", "p_col" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."_canon_has_col"("p_schema" "text", "p_table" "text", "p_col" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."_canon_has_col"("p_schema" "text", "p_table" "text", "p_col" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."_canon_try_uuid"("p_text" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."_canon_try_uuid"("p_text" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."_canon_try_uuid"("p_text" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."_ddl_guard_user_id_fk"() TO "anon";
GRANT ALL ON FUNCTION "public"."_ddl_guard_user_id_fk"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."_ddl_guard_user_id_fk"() TO "service_role";



GRANT ALL ON FUNCTION "public"."_ddl_guard_user_id_identity"() TO "anon";
GRANT ALL ON FUNCTION "public"."_ddl_guard_user_id_identity"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."_ddl_guard_user_id_identity"() TO "service_role";



GRANT ALL ON FUNCTION "public"."_evt_enforce_email_canon_v1"() TO "anon";
GRANT ALL ON FUNCTION "public"."_evt_enforce_email_canon_v1"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."_evt_enforce_email_canon_v1"() TO "service_role";



GRANT ALL ON FUNCTION "public"."_jobq_now_utc"() TO "anon";
GRANT ALL ON FUNCTION "public"."_jobq_now_utc"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."_jobq_now_utc"() TO "service_role";



REVOKE ALL ON FUNCTION "public"."_jq_pick_ts_col"("p_table" "text") FROM PUBLIC;
GRANT ALL ON FUNCTION "public"."_jq_pick_ts_col"("p_table" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."_jq_pick_ts_col"("p_table" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."_jq_pick_ts_col"("p_table" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."assert_canonical_schema"("p_domain" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."assert_canonical_schema"("p_domain" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."assert_canonical_schema"("p_domain" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."assert_email_canonical"() TO "anon";
GRANT ALL ON FUNCTION "public"."assert_email_canonical"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."assert_email_canonical"() TO "service_role";



GRANT ALL ON FUNCTION "public"."assert_no_user_id_fks"() TO "anon";
GRANT ALL ON FUNCTION "public"."assert_no_user_id_fks"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."assert_no_user_id_fks"() TO "service_role";



GRANT ALL ON FUNCTION "public"."assert_schema_identity"() TO "anon";
GRANT ALL ON FUNCTION "public"."assert_schema_identity"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."assert_schema_identity"() TO "service_role";



GRANT ALL ON FUNCTION "public"."assert_text_user_id"("val" "anyelement") TO "anon";
GRANT ALL ON FUNCTION "public"."assert_text_user_id"("val" "anyelement") TO "authenticated";
GRANT ALL ON FUNCTION "public"."assert_text_user_id"("val" "anyelement") TO "service_role";



GRANT ALL ON FUNCTION "public"."canary_ping"() TO "anon";
GRANT ALL ON FUNCTION "public"."canary_ping"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."canary_ping"() TO "service_role";



GRANT ALL ON FUNCTION "public"."canon_assert"("p_domain" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."canon_assert"("p_domain" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."canon_assert"("p_domain" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."canon_assert_email"() TO "anon";
GRANT ALL ON FUNCTION "public"."canon_assert_email"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."canon_assert_email"() TO "service_role";



GRANT ALL ON FUNCTION "public"."canon_autofix"("p_domain" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."canon_autofix"("p_domain" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."canon_autofix"("p_domain" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."canon_autofix_email"() TO "anon";
GRANT ALL ON FUNCTION "public"."canon_autofix_email"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."canon_autofix_email"() TO "service_role";



GRANT ALL ON FUNCTION "public"."canon_is_allowlisted"("p_schema" "text", "p_table" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."canon_is_allowlisted"("p_schema" "text", "p_table" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."canon_is_allowlisted"("p_schema" "text", "p_table" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."canon_replace_pulse_user_owns_row_uuid"("p_schema" "text", "p_table" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."canon_replace_pulse_user_owns_row_uuid"("p_schema" "text", "p_table" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."canon_replace_pulse_user_owns_row_uuid"("p_schema" "text", "p_table" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."canon_run_email"() TO "anon";
GRANT ALL ON FUNCTION "public"."canon_run_email"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."canon_run_email"() TO "service_role";



GRANT ALL ON FUNCTION "public"."compute_entity_importance"("entity_id_param" "uuid", "match_user_id" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."compute_entity_importance"("entity_id_param" "uuid", "match_user_id" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."compute_entity_importance"("entity_id_param" "uuid", "match_user_id" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."compute_job_queue_alerts"() TO "anon";
GRANT ALL ON FUNCTION "public"."compute_job_queue_alerts"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."compute_job_queue_alerts"() TO "service_role";



GRANT ALL ON FUNCTION "public"."compute_job_queue_budget_rollover"("p_day" "date") TO "anon";
GRANT ALL ON FUNCTION "public"."compute_job_queue_budget_rollover"("p_day" "date") TO "authenticated";
GRANT ALL ON FUNCTION "public"."compute_job_queue_budget_rollover"("p_day" "date") TO "service_role";



GRANT ALL ON FUNCTION "public"."compute_job_queue_health"("p_window_seconds" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."compute_job_queue_health"("p_window_seconds" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."compute_job_queue_health"("p_window_seconds" integer) TO "service_role";



REVOKE ALL ON FUNCTION "public"."create_canonical_user_table"("p_schema" "text", "p_table" "text", "p_with_id" boolean) FROM PUBLIC;
GRANT ALL ON FUNCTION "public"."create_canonical_user_table"("p_schema" "text", "p_table" "text", "p_with_id" boolean) TO "anon";
GRANT ALL ON FUNCTION "public"."create_canonical_user_table"("p_schema" "text", "p_table" "text", "p_with_id" boolean) TO "authenticated";
GRANT ALL ON FUNCTION "public"."create_canonical_user_table"("p_schema" "text", "p_table" "text", "p_with_id" boolean) TO "service_role";



GRANT ALL ON FUNCTION "public"."create_tasks_for_needs_response"("p_owner_user_id" "text", "p_limit" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."create_tasks_for_needs_response"("p_owner_user_id" "text", "p_limit" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."create_tasks_for_needs_response"("p_owner_user_id" "text", "p_limit" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."crm_block_writes_to_merged_contacts"() TO "anon";
GRANT ALL ON FUNCTION "public"."crm_block_writes_to_merged_contacts"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."crm_block_writes_to_merged_contacts"() TO "service_role";



GRANT ALL ON FUNCTION "public"."crm_contacts_foundation_before_write"() TO "anon";
GRANT ALL ON FUNCTION "public"."crm_contacts_foundation_before_write"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."crm_contacts_foundation_before_write"() TO "service_role";



GRANT ALL ON FUNCTION "public"."current_clerk_user_id"() TO "anon";
GRANT ALL ON FUNCTION "public"."current_clerk_user_id"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."current_clerk_user_id"() TO "service_role";



GRANT ALL ON FUNCTION "public"."current_user_id_uuid"() TO "anon";
GRANT ALL ON FUNCTION "public"."current_user_id_uuid"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."current_user_id_uuid"() TO "service_role";



GRANT ALL ON FUNCTION "public"."current_user_row_id"() TO "anon";
GRANT ALL ON FUNCTION "public"."current_user_row_id"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."current_user_row_id"() TO "service_role";



REVOKE ALL ON FUNCTION "public"."current_user_sub"() FROM PUBLIC;
GRANT ALL ON FUNCTION "public"."current_user_sub"() TO "anon";
GRANT ALL ON FUNCTION "public"."current_user_sub"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."current_user_sub"() TO "service_role";



GRANT ALL ON FUNCTION "public"."ddl_guard_user_id_fk"() TO "anon";
GRANT ALL ON FUNCTION "public"."ddl_guard_user_id_fk"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."ddl_guard_user_id_fk"() TO "service_role";



GRANT ALL ON FUNCTION "public"."ddl_guard_user_id_identity"() TO "anon";
GRANT ALL ON FUNCTION "public"."ddl_guard_user_id_identity"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."ddl_guard_user_id_identity"() TO "service_role";



REVOKE ALL ON FUNCTION "public"."ddl_guard_user_id_invariants"() FROM PUBLIC;
GRANT ALL ON FUNCTION "public"."ddl_guard_user_id_invariants"() TO "anon";
GRANT ALL ON FUNCTION "public"."ddl_guard_user_id_invariants"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."ddl_guard_user_id_invariants"() TO "service_role";



GRANT ALL ON FUNCTION "public"."dev_find_user_uuid"() TO "anon";
GRANT ALL ON FUNCTION "public"."dev_find_user_uuid"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."dev_find_user_uuid"() TO "service_role";



GRANT ALL ON TABLE "public"."email_outbox" TO "anon";
GRANT ALL ON TABLE "public"."email_outbox" TO "authenticated";
GRANT ALL ON TABLE "public"."email_outbox" TO "service_role";



REVOKE ALL ON FUNCTION "public"."email_outbox_claim"("p_limit" integer, "p_worker_id" "text", "p_lease_seconds" integer) FROM PUBLIC;
GRANT ALL ON FUNCTION "public"."email_outbox_claim"("p_limit" integer, "p_worker_id" "text", "p_lease_seconds" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."email_outbox_claim"("p_limit" integer, "p_worker_id" "text", "p_lease_seconds" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."email_outbox_claim"("p_limit" integer, "p_worker_id" "text", "p_lease_seconds" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."email_outbox_emit_reminders"() TO "anon";
GRANT ALL ON FUNCTION "public"."email_outbox_emit_reminders"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."email_outbox_emit_reminders"() TO "service_role";



GRANT ALL ON FUNCTION "public"."enforce_canonical_schema"("p_domain" "text", "p_table_schema" "text", "p_table_name" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."enforce_canonical_schema"("p_domain" "text", "p_table_schema" "text", "p_table_name" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."enforce_canonical_schema"("p_domain" "text", "p_table_schema" "text", "p_table_name" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."ensure_column"("p_schema" "text", "p_table" "text", "p_column" "text", "p_type" "text", "p_default_sql" "text", "p_backfill" boolean) TO "anon";
GRANT ALL ON FUNCTION "public"."ensure_column"("p_schema" "text", "p_table" "text", "p_column" "text", "p_type" "text", "p_default_sql" "text", "p_backfill" boolean) TO "authenticated";
GRANT ALL ON FUNCTION "public"."ensure_column"("p_schema" "text", "p_table" "text", "p_column" "text", "p_type" "text", "p_default_sql" "text", "p_backfill" boolean) TO "service_role";



GRANT ALL ON FUNCTION "public"."ensure_job_queue_daily_budget_row"("p_user_id" "uuid", "p_day" "date", "p_tier" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."ensure_job_queue_daily_budget_row"("p_user_id" "uuid", "p_day" "date", "p_tier" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."ensure_job_queue_daily_budget_row"("p_user_id" "uuid", "p_day" "date", "p_tier" "text") TO "service_role";



GRANT ALL ON TABLE "public"."daily_quests" TO "anon";
GRANT ALL ON TABLE "public"."daily_quests" TO "authenticated";
GRANT ALL ON TABLE "public"."daily_quests" TO "service_role";



GRANT ALL ON FUNCTION "public"."evaluate_daily_quests"("p_user_id" "text", "p_quest_date" "date") TO "anon";
GRANT ALL ON FUNCTION "public"."evaluate_daily_quests"("p_user_id" "text", "p_quest_date" "date") TO "authenticated";
GRANT ALL ON FUNCTION "public"."evaluate_daily_quests"("p_user_id" "text", "p_quest_date" "date") TO "service_role";



GRANT ALL ON FUNCTION "public"."fn_time_bucket_key"("p_at" timestamp with time zone, "p_minutes" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."fn_time_bucket_key"("p_at" timestamp with time zone, "p_minutes" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."fn_time_bucket_key"("p_at" timestamp with time zone, "p_minutes" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."generate_referral_code"() TO "anon";
GRANT ALL ON FUNCTION "public"."generate_referral_code"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."generate_referral_code"() TO "service_role";



GRANT ALL ON FUNCTION "public"."get_active_entities"("match_user_id" "text", "since_days" integer, "min_mentions" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."get_active_entities"("match_user_id" "text", "since_days" integer, "min_mentions" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."get_active_entities"("match_user_id" "text", "since_days" integer, "min_mentions" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."get_related_entities"("start_entity_id" "uuid", "match_user_id" "text", "max_depth" integer, "min_weight" numeric) TO "anon";
GRANT ALL ON FUNCTION "public"."get_related_entities"("start_entity_id" "uuid", "match_user_id" "text", "max_depth" integer, "min_weight" numeric) TO "authenticated";
GRANT ALL ON FUNCTION "public"."get_related_entities"("start_entity_id" "uuid", "match_user_id" "text", "max_depth" integer, "min_weight" numeric) TO "service_role";



GRANT ALL ON FUNCTION "public"."guard_user_id_types"() TO "anon";
GRANT ALL ON FUNCTION "public"."guard_user_id_types"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."guard_user_id_types"() TO "service_role";



GRANT ALL ON FUNCTION "public"."increment_teaching_usage"("teaching_id" "uuid") TO "anon";
GRANT ALL ON FUNCTION "public"."increment_teaching_usage"("teaching_id" "uuid") TO "authenticated";
GRANT ALL ON FUNCTION "public"."increment_teaching_usage"("teaching_id" "uuid") TO "service_role";



GRANT ALL ON FUNCTION "public"."is_current_user"("user_id" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."is_current_user"("user_id" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."is_current_user"("user_id" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."job_provider_from_event_meta"("p_meta" "jsonb") TO "anon";
GRANT ALL ON FUNCTION "public"."job_provider_from_event_meta"("p_meta" "jsonb") TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_provider_from_event_meta"("p_meta" "jsonb") TO "service_role";



REVOKE ALL ON FUNCTION "public"."job_provider_health_tick_c10"("p_window_minutes" integer, "p_degraded_threshold" numeric, "p_outage_threshold" numeric) FROM PUBLIC;
GRANT ALL ON FUNCTION "public"."job_provider_health_tick_c10"("p_window_minutes" integer, "p_degraded_threshold" numeric, "p_outage_threshold" numeric) TO "anon";
GRANT ALL ON FUNCTION "public"."job_provider_health_tick_c10"("p_window_minutes" integer, "p_degraded_threshold" numeric, "p_outage_threshold" numeric) TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_provider_health_tick_c10"("p_window_minutes" integer, "p_degraded_threshold" numeric, "p_outage_threshold" numeric) TO "service_role";



REVOKE ALL ON FUNCTION "public"."job_queue_adaptive_delay_c10"("p_provider" "text", "p_base_delay_seconds" integer, "p_max_delay_seconds" integer) FROM PUBLIC;
GRANT ALL ON FUNCTION "public"."job_queue_adaptive_delay_c10"("p_provider" "text", "p_base_delay_seconds" integer, "p_max_delay_seconds" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_adaptive_delay_c10"("p_provider" "text", "p_base_delay_seconds" integer, "p_max_delay_seconds" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_adaptive_delay_c10"("p_provider" "text", "p_base_delay_seconds" integer, "p_max_delay_seconds" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."job_queue_apply_credits"("p_user_id" "uuid", "p_day" "date", "p_delta" integer, "p_reason" "text", "p_job_id" "uuid", "p_meta" "jsonb") TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_apply_credits"("p_user_id" "uuid", "p_day" "date", "p_delta" integer, "p_reason" "text", "p_job_id" "uuid", "p_meta" "jsonb") TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_apply_credits"("p_user_id" "uuid", "p_day" "date", "p_delta" integer, "p_reason" "text", "p_job_id" "uuid", "p_meta" "jsonb") TO "service_role";



GRANT ALL ON FUNCTION "public"."job_queue_complete_c8"("p_job_id" "uuid", "p_worker_id" "text", "p_outcome" "text", "p_error" "text", "p_output" "jsonb", "p_meta" "jsonb", "p_now" timestamp with time zone) TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_complete_c8"("p_job_id" "uuid", "p_worker_id" "text", "p_outcome" "text", "p_error" "text", "p_output" "jsonb", "p_meta" "jsonb", "p_now" timestamp with time zone) TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_complete_c8"("p_job_id" "uuid", "p_worker_id" "text", "p_outcome" "text", "p_error" "text", "p_output" "jsonb", "p_meta" "jsonb", "p_now" timestamp with time zone) TO "service_role";



GRANT ALL ON FUNCTION "public"."job_queue_compute_cost"("p_user_id" "uuid", "p_tier" "text", "p_kind" "text", "p_is_burst" boolean, "p_priority" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_compute_cost"("p_user_id" "uuid", "p_tier" "text", "p_kind" "text", "p_is_burst" boolean, "p_priority" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_compute_cost"("p_user_id" "uuid", "p_tier" "text", "p_kind" "text", "p_is_burst" boolean, "p_priority" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."job_queue_effective_budget"("p_user_id" "uuid", "p_day" "date") TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_effective_budget"("p_user_id" "uuid", "p_day" "date") TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_effective_budget"("p_user_id" "uuid", "p_day" "date") TO "service_role";



REVOKE ALL ON FUNCTION "public"."job_queue_heartbeat_c8"("p_job_id" "uuid", "p_worker_id" "text", "p_lease_seconds" integer) FROM PUBLIC;
GRANT ALL ON FUNCTION "public"."job_queue_heartbeat_c8"("p_job_id" "uuid", "p_worker_id" "text", "p_lease_seconds" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_heartbeat_c8"("p_job_id" "uuid", "p_worker_id" "text", "p_lease_seconds" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_heartbeat_c8"("p_job_id" "uuid", "p_worker_id" "text", "p_lease_seconds" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."job_queue_lane_rank"("p_lane" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_lane_rank"("p_lane" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_lane_rank"("p_lane" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."job_queue_lease_any_budgeted"("p_locked_by" "text", "p_lock_seconds" integer, "p_max_running_per_user" integer, "p_default_daily_budget" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_lease_any_budgeted"("p_locked_by" "text", "p_lock_seconds" integer, "p_max_running_per_user" integer, "p_default_daily_budget" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_lease_any_budgeted"("p_locked_by" "text", "p_lock_seconds" integer, "p_max_running_per_user" integer, "p_default_daily_budget" integer) TO "service_role";



REVOKE ALL ON FUNCTION "public"."job_queue_lease_any_c5"("p_locked_by" "text", "p_lock_seconds" integer, "p_max_running_per_user" integer, "p_default_daily_budget" integer, "p_window_seconds" integer, "p_window_limit" integer) FROM PUBLIC;
GRANT ALL ON FUNCTION "public"."job_queue_lease_any_c5"("p_locked_by" "text", "p_lock_seconds" integer, "p_max_running_per_user" integer, "p_default_daily_budget" integer, "p_window_seconds" integer, "p_window_limit" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_lease_any_c5"("p_locked_by" "text", "p_lock_seconds" integer, "p_max_running_per_user" integer, "p_default_daily_budget" integer, "p_window_seconds" integer, "p_window_limit" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_lease_any_c5"("p_locked_by" "text", "p_lock_seconds" integer, "p_max_running_per_user" integer, "p_default_daily_budget" integer, "p_window_seconds" integer, "p_window_limit" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."job_queue_lease_any_c6"("p_user_id" "uuid", "p_worker_id" "text", "p_now" timestamp with time zone) TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_lease_any_c6"("p_user_id" "uuid", "p_worker_id" "text", "p_now" timestamp with time zone) TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_lease_any_c6"("p_user_id" "uuid", "p_worker_id" "text", "p_now" timestamp with time zone) TO "service_role";



GRANT ALL ON FUNCTION "public"."job_queue_lease_any_c7"("p_user_id" "uuid", "p_worker_id" "text", "p_now" timestamp with time zone) TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_lease_any_c7"("p_user_id" "uuid", "p_worker_id" "text", "p_now" timestamp with time zone) TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_lease_any_c7"("p_user_id" "uuid", "p_worker_id" "text", "p_now" timestamp with time zone) TO "service_role";



GRANT ALL ON FUNCTION "public"."job_queue_lease_any_next"("p_locked_by" "text", "p_lock_seconds" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_lease_any_next"("p_locked_by" "text", "p_lock_seconds" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_lease_any_next"("p_locked_by" "text", "p_lock_seconds" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."job_queue_lease_any_scheduled"("p_locked_by" "text", "p_lock_seconds" integer, "p_max_running_per_user" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_lease_any_scheduled"("p_locked_by" "text", "p_lock_seconds" integer, "p_max_running_per_user" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_lease_any_scheduled"("p_locked_by" "text", "p_lock_seconds" integer, "p_max_running_per_user" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."job_queue_lease_next"("p_user_id" "uuid", "p_locked_by" "text", "p_lock_seconds" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_lease_next"("p_user_id" "uuid", "p_locked_by" "text", "p_lock_seconds" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_lease_next"("p_user_id" "uuid", "p_locked_by" "text", "p_lock_seconds" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."job_queue_recover_stuck"("p_lock_age_seconds" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_recover_stuck"("p_lock_age_seconds" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_recover_stuck"("p_lock_age_seconds" integer) TO "service_role";



REVOKE ALL ON FUNCTION "public"."job_queue_recover_stuck_running_c8"("p_batch" integer, "p_stale_heartbeat_seconds" integer) FROM PUBLIC;
GRANT ALL ON FUNCTION "public"."job_queue_recover_stuck_running_c8"("p_batch" integer, "p_stale_heartbeat_seconds" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_recover_stuck_running_c8"("p_batch" integer, "p_stale_heartbeat_seconds" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_recover_stuck_running_c8"("p_batch" integer, "p_stale_heartbeat_seconds" integer) TO "service_role";



REVOKE ALL ON FUNCTION "public"."job_queue_recover_stuck_running_c8_count"("p_batch" integer, "p_stale_heartbeat_seconds" integer) FROM PUBLIC;
GRANT ALL ON FUNCTION "public"."job_queue_recover_stuck_running_c8_count"("p_batch" integer, "p_stale_heartbeat_seconds" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_recover_stuck_running_c8_count"("p_batch" integer, "p_stale_heartbeat_seconds" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_recover_stuck_running_c8_count"("p_batch" integer, "p_stale_heartbeat_seconds" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."job_queue_retry_backoff"("attempts" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_retry_backoff"("attempts" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_retry_backoff"("attempts" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."job_queue_runs"("p_user_id" "uuid", "p_limit" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_runs"("p_user_id" "uuid", "p_limit" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_runs"("p_user_id" "uuid", "p_limit" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."job_queue_sla_escalate_c9"("p_now" timestamp with time zone, "p_priority_bump" integer, "p_lane_when_breached" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_sla_escalate_c9"("p_now" timestamp with time zone, "p_priority_bump" integer, "p_lane_when_breached" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_sla_escalate_c9"("p_now" timestamp with time zone, "p_priority_bump" integer, "p_lane_when_breached" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."job_queue_start_c8"("p_job_id" "uuid", "p_worker_id" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_start_c8"("p_job_id" "uuid", "p_worker_id" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_start_c8"("p_job_id" "uuid", "p_worker_id" "text") TO "service_role";



REVOKE ALL ON FUNCTION "public"."job_queue_start_c8"("p_job_id" "uuid", "p_worker_id" "text", "p_lease_seconds" integer) FROM PUBLIC;
GRANT ALL ON FUNCTION "public"."job_queue_start_c8"("p_job_id" "uuid", "p_worker_id" "text", "p_lease_seconds" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."job_queue_start_c8"("p_job_id" "uuid", "p_worker_id" "text", "p_lease_seconds" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."job_queue_start_c8"("p_job_id" "uuid", "p_worker_id" "text", "p_lease_seconds" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."log_activity"("p_user_id" "uuid", "p_source" "text", "p_event_ts" timestamp with time zone, "p_event_type" "text", "p_title" "text", "p_detail" "text", "p_payload" "jsonb") TO "anon";
GRANT ALL ON FUNCTION "public"."log_activity"("p_user_id" "uuid", "p_source" "text", "p_event_ts" timestamp with time zone, "p_event_type" "text", "p_title" "text", "p_detail" "text", "p_payload" "jsonb") TO "authenticated";
GRANT ALL ON FUNCTION "public"."log_activity"("p_user_id" "uuid", "p_source" "text", "p_event_ts" timestamp with time zone, "p_event_type" "text", "p_title" "text", "p_detail" "text", "p_payload" "jsonb") TO "service_role";



GRANT ALL ON FUNCTION "public"."prevent_activity_event_updates"() TO "anon";
GRANT ALL ON FUNCTION "public"."prevent_activity_event_updates"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."prevent_activity_event_updates"() TO "service_role";



GRANT ALL ON FUNCTION "public"."prevent_writes_to_merged_contacts"() TO "anon";
GRANT ALL ON FUNCTION "public"."prevent_writes_to_merged_contacts"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."prevent_writes_to_merged_contacts"() TO "service_role";



GRANT ALL ON FUNCTION "public"."prune_job_queue_budget_rollover"() TO "anon";
GRANT ALL ON FUNCTION "public"."prune_job_queue_budget_rollover"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."prune_job_queue_budget_rollover"() TO "service_role";



REVOKE ALL ON FUNCTION "public"."pulse_assert_valid_user_id_uuid"("p_user_id_uuid" "uuid", "p_table" "text") FROM PUBLIC;
GRANT ALL ON FUNCTION "public"."pulse_assert_valid_user_id_uuid"("p_user_id_uuid" "uuid", "p_table" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."pulse_assert_valid_user_id_uuid"("p_user_id_uuid" "uuid", "p_table" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."pulse_assert_valid_user_id_uuid"("p_user_id_uuid" "uuid", "p_table" "text") TO "service_role";



REVOKE ALL ON FUNCTION "public"."pulse_canon_gate"() FROM PUBLIC;
GRANT ALL ON FUNCTION "public"."pulse_canon_gate"() TO "anon";
GRANT ALL ON FUNCTION "public"."pulse_canon_gate"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."pulse_canon_gate"() TO "service_role";



REVOKE ALL ON FUNCTION "public"."pulse_guard_canon_ddl"() FROM PUBLIC;
GRANT ALL ON FUNCTION "public"."pulse_guard_canon_ddl"() TO "anon";
GRANT ALL ON FUNCTION "public"."pulse_guard_canon_ddl"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."pulse_guard_canon_ddl"() TO "service_role";



GRANT ALL ON FUNCTION "public"."pulse_resolve_user_uuid"("p_any_user_id" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."pulse_resolve_user_uuid"("p_any_user_id" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."pulse_resolve_user_uuid"("p_any_user_id" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."pulse_sync_legacy_user_id"() TO "anon";
GRANT ALL ON FUNCTION "public"."pulse_sync_legacy_user_id"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."pulse_sync_legacy_user_id"() TO "service_role";



GRANT ALL ON FUNCTION "public"."pulse_try_uuid"("p_text" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."pulse_try_uuid"("p_text" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."pulse_try_uuid"("p_text" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."pulse_uuid_from_clerk"("p_clerk_user_id" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."pulse_uuid_from_clerk"("p_clerk_user_id" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."pulse_uuid_from_clerk"("p_clerk_user_id" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."refresh_contact_intel"("p_contact_id" "uuid", "p_owner_user_id" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."refresh_contact_intel"("p_contact_id" "uuid", "p_owner_user_id" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."refresh_contact_intel"("p_contact_id" "uuid", "p_owner_user_id" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."refresh_email_threads_for_owner"("p_owner_user_id" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."refresh_email_threads_for_owner"("p_owner_user_id" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."refresh_email_threads_for_owner"("p_owner_user_id" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."refresh_email_threads_for_pairs"() TO "anon";
GRANT ALL ON FUNCTION "public"."refresh_email_threads_for_pairs"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."refresh_email_threads_for_pairs"() TO "service_role";



GRANT ALL ON FUNCTION "public"."reset_monthly_usage"() TO "anon";
GRANT ALL ON FUNCTION "public"."reset_monthly_usage"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."reset_monthly_usage"() TO "service_role";



GRANT ALL ON FUNCTION "public"."rpc_artifact_link_insert"("p_user_id" "uuid", "p_trace_id" "uuid", "p_execution_id" "uuid", "p_execution_run_id" "uuid", "p_from_type" "text", "p_from_id" "uuid", "p_from_key" "text", "p_relation" "text", "p_meta" "jsonb", "p_to_type" "text", "p_to_id" "uuid", "p_to_key" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."rpc_artifact_link_insert"("p_user_id" "uuid", "p_trace_id" "uuid", "p_execution_id" "uuid", "p_execution_run_id" "uuid", "p_from_type" "text", "p_from_id" "uuid", "p_from_key" "text", "p_relation" "text", "p_meta" "jsonb", "p_to_type" "text", "p_to_id" "uuid", "p_to_key" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."rpc_artifact_link_insert"("p_user_id" "uuid", "p_trace_id" "uuid", "p_execution_id" "uuid", "p_execution_run_id" "uuid", "p_from_type" "text", "p_from_id" "uuid", "p_from_key" "text", "p_relation" "text", "p_meta" "jsonb", "p_to_type" "text", "p_to_id" "uuid", "p_to_key" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."rpc_cron_release_lock"("p_key" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."rpc_cron_release_lock"("p_key" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."rpc_cron_release_lock"("p_key" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."rpc_cron_try_lock"("p_key" "text", "p_ttl_seconds" integer, "p_holder" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."rpc_cron_try_lock"("p_key" "text", "p_ttl_seconds" integer, "p_holder" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."rpc_cron_try_lock"("p_key" "text", "p_ttl_seconds" integer, "p_holder" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."rpc_execution_cancel"("p_execution_id" "uuid", "p_reason" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."rpc_execution_cancel"("p_execution_id" "uuid", "p_reason" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."rpc_execution_cancel"("p_execution_id" "uuid", "p_reason" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."rpc_execution_claim_next"("p_now" timestamp with time zone) TO "anon";
GRANT ALL ON FUNCTION "public"."rpc_execution_claim_next"("p_now" timestamp with time zone) TO "authenticated";
GRANT ALL ON FUNCTION "public"."rpc_execution_claim_next"("p_now" timestamp with time zone) TO "service_role";



GRANT ALL ON FUNCTION "public"."rpc_execution_drift_radar"("p_user_id" "text", "p_kind" "text", "p_baseline_days" integer, "p_recent_hours" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."rpc_execution_drift_radar"("p_user_id" "text", "p_kind" "text", "p_baseline_days" integer, "p_recent_hours" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."rpc_execution_drift_radar"("p_user_id" "text", "p_kind" "text", "p_baseline_days" integer, "p_recent_hours" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."rpc_execution_enqueue"("p_kind" "text", "p_payload" "jsonb", "p_run_at" timestamp with time zone, "p_priority" integer, "p_dedupe_key" "text", "p_max_attempts" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."rpc_execution_enqueue"("p_kind" "text", "p_payload" "jsonb", "p_run_at" timestamp with time zone, "p_priority" integer, "p_dedupe_key" "text", "p_max_attempts" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."rpc_execution_enqueue"("p_kind" "text", "p_payload" "jsonb", "p_run_at" timestamp with time zone, "p_priority" integer, "p_dedupe_key" "text", "p_max_attempts" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."rpc_execution_finish_run"("p_run_id" "uuid", "p_status" "text", "p_output" "jsonb", "p_error" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."rpc_execution_finish_run"("p_run_id" "uuid", "p_status" "text", "p_output" "jsonb", "p_error" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."rpc_execution_finish_run"("p_run_id" "uuid", "p_status" "text", "p_output" "jsonb", "p_error" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."rpc_execution_start_run"("p_execution_id" "uuid") TO "anon";
GRANT ALL ON FUNCTION "public"."rpc_execution_start_run"("p_execution_id" "uuid") TO "authenticated";
GRANT ALL ON FUNCTION "public"."rpc_execution_start_run"("p_execution_id" "uuid") TO "service_role";



GRANT ALL ON FUNCTION "public"."rpc_ops_audit_insert"("p_actor_user_id" "text", "p_actor_is_admin" boolean, "p_target_user_id" "text", "p_action" "text", "p_resource_type" "text", "p_resource_id" "text", "p_meta" "jsonb", "p_ip" "text", "p_user_agent" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."rpc_ops_audit_insert"("p_actor_user_id" "text", "p_actor_is_admin" boolean, "p_target_user_id" "text", "p_action" "text", "p_resource_type" "text", "p_resource_id" "text", "p_meta" "jsonb", "p_ip" "text", "p_user_agent" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."rpc_ops_audit_insert"("p_actor_user_id" "text", "p_actor_is_admin" boolean, "p_target_user_id" "text", "p_action" "text", "p_resource_type" "text", "p_resource_id" "text", "p_meta" "jsonb", "p_ip" "text", "p_user_agent" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."rpc_scheduler_tick"("p_now" timestamp with time zone) TO "anon";
GRANT ALL ON FUNCTION "public"."rpc_scheduler_tick"("p_now" timestamp with time zone) TO "authenticated";
GRANT ALL ON FUNCTION "public"."rpc_scheduler_tick"("p_now" timestamp with time zone) TO "service_role";



GRANT ALL ON FUNCTION "public"."rpc_trace_search"("p_user_id" "uuid", "p_since" timestamp with time zone, "p_until" timestamp with time zone, "p_kind" "text", "p_status" "text", "p_has_error" boolean, "p_q" "text", "p_limit" integer, "p_offset" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."rpc_trace_search"("p_user_id" "uuid", "p_since" timestamp with time zone, "p_until" timestamp with time zone, "p_kind" "text", "p_status" "text", "p_has_error" boolean, "p_q" "text", "p_limit" integer, "p_offset" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."rpc_trace_search"("p_user_id" "uuid", "p_since" timestamp with time zone, "p_until" timestamp with time zone, "p_kind" "text", "p_status" "text", "p_has_error" boolean, "p_q" "text", "p_limit" integer, "p_offset" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."rpc_xp_create_eval_run"("p_evaluator_key" "text", "p_evaluator_version" integer, "p_evidence_id" "uuid", "p_result_xp" "jsonb", "p_result_meta" "jsonb") TO "anon";
GRANT ALL ON FUNCTION "public"."rpc_xp_create_eval_run"("p_evaluator_key" "text", "p_evaluator_version" integer, "p_evidence_id" "uuid", "p_result_xp" "jsonb", "p_result_meta" "jsonb") TO "authenticated";
GRANT ALL ON FUNCTION "public"."rpc_xp_create_eval_run"("p_evaluator_key" "text", "p_evaluator_version" integer, "p_evidence_id" "uuid", "p_result_xp" "jsonb", "p_result_meta" "jsonb") TO "service_role";



GRANT ALL ON FUNCTION "public"."rpc_xp_issue_from_eval_run"("p_eval_run_id" "uuid") TO "anon";
GRANT ALL ON FUNCTION "public"."rpc_xp_issue_from_eval_run"("p_eval_run_id" "uuid") TO "authenticated";
GRANT ALL ON FUNCTION "public"."rpc_xp_issue_from_eval_run"("p_eval_run_id" "uuid") TO "service_role";



GRANT ALL ON FUNCTION "public"."rpc_xp_record_evidence"("p_event_id" "uuid", "p_evidence_type" "text", "p_evidence_payload" "jsonb", "p_confidence" numeric, "p_source" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."rpc_xp_record_evidence"("p_event_id" "uuid", "p_evidence_type" "text", "p_evidence_payload" "jsonb", "p_confidence" numeric, "p_source" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."rpc_xp_record_evidence"("p_event_id" "uuid", "p_evidence_type" "text", "p_evidence_payload" "jsonb", "p_confidence" numeric, "p_source" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."rpc_xp_reverse_ledger_entry"("p_ledger_id" "uuid", "p_memo" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."rpc_xp_reverse_ledger_entry"("p_ledger_id" "uuid", "p_memo" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."rpc_xp_reverse_ledger_entry"("p_ledger_id" "uuid", "p_memo" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."search_fragments_by_embedding"("query_embedding" "public"."vector", "match_user_id" "text", "match_count" integer, "min_importance" numeric) TO "anon";
GRANT ALL ON FUNCTION "public"."search_fragments_by_embedding"("query_embedding" "public"."vector", "match_user_id" "text", "match_count" integer, "min_importance" numeric) TO "authenticated";
GRANT ALL ON FUNCTION "public"."search_fragments_by_embedding"("query_embedding" "public"."vector", "match_user_id" "text", "match_count" integer, "min_importance" numeric) TO "service_role";



GRANT ALL ON FUNCTION "public"."search_memories"("query_embedding" "public"."vector", "match_user_id" "text", "match_types" "text"[], "match_categories" "text"[], "min_importance" integer, "match_count" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."search_memories"("query_embedding" "public"."vector", "match_user_id" "text", "match_types" "text"[], "match_categories" "text"[], "min_importance" integer, "match_count" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."search_memories"("query_embedding" "public"."vector", "match_user_id" "text", "match_types" "text"[], "match_categories" "text"[], "min_importance" integer, "match_count" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."seed_default_domains"("p_user_id" "text") TO "anon";
GRANT ALL ON FUNCTION "public"."seed_default_domains"("p_user_id" "text") TO "authenticated";
GRANT ALL ON FUNCTION "public"."seed_default_domains"("p_user_id" "text") TO "service_role";



GRANT ALL ON FUNCTION "public"."set_referral_code"() TO "anon";
GRANT ALL ON FUNCTION "public"."set_referral_code"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."set_referral_code"() TO "service_role";



GRANT ALL ON FUNCTION "public"."set_updated_at"() TO "anon";
GRANT ALL ON FUNCTION "public"."set_updated_at"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."set_updated_at"() TO "service_role";



GRANT ALL ON FUNCTION "public"."sync_users_clerk_ids"() TO "anon";
GRANT ALL ON FUNCTION "public"."sync_users_clerk_ids"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."sync_users_clerk_ids"() TO "service_role";



GRANT ALL ON FUNCTION "public"."tasks_enforce_completion"() TO "anon";
GRANT ALL ON FUNCTION "public"."tasks_enforce_completion"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."tasks_enforce_completion"() TO "service_role";



GRANT ALL ON FUNCTION "public"."tg_set_updated_at"() TO "anon";
GRANT ALL ON FUNCTION "public"."tg_set_updated_at"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."tg_set_updated_at"() TO "service_role";



GRANT ALL ON FUNCTION "public"."tg_set_user_id_text"() TO "anon";
GRANT ALL ON FUNCTION "public"."tg_set_user_id_text"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."tg_set_user_id_text"() TO "service_role";



GRANT ALL ON FUNCTION "public"."trg_refresh_threads_after_email_insert"() TO "anon";
GRANT ALL ON FUNCTION "public"."trg_refresh_threads_after_email_insert"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."trg_refresh_threads_after_email_insert"() TO "service_role";



GRANT ALL ON FUNCTION "public"."update_autonomy_actions_updated_at"() TO "anon";
GRANT ALL ON FUNCTION "public"."update_autonomy_actions_updated_at"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."update_autonomy_actions_updated_at"() TO "service_role";



GRANT ALL ON FUNCTION "public"."update_calendar_accounts_updated_at"() TO "anon";
GRANT ALL ON FUNCTION "public"."update_calendar_accounts_updated_at"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."update_calendar_accounts_updated_at"() TO "service_role";



GRANT ALL ON FUNCTION "public"."update_calendar_events_cache_updated_at"() TO "anon";
GRANT ALL ON FUNCTION "public"."update_calendar_events_cache_updated_at"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."update_calendar_events_cache_updated_at"() TO "service_role";



GRANT ALL ON FUNCTION "public"."update_day_plans_updated_at"() TO "anon";
GRANT ALL ON FUNCTION "public"."update_day_plans_updated_at"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."update_day_plans_updated_at"() TO "service_role";



GRANT ALL ON FUNCTION "public"."update_delegated_drafts_updated_at"() TO "anon";
GRANT ALL ON FUNCTION "public"."update_delegated_drafts_updated_at"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."update_delegated_drafts_updated_at"() TO "service_role";



GRANT ALL ON FUNCTION "public"."update_entity_importance_trigger"() TO "anon";
GRANT ALL ON FUNCTION "public"."update_entity_importance_trigger"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."update_entity_importance_trigger"() TO "service_role";



GRANT ALL ON FUNCTION "public"."update_life_domains_updated_at"() TO "anon";
GRANT ALL ON FUNCTION "public"."update_life_domains_updated_at"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."update_life_domains_updated_at"() TO "service_role";



GRANT ALL ON FUNCTION "public"."update_notification_preferences_updated_at"() TO "anon";
GRANT ALL ON FUNCTION "public"."update_notification_preferences_updated_at"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."update_notification_preferences_updated_at"() TO "service_role";



GRANT ALL ON FUNCTION "public"."update_plan_items_updated_at"() TO "anon";
GRANT ALL ON FUNCTION "public"."update_plan_items_updated_at"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."update_plan_items_updated_at"() TO "service_role";



GRANT ALL ON FUNCTION "public"."update_updated_at"() TO "anon";
GRANT ALL ON FUNCTION "public"."update_updated_at"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."update_updated_at"() TO "service_role";



GRANT ALL ON FUNCTION "public"."upsert_third_brain_memory"("p_user_id" "text", "p_category" "text", "p_key" "text", "p_content" "text", "p_importance" integer, "p_metadata" "jsonb") TO "anon";
GRANT ALL ON FUNCTION "public"."upsert_third_brain_memory"("p_user_id" "text", "p_category" "text", "p_key" "text", "p_content" "text", "p_importance" integer, "p_metadata" "jsonb") TO "authenticated";
GRANT ALL ON FUNCTION "public"."upsert_third_brain_memory"("p_user_id" "text", "p_category" "text", "p_key" "text", "p_content" "text", "p_importance" integer, "p_metadata" "jsonb") TO "service_role";



GRANT ALL ON FUNCTION "public"."user_daily_activity_rollup_read"("p_days" integer) TO "anon";
GRANT ALL ON FUNCTION "public"."user_daily_activity_rollup_read"("p_days" integer) TO "authenticated";
GRANT ALL ON FUNCTION "public"."user_daily_activity_rollup_read"("p_days" integer) TO "service_role";



GRANT ALL ON FUNCTION "public"."utc_day_bounds"("p_day" "date") TO "anon";
GRANT ALL ON FUNCTION "public"."utc_day_bounds"("p_day" "date") TO "authenticated";
GRANT ALL ON FUNCTION "public"."utc_day_bounds"("p_day" "date") TO "service_role";



GRANT ALL ON TABLE "public"."_pulse_dropped_policies" TO "anon";
GRANT ALL ON TABLE "public"."_pulse_dropped_policies" TO "authenticated";
GRANT ALL ON TABLE "public"."_pulse_dropped_policies" TO "service_role";



GRANT ALL ON TABLE "public"."_pulse_dropped_user_id_fks" TO "anon";
GRANT ALL ON TABLE "public"."_pulse_dropped_user_id_fks" TO "authenticated";
GRANT ALL ON TABLE "public"."_pulse_dropped_user_id_fks" TO "service_role";



GRANT ALL ON TABLE "public"."_pulse_dropped_views" TO "anon";
GRANT ALL ON TABLE "public"."_pulse_dropped_views" TO "authenticated";
GRANT ALL ON TABLE "public"."_pulse_dropped_views" TO "service_role";



GRANT ALL ON TABLE "public"."_pulse_quarantine_rows" TO "anon";
GRANT ALL ON TABLE "public"."_pulse_quarantine_rows" TO "authenticated";
GRANT ALL ON TABLE "public"."_pulse_quarantine_rows" TO "service_role";



GRANT ALL ON SEQUENCE "public"."_pulse_quarantine_rows_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."_pulse_quarantine_rows_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."_pulse_quarantine_rows_id_seq" TO "service_role";



GRANT ALL ON TABLE "public"."achievements" TO "anon";
GRANT ALL ON TABLE "public"."achievements" TO "authenticated";
GRANT ALL ON TABLE "public"."achievements" TO "service_role";



GRANT ALL ON TABLE "public"."activity_events" TO "anon";
GRANT ALL ON TABLE "public"."activity_events" TO "authenticated";
GRANT ALL ON TABLE "public"."activity_events" TO "service_role";



GRANT ALL ON TABLE "public"."ag_agents" TO "anon";
GRANT ALL ON TABLE "public"."ag_agents" TO "authenticated";
GRANT ALL ON TABLE "public"."ag_agents" TO "service_role";



GRANT ALL ON TABLE "public"."ag_messages" TO "anon";
GRANT ALL ON TABLE "public"."ag_messages" TO "authenticated";
GRANT ALL ON TABLE "public"."ag_messages" TO "service_role";



GRANT ALL ON TABLE "public"."ag_runs" TO "anon";
GRANT ALL ON TABLE "public"."ag_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."ag_runs" TO "service_role";



GRANT ALL ON TABLE "public"."agi_actions" TO "anon";
GRANT ALL ON TABLE "public"."agi_actions" TO "authenticated";
GRANT ALL ON TABLE "public"."agi_actions" TO "service_role";



GRANT ALL ON TABLE "public"."agi_agent_profiles" TO "anon";
GRANT ALL ON TABLE "public"."agi_agent_profiles" TO "authenticated";
GRANT ALL ON TABLE "public"."agi_agent_profiles" TO "service_role";



GRANT ALL ON TABLE "public"."agi_feedback" TO "anon";
GRANT ALL ON TABLE "public"."agi_feedback" TO "authenticated";
GRANT ALL ON TABLE "public"."agi_feedback" TO "service_role";



GRANT ALL ON TABLE "public"."agi_policies" TO "anon";
GRANT ALL ON TABLE "public"."agi_policies" TO "authenticated";
GRANT ALL ON TABLE "public"."agi_policies" TO "service_role";



GRANT ALL ON TABLE "public"."agi_runs" TO "anon";
GRANT ALL ON TABLE "public"."agi_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."agi_runs" TO "service_role";



GRANT ALL ON TABLE "public"."agi_scenario_runs" TO "anon";
GRANT ALL ON TABLE "public"."agi_scenario_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."agi_scenario_runs" TO "service_role";



GRANT ALL ON TABLE "public"."agi_scenarios" TO "anon";
GRANT ALL ON TABLE "public"."agi_scenarios" TO "authenticated";
GRANT ALL ON TABLE "public"."agi_scenarios" TO "service_role";



GRANT ALL ON TABLE "public"."agi_telemetry" TO "anon";
GRANT ALL ON TABLE "public"."agi_telemetry" TO "authenticated";
GRANT ALL ON TABLE "public"."agi_telemetry" TO "service_role";



GRANT ALL ON TABLE "public"."agi_user_profile" TO "anon";
GRANT ALL ON TABLE "public"."agi_user_profile" TO "authenticated";
GRANT ALL ON TABLE "public"."agi_user_profile" TO "service_role";



GRANT ALL ON TABLE "public"."align_feedback" TO "anon";
GRANT ALL ON TABLE "public"."align_feedback" TO "authenticated";
GRANT ALL ON TABLE "public"."align_feedback" TO "service_role";



GRANT ALL ON TABLE "public"."align_global_policies" TO "anon";
GRANT ALL ON TABLE "public"."align_global_policies" TO "authenticated";
GRANT ALL ON TABLE "public"."align_global_policies" TO "service_role";



GRANT ALL ON TABLE "public"."align_user_profiles" TO "anon";
GRANT ALL ON TABLE "public"."align_user_profiles" TO "authenticated";
GRANT ALL ON TABLE "public"."align_user_profiles" TO "service_role";



GRANT ALL ON TABLE "public"."align_violations" TO "anon";
GRANT ALL ON TABLE "public"."align_violations" TO "authenticated";
GRANT ALL ON TABLE "public"."align_violations" TO "service_role";



GRANT ALL ON TABLE "public"."alignment_evaluations" TO "anon";
GRANT ALL ON TABLE "public"."alignment_evaluations" TO "authenticated";
GRANT ALL ON TABLE "public"."alignment_evaluations" TO "service_role";



GRANT ALL ON TABLE "public"."archetype_definitions" TO "anon";
GRANT ALL ON TABLE "public"."archetype_definitions" TO "authenticated";
GRANT ALL ON TABLE "public"."archetype_definitions" TO "service_role";



GRANT ALL ON TABLE "public"."archetype_events" TO "anon";
GRANT ALL ON TABLE "public"."archetype_events" TO "authenticated";
GRANT ALL ON TABLE "public"."archetype_events" TO "service_role";



GRANT ALL ON TABLE "public"."archetype_snapshots" TO "anon";
GRANT ALL ON TABLE "public"."archetype_snapshots" TO "authenticated";
GRANT ALL ON TABLE "public"."archetype_snapshots" TO "service_role";



GRANT ALL ON TABLE "public"."artifact_links" TO "anon";
GRANT ALL ON TABLE "public"."artifact_links" TO "authenticated";
GRANT ALL ON TABLE "public"."artifact_links" TO "service_role";



GRANT ALL ON TABLE "public"."attention_events" TO "anon";
GRANT ALL ON TABLE "public"."attention_events" TO "authenticated";
GRANT ALL ON TABLE "public"."attention_events" TO "service_role";



GRANT ALL ON TABLE "public"."autonomy_actions" TO "anon";
GRANT ALL ON TABLE "public"."autonomy_actions" TO "authenticated";
GRANT ALL ON TABLE "public"."autonomy_actions" TO "service_role";



GRANT ALL ON TABLE "public"."autopilot_jobs" TO "anon";
GRANT ALL ON TABLE "public"."autopilot_jobs" TO "authenticated";
GRANT ALL ON TABLE "public"."autopilot_jobs" TO "service_role";



GRANT ALL ON TABLE "public"."autopilot_suggestions" TO "anon";
GRANT ALL ON TABLE "public"."autopilot_suggestions" TO "authenticated";
GRANT ALL ON TABLE "public"."autopilot_suggestions" TO "service_role";



GRANT ALL ON TABLE "public"."behavior_predictions" TO "anon";
GRANT ALL ON TABLE "public"."behavior_predictions" TO "authenticated";
GRANT ALL ON TABLE "public"."behavior_predictions" TO "service_role";



GRANT ALL ON TABLE "public"."brain_capabilities" TO "anon";
GRANT ALL ON TABLE "public"."brain_capabilities" TO "authenticated";
GRANT ALL ON TABLE "public"."brain_capabilities" TO "service_role";



GRANT ALL ON TABLE "public"."brain_changelog" TO "anon";
GRANT ALL ON TABLE "public"."brain_changelog" TO "authenticated";
GRANT ALL ON TABLE "public"."brain_changelog" TO "service_role";



GRANT ALL ON TABLE "public"."brain_entries" TO "anon";
GRANT ALL ON TABLE "public"."brain_entries" TO "authenticated";
GRANT ALL ON TABLE "public"."brain_entries" TO "service_role";



GRANT ALL ON TABLE "public"."brain_error_events" TO "anon";
GRANT ALL ON TABLE "public"."brain_error_events" TO "authenticated";
GRANT ALL ON TABLE "public"."brain_error_events" TO "service_role";



GRANT ALL ON TABLE "public"."brain_events" TO "anon";
GRANT ALL ON TABLE "public"."brain_events" TO "authenticated";
GRANT ALL ON TABLE "public"."brain_events" TO "service_role";



GRANT ALL ON TABLE "public"."brain_health_snapshots" TO "anon";
GRANT ALL ON TABLE "public"."brain_health_snapshots" TO "authenticated";
GRANT ALL ON TABLE "public"."brain_health_snapshots" TO "service_role";



GRANT ALL ON TABLE "public"."brain_subsystems" TO "anon";
GRANT ALL ON TABLE "public"."brain_subsystems" TO "authenticated";
GRANT ALL ON TABLE "public"."brain_subsystems" TO "service_role";



GRANT ALL ON TABLE "public"."brainstem_status" TO "anon";
GRANT ALL ON TABLE "public"."brainstem_status" TO "authenticated";
GRANT ALL ON TABLE "public"."brainstem_status" TO "service_role";



GRANT ALL ON TABLE "public"."branch_comparisons" TO "anon";
GRANT ALL ON TABLE "public"."branch_comparisons" TO "authenticated";
GRANT ALL ON TABLE "public"."branch_comparisons" TO "service_role";



GRANT ALL ON TABLE "public"."branch_simulation_runs" TO "anon";
GRANT ALL ON TABLE "public"."branch_simulation_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."branch_simulation_runs" TO "service_role";



GRANT ALL ON TABLE "public"."butler_notifications" TO "anon";
GRANT ALL ON TABLE "public"."butler_notifications" TO "authenticated";
GRANT ALL ON TABLE "public"."butler_notifications" TO "service_role";



GRANT ALL ON TABLE "public"."butler_snoozes" TO "anon";
GRANT ALL ON TABLE "public"."butler_snoozes" TO "authenticated";
GRANT ALL ON TABLE "public"."butler_snoozes" TO "service_role";



GRANT ALL ON TABLE "public"."calendar_accounts" TO "anon";
GRANT ALL ON TABLE "public"."calendar_accounts" TO "authenticated";
GRANT ALL ON TABLE "public"."calendar_accounts" TO "service_role";



GRANT ALL ON TABLE "public"."calendar_events_cache" TO "anon";
GRANT ALL ON TABLE "public"."calendar_events_cache" TO "authenticated";
GRANT ALL ON TABLE "public"."calendar_events_cache" TO "service_role";



GRANT ALL ON TABLE "public"."call_intelligence_settings" TO "anon";
GRANT ALL ON TABLE "public"."call_intelligence_settings" TO "authenticated";
GRANT ALL ON TABLE "public"."call_intelligence_settings" TO "service_role";



GRANT ALL ON TABLE "public"."call_links" TO "anon";
GRANT ALL ON TABLE "public"."call_links" TO "authenticated";
GRANT ALL ON TABLE "public"."call_links" TO "service_role";



GRANT ALL ON TABLE "public"."call_segments" TO "anon";
GRANT ALL ON TABLE "public"."call_segments" TO "authenticated";
GRANT ALL ON TABLE "public"."call_segments" TO "service_role";



GRANT ALL ON TABLE "public"."call_sessions" TO "anon";
GRANT ALL ON TABLE "public"."call_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."call_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."call_summaries" TO "anon";
GRANT ALL ON TABLE "public"."call_summaries" TO "authenticated";
GRANT ALL ON TABLE "public"."call_summaries" TO "service_role";



GRANT ALL ON TABLE "public"."calls" TO "anon";
GRANT ALL ON TABLE "public"."calls" TO "authenticated";
GRANT ALL ON TABLE "public"."calls" TO "service_role";



GRANT ALL ON TABLE "public"."campaign_enrollments" TO "anon";
GRANT ALL ON TABLE "public"."campaign_enrollments" TO "authenticated";
GRANT ALL ON TABLE "public"."campaign_enrollments" TO "service_role";



GRANT ALL ON TABLE "public"."campaigns" TO "anon";
GRANT ALL ON TABLE "public"."campaigns" TO "authenticated";
GRANT ALL ON TABLE "public"."campaigns" TO "service_role";



GRANT ALL ON TABLE "public"."canon_dashboard" TO "anon";
GRANT ALL ON TABLE "public"."canon_dashboard" TO "authenticated";
GRANT ALL ON TABLE "public"."canon_dashboard" TO "service_role";



GRANT ALL ON TABLE "public"."canon_events" TO "anon";
GRANT ALL ON TABLE "public"."canon_events" TO "authenticated";
GRANT ALL ON TABLE "public"."canon_events" TO "service_role";



GRANT ALL ON TABLE "public"."identity_users" TO "anon";
GRANT ALL ON TABLE "public"."identity_users" TO "authenticated";
GRANT ALL ON TABLE "public"."identity_users" TO "service_role";



GRANT ALL ON TABLE "public"."canon_health_summary" TO "anon";
GRANT ALL ON TABLE "public"."canon_health_summary" TO "authenticated";
GRANT ALL ON TABLE "public"."canon_health_summary" TO "service_role";



GRANT ALL ON TABLE "public"."canon_migration_allowlist" TO "anon";
GRANT ALL ON TABLE "public"."canon_migration_allowlist" TO "authenticated";
GRANT ALL ON TABLE "public"."canon_migration_allowlist" TO "service_role";



GRANT ALL ON TABLE "public"."canon_mode" TO "anon";
GRANT ALL ON TABLE "public"."canon_mode" TO "authenticated";
GRANT ALL ON TABLE "public"."canon_mode" TO "service_role";



GRANT ALL ON TABLE "public"."canon_timeline_index" TO "anon";
GRANT ALL ON TABLE "public"."canon_timeline_index" TO "authenticated";
GRANT ALL ON TABLE "public"."canon_timeline_index" TO "service_role";



GRANT ALL ON TABLE "public"."canonical_schema_rules" TO "anon";
GRANT ALL ON TABLE "public"."canonical_schema_rules" TO "authenticated";
GRANT ALL ON TABLE "public"."canonical_schema_rules" TO "service_role";



GRANT ALL ON SEQUENCE "public"."canonical_schema_rules_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."canonical_schema_rules_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."canonical_schema_rules_id_seq" TO "service_role";



GRANT ALL ON TABLE "public"."chapter_archetypes" TO "anon";
GRANT ALL ON TABLE "public"."chapter_archetypes" TO "authenticated";
GRANT ALL ON TABLE "public"."chapter_archetypes" TO "service_role";



GRANT ALL ON TABLE "public"."civilization_domain_mappings" TO "anon";
GRANT ALL ON TABLE "public"."civilization_domain_mappings" TO "authenticated";
GRANT ALL ON TABLE "public"."civilization_domain_mappings" TO "service_role";



GRANT ALL ON TABLE "public"."civilization_domain_state" TO "anon";
GRANT ALL ON TABLE "public"."civilization_domain_state" TO "authenticated";
GRANT ALL ON TABLE "public"."civilization_domain_state" TO "service_role";



GRANT ALL ON TABLE "public"."civilization_domains" TO "anon";
GRANT ALL ON TABLE "public"."civilization_domains" TO "authenticated";
GRANT ALL ON TABLE "public"."civilization_domains" TO "service_role";



GRANT ALL ON TABLE "public"."civilization_patterns" TO "anon";
GRANT ALL ON TABLE "public"."civilization_patterns" TO "authenticated";
GRANT ALL ON TABLE "public"."civilization_patterns" TO "service_role";



GRANT ALL ON TABLE "public"."civilization_settings" TO "anon";
GRANT ALL ON TABLE "public"."civilization_settings" TO "authenticated";
GRANT ALL ON TABLE "public"."civilization_settings" TO "service_role";



GRANT ALL ON TABLE "public"."coach_council_deliberations" TO "anon";
GRANT ALL ON TABLE "public"."coach_council_deliberations" TO "authenticated";
GRANT ALL ON TABLE "public"."coach_council_deliberations" TO "service_role";



GRANT ALL ON TABLE "public"."coach_council_members" TO "anon";
GRANT ALL ON TABLE "public"."coach_council_members" TO "authenticated";
GRANT ALL ON TABLE "public"."coach_council_members" TO "service_role";



GRANT ALL ON TABLE "public"."coach_council_sessions" TO "anon";
GRANT ALL ON TABLE "public"."coach_council_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."coach_council_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."coach_council_summary" TO "anon";
GRANT ALL ON TABLE "public"."coach_council_summary" TO "authenticated";
GRANT ALL ON TABLE "public"."coach_council_summary" TO "service_role";



GRANT ALL ON TABLE "public"."coach_generated_scenarios" TO "anon";
GRANT ALL ON TABLE "public"."coach_generated_scenarios" TO "authenticated";
GRANT ALL ON TABLE "public"."coach_generated_scenarios" TO "service_role";



GRANT ALL ON TABLE "public"."coach_multi_agent_sessions" TO "anon";
GRANT ALL ON TABLE "public"."coach_multi_agent_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."coach_multi_agent_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."coach_roleplay_scenarios" TO "anon";
GRANT ALL ON TABLE "public"."coach_roleplay_scenarios" TO "authenticated";
GRANT ALL ON TABLE "public"."coach_roleplay_scenarios" TO "service_role";



GRANT ALL ON TABLE "public"."coach_scenarios" TO "anon";
GRANT ALL ON TABLE "public"."coach_scenarios" TO "authenticated";
GRANT ALL ON TABLE "public"."coach_scenarios" TO "service_role";



GRANT ALL ON TABLE "public"."coach_sessions" TO "anon";
GRANT ALL ON TABLE "public"."coach_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."coach_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."coach_training_sessions" TO "anon";
GRANT ALL ON TABLE "public"."coach_training_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."coach_training_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."coach_user_preferences" TO "anon";
GRANT ALL ON TABLE "public"."coach_user_preferences" TO "authenticated";
GRANT ALL ON TABLE "public"."coach_user_preferences" TO "service_role";



GRANT ALL ON TABLE "public"."coach_voice_overrides" TO "anon";
GRANT ALL ON TABLE "public"."coach_voice_overrides" TO "authenticated";
GRANT ALL ON TABLE "public"."coach_voice_overrides" TO "service_role";



GRANT ALL ON TABLE "public"."coach_voice_sessions" TO "anon";
GRANT ALL ON TABLE "public"."coach_voice_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."coach_voice_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."cognitive_hypotheses" TO "anon";
GRANT ALL ON TABLE "public"."cognitive_hypotheses" TO "authenticated";
GRANT ALL ON TABLE "public"."cognitive_hypotheses" TO "service_role";



GRANT ALL ON TABLE "public"."cognitive_insights" TO "anon";
GRANT ALL ON TABLE "public"."cognitive_insights" TO "authenticated";
GRANT ALL ON TABLE "public"."cognitive_insights" TO "service_role";



GRANT ALL ON TABLE "public"."cognitive_phases" TO "anon";
GRANT ALL ON TABLE "public"."cognitive_phases" TO "authenticated";
GRANT ALL ON TABLE "public"."cognitive_phases" TO "service_role";



GRANT ALL ON TABLE "public"."cognitive_runs" TO "anon";
GRANT ALL ON TABLE "public"."cognitive_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."cognitive_runs" TO "service_role";



GRANT ALL ON TABLE "public"."cognitive_self_reflections" TO "anon";
GRANT ALL ON TABLE "public"."cognitive_self_reflections" TO "authenticated";
GRANT ALL ON TABLE "public"."cognitive_self_reflections" TO "service_role";



GRANT ALL ON TABLE "public"."cognitive_update_actions" TO "anon";
GRANT ALL ON TABLE "public"."cognitive_update_actions" TO "authenticated";
GRANT ALL ON TABLE "public"."cognitive_update_actions" TO "service_role";



GRANT ALL ON TABLE "public"."communication_programs" TO "anon";
GRANT ALL ON TABLE "public"."communication_programs" TO "authenticated";
GRANT ALL ON TABLE "public"."communication_programs" TO "service_role";



GRANT ALL ON TABLE "public"."communication_sessions" TO "anon";
GRANT ALL ON TABLE "public"."communication_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."communication_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."communication_turns" TO "anon";
GRANT ALL ON TABLE "public"."communication_turns" TO "authenticated";
GRANT ALL ON TABLE "public"."communication_turns" TO "service_role";



GRANT ALL ON TABLE "public"."conscious_conflicts" TO "anon";
GRANT ALL ON TABLE "public"."conscious_conflicts" TO "authenticated";
GRANT ALL ON TABLE "public"."conscious_conflicts" TO "service_role";



GRANT ALL ON TABLE "public"."conscious_frames" TO "anon";
GRANT ALL ON TABLE "public"."conscious_frames" TO "authenticated";
GRANT ALL ON TABLE "public"."conscious_frames" TO "service_role";



GRANT ALL ON TABLE "public"."conscious_insights" TO "anon";
GRANT ALL ON TABLE "public"."conscious_insights" TO "authenticated";
GRANT ALL ON TABLE "public"."conscious_insights" TO "service_role";



GRANT ALL ON TABLE "public"."conscious_items" TO "anon";
GRANT ALL ON TABLE "public"."conscious_items" TO "authenticated";
GRANT ALL ON TABLE "public"."conscious_items" TO "service_role";



GRANT ALL ON TABLE "public"."conscious_links" TO "anon";
GRANT ALL ON TABLE "public"."conscious_links" TO "authenticated";
GRANT ALL ON TABLE "public"."conscious_links" TO "service_role";



GRANT ALL ON TABLE "public"."contact_dates" TO "anon";
GRANT ALL ON TABLE "public"."contact_dates" TO "authenticated";
GRANT ALL ON TABLE "public"."contact_dates" TO "service_role";



GRANT ALL ON TABLE "public"."contact_emails" TO "anon";
GRANT ALL ON TABLE "public"."contact_emails" TO "authenticated";
GRANT ALL ON TABLE "public"."contact_emails" TO "service_role";



GRANT ALL ON TABLE "public"."contact_facts" TO "anon";
GRANT ALL ON TABLE "public"."contact_facts" TO "authenticated";
GRANT ALL ON TABLE "public"."contact_facts" TO "service_role";



GRANT ALL ON TABLE "public"."contact_identity_intel" TO "anon";
GRANT ALL ON TABLE "public"."contact_identity_intel" TO "authenticated";
GRANT ALL ON TABLE "public"."contact_identity_intel" TO "service_role";



GRANT ALL ON TABLE "public"."contact_influence_events" TO "anon";
GRANT ALL ON TABLE "public"."contact_influence_events" TO "authenticated";
GRANT ALL ON TABLE "public"."contact_influence_events" TO "service_role";



GRANT ALL ON TABLE "public"."contact_intelligence_sources" TO "anon";
GRANT ALL ON TABLE "public"."contact_intelligence_sources" TO "authenticated";
GRANT ALL ON TABLE "public"."contact_intelligence_sources" TO "service_role";



GRANT ALL ON TABLE "public"."contact_phones" TO "anon";
GRANT ALL ON TABLE "public"."contact_phones" TO "authenticated";
GRANT ALL ON TABLE "public"."contact_phones" TO "service_role";



GRANT ALL ON TABLE "public"."contact_playbooks" TO "anon";
GRANT ALL ON TABLE "public"."contact_playbooks" TO "authenticated";
GRANT ALL ON TABLE "public"."contact_playbooks" TO "service_role";



GRANT ALL ON TABLE "public"."contact_relationship_scores" TO "anon";
GRANT ALL ON TABLE "public"."contact_relationship_scores" TO "authenticated";
GRANT ALL ON TABLE "public"."contact_relationship_scores" TO "service_role";



GRANT ALL ON TABLE "public"."contact_relationships" TO "anon";
GRANT ALL ON TABLE "public"."contact_relationships" TO "authenticated";
GRANT ALL ON TABLE "public"."contact_relationships" TO "service_role";



GRANT ALL ON TABLE "public"."contact_tag_links" TO "anon";
GRANT ALL ON TABLE "public"."contact_tag_links" TO "authenticated";
GRANT ALL ON TABLE "public"."contact_tag_links" TO "service_role";



GRANT ALL ON TABLE "public"."contact_tags" TO "anon";
GRANT ALL ON TABLE "public"."contact_tags" TO "authenticated";
GRANT ALL ON TABLE "public"."contact_tags" TO "service_role";



GRANT ALL ON TABLE "public"."contacts" TO "anon";
GRANT ALL ON TABLE "public"."contacts" TO "authenticated";
GRANT ALL ON TABLE "public"."contacts" TO "service_role";



GRANT ALL ON TABLE "public"."cortex_anomalies" TO "anon";
GRANT ALL ON TABLE "public"."cortex_anomalies" TO "authenticated";
GRANT ALL ON TABLE "public"."cortex_anomalies" TO "service_role";



GRANT ALL ON TABLE "public"."cortex_areas" TO "anon";
GRANT ALL ON TABLE "public"."cortex_areas" TO "authenticated";
GRANT ALL ON TABLE "public"."cortex_areas" TO "service_role";



GRANT ALL ON TABLE "public"."cortex_events" TO "anon";
GRANT ALL ON TABLE "public"."cortex_events" TO "authenticated";
GRANT ALL ON TABLE "public"."cortex_events" TO "service_role";



GRANT ALL ON TABLE "public"."cortex_patterns" TO "anon";
GRANT ALL ON TABLE "public"."cortex_patterns" TO "authenticated";
GRANT ALL ON TABLE "public"."cortex_patterns" TO "service_role";



GRANT ALL ON TABLE "public"."cortex_predictions" TO "anon";
GRANT ALL ON TABLE "public"."cortex_predictions" TO "authenticated";
GRANT ALL ON TABLE "public"."cortex_predictions" TO "service_role";



GRANT ALL ON TABLE "public"."cortex_signals" TO "anon";
GRANT ALL ON TABLE "public"."cortex_signals" TO "authenticated";
GRANT ALL ON TABLE "public"."cortex_signals" TO "service_role";



GRANT ALL ON TABLE "public"."council_consensus" TO "anon";
GRANT ALL ON TABLE "public"."council_consensus" TO "authenticated";
GRANT ALL ON TABLE "public"."council_consensus" TO "service_role";



GRANT ALL ON TABLE "public"."council_decision_dossiers" TO "anon";
GRANT ALL ON TABLE "public"."council_decision_dossiers" TO "authenticated";
GRANT ALL ON TABLE "public"."council_decision_dossiers" TO "service_role";



GRANT ALL ON TABLE "public"."council_members" TO "anon";
GRANT ALL ON TABLE "public"."council_members" TO "authenticated";
GRANT ALL ON TABLE "public"."council_members" TO "service_role";



GRANT ALL ON TABLE "public"."council_opinions" TO "anon";
GRANT ALL ON TABLE "public"."council_opinions" TO "authenticated";
GRANT ALL ON TABLE "public"."council_opinions" TO "service_role";



GRANT ALL ON TABLE "public"."council_sessions" TO "anon";
GRANT ALL ON TABLE "public"."council_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."council_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."creative_artifacts" TO "anon";
GRANT ALL ON TABLE "public"."creative_artifacts" TO "authenticated";
GRANT ALL ON TABLE "public"."creative_artifacts" TO "service_role";



GRANT ALL ON TABLE "public"."creative_assets" TO "anon";
GRANT ALL ON TABLE "public"."creative_assets" TO "authenticated";
GRANT ALL ON TABLE "public"."creative_assets" TO "service_role";



GRANT ALL ON TABLE "public"."creative_evaluations" TO "anon";
GRANT ALL ON TABLE "public"."creative_evaluations" TO "authenticated";
GRANT ALL ON TABLE "public"."creative_evaluations" TO "service_role";



GRANT ALL ON TABLE "public"."creative_ideas" TO "anon";
GRANT ALL ON TABLE "public"."creative_ideas" TO "authenticated";
GRANT ALL ON TABLE "public"."creative_ideas" TO "service_role";



GRANT ALL ON TABLE "public"."creative_patterns" TO "anon";
GRANT ALL ON TABLE "public"."creative_patterns" TO "authenticated";
GRANT ALL ON TABLE "public"."creative_patterns" TO "service_role";



GRANT ALL ON TABLE "public"."creative_projects" TO "anon";
GRANT ALL ON TABLE "public"."creative_projects" TO "authenticated";
GRANT ALL ON TABLE "public"."creative_projects" TO "service_role";



GRANT ALL ON TABLE "public"."creative_sessions" TO "anon";
GRANT ALL ON TABLE "public"."creative_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."creative_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."creative_style_profiles" TO "anon";
GRANT ALL ON TABLE "public"."creative_style_profiles" TO "authenticated";
GRANT ALL ON TABLE "public"."creative_style_profiles" TO "service_role";



GRANT ALL ON TABLE "public"."crm_alerts" TO "anon";
GRANT ALL ON TABLE "public"."crm_alerts" TO "authenticated";
GRANT ALL ON TABLE "public"."crm_alerts" TO "service_role";



GRANT ALL ON TABLE "public"."crm_contact_events" TO "anon";
GRANT ALL ON TABLE "public"."crm_contact_events" TO "authenticated";
GRANT ALL ON TABLE "public"."crm_contact_events" TO "service_role";



GRANT ALL ON TABLE "public"."crm_contact_facts" TO "anon";
GRANT ALL ON TABLE "public"."crm_contact_facts" TO "authenticated";
GRANT ALL ON TABLE "public"."crm_contact_facts" TO "service_role";



GRANT ALL ON TABLE "public"."crm_contact_intel" TO "anon";
GRANT ALL ON TABLE "public"."crm_contact_intel" TO "authenticated";
GRANT ALL ON TABLE "public"."crm_contact_intel" TO "service_role";



GRANT ALL ON TABLE "public"."crm_contact_intel_sources" TO "anon";
GRANT ALL ON TABLE "public"."crm_contact_intel_sources" TO "authenticated";
GRANT ALL ON TABLE "public"."crm_contact_intel_sources" TO "service_role";



GRANT ALL ON TABLE "public"."crm_contact_org_links" TO "anon";
GRANT ALL ON TABLE "public"."crm_contact_org_links" TO "authenticated";
GRANT ALL ON TABLE "public"."crm_contact_org_links" TO "service_role";



GRANT ALL ON TABLE "public"."crm_contact_photo_candidates" TO "anon";
GRANT ALL ON TABLE "public"."crm_contact_photo_candidates" TO "authenticated";
GRANT ALL ON TABLE "public"."crm_contact_photo_candidates" TO "service_role";



GRANT ALL ON TABLE "public"."crm_contacts" TO "anon";
GRANT ALL ON TABLE "public"."crm_contacts" TO "authenticated";
GRANT ALL ON TABLE "public"."crm_contacts" TO "service_role";



GRANT ALL ON TABLE "public"."crm_deal_contacts" TO "anon";
GRANT ALL ON TABLE "public"."crm_deal_contacts" TO "authenticated";
GRANT ALL ON TABLE "public"."crm_deal_contacts" TO "service_role";



GRANT ALL ON TABLE "public"."crm_deal_health" TO "anon";
GRANT ALL ON TABLE "public"."crm_deal_health" TO "authenticated";
GRANT ALL ON TABLE "public"."crm_deal_health" TO "service_role";



GRANT ALL ON TABLE "public"."crm_deals" TO "anon";
GRANT ALL ON TABLE "public"."crm_deals" TO "authenticated";
GRANT ALL ON TABLE "public"."crm_deals" TO "service_role";



GRANT ALL ON TABLE "public"."crm_interactions" TO "anon";
GRANT ALL ON TABLE "public"."crm_interactions" TO "authenticated";
GRANT ALL ON TABLE "public"."crm_interactions" TO "service_role";



GRANT ALL ON TABLE "public"."crm_organizations" TO "anon";
GRANT ALL ON TABLE "public"."crm_organizations" TO "authenticated";
GRANT ALL ON TABLE "public"."crm_organizations" TO "service_role";



GRANT ALL ON TABLE "public"."crm_relationship_health" TO "anon";
GRANT ALL ON TABLE "public"."crm_relationship_health" TO "authenticated";
GRANT ALL ON TABLE "public"."crm_relationship_health" TO "service_role";



GRANT ALL ON TABLE "public"."crm_tasks" TO "anon";
GRANT ALL ON TABLE "public"."crm_tasks" TO "authenticated";
GRANT ALL ON TABLE "public"."crm_tasks" TO "service_role";



GRANT ALL ON TABLE "public"."cron_locks" TO "anon";
GRANT ALL ON TABLE "public"."cron_locks" TO "authenticated";
GRANT ALL ON TABLE "public"."cron_locks" TO "service_role";



GRANT ALL ON TABLE "public"."cultural_domains" TO "anon";
GRANT ALL ON TABLE "public"."cultural_domains" TO "authenticated";
GRANT ALL ON TABLE "public"."cultural_domains" TO "service_role";



GRANT ALL ON TABLE "public"."cultural_highlights" TO "anon";
GRANT ALL ON TABLE "public"."cultural_highlights" TO "authenticated";
GRANT ALL ON TABLE "public"."cultural_highlights" TO "service_role";



GRANT ALL ON TABLE "public"."cultural_inference_snapshots" TO "anon";
GRANT ALL ON TABLE "public"."cultural_inference_snapshots" TO "authenticated";
GRANT ALL ON TABLE "public"."cultural_inference_snapshots" TO "service_role";



GRANT ALL ON TABLE "public"."cultural_predictions" TO "anon";
GRANT ALL ON TABLE "public"."cultural_predictions" TO "authenticated";
GRANT ALL ON TABLE "public"."cultural_predictions" TO "service_role";



GRANT ALL ON TABLE "public"."cultural_profiles" TO "anon";
GRANT ALL ON TABLE "public"."cultural_profiles" TO "authenticated";
GRANT ALL ON TABLE "public"."cultural_profiles" TO "service_role";



GRANT ALL ON TABLE "public"."cultural_signals" TO "anon";
GRANT ALL ON TABLE "public"."cultural_signals" TO "authenticated";
GRANT ALL ON TABLE "public"."cultural_signals" TO "service_role";



GRANT ALL ON TABLE "public"."culture_alignment_log" TO "anon";
GRANT ALL ON TABLE "public"."culture_alignment_log" TO "authenticated";
GRANT ALL ON TABLE "public"."culture_alignment_log" TO "service_role";



GRANT ALL ON TABLE "public"."culture_contexts" TO "anon";
GRANT ALL ON TABLE "public"."culture_contexts" TO "authenticated";
GRANT ALL ON TABLE "public"."culture_contexts" TO "service_role";



GRANT ALL ON TABLE "public"."culture_norm_logs" TO "anon";
GRANT ALL ON TABLE "public"."culture_norm_logs" TO "authenticated";
GRANT ALL ON TABLE "public"."culture_norm_logs" TO "service_role";



GRANT ALL ON TABLE "public"."culture_profiles" TO "anon";
GRANT ALL ON TABLE "public"."culture_profiles" TO "authenticated";
GRANT ALL ON TABLE "public"."culture_profiles" TO "service_role";



GRANT ALL ON TABLE "public"."daily_briefs" TO "anon";
GRANT ALL ON TABLE "public"."daily_briefs" TO "authenticated";
GRANT ALL ON TABLE "public"."daily_briefs" TO "service_role";



GRANT ALL ON TABLE "public"."daily_quest_generation_runs" TO "anon";
GRANT ALL ON TABLE "public"."daily_quest_generation_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."daily_quest_generation_runs" TO "service_role";



GRANT ALL ON TABLE "public"."daily_timeline_views" TO "anon";
GRANT ALL ON TABLE "public"."daily_timeline_views" TO "authenticated";
GRANT ALL ON TABLE "public"."daily_timeline_views" TO "service_role";



GRANT ALL ON TABLE "public"."dash_layouts" TO "anon";
GRANT ALL ON TABLE "public"."dash_layouts" TO "authenticated";
GRANT ALL ON TABLE "public"."dash_layouts" TO "service_role";



GRANT ALL ON TABLE "public"."dash_panels" TO "anon";
GRANT ALL ON TABLE "public"."dash_panels" TO "authenticated";
GRANT ALL ON TABLE "public"."dash_panels" TO "service_role";



GRANT ALL ON TABLE "public"."dashboard_telemetry" TO "anon";
GRANT ALL ON TABLE "public"."dashboard_telemetry" TO "authenticated";
GRANT ALL ON TABLE "public"."dashboard_telemetry" TO "service_role";



GRANT ALL ON TABLE "public"."dashboard_telemetry_events" TO "anon";
GRANT ALL ON TABLE "public"."dashboard_telemetry_events" TO "authenticated";
GRANT ALL ON TABLE "public"."dashboard_telemetry_events" TO "service_role";



GRANT ALL ON TABLE "public"."day_plans" TO "anon";
GRANT ALL ON TABLE "public"."day_plans" TO "authenticated";
GRANT ALL ON TABLE "public"."day_plans" TO "service_role";



GRANT ALL ON TABLE "public"."deal_archetype_runs" TO "anon";
GRANT ALL ON TABLE "public"."deal_archetype_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."deal_archetype_runs" TO "service_role";



GRANT ALL ON TABLE "public"."deal_archetypes" TO "anon";
GRANT ALL ON TABLE "public"."deal_archetypes" TO "authenticated";
GRANT ALL ON TABLE "public"."deal_archetypes" TO "service_role";



GRANT ALL ON TABLE "public"."deal_intelligence" TO "anon";
GRANT ALL ON TABLE "public"."deal_intelligence" TO "authenticated";
GRANT ALL ON TABLE "public"."deal_intelligence" TO "service_role";



GRANT ALL ON TABLE "public"."deal_participants" TO "anon";
GRANT ALL ON TABLE "public"."deal_participants" TO "authenticated";
GRANT ALL ON TABLE "public"."deal_participants" TO "service_role";



GRANT ALL ON TABLE "public"."deal_stages" TO "anon";
GRANT ALL ON TABLE "public"."deal_stages" TO "authenticated";
GRANT ALL ON TABLE "public"."deal_stages" TO "service_role";



GRANT ALL ON TABLE "public"."deals" TO "anon";
GRANT ALL ON TABLE "public"."deals" TO "authenticated";
GRANT ALL ON TABLE "public"."deals" TO "service_role";



GRANT ALL ON TABLE "public"."decision_options" TO "anon";
GRANT ALL ON TABLE "public"."decision_options" TO "authenticated";
GRANT ALL ON TABLE "public"."decision_options" TO "service_role";



GRANT ALL ON TABLE "public"."decision_scenarios" TO "anon";
GRANT ALL ON TABLE "public"."decision_scenarios" TO "authenticated";
GRANT ALL ON TABLE "public"."decision_scenarios" TO "service_role";



GRANT ALL ON TABLE "public"."decision_tree_edges" TO "anon";
GRANT ALL ON TABLE "public"."decision_tree_edges" TO "authenticated";
GRANT ALL ON TABLE "public"."decision_tree_edges" TO "service_role";



GRANT ALL ON TABLE "public"."decision_tree_nodes" TO "anon";
GRANT ALL ON TABLE "public"."decision_tree_nodes" TO "authenticated";
GRANT ALL ON TABLE "public"."decision_tree_nodes" TO "service_role";



GRANT ALL ON TABLE "public"."decision_trees" TO "anon";
GRANT ALL ON TABLE "public"."decision_trees" TO "authenticated";
GRANT ALL ON TABLE "public"."decision_trees" TO "service_role";



GRANT ALL ON TABLE "public"."decisions" TO "anon";
GRANT ALL ON TABLE "public"."decisions" TO "authenticated";
GRANT ALL ON TABLE "public"."decisions" TO "service_role";



GRANT ALL ON TABLE "public"."delegated_drafts" TO "anon";
GRANT ALL ON TABLE "public"."delegated_drafts" TO "authenticated";
GRANT ALL ON TABLE "public"."delegated_drafts" TO "service_role";



GRANT ALL ON TABLE "public"."desire_profiles" TO "anon";
GRANT ALL ON TABLE "public"."desire_profiles" TO "authenticated";
GRANT ALL ON TABLE "public"."desire_profiles" TO "service_role";



GRANT ALL ON TABLE "public"."desire_signals" TO "anon";
GRANT ALL ON TABLE "public"."desire_signals" TO "authenticated";
GRANT ALL ON TABLE "public"."desire_signals" TO "service_role";



GRANT ALL ON TABLE "public"."destiny_alignment_log" TO "anon";
GRANT ALL ON TABLE "public"."destiny_alignment_log" TO "authenticated";
GRANT ALL ON TABLE "public"."destiny_alignment_log" TO "service_role";



GRANT ALL ON TABLE "public"."destiny_anchor_choices" TO "anon";
GRANT ALL ON TABLE "public"."destiny_anchor_choices" TO "authenticated";
GRANT ALL ON TABLE "public"."destiny_anchor_choices" TO "service_role";



GRANT ALL ON TABLE "public"."destiny_arcs" TO "anon";
GRANT ALL ON TABLE "public"."destiny_arcs" TO "authenticated";
GRANT ALL ON TABLE "public"."destiny_arcs" TO "service_role";



GRANT ALL ON TABLE "public"."destiny_blueprints" TO "anon";
GRANT ALL ON TABLE "public"."destiny_blueprints" TO "authenticated";
GRANT ALL ON TABLE "public"."destiny_blueprints" TO "service_role";



GRANT ALL ON TABLE "public"."destiny_checkpoints" TO "anon";
GRANT ALL ON TABLE "public"."destiny_checkpoints" TO "authenticated";
GRANT ALL ON TABLE "public"."destiny_checkpoints" TO "service_role";



GRANT ALL ON TABLE "public"."destiny_milestones" TO "anon";
GRANT ALL ON TABLE "public"."destiny_milestones" TO "authenticated";
GRANT ALL ON TABLE "public"."destiny_milestones" TO "service_role";



GRANT ALL ON TABLE "public"."destiny_simulation_runs" TO "anon";
GRANT ALL ON TABLE "public"."destiny_simulation_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."destiny_simulation_runs" TO "service_role";



GRANT ALL ON TABLE "public"."destiny_timeline_scores" TO "anon";
GRANT ALL ON TABLE "public"."destiny_timeline_scores" TO "authenticated";
GRANT ALL ON TABLE "public"."destiny_timeline_scores" TO "service_role";



GRANT ALL ON TABLE "public"."destiny_timelines" TO "anon";
GRANT ALL ON TABLE "public"."destiny_timelines" TO "authenticated";
GRANT ALL ON TABLE "public"."destiny_timelines" TO "service_role";



GRANT ALL ON TABLE "public"."destiny_waypoints" TO "anon";
GRANT ALL ON TABLE "public"."destiny_waypoints" TO "authenticated";
GRANT ALL ON TABLE "public"."destiny_waypoints" TO "service_role";



GRANT ALL ON TABLE "public"."domain_kpis" TO "anon";
GRANT ALL ON TABLE "public"."domain_kpis" TO "authenticated";
GRANT ALL ON TABLE "public"."domain_kpis" TO "service_role";



GRANT ALL ON TABLE "public"."efc_action_sequences" TO "anon";
GRANT ALL ON TABLE "public"."efc_action_sequences" TO "authenticated";
GRANT ALL ON TABLE "public"."efc_action_sequences" TO "service_role";



GRANT ALL ON TABLE "public"."efc_commitments" TO "anon";
GRANT ALL ON TABLE "public"."efc_commitments" TO "authenticated";
GRANT ALL ON TABLE "public"."efc_commitments" TO "service_role";



GRANT ALL ON TABLE "public"."efc_energy_states" TO "anon";
GRANT ALL ON TABLE "public"."efc_energy_states" TO "authenticated";
GRANT ALL ON TABLE "public"."efc_energy_states" TO "service_role";



GRANT ALL ON TABLE "public"."efc_execution_log" TO "anon";
GRANT ALL ON TABLE "public"."efc_execution_log" TO "authenticated";
GRANT ALL ON TABLE "public"."efc_execution_log" TO "service_role";



GRANT ALL ON TABLE "public"."efc_generated_actions" TO "anon";
GRANT ALL ON TABLE "public"."efc_generated_actions" TO "authenticated";
GRANT ALL ON TABLE "public"."efc_generated_actions" TO "service_role";



GRANT ALL ON TABLE "public"."efc_nudges" TO "anon";
GRANT ALL ON TABLE "public"."efc_nudges" TO "authenticated";
GRANT ALL ON TABLE "public"."efc_nudges" TO "service_role";



GRANT ALL ON TABLE "public"."email_accounts" TO "anon";
GRANT ALL ON TABLE "public"."email_accounts" TO "authenticated";
GRANT ALL ON TABLE "public"."email_accounts" TO "service_role";



GRANT ALL ON TABLE "public"."email_actions" TO "anon";
GRANT ALL ON TABLE "public"."email_actions" TO "authenticated";
GRANT ALL ON TABLE "public"."email_actions" TO "service_role";



GRANT ALL ON TABLE "public"."email_daily_briefs" TO "anon";
GRANT ALL ON TABLE "public"."email_daily_briefs" TO "authenticated";
GRANT ALL ON TABLE "public"."email_daily_briefs" TO "service_role";



GRANT ALL ON TABLE "public"."email_drafts" TO "anon";
GRANT ALL ON TABLE "public"."email_drafts" TO "authenticated";
GRANT ALL ON TABLE "public"."email_drafts" TO "service_role";



GRANT ALL ON TABLE "public"."email_events" TO "anon";
GRANT ALL ON TABLE "public"."email_events" TO "authenticated";
GRANT ALL ON TABLE "public"."email_events" TO "service_role";



GRANT ALL ON TABLE "public"."email_followups" TO "anon";
GRANT ALL ON TABLE "public"."email_followups" TO "authenticated";
GRANT ALL ON TABLE "public"."email_followups" TO "service_role";



GRANT ALL ON TABLE "public"."email_items" TO "anon";
GRANT ALL ON TABLE "public"."email_items" TO "authenticated";
GRANT ALL ON TABLE "public"."email_items" TO "service_role";



GRANT ALL ON TABLE "public"."email_messages" TO "anon";
GRANT ALL ON TABLE "public"."email_messages" TO "authenticated";
GRANT ALL ON TABLE "public"."email_messages" TO "service_role";



GRANT ALL ON TABLE "public"."email_resolution" TO "anon";
GRANT ALL ON TABLE "public"."email_resolution" TO "authenticated";
GRANT ALL ON TABLE "public"."email_resolution" TO "service_role";



GRANT ALL ON TABLE "public"."email_send_audit" TO "anon";
GRANT ALL ON TABLE "public"."email_send_audit" TO "authenticated";
GRANT ALL ON TABLE "public"."email_send_audit" TO "service_role";



GRANT ALL ON TABLE "public"."email_suggested_drafts" TO "anon";
GRANT ALL ON TABLE "public"."email_suggested_drafts" TO "authenticated";
GRANT ALL ON TABLE "public"."email_suggested_drafts" TO "service_role";



GRANT ALL ON TABLE "public"."email_threads" TO "anon";
GRANT ALL ON TABLE "public"."email_threads" TO "authenticated";
GRANT ALL ON TABLE "public"."email_threads" TO "service_role";



GRANT ALL ON TABLE "public"."email_triage_items" TO "anon";
GRANT ALL ON TABLE "public"."email_triage_items" TO "authenticated";
GRANT ALL ON TABLE "public"."email_triage_items" TO "service_role";



GRANT ALL ON TABLE "public"."emails" TO "anon";
GRANT ALL ON TABLE "public"."emails" TO "authenticated";
GRANT ALL ON TABLE "public"."emails" TO "service_role";



GRANT ALL ON TABLE "public"."emo_adaptive_responses" TO "anon";
GRANT ALL ON TABLE "public"."emo_adaptive_responses" TO "authenticated";
GRANT ALL ON TABLE "public"."emo_adaptive_responses" TO "service_role";



GRANT ALL ON TABLE "public"."emo_checkins" TO "anon";
GRANT ALL ON TABLE "public"."emo_checkins" TO "authenticated";
GRANT ALL ON TABLE "public"."emo_checkins" TO "service_role";



GRANT ALL ON TABLE "public"."emo_goals" TO "anon";
GRANT ALL ON TABLE "public"."emo_goals" TO "authenticated";
GRANT ALL ON TABLE "public"."emo_goals" TO "service_role";



GRANT ALL ON TABLE "public"."emo_interventions" TO "anon";
GRANT ALL ON TABLE "public"."emo_interventions" TO "authenticated";
GRANT ALL ON TABLE "public"."emo_interventions" TO "service_role";



GRANT ALL ON TABLE "public"."emo_profiles" TO "anon";
GRANT ALL ON TABLE "public"."emo_profiles" TO "authenticated";
GRANT ALL ON TABLE "public"."emo_profiles" TO "service_role";



GRANT ALL ON TABLE "public"."emo_states" TO "anon";
GRANT ALL ON TABLE "public"."emo_states" TO "authenticated";
GRANT ALL ON TABLE "public"."emo_states" TO "service_role";



GRANT ALL ON TABLE "public"."emo_transitions" TO "anon";
GRANT ALL ON TABLE "public"."emo_transitions" TO "authenticated";
GRANT ALL ON TABLE "public"."emo_transitions" TO "service_role";



GRANT ALL ON TABLE "public"."emotion_channel_settings" TO "anon";
GRANT ALL ON TABLE "public"."emotion_channel_settings" TO "authenticated";
GRANT ALL ON TABLE "public"."emotion_channel_settings" TO "service_role";



GRANT ALL ON TABLE "public"."emotion_interaction_log" TO "anon";
GRANT ALL ON TABLE "public"."emotion_interaction_log" TO "authenticated";
GRANT ALL ON TABLE "public"."emotion_interaction_log" TO "service_role";



GRANT ALL ON TABLE "public"."emotion_resonance_events" TO "anon";
GRANT ALL ON TABLE "public"."emotion_resonance_events" TO "authenticated";
GRANT ALL ON TABLE "public"."emotion_resonance_events" TO "service_role";



GRANT ALL ON TABLE "public"."emotion_samples" TO "anon";
GRANT ALL ON TABLE "public"."emotion_samples" TO "authenticated";
GRANT ALL ON TABLE "public"."emotion_samples" TO "service_role";



GRANT ALL ON TABLE "public"."emotion_state_daily" TO "anon";
GRANT ALL ON TABLE "public"."emotion_state_daily" TO "authenticated";
GRANT ALL ON TABLE "public"."emotion_state_daily" TO "service_role";



GRANT ALL ON TABLE "public"."emotion_style_profile" TO "anon";
GRANT ALL ON TABLE "public"."emotion_style_profile" TO "authenticated";
GRANT ALL ON TABLE "public"."emotion_style_profile" TO "service_role";



GRANT ALL ON TABLE "public"."emotional_checkins" TO "anon";
GRANT ALL ON TABLE "public"."emotional_checkins" TO "authenticated";
GRANT ALL ON TABLE "public"."emotional_checkins" TO "service_role";



GRANT ALL ON TABLE "public"."emotional_patterns" TO "anon";
GRANT ALL ON TABLE "public"."emotional_patterns" TO "authenticated";
GRANT ALL ON TABLE "public"."emotional_patterns" TO "service_role";



GRANT ALL ON TABLE "public"."emotional_support_logs" TO "anon";
GRANT ALL ON TABLE "public"."emotional_support_logs" TO "authenticated";
GRANT ALL ON TABLE "public"."emotional_support_logs" TO "service_role";



GRANT ALL ON TABLE "public"."empathic_events" TO "anon";
GRANT ALL ON TABLE "public"."empathic_events" TO "authenticated";
GRANT ALL ON TABLE "public"."empathic_events" TO "service_role";



GRANT ALL ON TABLE "public"."ethical_policies" TO "anon";
GRANT ALL ON TABLE "public"."ethical_policies" TO "authenticated";
GRANT ALL ON TABLE "public"."ethical_policies" TO "service_role";



GRANT ALL ON TABLE "public"."execution_logs" TO "anon";
GRANT ALL ON TABLE "public"."execution_logs" TO "authenticated";
GRANT ALL ON TABLE "public"."execution_logs" TO "service_role";



GRANT ALL ON TABLE "public"."execution_runs" TO "anon";
GRANT ALL ON TABLE "public"."execution_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."execution_runs" TO "service_role";



GRANT ALL ON TABLE "public"."executions" TO "anon";
GRANT ALL ON TABLE "public"."executions" TO "authenticated";
GRANT ALL ON TABLE "public"."executions" TO "service_role";



GRANT ALL ON TABLE "public"."executive_council_members" TO "anon";
GRANT ALL ON TABLE "public"."executive_council_members" TO "authenticated";
GRANT ALL ON TABLE "public"."executive_council_members" TO "service_role";



GRANT ALL ON TABLE "public"."executive_council_votes" TO "anon";
GRANT ALL ON TABLE "public"."executive_council_votes" TO "authenticated";
GRANT ALL ON TABLE "public"."executive_council_votes" TO "service_role";



GRANT ALL ON TABLE "public"."executive_summaries" TO "anon";
GRANT ALL ON TABLE "public"."executive_summaries" TO "authenticated";
GRANT ALL ON TABLE "public"."executive_summaries" TO "service_role";



GRANT ALL ON TABLE "public"."experience_events" TO "anon";
GRANT ALL ON TABLE "public"."experience_events" TO "authenticated";
GRANT ALL ON TABLE "public"."experience_events" TO "service_role";



GRANT ALL ON TABLE "public"."experiment_metrics" TO "anon";
GRANT ALL ON TABLE "public"."experiment_metrics" TO "authenticated";
GRANT ALL ON TABLE "public"."experiment_metrics" TO "service_role";



GRANT ALL ON TABLE "public"."experiment_templates" TO "anon";
GRANT ALL ON TABLE "public"."experiment_templates" TO "authenticated";
GRANT ALL ON TABLE "public"."experiment_templates" TO "service_role";



GRANT ALL ON TABLE "public"."feedback" TO "anon";
GRANT ALL ON TABLE "public"."feedback" TO "authenticated";
GRANT ALL ON TABLE "public"."feedback" TO "service_role";



GRANT ALL ON TABLE "public"."finance_accounts" TO "anon";
GRANT ALL ON TABLE "public"."finance_accounts" TO "authenticated";
GRANT ALL ON TABLE "public"."finance_accounts" TO "service_role";



GRANT ALL ON TABLE "public"."finance_alerts" TO "anon";
GRANT ALL ON TABLE "public"."finance_alerts" TO "authenticated";
GRANT ALL ON TABLE "public"."finance_alerts" TO "service_role";



GRANT ALL ON TABLE "public"."finance_budgets" TO "anon";
GRANT ALL ON TABLE "public"."finance_budgets" TO "authenticated";
GRANT ALL ON TABLE "public"."finance_budgets" TO "service_role";



GRANT ALL ON TABLE "public"."finance_goals" TO "anon";
GRANT ALL ON TABLE "public"."finance_goals" TO "authenticated";
GRANT ALL ON TABLE "public"."finance_goals" TO "service_role";



GRANT ALL ON TABLE "public"."finance_snapshots" TO "anon";
GRANT ALL ON TABLE "public"."finance_snapshots" TO "authenticated";
GRANT ALL ON TABLE "public"."finance_snapshots" TO "service_role";



GRANT ALL ON TABLE "public"."finance_transactions" TO "anon";
GRANT ALL ON TABLE "public"."finance_transactions" TO "authenticated";
GRANT ALL ON TABLE "public"."finance_transactions" TO "service_role";



GRANT ALL ON TABLE "public"."financial_accounts" TO "anon";
GRANT ALL ON TABLE "public"."financial_accounts" TO "authenticated";
GRANT ALL ON TABLE "public"."financial_accounts" TO "service_role";



GRANT ALL ON TABLE "public"."financial_budget_envelopes" TO "anon";
GRANT ALL ON TABLE "public"."financial_budget_envelopes" TO "authenticated";
GRANT ALL ON TABLE "public"."financial_budget_envelopes" TO "service_role";



GRANT ALL ON TABLE "public"."financial_budgets" TO "anon";
GRANT ALL ON TABLE "public"."financial_budgets" TO "authenticated";
GRANT ALL ON TABLE "public"."financial_budgets" TO "service_role";



GRANT ALL ON TABLE "public"."financial_connections" TO "anon";
GRANT ALL ON TABLE "public"."financial_connections" TO "authenticated";
GRANT ALL ON TABLE "public"."financial_connections" TO "service_role";



GRANT ALL ON TABLE "public"."financial_entities" TO "anon";
GRANT ALL ON TABLE "public"."financial_entities" TO "authenticated";
GRANT ALL ON TABLE "public"."financial_entities" TO "service_role";



GRANT ALL ON TABLE "public"."financial_imported_transactions" TO "anon";
GRANT ALL ON TABLE "public"."financial_imported_transactions" TO "authenticated";
GRANT ALL ON TABLE "public"."financial_imported_transactions" TO "service_role";



GRANT ALL ON TABLE "public"."financial_ledger_entries" TO "anon";
GRANT ALL ON TABLE "public"."financial_ledger_entries" TO "authenticated";
GRANT ALL ON TABLE "public"."financial_ledger_entries" TO "service_role";



GRANT ALL ON TABLE "public"."financial_ledger_lines" TO "anon";
GRANT ALL ON TABLE "public"."financial_ledger_lines" TO "authenticated";
GRANT ALL ON TABLE "public"."financial_ledger_lines" TO "service_role";



GRANT ALL ON TABLE "public"."financial_snapshots" TO "anon";
GRANT ALL ON TABLE "public"."financial_snapshots" TO "authenticated";
GRANT ALL ON TABLE "public"."financial_snapshots" TO "service_role";



GRANT ALL ON TABLE "public"."focus_locks" TO "anon";
GRANT ALL ON TABLE "public"."focus_locks" TO "authenticated";
GRANT ALL ON TABLE "public"."focus_locks" TO "service_role";



GRANT ALL ON TABLE "public"."focus_sessions" TO "anon";
GRANT ALL ON TABLE "public"."focus_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."focus_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."follow_ups" TO "anon";
GRANT ALL ON TABLE "public"."follow_ups" TO "authenticated";
GRANT ALL ON TABLE "public"."follow_ups" TO "service_role";



GRANT ALL ON TABLE "public"."gift_ideas" TO "anon";
GRANT ALL ON TABLE "public"."gift_ideas" TO "authenticated";
GRANT ALL ON TABLE "public"."gift_ideas" TO "service_role";



GRANT ALL ON TABLE "public"."goal_hierarchy" TO "anon";
GRANT ALL ON TABLE "public"."goal_hierarchy" TO "authenticated";
GRANT ALL ON TABLE "public"."goal_hierarchy" TO "service_role";



GRANT ALL ON TABLE "public"."goals" TO "anon";
GRANT ALL ON TABLE "public"."goals" TO "authenticated";
GRANT ALL ON TABLE "public"."goals" TO "service_role";



GRANT ALL ON TABLE "public"."guardrail_events" TO "anon";
GRANT ALL ON TABLE "public"."guardrail_events" TO "authenticated";
GRANT ALL ON TABLE "public"."guardrail_events" TO "service_role";



GRANT ALL ON TABLE "public"."habit_completions" TO "anon";
GRANT ALL ON TABLE "public"."habit_completions" TO "authenticated";
GRANT ALL ON TABLE "public"."habit_completions" TO "service_role";



GRANT ALL ON TABLE "public"."habit_logs" TO "anon";
GRANT ALL ON TABLE "public"."habit_logs" TO "authenticated";
GRANT ALL ON TABLE "public"."habit_logs" TO "service_role";



GRANT ALL ON TABLE "public"."habit_streaks" TO "anon";
GRANT ALL ON TABLE "public"."habit_streaks" TO "authenticated";
GRANT ALL ON TABLE "public"."habit_streaks" TO "service_role";



GRANT ALL ON TABLE "public"."habits" TO "anon";
GRANT ALL ON TABLE "public"."habits" TO "authenticated";
GRANT ALL ON TABLE "public"."habits" TO "service_role";



GRANT ALL ON TABLE "public"."pulse_events" TO "anon";
GRANT ALL ON TABLE "public"."pulse_events" TO "authenticated";
GRANT ALL ON TABLE "public"."pulse_events" TO "service_role";



GRANT ALL ON TABLE "public"."tasks" TO "anon";
GRANT ALL ON TABLE "public"."tasks" TO "authenticated";
GRANT ALL ON TABLE "public"."tasks" TO "service_role";



GRANT ALL ON TABLE "public"."health_core_summary" TO "anon";
GRANT ALL ON TABLE "public"."health_core_summary" TO "authenticated";
GRANT ALL ON TABLE "public"."health_core_summary" TO "service_role";



GRANT ALL ON TABLE "public"."health_rls_status" TO "anon";
GRANT ALL ON TABLE "public"."health_rls_status" TO "authenticated";
GRANT ALL ON TABLE "public"."health_rls_status" TO "service_role";



GRANT ALL ON TABLE "public"."household_members" TO "anon";
GRANT ALL ON TABLE "public"."household_members" TO "authenticated";
GRANT ALL ON TABLE "public"."household_members" TO "service_role";



GRANT ALL ON TABLE "public"."households" TO "anon";
GRANT ALL ON TABLE "public"."households" TO "authenticated";
GRANT ALL ON TABLE "public"."households" TO "service_role";



GRANT ALL ON TABLE "public"."id_aspirations" TO "anon";
GRANT ALL ON TABLE "public"."id_aspirations" TO "authenticated";
GRANT ALL ON TABLE "public"."id_aspirations" TO "service_role";



GRANT ALL ON TABLE "public"."id_beliefs" TO "anon";
GRANT ALL ON TABLE "public"."id_beliefs" TO "authenticated";
GRANT ALL ON TABLE "public"."id_beliefs" TO "service_role";



GRANT ALL ON TABLE "public"."id_growth_areas" TO "anon";
GRANT ALL ON TABLE "public"."id_growth_areas" TO "authenticated";
GRANT ALL ON TABLE "public"."id_growth_areas" TO "service_role";



GRANT ALL ON TABLE "public"."id_momentum_daily" TO "anon";
GRANT ALL ON TABLE "public"."id_momentum_daily" TO "authenticated";
GRANT ALL ON TABLE "public"."id_momentum_daily" TO "service_role";



GRANT ALL ON TABLE "public"."id_narrative_chapters" TO "anon";
GRANT ALL ON TABLE "public"."id_narrative_chapters" TO "authenticated";
GRANT ALL ON TABLE "public"."id_narrative_chapters" TO "service_role";



GRANT ALL ON TABLE "public"."id_roles" TO "anon";
GRANT ALL ON TABLE "public"."id_roles" TO "authenticated";
GRANT ALL ON TABLE "public"."id_roles" TO "service_role";



GRANT ALL ON TABLE "public"."id_snapshots" TO "anon";
GRANT ALL ON TABLE "public"."id_snapshots" TO "authenticated";
GRANT ALL ON TABLE "public"."id_snapshots" TO "service_role";



GRANT ALL ON TABLE "public"."id_strengths" TO "anon";
GRANT ALL ON TABLE "public"."id_strengths" TO "authenticated";
GRANT ALL ON TABLE "public"."id_strengths" TO "service_role";



GRANT ALL ON TABLE "public"."id_values" TO "anon";
GRANT ALL ON TABLE "public"."id_values" TO "authenticated";
GRANT ALL ON TABLE "public"."id_values" TO "service_role";



GRANT ALL ON TABLE "public"."identity_arcs" TO "anon";
GRANT ALL ON TABLE "public"."identity_arcs" TO "authenticated";
GRANT ALL ON TABLE "public"."identity_arcs" TO "service_role";



GRANT ALL ON TABLE "public"."identity_events" TO "anon";
GRANT ALL ON TABLE "public"."identity_events" TO "authenticated";
GRANT ALL ON TABLE "public"."identity_events" TO "service_role";



GRANT ALL ON TABLE "public"."identity_transforms" TO "anon";
GRANT ALL ON TABLE "public"."identity_transforms" TO "authenticated";
GRANT ALL ON TABLE "public"."identity_transforms" TO "service_role";



GRANT ALL ON TABLE "public"."inbox_actions" TO "anon";
GRANT ALL ON TABLE "public"."inbox_actions" TO "authenticated";
GRANT ALL ON TABLE "public"."inbox_actions" TO "service_role";



GRANT ALL ON TABLE "public"."inbox_items" TO "anon";
GRANT ALL ON TABLE "public"."inbox_items" TO "authenticated";
GRANT ALL ON TABLE "public"."inbox_items" TO "service_role";



GRANT ALL ON TABLE "public"."inbox_rule_outcomes" TO "anon";
GRANT ALL ON TABLE "public"."inbox_rule_outcomes" TO "authenticated";
GRANT ALL ON TABLE "public"."inbox_rule_outcomes" TO "service_role";



GRANT ALL ON TABLE "public"."inbox_rule_runs" TO "anon";
GRANT ALL ON TABLE "public"."inbox_rule_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."inbox_rule_runs" TO "service_role";



GRANT ALL ON TABLE "public"."inbox_rules" TO "anon";
GRANT ALL ON TABLE "public"."inbox_rules" TO "authenticated";
GRANT ALL ON TABLE "public"."inbox_rules" TO "service_role";



GRANT ALL ON TABLE "public"."inbox_triage_events" TO "anon";
GRANT ALL ON TABLE "public"."inbox_triage_events" TO "authenticated";
GRANT ALL ON TABLE "public"."inbox_triage_events" TO "service_role";



GRANT ALL ON TABLE "public"."industries" TO "anon";
GRANT ALL ON TABLE "public"."industries" TO "authenticated";
GRANT ALL ON TABLE "public"."industries" TO "service_role";



GRANT ALL ON TABLE "public"."inner_monologue_entries" TO "anon";
GRANT ALL ON TABLE "public"."inner_monologue_entries" TO "authenticated";
GRANT ALL ON TABLE "public"."inner_monologue_entries" TO "service_role";



GRANT ALL ON TABLE "public"."inner_monologue_turns" TO "anon";
GRANT ALL ON TABLE "public"."inner_monologue_turns" TO "authenticated";
GRANT ALL ON TABLE "public"."inner_monologue_turns" TO "service_role";



GRANT ALL ON TABLE "public"."interaction_events" TO "anon";
GRANT ALL ON TABLE "public"."interaction_events" TO "authenticated";
GRANT ALL ON TABLE "public"."interaction_events" TO "service_role";



GRANT ALL ON TABLE "public"."interactions" TO "anon";
GRANT ALL ON TABLE "public"."interactions" TO "authenticated";
GRANT ALL ON TABLE "public"."interactions" TO "service_role";



GRANT ALL ON TABLE "public"."job_categories" TO "anon";
GRANT ALL ON TABLE "public"."job_categories" TO "authenticated";
GRANT ALL ON TABLE "public"."job_categories" TO "service_role";



GRANT ALL ON TABLE "public"."job_graph_nodes" TO "anon";
GRANT ALL ON TABLE "public"."job_graph_nodes" TO "authenticated";
GRANT ALL ON TABLE "public"."job_graph_nodes" TO "service_role";



GRANT ALL ON TABLE "public"."job_kpis" TO "anon";
GRANT ALL ON TABLE "public"."job_kpis" TO "authenticated";
GRANT ALL ON TABLE "public"."job_kpis" TO "service_role";



GRANT ALL ON TABLE "public"."job_provider_health" TO "anon";
GRANT ALL ON TABLE "public"."job_provider_health" TO "authenticated";
GRANT ALL ON TABLE "public"."job_provider_health" TO "service_role";



GRANT ALL ON TABLE "public"."job_provider_health_view" TO "anon";
GRANT ALL ON TABLE "public"."job_provider_health_view" TO "authenticated";
GRANT ALL ON TABLE "public"."job_provider_health_view" TO "service_role";



GRANT ALL ON TABLE "public"."job_provider_incidents" TO "anon";
GRANT ALL ON TABLE "public"."job_provider_incidents" TO "authenticated";
GRANT ALL ON TABLE "public"."job_provider_incidents" TO "service_role";



GRANT ALL ON SEQUENCE "public"."job_provider_incidents_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."job_provider_incidents_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."job_provider_incidents_id_seq" TO "service_role";



GRANT ALL ON TABLE "public"."job_provider_incidents_recent" TO "anon";
GRANT ALL ON TABLE "public"."job_provider_incidents_recent" TO "authenticated";
GRANT ALL ON TABLE "public"."job_provider_incidents_recent" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue" TO "anon";
GRANT ALL ON TABLE "public"."job_queue" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_agent_budgets" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_agent_budgets" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_agent_budgets" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_agents" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_agents" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_agents" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_alerts" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_alerts" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_alerts" TO "service_role";



GRANT ALL ON SEQUENCE "public"."job_queue_alerts_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."job_queue_alerts_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."job_queue_alerts_id_seq" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_budget_ledger" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_budget_ledger" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_budget_ledger" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_budget_rollover" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_budget_rollover" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_budget_rollover" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_credit_balances" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_credit_balances" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_credit_balances" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_credits_ledger" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_credits_ledger" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_credits_ledger" TO "service_role";



GRANT ALL ON SEQUENCE "public"."job_queue_credits_ledger_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."job_queue_credits_ledger_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."job_queue_credits_ledger_id_seq" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_daily_budget" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_daily_budget" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_daily_budget" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_events" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_events" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_events" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_events_c9" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_events_c9" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_events_c9" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_fairness_ledger" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_fairness_ledger" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_fairness_ledger" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_health_snapshots" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_health_snapshots" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_health_snapshots" TO "service_role";



GRANT ALL ON SEQUENCE "public"."job_queue_health_snapshots_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."job_queue_health_snapshots_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."job_queue_health_snapshots_id_seq" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_lane_quota" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_lane_quota" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_lane_quota" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_metrics_daily" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_metrics_daily" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_metrics_daily" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_pricing" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_pricing" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_pricing" TO "service_role";



GRANT ALL ON SEQUENCE "public"."job_queue_pricing_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."job_queue_pricing_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."job_queue_pricing_id_seq" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_rate_window" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_rate_window" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_rate_window" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_reliability_24h" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_reliability_24h" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_reliability_24h" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_results" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_results" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_results" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_scheduler_decisions" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_scheduler_decisions" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_scheduler_decisions" TO "service_role";



GRANT ALL ON SEQUENCE "public"."job_queue_scheduler_decisions_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."job_queue_scheduler_decisions_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."job_queue_scheduler_decisions_id_seq" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_tiers" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_tiers" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_tiers" TO "service_role";



GRANT ALL ON TABLE "public"."job_queue_user_tiers" TO "anon";
GRANT ALL ON TABLE "public"."job_queue_user_tiers" TO "authenticated";
GRANT ALL ON TABLE "public"."job_queue_user_tiers" TO "service_role";



GRANT ALL ON TABLE "public"."job_requests" TO "anon";
GRANT ALL ON TABLE "public"."job_requests" TO "authenticated";
GRANT ALL ON TABLE "public"."job_requests" TO "service_role";



GRANT ALL ON TABLE "public"."job_runs" TO "anon";
GRANT ALL ON TABLE "public"."job_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."job_runs" TO "service_role";



GRANT ALL ON TABLE "public"."job_scorecards" TO "anon";
GRANT ALL ON TABLE "public"."job_scorecards" TO "authenticated";
GRANT ALL ON TABLE "public"."job_scorecards" TO "service_role";



GRANT ALL ON TABLE "public"."job_titles" TO "anon";
GRANT ALL ON TABLE "public"."job_titles" TO "authenticated";
GRANT ALL ON TABLE "public"."job_titles" TO "service_role";



GRANT ALL ON TABLE "public"."job_verticals" TO "anon";
GRANT ALL ON TABLE "public"."job_verticals" TO "authenticated";
GRANT ALL ON TABLE "public"."job_verticals" TO "service_role";



GRANT ALL ON TABLE "public"."journal_entries" TO "anon";
GRANT ALL ON TABLE "public"."journal_entries" TO "authenticated";
GRANT ALL ON TABLE "public"."journal_entries" TO "service_role";



GRANT ALL ON TABLE "public"."knowledge_context_links" TO "anon";
GRANT ALL ON TABLE "public"."knowledge_context_links" TO "authenticated";
GRANT ALL ON TABLE "public"."knowledge_context_links" TO "service_role";



GRANT ALL ON TABLE "public"."knowledge_contexts" TO "anon";
GRANT ALL ON TABLE "public"."knowledge_contexts" TO "authenticated";
GRANT ALL ON TABLE "public"."knowledge_contexts" TO "service_role";



GRANT ALL ON TABLE "public"."knowledge_edges" TO "anon";
GRANT ALL ON TABLE "public"."knowledge_edges" TO "authenticated";
GRANT ALL ON TABLE "public"."knowledge_edges" TO "service_role";



GRANT ALL ON TABLE "public"."knowledge_nodes" TO "anon";
GRANT ALL ON TABLE "public"."knowledge_nodes" TO "authenticated";
GRANT ALL ON TABLE "public"."knowledge_nodes" TO "service_role";



GRANT ALL ON TABLE "public"."lb_daily_metrics" TO "anon";
GRANT ALL ON TABLE "public"."lb_daily_metrics" TO "authenticated";
GRANT ALL ON TABLE "public"."lb_daily_metrics" TO "service_role";



GRANT ALL ON TABLE "public"."lb_insights" TO "anon";
GRANT ALL ON TABLE "public"."lb_insights" TO "authenticated";
GRANT ALL ON TABLE "public"."lb_insights" TO "service_role";



GRANT ALL ON TABLE "public"."league_members" TO "anon";
GRANT ALL ON TABLE "public"."league_members" TO "authenticated";
GRANT ALL ON TABLE "public"."league_members" TO "service_role";



GRANT ALL ON TABLE "public"."league_scores" TO "anon";
GRANT ALL ON TABLE "public"."league_scores" TO "authenticated";
GRANT ALL ON TABLE "public"."league_scores" TO "service_role";



GRANT ALL ON TABLE "public"."leagues" TO "anon";
GRANT ALL ON TABLE "public"."leagues" TO "authenticated";
GRANT ALL ON TABLE "public"."leagues" TO "service_role";



GRANT ALL ON TABLE "public"."life_arc_autopilot_runs" TO "anon";
GRANT ALL ON TABLE "public"."life_arc_autopilot_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."life_arc_autopilot_runs" TO "service_role";



GRANT ALL ON TABLE "public"."life_arc_autopilot_suggestions" TO "anon";
GRANT SELECT,INSERT,REFERENCES,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE "public"."life_arc_autopilot_suggestions" TO "authenticated";
GRANT ALL ON TABLE "public"."life_arc_autopilot_suggestions" TO "service_role";



GRANT ALL ON TABLE "public"."life_arc_checkpoints" TO "anon";
GRANT ALL ON TABLE "public"."life_arc_checkpoints" TO "authenticated";
GRANT ALL ON TABLE "public"."life_arc_checkpoints" TO "service_role";



GRANT ALL ON TABLE "public"."life_arc_daily_focus" TO "anon";
GRANT ALL ON TABLE "public"."life_arc_daily_focus" TO "authenticated";
GRANT ALL ON TABLE "public"."life_arc_daily_focus" TO "service_role";



GRANT ALL ON TABLE "public"."life_arc_objectives" TO "anon";
GRANT ALL ON TABLE "public"."life_arc_objectives" TO "authenticated";
GRANT ALL ON TABLE "public"."life_arc_objectives" TO "service_role";



GRANT ALL ON TABLE "public"."life_arc_quests" TO "anon";
GRANT ALL ON TABLE "public"."life_arc_quests" TO "authenticated";
GRANT ALL ON TABLE "public"."life_arc_quests" TO "service_role";



GRANT ALL ON TABLE "public"."life_arc_risk_events" TO "anon";
GRANT ALL ON TABLE "public"."life_arc_risk_events" TO "authenticated";
GRANT ALL ON TABLE "public"."life_arc_risk_events" TO "service_role";



GRANT ALL ON TABLE "public"."life_arc_sources" TO "anon";
GRANT ALL ON TABLE "public"."life_arc_sources" TO "authenticated";
GRANT ALL ON TABLE "public"."life_arc_sources" TO "service_role";



GRANT ALL ON TABLE "public"."life_arcs" TO "anon";
GRANT ALL ON TABLE "public"."life_arcs" TO "authenticated";
GRANT ALL ON TABLE "public"."life_arcs" TO "service_role";



GRANT ALL ON TABLE "public"."life_canon_entries" TO "anon";
GRANT ALL ON TABLE "public"."life_canon_entries" TO "authenticated";
GRANT ALL ON TABLE "public"."life_canon_entries" TO "service_role";



GRANT ALL ON TABLE "public"."life_canon_snapshots" TO "anon";
GRANT ALL ON TABLE "public"."life_canon_snapshots" TO "authenticated";
GRANT ALL ON TABLE "public"."life_canon_snapshots" TO "service_role";



GRANT ALL ON TABLE "public"."life_chapters" TO "anon";
GRANT ALL ON TABLE "public"."life_chapters" TO "authenticated";
GRANT ALL ON TABLE "public"."life_chapters" TO "service_role";



GRANT ALL ON TABLE "public"."life_domains" TO "anon";
GRANT ALL ON TABLE "public"."life_domains" TO "authenticated";
GRANT ALL ON TABLE "public"."life_domains" TO "service_role";



GRANT ALL ON TABLE "public"."life_events" TO "anon";
GRANT ALL ON TABLE "public"."life_events" TO "authenticated";
GRANT ALL ON TABLE "public"."life_events" TO "service_role";



GRANT ALL ON TABLE "public"."life_evidence" TO "anon";
GRANT ALL ON TABLE "public"."life_evidence" TO "authenticated";
GRANT ALL ON TABLE "public"."life_evidence" TO "service_role";



GRANT ALL ON TABLE "public"."life_themes" TO "anon";
GRANT ALL ON TABLE "public"."life_themes" TO "authenticated";
GRANT ALL ON TABLE "public"."life_themes" TO "service_role";



GRANT ALL ON TABLE "public"."long_chapters" TO "anon";
GRANT ALL ON TABLE "public"."long_chapters" TO "authenticated";
GRANT ALL ON TABLE "public"."long_chapters" TO "service_role";



GRANT ALL ON TABLE "public"."long_milestones" TO "anon";
GRANT ALL ON TABLE "public"."long_milestones" TO "authenticated";
GRANT ALL ON TABLE "public"."long_milestones" TO "service_role";



GRANT ALL ON TABLE "public"."long_predictions" TO "anon";
GRANT ALL ON TABLE "public"."long_predictions" TO "authenticated";
GRANT ALL ON TABLE "public"."long_predictions" TO "service_role";



GRANT ALL ON TABLE "public"."long_snapshots" TO "anon";
GRANT ALL ON TABLE "public"."long_snapshots" TO "authenticated";
GRANT ALL ON TABLE "public"."long_snapshots" TO "service_role";



GRANT ALL ON TABLE "public"."long_trajectories" TO "anon";
GRANT ALL ON TABLE "public"."long_trajectories" TO "authenticated";
GRANT ALL ON TABLE "public"."long_trajectories" TO "service_role";



GRANT ALL ON TABLE "public"."long_trends" TO "anon";
GRANT ALL ON TABLE "public"."long_trends" TO "authenticated";
GRANT ALL ON TABLE "public"."long_trends" TO "service_role";



GRANT ALL ON TABLE "public"."mc_events" TO "anon";
GRANT ALL ON TABLE "public"."mc_events" TO "authenticated";
GRANT ALL ON TABLE "public"."mc_events" TO "service_role";



GRANT ALL ON TABLE "public"."mc_interventions" TO "anon";
GRANT ALL ON TABLE "public"."mc_interventions" TO "authenticated";
GRANT ALL ON TABLE "public"."mc_interventions" TO "service_role";



GRANT ALL ON TABLE "public"."mc_strategy_profiles" TO "anon";
GRANT ALL ON TABLE "public"."mc_strategy_profiles" TO "authenticated";
GRANT ALL ON TABLE "public"."mc_strategy_profiles" TO "service_role";



GRANT ALL ON TABLE "public"."mem_archives" TO "anon";
GRANT ALL ON TABLE "public"."mem_archives" TO "authenticated";
GRANT ALL ON TABLE "public"."mem_archives" TO "service_role";



GRANT ALL ON TABLE "public"."mem_compressed" TO "anon";
GRANT ALL ON TABLE "public"."mem_compressed" TO "authenticated";
GRANT ALL ON TABLE "public"."mem_compressed" TO "service_role";



GRANT ALL ON TABLE "public"."mem_compression_jobs" TO "anon";
GRANT ALL ON TABLE "public"."mem_compression_jobs" TO "authenticated";
GRANT ALL ON TABLE "public"."mem_compression_jobs" TO "service_role";



GRANT ALL ON TABLE "public"."mem_compression_settings" TO "anon";
GRANT ALL ON TABLE "public"."mem_compression_settings" TO "authenticated";
GRANT ALL ON TABLE "public"."mem_compression_settings" TO "service_role";



GRANT ALL ON TABLE "public"."memories" TO "anon";
GRANT ALL ON TABLE "public"."memories" TO "authenticated";
GRANT ALL ON TABLE "public"."memories" TO "service_role";



GRANT ALL ON TABLE "public"."memory_events" TO "anon";
GRANT ALL ON TABLE "public"."memory_events" TO "authenticated";
GRANT ALL ON TABLE "public"."memory_events" TO "service_role";



GRANT ALL ON TABLE "public"."memory_patterns" TO "anon";
GRANT ALL ON TABLE "public"."memory_patterns" TO "authenticated";
GRANT ALL ON TABLE "public"."memory_patterns" TO "service_role";



GRANT ALL ON TABLE "public"."mind_models" TO "anon";
GRANT ALL ON TABLE "public"."mind_models" TO "authenticated";
GRANT ALL ON TABLE "public"."mind_models" TO "service_role";



GRANT ALL ON TABLE "public"."motor_routine_metrics" TO "anon";
GRANT ALL ON TABLE "public"."motor_routine_metrics" TO "authenticated";
GRANT ALL ON TABLE "public"."motor_routine_metrics" TO "service_role";



GRANT ALL ON TABLE "public"."motor_routine_runs" TO "anon";
GRANT ALL ON TABLE "public"."motor_routine_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."motor_routine_runs" TO "service_role";



GRANT ALL ON TABLE "public"."motor_routine_steps" TO "anon";
GRANT ALL ON TABLE "public"."motor_routine_steps" TO "authenticated";
GRANT ALL ON TABLE "public"."motor_routine_steps" TO "service_role";



GRANT ALL ON TABLE "public"."motor_routine_triggers" TO "anon";
GRANT ALL ON TABLE "public"."motor_routine_triggers" TO "authenticated";
GRANT ALL ON TABLE "public"."motor_routine_triggers" TO "service_role";



GRANT ALL ON TABLE "public"."motor_routines" TO "anon";
GRANT ALL ON TABLE "public"."motor_routines" TO "authenticated";
GRANT ALL ON TABLE "public"."motor_routines" TO "service_role";



GRANT ALL ON TABLE "public"."mythic_achievements" TO "anon";
GRANT ALL ON TABLE "public"."mythic_achievements" TO "authenticated";
GRANT ALL ON TABLE "public"."mythic_achievements" TO "service_role";



GRANT ALL ON TABLE "public"."mythic_archetypes" TO "anon";
GRANT ALL ON TABLE "public"."mythic_archetypes" TO "authenticated";
GRANT ALL ON TABLE "public"."mythic_archetypes" TO "service_role";



GRANT ALL ON TABLE "public"."mythic_arcs" TO "anon";
GRANT ALL ON TABLE "public"."mythic_arcs" TO "authenticated";
GRANT ALL ON TABLE "public"."mythic_arcs" TO "service_role";



GRANT ALL ON TABLE "public"."mythic_belt_levels" TO "anon";
GRANT ALL ON TABLE "public"."mythic_belt_levels" TO "authenticated";
GRANT ALL ON TABLE "public"."mythic_belt_levels" TO "service_role";



GRANT ALL ON TABLE "public"."mythic_belt_progress" TO "anon";
GRANT ALL ON TABLE "public"."mythic_belt_progress" TO "authenticated";
GRANT ALL ON TABLE "public"."mythic_belt_progress" TO "service_role";



GRANT ALL ON TABLE "public"."mythic_coach_sessions" TO "anon";
GRANT ALL ON TABLE "public"."mythic_coach_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."mythic_coach_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."mythic_playbooks" TO "anon";
GRANT ALL ON TABLE "public"."mythic_playbooks" TO "authenticated";
GRANT ALL ON TABLE "public"."mythic_playbooks" TO "service_role";



GRANT ALL ON TABLE "public"."mythic_quests" TO "anon";
GRANT ALL ON TABLE "public"."mythic_quests" TO "authenticated";
GRANT ALL ON TABLE "public"."mythic_quests" TO "service_role";



GRANT ALL ON TABLE "public"."mythic_rituals" TO "anon";
GRANT ALL ON TABLE "public"."mythic_rituals" TO "authenticated";
GRANT ALL ON TABLE "public"."mythic_rituals" TO "service_role";



GRANT ALL ON TABLE "public"."mythic_sessions" TO "anon";
GRANT ALL ON TABLE "public"."mythic_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."mythic_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."mythic_training_focus" TO "anon";
GRANT ALL ON TABLE "public"."mythic_training_focus" TO "authenticated";
GRANT ALL ON TABLE "public"."mythic_training_focus" TO "service_role";



GRANT ALL ON TABLE "public"."mythic_training_missions" TO "anon";
GRANT ALL ON TABLE "public"."mythic_training_missions" TO "authenticated";
GRANT ALL ON TABLE "public"."mythic_training_missions" TO "service_role";



GRANT ALL ON TABLE "public"."mythic_training_plans" TO "anon";
GRANT ALL ON TABLE "public"."mythic_training_plans" TO "authenticated";
GRANT ALL ON TABLE "public"."mythic_training_plans" TO "service_role";



GRANT ALL ON TABLE "public"."mythic_training_reflections" TO "anon";
GRANT ALL ON TABLE "public"."mythic_training_reflections" TO "authenticated";
GRANT ALL ON TABLE "public"."mythic_training_reflections" TO "service_role";



GRANT ALL ON TABLE "public"."mythic_voice_mappings" TO "anon";
GRANT ALL ON TABLE "public"."mythic_voice_mappings" TO "authenticated";
GRANT ALL ON TABLE "public"."mythic_voice_mappings" TO "service_role";



GRANT ALL ON TABLE "public"."narrative_snapshots" TO "anon";
GRANT ALL ON TABLE "public"."narrative_snapshots" TO "authenticated";
GRANT ALL ON TABLE "public"."narrative_snapshots" TO "service_role";



GRANT ALL ON TABLE "public"."notes" TO "anon";
GRANT ALL ON TABLE "public"."notes" TO "authenticated";
GRANT ALL ON TABLE "public"."notes" TO "service_role";



GRANT ALL ON TABLE "public"."notification_log" TO "anon";
GRANT ALL ON TABLE "public"."notification_log" TO "authenticated";
GRANT ALL ON TABLE "public"."notification_log" TO "service_role";



GRANT ALL ON TABLE "public"."notification_preferences" TO "anon";
GRANT ALL ON TABLE "public"."notification_preferences" TO "authenticated";
GRANT ALL ON TABLE "public"."notification_preferences" TO "service_role";



GRANT ALL ON TABLE "public"."notification_queue" TO "anon";
GRANT ALL ON TABLE "public"."notification_queue" TO "authenticated";
GRANT ALL ON TABLE "public"."notification_queue" TO "service_role";



GRANT ALL ON TABLE "public"."onboarding_conversations" TO "anon";
GRANT ALL ON TABLE "public"."onboarding_conversations" TO "authenticated";
GRANT ALL ON TABLE "public"."onboarding_conversations" TO "service_role";



GRANT ALL ON TABLE "public"."onboarding_state" TO "anon";
GRANT ALL ON TABLE "public"."onboarding_state" TO "authenticated";
GRANT ALL ON TABLE "public"."onboarding_state" TO "service_role";



GRANT ALL ON TABLE "public"."ops_audit_log" TO "anon";
GRANT ALL ON TABLE "public"."ops_audit_log" TO "authenticated";
GRANT ALL ON TABLE "public"."ops_audit_log" TO "service_role";



GRANT ALL ON TABLE "public"."ops_automation_locks" TO "anon";
GRANT ALL ON TABLE "public"."ops_automation_locks" TO "authenticated";
GRANT ALL ON TABLE "public"."ops_automation_locks" TO "service_role";



GRANT ALL ON TABLE "public"."ops_incident_events" TO "anon";
GRANT ALL ON TABLE "public"."ops_incident_events" TO "authenticated";
GRANT ALL ON TABLE "public"."ops_incident_events" TO "service_role";



GRANT ALL ON TABLE "public"."ops_incidents" TO "anon";
GRANT ALL ON TABLE "public"."ops_incidents" TO "authenticated";
GRANT ALL ON TABLE "public"."ops_incidents" TO "service_role";



GRANT ALL ON TABLE "public"."org_members" TO "anon";
GRANT ALL ON TABLE "public"."org_members" TO "authenticated";
GRANT ALL ON TABLE "public"."org_members" TO "service_role";



GRANT ALL ON TABLE "public"."organizations" TO "anon";
GRANT ALL ON TABLE "public"."organizations" TO "authenticated";
GRANT ALL ON TABLE "public"."organizations" TO "service_role";



GRANT ALL ON TABLE "public"."persona_arc_events" TO "anon";
GRANT ALL ON TABLE "public"."persona_arc_events" TO "authenticated";
GRANT ALL ON TABLE "public"."persona_arc_events" TO "service_role";



GRANT ALL ON TABLE "public"."persona_archetype_stats" TO "anon";
GRANT ALL ON TABLE "public"."persona_archetype_stats" TO "authenticated";
GRANT ALL ON TABLE "public"."persona_archetype_stats" TO "service_role";



GRANT ALL ON TABLE "public"."persona_archetypes" TO "anon";
GRANT ALL ON TABLE "public"."persona_archetypes" TO "authenticated";
GRANT ALL ON TABLE "public"."persona_archetypes" TO "service_role";



GRANT ALL ON TABLE "public"."persona_companion_events" TO "anon";
GRANT ALL ON TABLE "public"."persona_companion_events" TO "authenticated";
GRANT ALL ON TABLE "public"."persona_companion_events" TO "service_role";



GRANT ALL ON TABLE "public"."persona_companion_highlights" TO "anon";
GRANT ALL ON TABLE "public"."persona_companion_highlights" TO "authenticated";
GRANT ALL ON TABLE "public"."persona_companion_highlights" TO "service_role";



GRANT ALL ON TABLE "public"."persona_companion_state" TO "anon";
GRANT ALL ON TABLE "public"."persona_companion_state" TO "authenticated";
GRANT ALL ON TABLE "public"."persona_companion_state" TO "service_role";



GRANT ALL ON TABLE "public"."persona_dna_templates" TO "anon";
GRANT ALL ON TABLE "public"."persona_dna_templates" TO "authenticated";
GRANT ALL ON TABLE "public"."persona_dna_templates" TO "service_role";



GRANT ALL ON TABLE "public"."persona_interaction_stats" TO "anon";
GRANT ALL ON TABLE "public"."persona_interaction_stats" TO "authenticated";
GRANT ALL ON TABLE "public"."persona_interaction_stats" TO "service_role";



GRANT ALL ON TABLE "public"."persona_memory_snapshots" TO "anon";
GRANT ALL ON TABLE "public"."persona_memory_snapshots" TO "authenticated";
GRANT ALL ON TABLE "public"."persona_memory_snapshots" TO "service_role";



GRANT ALL ON TABLE "public"."persona_microstyle_prefs" TO "anon";
GRANT ALL ON TABLE "public"."persona_microstyle_prefs" TO "authenticated";
GRANT ALL ON TABLE "public"."persona_microstyle_prefs" TO "service_role";



GRANT ALL ON TABLE "public"."persona_style_variants" TO "anon";
GRANT ALL ON TABLE "public"."persona_style_variants" TO "authenticated";
GRANT ALL ON TABLE "public"."persona_style_variants" TO "service_role";



GRANT ALL ON TABLE "public"."persona_user_arc" TO "anon";
GRANT ALL ON TABLE "public"."persona_user_arc" TO "authenticated";
GRANT ALL ON TABLE "public"."persona_user_arc" TO "service_role";



GRANT ALL ON TABLE "public"."personal_heuristics" TO "anon";
GRANT ALL ON TABLE "public"."personal_heuristics" TO "authenticated";
GRANT ALL ON TABLE "public"."personal_heuristics" TO "service_role";



GRANT ALL ON TABLE "public"."personas" TO "anon";
GRANT ALL ON TABLE "public"."personas" TO "authenticated";
GRANT ALL ON TABLE "public"."personas" TO "service_role";



GRANT ALL ON TABLE "public"."philosophy_exercises" TO "anon";
GRANT ALL ON TABLE "public"."philosophy_exercises" TO "authenticated";
GRANT ALL ON TABLE "public"."philosophy_exercises" TO "service_role";



GRANT ALL ON TABLE "public"."philosophy_lessons" TO "anon";
GRANT ALL ON TABLE "public"."philosophy_lessons" TO "authenticated";
GRANT ALL ON TABLE "public"."philosophy_lessons" TO "service_role";



GRANT ALL ON TABLE "public"."philosophy_schools" TO "anon";
GRANT ALL ON TABLE "public"."philosophy_schools" TO "authenticated";
GRANT ALL ON TABLE "public"."philosophy_schools" TO "service_role";



GRANT ALL ON TABLE "public"."plan_items" TO "anon";
GRANT ALL ON TABLE "public"."plan_items" TO "authenticated";
GRANT ALL ON TABLE "public"."plan_items" TO "service_role";



GRANT ALL ON TABLE "public"."planning_constraints" TO "anon";
GRANT ALL ON TABLE "public"."planning_constraints" TO "authenticated";
GRANT ALL ON TABLE "public"."planning_constraints" TO "service_role";



GRANT ALL ON TABLE "public"."planning_decisions" TO "anon";
GRANT ALL ON TABLE "public"."planning_decisions" TO "authenticated";
GRANT ALL ON TABLE "public"."planning_decisions" TO "service_role";



GRANT ALL ON TABLE "public"."planning_overrides" TO "anon";
GRANT ALL ON TABLE "public"."planning_overrides" TO "authenticated";
GRANT ALL ON TABLE "public"."planning_overrides" TO "service_role";



GRANT ALL ON TABLE "public"."planning_sessions" TO "anon";
GRANT ALL ON TABLE "public"."planning_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."planning_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."plugin_api_keys" TO "anon";
GRANT ALL ON TABLE "public"."plugin_api_keys" TO "authenticated";
GRANT ALL ON TABLE "public"."plugin_api_keys" TO "service_role";



GRANT ALL ON TABLE "public"."plugin_automations" TO "anon";
GRANT ALL ON TABLE "public"."plugin_automations" TO "authenticated";
GRANT ALL ON TABLE "public"."plugin_automations" TO "service_role";



GRANT ALL ON TABLE "public"."plugin_data" TO "anon";
GRANT ALL ON TABLE "public"."plugin_data" TO "authenticated";
GRANT ALL ON TABLE "public"."plugin_data" TO "service_role";



GRANT ALL ON TABLE "public"."plugin_events" TO "anon";
GRANT ALL ON TABLE "public"."plugin_events" TO "authenticated";
GRANT ALL ON TABLE "public"."plugin_events" TO "service_role";



GRANT ALL ON TABLE "public"."plugin_webhooks" TO "anon";
GRANT ALL ON TABLE "public"."plugin_webhooks" TO "authenticated";
GRANT ALL ON TABLE "public"."plugin_webhooks" TO "service_role";



GRANT ALL ON TABLE "public"."plugins" TO "anon";
GRANT ALL ON TABLE "public"."plugins" TO "authenticated";
GRANT ALL ON TABLE "public"."plugins" TO "service_role";



GRANT ALL ON TABLE "public"."prefrontal_goals" TO "anon";
GRANT ALL ON TABLE "public"."prefrontal_goals" TO "authenticated";
GRANT ALL ON TABLE "public"."prefrontal_goals" TO "service_role";



GRANT ALL ON TABLE "public"."presence_daily_summaries" TO "anon";
GRANT ALL ON TABLE "public"."presence_daily_summaries" TO "authenticated";
GRANT ALL ON TABLE "public"."presence_daily_summaries" TO "service_role";



GRANT ALL ON TABLE "public"."presence_decisions" TO "anon";
GRANT ALL ON TABLE "public"."presence_decisions" TO "authenticated";
GRANT ALL ON TABLE "public"."presence_decisions" TO "service_role";



GRANT ALL ON TABLE "public"."presence_events" TO "anon";
GRANT ALL ON TABLE "public"."presence_events" TO "authenticated";
GRANT ALL ON TABLE "public"."presence_events" TO "service_role";



GRANT ALL ON TABLE "public"."proactive_interventions" TO "anon";
GRANT ALL ON TABLE "public"."proactive_interventions" TO "authenticated";
GRANT ALL ON TABLE "public"."proactive_interventions" TO "service_role";



GRANT ALL ON TABLE "public"."profiles" TO "anon";
GRANT ALL ON TABLE "public"."profiles" TO "authenticated";
GRANT ALL ON TABLE "public"."profiles" TO "service_role";



GRANT ALL ON TABLE "public"."pulse_brain_preferences" TO "anon";
GRANT ALL ON TABLE "public"."pulse_brain_preferences" TO "authenticated";
GRANT ALL ON TABLE "public"."pulse_brain_preferences" TO "service_role";



GRANT ALL ON TABLE "public"."pulse_brain_surface_events" TO "anon";
GRANT ALL ON TABLE "public"."pulse_brain_surface_events" TO "authenticated";
GRANT ALL ON TABLE "public"."pulse_brain_surface_events" TO "service_role";



GRANT ALL ON TABLE "public"."pulse_docs" TO "anon";
GRANT ALL ON TABLE "public"."pulse_docs" TO "authenticated";
GRANT ALL ON TABLE "public"."pulse_docs" TO "service_role";



GRANT ALL ON TABLE "public"."pulse_insight_acknowledgements" TO "anon";
GRANT ALL ON TABLE "public"."pulse_insight_acknowledgements" TO "authenticated";
GRANT ALL ON TABLE "public"."pulse_insight_acknowledgements" TO "service_role";



GRANT ALL ON TABLE "public"."pulse_introduction_sessions" TO "anon";
GRANT ALL ON TABLE "public"."pulse_introduction_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."pulse_introduction_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."push_subscriptions" TO "anon";
GRANT ALL ON TABLE "public"."push_subscriptions" TO "authenticated";
GRANT ALL ON TABLE "public"."push_subscriptions" TO "service_role";



GRANT ALL ON TABLE "public"."quest_catalog" TO "anon";
GRANT ALL ON TABLE "public"."quest_catalog" TO "authenticated";
GRANT ALL ON TABLE "public"."quest_catalog" TO "service_role";



GRANT ALL ON TABLE "public"."quest_completions" TO "anon";
GRANT ALL ON TABLE "public"."quest_completions" TO "authenticated";
GRANT ALL ON TABLE "public"."quest_completions" TO "service_role";



GRANT ALL ON TABLE "public"."referral_rewards" TO "anon";
GRANT ALL ON TABLE "public"."referral_rewards" TO "authenticated";
GRANT ALL ON TABLE "public"."referral_rewards" TO "service_role";



GRANT ALL ON TABLE "public"."relational_identities" TO "anon";
GRANT ALL ON TABLE "public"."relational_identities" TO "authenticated";
GRANT ALL ON TABLE "public"."relational_identities" TO "service_role";



GRANT ALL ON TABLE "public"."relational_predictions" TO "anon";
GRANT ALL ON TABLE "public"."relational_predictions" TO "authenticated";
GRANT ALL ON TABLE "public"."relational_predictions" TO "service_role";



GRANT ALL ON TABLE "public"."relational_state_snapshots" TO "anon";
GRANT ALL ON TABLE "public"."relational_state_snapshots" TO "authenticated";
GRANT ALL ON TABLE "public"."relational_state_snapshots" TO "service_role";



GRANT ALL ON TABLE "public"."relationship_highlights" TO "anon";
GRANT ALL ON TABLE "public"."relationship_highlights" TO "authenticated";
GRANT ALL ON TABLE "public"."relationship_highlights" TO "service_role";



GRANT ALL ON TABLE "public"."relationship_interactions" TO "anon";
GRANT ALL ON TABLE "public"."relationship_interactions" TO "authenticated";
GRANT ALL ON TABLE "public"."relationship_interactions" TO "service_role";



GRANT ALL ON TABLE "public"."relationships" TO "anon";
GRANT ALL ON TABLE "public"."relationships" TO "authenticated";
GRANT ALL ON TABLE "public"."relationships" TO "service_role";



GRANT ALL ON TABLE "public"."reminder_subscriptions" TO "anon";
GRANT ALL ON TABLE "public"."reminder_subscriptions" TO "authenticated";
GRANT ALL ON TABLE "public"."reminder_subscriptions" TO "service_role";



GRANT ALL ON TABLE "public"."reply_drafts" TO "anon";
GRANT ALL ON TABLE "public"."reply_drafts" TO "authenticated";
GRANT ALL ON TABLE "public"."reply_drafts" TO "service_role";



GRANT ALL ON TABLE "public"."response_style_profiles" TO "anon";
GRANT ALL ON TABLE "public"."response_style_profiles" TO "authenticated";
GRANT ALL ON TABLE "public"."response_style_profiles" TO "service_role";



GRANT ALL ON TABLE "public"."safety_incidents" TO "anon";
GRANT ALL ON TABLE "public"."safety_incidents" TO "authenticated";
GRANT ALL ON TABLE "public"."safety_incidents" TO "service_role";



GRANT ALL ON TABLE "public"."safety_policies" TO "anon";
GRANT ALL ON TABLE "public"."safety_policies" TO "authenticated";
GRANT ALL ON TABLE "public"."safety_policies" TO "service_role";



GRANT ALL ON TABLE "public"."scheduler_targets" TO "anon";
GRANT ALL ON TABLE "public"."scheduler_targets" TO "authenticated";
GRANT ALL ON TABLE "public"."scheduler_targets" TO "service_role";



GRANT ALL ON TABLE "public"."schema_identity_violations" TO "anon";
GRANT ALL ON TABLE "public"."schema_identity_violations" TO "authenticated";
GRANT ALL ON TABLE "public"."schema_identity_violations" TO "service_role";



GRANT ALL ON TABLE "public"."self_identity_snapshots" TO "anon";
GRANT ALL ON TABLE "public"."self_identity_snapshots" TO "authenticated";
GRANT ALL ON TABLE "public"."self_identity_snapshots" TO "service_role";



GRANT ALL ON TABLE "public"."self_mirror_deltas" TO "anon";
GRANT ALL ON TABLE "public"."self_mirror_deltas" TO "authenticated";
GRANT ALL ON TABLE "public"."self_mirror_deltas" TO "service_role";



GRANT ALL ON TABLE "public"."self_mirror_facets" TO "anon";
GRANT ALL ON TABLE "public"."self_mirror_facets" TO "authenticated";
GRANT ALL ON TABLE "public"."self_mirror_facets" TO "service_role";



GRANT ALL ON TABLE "public"."self_mirror_highlights" TO "anon";
GRANT ALL ON TABLE "public"."self_mirror_highlights" TO "authenticated";
GRANT ALL ON TABLE "public"."self_mirror_highlights" TO "service_role";



GRANT ALL ON TABLE "public"."self_mirror_sessions" TO "anon";
GRANT ALL ON TABLE "public"."self_mirror_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."self_mirror_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."self_mirror_snapshots" TO "anon";
GRANT ALL ON TABLE "public"."self_mirror_snapshots" TO "authenticated";
GRANT ALL ON TABLE "public"."self_mirror_snapshots" TO "service_role";



GRANT ALL ON TABLE "public"."self_perception_signals" TO "anon";
GRANT ALL ON TABLE "public"."self_perception_signals" TO "authenticated";
GRANT ALL ON TABLE "public"."self_perception_signals" TO "service_role";



GRANT ALL ON TABLE "public"."sim_decision_trees" TO "anon";
GRANT ALL ON TABLE "public"."sim_decision_trees" TO "authenticated";
GRANT ALL ON TABLE "public"."sim_decision_trees" TO "service_role";



GRANT ALL ON TABLE "public"."sim_history" TO "anon";
GRANT ALL ON TABLE "public"."sim_history" TO "authenticated";
GRANT ALL ON TABLE "public"."sim_history" TO "service_role";



GRANT ALL ON TABLE "public"."sim_runs" TO "anon";
GRANT ALL ON TABLE "public"."sim_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."sim_runs" TO "service_role";



GRANT ALL ON TABLE "public"."sim_scenarios" TO "anon";
GRANT ALL ON TABLE "public"."sim_scenarios" TO "authenticated";
GRANT ALL ON TABLE "public"."sim_scenarios" TO "service_role";



GRANT ALL ON TABLE "public"."sim_simulations" TO "anon";
GRANT ALL ON TABLE "public"."sim_simulations" TO "authenticated";
GRANT ALL ON TABLE "public"."sim_simulations" TO "service_role";



GRANT ALL ON TABLE "public"."sim_templates" TO "anon";
GRANT ALL ON TABLE "public"."sim_templates" TO "authenticated";
GRANT ALL ON TABLE "public"."sim_templates" TO "service_role";



GRANT ALL ON TABLE "public"."sim_what_ifs" TO "anon";
GRANT ALL ON TABLE "public"."sim_what_ifs" TO "authenticated";
GRANT ALL ON TABLE "public"."sim_what_ifs" TO "service_role";



GRANT ALL ON TABLE "public"."simulation_fix_plans" TO "anon";
GRANT ALL ON TABLE "public"."simulation_fix_plans" TO "authenticated";
GRANT ALL ON TABLE "public"."simulation_fix_plans" TO "service_role";



GRANT ALL ON TABLE "public"."simulation_metrics" TO "anon";
GRANT ALL ON TABLE "public"."simulation_metrics" TO "authenticated";
GRANT ALL ON TABLE "public"."simulation_metrics" TO "service_role";



GRANT ALL ON TABLE "public"."simulation_models" TO "anon";
GRANT ALL ON TABLE "public"."simulation_models" TO "authenticated";
GRANT ALL ON TABLE "public"."simulation_models" TO "service_role";



GRANT ALL ON TABLE "public"."simulation_outcomes" TO "anon";
GRANT ALL ON TABLE "public"."simulation_outcomes" TO "authenticated";
GRANT ALL ON TABLE "public"."simulation_outcomes" TO "service_role";



GRANT ALL ON TABLE "public"."simulation_policies" TO "anon";
GRANT ALL ON TABLE "public"."simulation_policies" TO "authenticated";
GRANT ALL ON TABLE "public"."simulation_policies" TO "service_role";



GRANT ALL ON TABLE "public"."simulation_runs" TO "anon";
GRANT ALL ON TABLE "public"."simulation_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."simulation_runs" TO "service_role";



GRANT ALL ON TABLE "public"."simulation_steps" TO "anon";
GRANT ALL ON TABLE "public"."simulation_steps" TO "authenticated";
GRANT ALL ON TABLE "public"."simulation_steps" TO "service_role";



GRANT ALL ON TABLE "public"."simulation_timelines" TO "anon";
GRANT ALL ON TABLE "public"."simulation_timelines" TO "authenticated";
GRANT ALL ON TABLE "public"."simulation_timelines" TO "service_role";



GRANT ALL ON TABLE "public"."sms_messages" TO "anon";
GRANT ALL ON TABLE "public"."sms_messages" TO "authenticated";
GRANT ALL ON TABLE "public"."sms_messages" TO "service_role";



GRANT ALL ON TABLE "public"."social_edges" TO "anon";
GRANT ALL ON TABLE "public"."social_edges" TO "authenticated";
GRANT ALL ON TABLE "public"."social_edges" TO "service_role";



GRANT ALL ON TABLE "public"."social_entities" TO "anon";
GRANT ALL ON TABLE "public"."social_entities" TO "authenticated";
GRANT ALL ON TABLE "public"."social_entities" TO "service_role";



GRANT ALL ON TABLE "public"."social_insights" TO "anon";
GRANT ALL ON TABLE "public"."social_insights" TO "authenticated";
GRANT ALL ON TABLE "public"."social_insights" TO "service_role";



GRANT ALL ON TABLE "public"."social_nodes" TO "anon";
GRANT ALL ON TABLE "public"."social_nodes" TO "authenticated";
GRANT ALL ON TABLE "public"."social_nodes" TO "service_role";



GRANT ALL ON TABLE "public"."social_recommendations" TO "anon";
GRANT ALL ON TABLE "public"."social_recommendations" TO "authenticated";
GRANT ALL ON TABLE "public"."social_recommendations" TO "service_role";



GRANT ALL ON TABLE "public"."social_risk_events" TO "anon";
GRANT ALL ON TABLE "public"."social_risk_events" TO "authenticated";
GRANT ALL ON TABLE "public"."social_risk_events" TO "service_role";



GRANT ALL ON TABLE "public"."social_state_snapshots" TO "anon";
GRANT ALL ON TABLE "public"."social_state_snapshots" TO "authenticated";
GRANT ALL ON TABLE "public"."social_state_snapshots" TO "service_role";



GRANT ALL ON TABLE "public"."somatic_alerts" TO "anon";
GRANT ALL ON TABLE "public"."somatic_alerts" TO "authenticated";
GRANT ALL ON TABLE "public"."somatic_alerts" TO "service_role";



GRANT ALL ON TABLE "public"."somatic_daily_metrics" TO "anon";
GRANT ALL ON TABLE "public"."somatic_daily_metrics" TO "authenticated";
GRANT ALL ON TABLE "public"."somatic_daily_metrics" TO "service_role";



GRANT ALL ON TABLE "public"."somatic_device_settings" TO "anon";
GRANT ALL ON TABLE "public"."somatic_device_settings" TO "authenticated";
GRANT ALL ON TABLE "public"."somatic_device_settings" TO "service_role";



GRANT ALL ON TABLE "public"."somatic_patterns" TO "anon";
GRANT ALL ON TABLE "public"."somatic_patterns" TO "authenticated";
GRANT ALL ON TABLE "public"."somatic_patterns" TO "service_role";



GRANT ALL ON TABLE "public"."somatic_raw_device_events" TO "anon";
GRANT ALL ON TABLE "public"."somatic_raw_device_events" TO "authenticated";
GRANT ALL ON TABLE "public"."somatic_raw_device_events" TO "service_role";



GRANT ALL ON TABLE "public"."somatic_samples" TO "anon";
GRANT ALL ON TABLE "public"."somatic_samples" TO "authenticated";
GRANT ALL ON TABLE "public"."somatic_samples" TO "service_role";



GRANT ALL ON TABLE "public"."somatic_state_daily" TO "anon";
GRANT ALL ON TABLE "public"."somatic_state_daily" TO "authenticated";
GRANT ALL ON TABLE "public"."somatic_state_daily" TO "service_role";



GRANT ALL ON TABLE "public"."strategic_conflicts" TO "anon";
GRANT ALL ON TABLE "public"."strategic_conflicts" TO "authenticated";
GRANT ALL ON TABLE "public"."strategic_conflicts" TO "service_role";



GRANT ALL ON TABLE "public"."strategic_domains" TO "anon";
GRANT ALL ON TABLE "public"."strategic_domains" TO "authenticated";
GRANT ALL ON TABLE "public"."strategic_domains" TO "service_role";



GRANT ALL ON TABLE "public"."strategic_equilibria" TO "anon";
GRANT ALL ON TABLE "public"."strategic_equilibria" TO "authenticated";
GRANT ALL ON TABLE "public"."strategic_equilibria" TO "service_role";



GRANT ALL ON TABLE "public"."strategic_objectives" TO "anon";
GRANT ALL ON TABLE "public"."strategic_objectives" TO "authenticated";
GRANT ALL ON TABLE "public"."strategic_objectives" TO "service_role";



GRANT ALL ON TABLE "public"."strategic_plans" TO "anon";
GRANT ALL ON TABLE "public"."strategic_plans" TO "authenticated";
GRANT ALL ON TABLE "public"."strategic_plans" TO "service_role";



GRANT ALL ON TABLE "public"."strategic_playbooks" TO "anon";
GRANT ALL ON TABLE "public"."strategic_playbooks" TO "authenticated";
GRANT ALL ON TABLE "public"."strategic_playbooks" TO "service_role";



GRANT ALL ON TABLE "public"."strategic_review_events" TO "anon";
GRANT ALL ON TABLE "public"."strategic_review_events" TO "authenticated";
GRANT ALL ON TABLE "public"."strategic_review_events" TO "service_role";



GRANT ALL ON TABLE "public"."strategic_state_snapshots" TO "anon";
GRANT ALL ON TABLE "public"."strategic_state_snapshots" TO "authenticated";
GRANT ALL ON TABLE "public"."strategic_state_snapshots" TO "service_role";



GRANT ALL ON TABLE "public"."strategist_sessions" TO "anon";
GRANT ALL ON TABLE "public"."strategist_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."strategist_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."strategy_actions" TO "anon";
GRANT ALL ON TABLE "public"."strategy_actions" TO "authenticated";
GRANT ALL ON TABLE "public"."strategy_actions" TO "service_role";



GRANT ALL ON TABLE "public"."strategy_feedback" TO "anon";
GRANT ALL ON TABLE "public"."strategy_feedback" TO "authenticated";
GRANT ALL ON TABLE "public"."strategy_feedback" TO "service_role";



GRANT ALL ON TABLE "public"."strategy_paths" TO "anon";
GRANT ALL ON TABLE "public"."strategy_paths" TO "authenticated";
GRANT ALL ON TABLE "public"."strategy_paths" TO "service_role";



GRANT ALL ON TABLE "public"."strategy_pillars" TO "anon";
GRANT ALL ON TABLE "public"."strategy_pillars" TO "authenticated";
GRANT ALL ON TABLE "public"."strategy_pillars" TO "service_role";



GRANT ALL ON TABLE "public"."strategy_recommendations" TO "anon";
GRANT ALL ON TABLE "public"."strategy_recommendations" TO "authenticated";
GRANT ALL ON TABLE "public"."strategy_recommendations" TO "service_role";



GRANT ALL ON TABLE "public"."strategy_snapshots" TO "anon";
GRANT ALL ON TABLE "public"."strategy_snapshots" TO "authenticated";
GRANT ALL ON TABLE "public"."strategy_snapshots" TO "service_role";



GRANT ALL ON TABLE "public"."streaks" TO "anon";
GRANT ALL ON TABLE "public"."streaks" TO "authenticated";
GRANT ALL ON TABLE "public"."streaks" TO "service_role";



GRANT ALL ON TABLE "public"."system_capabilities" TO "anon";
GRANT ALL ON TABLE "public"."system_capabilities" TO "authenticated";
GRANT ALL ON TABLE "public"."system_capabilities" TO "service_role";



GRANT ALL ON TABLE "public"."system_capability_health" TO "anon";
GRANT ALL ON TABLE "public"."system_capability_health" TO "authenticated";
GRANT ALL ON TABLE "public"."system_capability_health" TO "service_role";



GRANT ALL ON TABLE "public"."system_changelog" TO "anon";
GRANT ALL ON TABLE "public"."system_changelog" TO "authenticated";
GRANT ALL ON TABLE "public"."system_changelog" TO "service_role";



GRANT ALL ON TABLE "public"."system_diagnostics_findings" TO "anon";
GRANT ALL ON TABLE "public"."system_diagnostics_findings" TO "authenticated";
GRANT ALL ON TABLE "public"."system_diagnostics_findings" TO "service_role";



GRANT ALL ON TABLE "public"."system_diagnostics_runs" TO "anon";
GRANT ALL ON TABLE "public"."system_diagnostics_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."system_diagnostics_runs" TO "service_role";



GRANT ALL ON TABLE "public"."system_experiment_runs" TO "anon";
GRANT ALL ON TABLE "public"."system_experiment_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."system_experiment_runs" TO "service_role";



GRANT ALL ON TABLE "public"."system_experiments" TO "anon";
GRANT ALL ON TABLE "public"."system_experiments" TO "authenticated";
GRANT ALL ON TABLE "public"."system_experiments" TO "service_role";



GRANT ALL ON TABLE "public"."system_improvement_ideas" TO "anon";
GRANT ALL ON TABLE "public"."system_improvement_ideas" TO "authenticated";
GRANT ALL ON TABLE "public"."system_improvement_ideas" TO "service_role";



GRANT ALL ON TABLE "public"."system_module_health" TO "anon";
GRANT ALL ON TABLE "public"."system_module_health" TO "authenticated";
GRANT ALL ON TABLE "public"."system_module_health" TO "service_role";



GRANT ALL ON TABLE "public"."system_module_metrics" TO "anon";
GRANT ALL ON TABLE "public"."system_module_metrics" TO "authenticated";
GRANT ALL ON TABLE "public"."system_module_metrics" TO "service_role";



GRANT ALL ON TABLE "public"."system_modules" TO "anon";
GRANT ALL ON TABLE "public"."system_modules" TO "authenticated";
GRANT ALL ON TABLE "public"."system_modules" TO "service_role";



GRANT ALL ON TABLE "public"."system_user_feedback" TO "anon";
GRANT ALL ON TABLE "public"."system_user_feedback" TO "authenticated";
GRANT ALL ON TABLE "public"."system_user_feedback" TO "service_role";



GRANT ALL ON TABLE "public"."task_events" TO "anon";
GRANT ALL ON TABLE "public"."task_events" TO "authenticated";
GRANT ALL ON TABLE "public"."task_events" TO "service_role";



GRANT ALL ON TABLE "public"."tb_chapters" TO "anon";
GRANT ALL ON TABLE "public"."tb_chapters" TO "authenticated";
GRANT ALL ON TABLE "public"."tb_chapters" TO "service_role";



GRANT ALL ON TABLE "public"."tb_context_snapshots" TO "anon";
GRANT ALL ON TABLE "public"."tb_context_snapshots" TO "authenticated";
GRANT ALL ON TABLE "public"."tb_context_snapshots" TO "service_role";



GRANT ALL ON TABLE "public"."tb_edges" TO "anon";
GRANT ALL ON TABLE "public"."tb_edges" TO "authenticated";
GRANT ALL ON TABLE "public"."tb_edges" TO "service_role";



GRANT ALL ON TABLE "public"."tb_embeddings" TO "anon";
GRANT ALL ON TABLE "public"."tb_embeddings" TO "authenticated";
GRANT ALL ON TABLE "public"."tb_embeddings" TO "service_role";



GRANT ALL ON TABLE "public"."tb_entities" TO "anon";
GRANT ALL ON TABLE "public"."tb_entities" TO "authenticated";
GRANT ALL ON TABLE "public"."tb_entities" TO "service_role";



GRANT ALL ON TABLE "public"."tb_entity_edges" TO "anon";
GRANT ALL ON TABLE "public"."tb_entity_edges" TO "authenticated";
GRANT ALL ON TABLE "public"."tb_entity_edges" TO "service_role";



GRANT ALL ON TABLE "public"."tb_entity_fragment_links" TO "anon";
GRANT ALL ON TABLE "public"."tb_entity_fragment_links" TO "authenticated";
GRANT ALL ON TABLE "public"."tb_entity_fragment_links" TO "service_role";



GRANT ALL ON TABLE "public"."tb_insights" TO "anon";
GRANT ALL ON TABLE "public"."tb_insights" TO "authenticated";
GRANT ALL ON TABLE "public"."tb_insights" TO "service_role";



GRANT ALL ON TABLE "public"."tb_memory_fragments" TO "anon";
GRANT ALL ON TABLE "public"."tb_memory_fragments" TO "authenticated";
GRANT ALL ON TABLE "public"."tb_memory_fragments" TO "service_role";



GRANT ALL ON TABLE "public"."tb_node_types" TO "anon";
GRANT ALL ON TABLE "public"."tb_node_types" TO "authenticated";
GRANT ALL ON TABLE "public"."tb_node_types" TO "service_role";



GRANT ALL ON TABLE "public"."tb_nodes" TO "anon";
GRANT ALL ON TABLE "public"."tb_nodes" TO "authenticated";
GRANT ALL ON TABLE "public"."tb_nodes" TO "service_role";



GRANT ALL ON TABLE "public"."tb_raw_events" TO "anon";
GRANT ALL ON TABLE "public"."tb_raw_events" TO "authenticated";
GRANT ALL ON TABLE "public"."tb_raw_events" TO "service_role";



GRANT ALL ON TABLE "public"."tb_user_patterns" TO "anon";
GRANT ALL ON TABLE "public"."tb_user_patterns" TO "authenticated";
GRANT ALL ON TABLE "public"."tb_user_patterns" TO "service_role";



GRANT ALL ON TABLE "public"."teachings" TO "anon";
GRANT ALL ON TABLE "public"."teachings" TO "authenticated";
GRANT ALL ON TABLE "public"."teachings" TO "service_role";



GRANT ALL ON TABLE "public"."theory_of_mind_profiles" TO "anon";
GRANT ALL ON TABLE "public"."theory_of_mind_profiles" TO "authenticated";
GRANT ALL ON TABLE "public"."theory_of_mind_profiles" TO "service_role";



GRANT ALL ON TABLE "public"."third_brain_events" TO "anon";
GRANT ALL ON TABLE "public"."third_brain_events" TO "authenticated";
GRANT ALL ON TABLE "public"."third_brain_events" TO "service_role";



GRANT ALL ON TABLE "public"."third_brain_insights" TO "anon";
GRANT ALL ON TABLE "public"."third_brain_insights" TO "authenticated";
GRANT ALL ON TABLE "public"."third_brain_insights" TO "service_role";



GRANT ALL ON TABLE "public"."third_brain_memories" TO "anon";
GRANT ALL ON TABLE "public"."third_brain_memories" TO "authenticated";
GRANT ALL ON TABLE "public"."third_brain_memories" TO "service_role";



GRANT ALL ON TABLE "public"."timeline_coach_sessions" TO "anon";
GRANT ALL ON TABLE "public"."timeline_coach_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."timeline_coach_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."timeline_commitments" TO "anon";
GRANT ALL ON TABLE "public"."timeline_commitments" TO "authenticated";
GRANT ALL ON TABLE "public"."timeline_commitments" TO "service_role";



GRANT ALL ON TABLE "public"."timeline_decisions" TO "anon";
GRANT ALL ON TABLE "public"."timeline_decisions" TO "authenticated";
GRANT ALL ON TABLE "public"."timeline_decisions" TO "service_role";



GRANT ALL ON TABLE "public"."timeline_preference_profile" TO "anon";
GRANT ALL ON TABLE "public"."timeline_preference_profile" TO "authenticated";
GRANT ALL ON TABLE "public"."timeline_preference_profile" TO "service_role";



GRANT ALL ON TABLE "public"."timeline_reflections" TO "anon";
GRANT ALL ON TABLE "public"."timeline_reflections" TO "authenticated";
GRANT ALL ON TABLE "public"."timeline_reflections" TO "service_role";



GRANT ALL ON TABLE "public"."usage_logs" TO "anon";
GRANT ALL ON TABLE "public"."usage_logs" TO "authenticated";
GRANT ALL ON TABLE "public"."usage_logs" TO "service_role";



GRANT ALL ON TABLE "public"."user_agi_settings" TO "anon";
GRANT ALL ON TABLE "public"."user_agi_settings" TO "authenticated";
GRANT ALL ON TABLE "public"."user_agi_settings" TO "service_role";



GRANT ALL ON TABLE "public"."user_archetype_profiles" TO "anon";
GRANT ALL ON TABLE "public"."user_archetype_profiles" TO "authenticated";
GRANT ALL ON TABLE "public"."user_archetype_profiles" TO "service_role";



GRANT ALL ON TABLE "public"."user_daily_activity_rollup" TO "anon";
GRANT ALL ON TABLE "public"."user_daily_activity_rollup" TO "authenticated";
GRANT ALL ON TABLE "public"."user_daily_activity_rollup" TO "service_role";



GRANT ALL ON TABLE "public"."user_dashboard_layouts" TO "anon";
GRANT ALL ON TABLE "public"."user_dashboard_layouts" TO "authenticated";
GRANT ALL ON TABLE "public"."user_dashboard_layouts" TO "service_role";



GRANT ALL ON TABLE "public"."user_experiment_arms" TO "anon";
GRANT ALL ON TABLE "public"."user_experiment_arms" TO "authenticated";
GRANT ALL ON TABLE "public"."user_experiment_arms" TO "service_role";



GRANT ALL ON TABLE "public"."user_experiment_data_points" TO "anon";
GRANT ALL ON TABLE "public"."user_experiment_data_points" TO "authenticated";
GRANT ALL ON TABLE "public"."user_experiment_data_points" TO "service_role";



GRANT ALL ON TABLE "public"."user_experiment_results" TO "anon";
GRANT ALL ON TABLE "public"."user_experiment_results" TO "authenticated";
GRANT ALL ON TABLE "public"."user_experiment_results" TO "service_role";



GRANT ALL ON TABLE "public"."user_experiments" TO "anon";
GRANT ALL ON TABLE "public"."user_experiments" TO "authenticated";
GRANT ALL ON TABLE "public"."user_experiments" TO "service_role";



GRANT ALL ON TABLE "public"."user_focus_profile" TO "anon";
GRANT ALL ON TABLE "public"."user_focus_profile" TO "authenticated";
GRANT ALL ON TABLE "public"."user_focus_profile" TO "service_role";



GRANT ALL ON TABLE "public"."user_id_canon_audit" TO "anon";
GRANT ALL ON TABLE "public"."user_id_canon_audit" TO "authenticated";
GRANT ALL ON TABLE "public"."user_id_canon_audit" TO "service_role";



GRANT ALL ON TABLE "public"."user_interview_sessions" TO "anon";
GRANT ALL ON TABLE "public"."user_interview_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."user_interview_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."user_job_profiles" TO "anon";
GRANT ALL ON TABLE "public"."user_job_profiles" TO "authenticated";
GRANT ALL ON TABLE "public"."user_job_profiles" TO "service_role";



GRANT ALL ON TABLE "public"."user_mythic_coach_settings" TO "anon";
GRANT ALL ON TABLE "public"."user_mythic_coach_settings" TO "authenticated";
GRANT ALL ON TABLE "public"."user_mythic_coach_settings" TO "service_role";



GRANT ALL ON TABLE "public"."user_mythic_profile" TO "anon";
GRANT ALL ON TABLE "public"."user_mythic_profile" TO "authenticated";
GRANT ALL ON TABLE "public"."user_mythic_profile" TO "service_role";



GRANT ALL ON TABLE "public"."user_onboarding_state" TO "anon";
GRANT ALL ON TABLE "public"."user_onboarding_state" TO "authenticated";
GRANT ALL ON TABLE "public"."user_onboarding_state" TO "service_role";



GRANT ALL ON TABLE "public"."user_packs" TO "anon";
GRANT ALL ON TABLE "public"."user_packs" TO "authenticated";
GRANT ALL ON TABLE "public"."user_packs" TO "service_role";



GRANT ALL ON TABLE "public"."user_persona_tuning" TO "anon";
GRANT ALL ON TABLE "public"."user_persona_tuning" TO "authenticated";
GRANT ALL ON TABLE "public"."user_persona_tuning" TO "service_role";



GRANT ALL ON TABLE "public"."user_philosophy_progress" TO "anon";
GRANT ALL ON TABLE "public"."user_philosophy_progress" TO "authenticated";
GRANT ALL ON TABLE "public"."user_philosophy_progress" TO "service_role";



GRANT ALL ON TABLE "public"."user_plugins" TO "anon";
GRANT ALL ON TABLE "public"."user_plugins" TO "authenticated";
GRANT ALL ON TABLE "public"."user_plugins" TO "service_role";



GRANT ALL ON TABLE "public"."user_prefs" TO "anon";
GRANT ALL ON TABLE "public"."user_prefs" TO "authenticated";
GRANT ALL ON TABLE "public"."user_prefs" TO "service_role";



GRANT ALL ON TABLE "public"."user_profiles" TO "anon";
GRANT ALL ON TABLE "public"."user_profiles" TO "authenticated";
GRANT ALL ON TABLE "public"."user_profiles" TO "service_role";



GRANT ALL ON TABLE "public"."user_safety_settings" TO "anon";
GRANT ALL ON TABLE "public"."user_safety_settings" TO "authenticated";
GRANT ALL ON TABLE "public"."user_safety_settings" TO "service_role";



GRANT ALL ON TABLE "public"."user_settings" TO "anon";
GRANT ALL ON TABLE "public"."user_settings" TO "authenticated";
GRANT ALL ON TABLE "public"."user_settings" TO "service_role";



GRANT ALL ON TABLE "public"."users" TO "anon";
GRANT ALL ON TABLE "public"."users" TO "authenticated";
GRANT ALL ON TABLE "public"."users" TO "service_role";



GRANT ALL ON TABLE "public"."value_profile" TO "anon";
GRANT ALL ON TABLE "public"."value_profile" TO "authenticated";
GRANT ALL ON TABLE "public"."value_profile" TO "service_role";



GRANT ALL ON TABLE "public"."vault_access_log" TO "anon";
GRANT ALL ON TABLE "public"."vault_access_log" TO "authenticated";
GRANT ALL ON TABLE "public"."vault_access_log" TO "service_role";



GRANT ALL ON TABLE "public"."vault_emergency_access" TO "anon";
GRANT ALL ON TABLE "public"."vault_emergency_access" TO "authenticated";
GRANT ALL ON TABLE "public"."vault_emergency_access" TO "service_role";



GRANT ALL ON TABLE "public"."vault_items" TO "anon";
GRANT ALL ON TABLE "public"."vault_items" TO "authenticated";
GRANT ALL ON TABLE "public"."vault_items" TO "service_role";



GRANT ALL ON TABLE "public"."vault_keys" TO "anon";
GRANT ALL ON TABLE "public"."vault_keys" TO "authenticated";
GRANT ALL ON TABLE "public"."vault_keys" TO "service_role";



GRANT ALL ON TABLE "public"."vault_secure_notes" TO "anon";
GRANT ALL ON TABLE "public"."vault_secure_notes" TO "authenticated";
GRANT ALL ON TABLE "public"."vault_secure_notes" TO "service_role";



GRANT ALL ON TABLE "public"."vault_shares" TO "anon";
GRANT ALL ON TABLE "public"."vault_shares" TO "authenticated";
GRANT ALL ON TABLE "public"."vault_shares" TO "service_role";



GRANT ALL ON TABLE "public"."vertical_metrics" TO "anon";
GRANT ALL ON TABLE "public"."vertical_metrics" TO "authenticated";
GRANT ALL ON TABLE "public"."vertical_metrics" TO "service_role";



GRANT ALL ON TABLE "public"."voice_profiles" TO "anon";
GRANT ALL ON TABLE "public"."voice_profiles" TO "authenticated";
GRANT ALL ON TABLE "public"."voice_profiles" TO "service_role";



GRANT ALL ON TABLE "public"."voice_sessions" TO "anon";
GRANT ALL ON TABLE "public"."voice_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."voice_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."voice_turns" TO "anon";
GRANT ALL ON TABLE "public"."voice_turns" TO "authenticated";
GRANT ALL ON TABLE "public"."voice_turns" TO "service_role";



GRANT ALL ON TABLE "public"."voicemails" TO "anon";
GRANT ALL ON TABLE "public"."voicemails" TO "authenticated";
GRANT ALL ON TABLE "public"."voicemails" TO "service_role";



GRANT ALL ON TABLE "public"."weekly_plans" TO "anon";
GRANT ALL ON TABLE "public"."weekly_plans" TO "authenticated";
GRANT ALL ON TABLE "public"."weekly_plans" TO "service_role";



GRANT ALL ON TABLE "public"."what_if_outcomes" TO "anon";
GRANT ALL ON TABLE "public"."what_if_outcomes" TO "authenticated";
GRANT ALL ON TABLE "public"."what_if_outcomes" TO "service_role";



GRANT ALL ON TABLE "public"."what_if_runs" TO "anon";
GRANT ALL ON TABLE "public"."what_if_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."what_if_runs" TO "service_role";



GRANT ALL ON TABLE "public"."what_if_scenarios" TO "anon";
GRANT ALL ON TABLE "public"."what_if_scenarios" TO "authenticated";
GRANT ALL ON TABLE "public"."what_if_scenarios" TO "service_role";



GRANT ALL ON TABLE "public"."wisdom_lessons" TO "anon";
GRANT ALL ON TABLE "public"."wisdom_lessons" TO "authenticated";
GRANT ALL ON TABLE "public"."wisdom_lessons" TO "service_role";



GRANT ALL ON TABLE "public"."wisdom_playbooks" TO "anon";
GRANT ALL ON TABLE "public"."wisdom_playbooks" TO "authenticated";
GRANT ALL ON TABLE "public"."wisdom_playbooks" TO "service_role";



GRANT ALL ON TABLE "public"."wisdom_refresh_runs" TO "anon";
GRANT ALL ON TABLE "public"."wisdom_refresh_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."wisdom_refresh_runs" TO "service_role";



GRANT ALL ON TABLE "public"."work_scoreboard_days" TO "anon";
GRANT ALL ON TABLE "public"."work_scoreboard_days" TO "authenticated";
GRANT ALL ON TABLE "public"."work_scoreboard_days" TO "service_role";



GRANT ALL ON TABLE "public"."workspace_day_log" TO "anon";
GRANT ALL ON TABLE "public"."workspace_day_log" TO "authenticated";
GRANT ALL ON TABLE "public"."workspace_day_log" TO "service_role";



GRANT ALL ON TABLE "public"."workspace_focus_sessions" TO "anon";
GRANT ALL ON TABLE "public"."workspace_focus_sessions" TO "authenticated";
GRANT ALL ON TABLE "public"."workspace_focus_sessions" TO "service_role";



GRANT ALL ON TABLE "public"."workspace_focus_states" TO "anon";
GRANT ALL ON TABLE "public"."workspace_focus_states" TO "authenticated";
GRANT ALL ON TABLE "public"."workspace_focus_states" TO "service_role";



GRANT ALL ON TABLE "public"."workspace_interrupts" TO "anon";
GRANT ALL ON TABLE "public"."workspace_interrupts" TO "authenticated";
GRANT ALL ON TABLE "public"."workspace_interrupts" TO "service_role";



GRANT ALL ON TABLE "public"."workspace_state" TO "anon";
GRANT ALL ON TABLE "public"."workspace_state" TO "authenticated";
GRANT ALL ON TABLE "public"."workspace_state" TO "service_role";



GRANT ALL ON TABLE "public"."workspace_threads" TO "anon";
GRANT ALL ON TABLE "public"."workspace_threads" TO "authenticated";
GRANT ALL ON TABLE "public"."workspace_threads" TO "service_role";



GRANT ALL ON TABLE "public"."workspace_timeline_links" TO "anon";
GRANT ALL ON TABLE "public"."workspace_timeline_links" TO "authenticated";
GRANT ALL ON TABLE "public"."workspace_timeline_links" TO "service_role";



GRANT ALL ON TABLE "public"."workspaces" TO "anon";
GRANT ALL ON TABLE "public"."workspaces" TO "authenticated";
GRANT ALL ON TABLE "public"."workspaces" TO "service_role";



GRANT ALL ON TABLE "public"."xp_evaluation_runs" TO "anon";
GRANT ALL ON TABLE "public"."xp_evaluation_runs" TO "authenticated";
GRANT ALL ON TABLE "public"."xp_evaluation_runs" TO "service_role";



GRANT ALL ON TABLE "public"."xp_evaluators" TO "anon";
GRANT ALL ON TABLE "public"."xp_evaluators" TO "authenticated";
GRANT ALL ON TABLE "public"."xp_evaluators" TO "service_role";



GRANT ALL ON TABLE "public"."xp_events" TO "anon";
GRANT ALL ON TABLE "public"."xp_events" TO "authenticated";
GRANT ALL ON TABLE "public"."xp_events" TO "service_role";



GRANT ALL ON TABLE "public"."xp_ledger" TO "anon";
GRANT ALL ON TABLE "public"."xp_ledger" TO "authenticated";
GRANT ALL ON TABLE "public"."xp_ledger" TO "service_role";



GRANT ALL ON TABLE "public"."xp_transactions" TO "anon";
GRANT ALL ON TABLE "public"."xp_transactions" TO "authenticated";
GRANT ALL ON TABLE "public"."xp_transactions" TO "service_role";



ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON SEQUENCES TO "postgres";
ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON SEQUENCES TO "anon";
ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON SEQUENCES TO "authenticated";
ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON SEQUENCES TO "service_role";






ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON FUNCTIONS TO "postgres";
ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON FUNCTIONS TO "anon";
ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON FUNCTIONS TO "authenticated";
ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON FUNCTIONS TO "service_role";






ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON TABLES TO "postgres";
ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON TABLES TO "anon";
ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON TABLES TO "authenticated";
ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON TABLES TO "service_role";







